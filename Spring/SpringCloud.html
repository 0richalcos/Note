<!DOCTYPE html><html lang="zh" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://0richalcos.github.io/Note/Spring/SpringCloud.html"><link rel="prev" href="SpringBoot.html"><link rel="next" href="SpringMVC.html"><link rel="icon" href="../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>SpringCloud - éšä¾¿è®°è®°</title><link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css"><link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel="stylesheet" href="../_stylesheets/extra.css"><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal"> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a href="#1å¾®æœåŠ¡" class="md-skip"> è·³è½¬è‡³ </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow" data-md-component="header"> <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰"> <a href="../index.html" title="éšä¾¿è®°è®°" class="md-header__button md-logo" aria-label="éšä¾¿è®°è®°" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> éšä¾¿è®°è®° </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> SpringCloud </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input class="md-option" data-md-color-media data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal" aria-label="åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼" type="radio" name="__palette" id="__palette_0"> <label class="md-header__button md-icon" title="åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼" for="__palette_1" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> <input class="md-option" data-md-color-media data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal" aria-label="åˆ‡æ¢åˆ°äº®è‰²æ¨¡å¼" type="radio" name="__palette" id="__palette_1"> <label class="md-header__button md-icon" title="åˆ‡æ¢åˆ°äº®è‰²æ¨¡å¼" for="__palette_0" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required> <label class="md-search__icon md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class="md-search__options" aria-label="æŸ¥æ‰¾"> <button type="reset" class="md-search__icon md-icon" title="æ¸…ç©ºå½“å‰å†…å®¹" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“ </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a href="https://github.com/0richalcos/Note" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> GitHub </div> </a> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--primary" aria-label="å¯¼èˆªæ " data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a href="../index.html" title="éšä¾¿è®°è®°" class="md-nav__button md-logo" aria-label="éšä¾¿è®°è®°" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> éšä¾¿è®°è®° </label> <div class="md-nav__source"> <a href="https://github.com/0richalcos/Note" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> GitHub </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../index.html" class="md-nav__link"> <span class="md-ellipsis"> ğŸ  é¦–é¡µ </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2"> <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0"> <span class="md-ellipsis"> â™¨ï¸ Java </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> â™¨ï¸ Java </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../Java/Java.html" class="md-nav__link"> <span class="md-ellipsis"> Java </span> </a> </li> <li class="md-nav__item"> <a href="../Java/Java8.html" class="md-nav__link"> <span class="md-ellipsis"> Java 8 </span> </a> </li> <li class="md-nav__item"> <a href="../Java/JavaBasics.html" class="md-nav__link"> <span class="md-ellipsis"> Java åŸºç¡€ </span> </a> </li> <li class="md-nav__item"> <a href="../Java/JavaCollection.html" class="md-nav__link"> <span class="md-ellipsis"> Java é›†åˆ </span> </a> </li> <li class="md-nav__item"> <a href="../Java/JavaObject.html" class="md-nav__link"> <span class="md-ellipsis"> Java ç±»å’Œå¯¹è±¡ </span> </a> </li> <li class="md-nav__item"> <a href="../Java/JavaWeb.html" class="md-nav__link"> <span class="md-ellipsis"> JavaWeb </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3"> <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0"> <span class="md-ellipsis"> ğŸ§® æ•°æ®ç»“æ„åŠç®—æ³• </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> ğŸ§® æ•°æ®ç»“æ„åŠç®—æ³• </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E7%AE%97%E6%B3%95/Algorithm.html" class="md-nav__link"> <span class="md-ellipsis"> Algorithm </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E7%AE%97%E6%B3%95/DesignPattern.html" class="md-nav__link"> <span class="md-ellipsis"> DesignPattern </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked> <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0"> <span class="md-ellipsis"> ğŸƒ Spring </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> ğŸƒ Spring </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="Spring.html" class="md-nav__link"> <span class="md-ellipsis"> Spring </span> </a> </li> <li class="md-nav__item"> <a href="SpringBoot.html" class="md-nav__link"> <span class="md-ellipsis"> SpringBoot </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc"> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> SpringCloud </span> <span class="md-nav__icon md-icon"></span> </label> <a href="SpringCloud.html" class="md-nav__link md-nav__link--active"> <span class="md-ellipsis"> SpringCloud </span> </a> <nav class="md-nav md-nav--secondary" aria-label="ç›®å½•"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> ç›®å½• </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#1å¾®æœåŠ¡" class="md-nav__link"> <span class="md-ellipsis"> 1ã€å¾®æœåŠ¡ </span> </a> <nav class="md-nav" aria-label="1ã€å¾®æœåŠ¡"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#11å•ä½“åº”ç”¨å’Œå¾®æœåŠ¡ç»“æ„åº”ç”¨" class="md-nav__link"> <span class="md-ellipsis"> 1.1ã€å•ä½“åº”ç”¨å’Œå¾®æœåŠ¡ç»“æ„åº”ç”¨ </span> </a> </li> <li class="md-nav__item"> <a href="#12æ¶æ„çš„æ¼”å˜" class="md-nav__link"> <span class="md-ellipsis"> 1.2ã€æ¶æ„çš„æ¼”å˜ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#2springcloud" class="md-nav__link"> <span class="md-ellipsis"> 2ã€SpringCloud </span> </a> <nav class="md-nav" aria-label="2ã€SpringCloud"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#21æ ¸å¿ƒç»„ä»¶è¯´æ˜" class="md-nav__link"> <span class="md-ellipsis"> 2.1ã€æ ¸å¿ƒç»„ä»¶è¯´æ˜ </span> </a> </li> <li class="md-nav__item"> <a href="#22å‘½åå’Œç‰ˆæœ¬é€‰æ‹©" class="md-nav__link"> <span class="md-ellipsis"> 2.2ã€å‘½åå’Œç‰ˆæœ¬é€‰æ‹© </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#2ç¯å¢ƒæ­å»º" class="md-nav__link"> <span class="md-ellipsis"> 2ã€ç¯å¢ƒæ­å»º </span> </a> </li> <li class="md-nav__item"> <a href="#3æœåŠ¡æ³¨å†Œä¸­å¿ƒ" class="md-nav__link"> <span class="md-ellipsis"> 3ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒ </span> </a> <nav class="md-nav" aria-label="3ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#31eureka" class="md-nav__link"> <span class="md-ellipsis"> 3.1ã€Eureka </span> </a> <nav class="md-nav" aria-label="3.1ã€Eureka"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#311å¼€å‘-eureka-server" class="md-nav__link"> <span class="md-ellipsis"> 3.1.1ã€å¼€å‘ Eureka Server </span> </a> </li> <li class="md-nav__item"> <a href="#312å¼€å‘-eureka-client" class="md-nav__link"> <span class="md-ellipsis"> 3.1.2ã€å¼€å‘ Eureka Client </span> </a> </li> <li class="md-nav__item"> <a href="#313eureka-server-é›†ç¾¤" class="md-nav__link"> <span class="md-ellipsis"> 3.1.3ã€Eureka Server é›†ç¾¤ </span> </a> </li> <li class="md-nav__item"> <a href="#314eureka-è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶" class="md-nav__link"> <span class="md-ellipsis"> 3.1.4ã€Eureka è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#32consul" class="md-nav__link"> <span class="md-ellipsis"> 3.2ã€Consul </span> </a> <nav class="md-nav" aria-label="3.2ã€Consul"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#321å®‰è£…-consul" class="md-nav__link"> <span class="md-ellipsis"> 3.2.1ã€å®‰è£… Consul </span> </a> </li> <li class="md-nav__item"> <a href="#322å¼€å‘-consul-client" class="md-nav__link"> <span class="md-ellipsis"> 3.2.2ã€å¼€å‘ Consul Client </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#4æœåŠ¡è°ƒç”¨ç»„ä»¶" class="md-nav__link"> <span class="md-ellipsis"> 4ã€æœåŠ¡è°ƒç”¨ç»„ä»¶ </span> </a> <nav class="md-nav" aria-label="4ã€æœåŠ¡è°ƒç”¨ç»„ä»¶"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#41resttemplate" class="md-nav__link"> <span class="md-ellipsis"> 4.1ã€RestTemplate </span> </a> </li> <li class="md-nav__item"> <a href="#42openfeign" class="md-nav__link"> <span class="md-ellipsis"> 4.2ã€OpenFeign </span> </a> <nav class="md-nav" aria-label="4.2ã€OpenFeign"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#421openfeign-æœåŠ¡è°ƒç”¨" class="md-nav__link"> <span class="md-ellipsis"> 4.2.1ã€OpenFeign æœåŠ¡è°ƒç”¨ </span> </a> </li> <li class="md-nav__item"> <a href="#422è°ƒç”¨æœåŠ¡å¹¶ä¼ å‚" class="md-nav__link"> <span class="md-ellipsis"> 4.2.2ã€è°ƒç”¨æœåŠ¡å¹¶ä¼ å‚ </span> </a> </li> <li class="md-nav__item"> <a href="#423openfeign-è¶…æ—¶è®¾ç½®" class="md-nav__link"> <span class="md-ellipsis"> 4.2.3ã€OpenFeign è¶…æ—¶è®¾ç½® </span> </a> </li> <li class="md-nav__item"> <a href="#424æ—¥å¿—å±•ç¤º" class="md-nav__link"> <span class="md-ellipsis"> 4.2.4ã€æ—¥å¿—å±•ç¤º </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#5æœåŠ¡è´Ÿè½½å‡è¡¡" class="md-nav__link"> <span class="md-ellipsis"> 5ã€æœåŠ¡è´Ÿè½½å‡è¡¡ </span> </a> <nav class="md-nav" aria-label="5ã€æœåŠ¡è´Ÿè½½å‡è¡¡"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#51ribbon" class="md-nav__link"> <span class="md-ellipsis"> 5.1ã€Ribbon </span> </a> <nav class="md-nav" aria-label="5.1ã€Ribbon"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#511ribbon-æœåŠ¡è°ƒç”¨" class="md-nav__link"> <span class="md-ellipsis"> 5.1.1ã€Ribbon æœåŠ¡è°ƒç”¨ </span> </a> </li> <li class="md-nav__item"> <a href="#512ribbon-çš„è´Ÿè½½å‡è¡¡ç­–ç•¥" class="md-nav__link"> <span class="md-ellipsis"> 5.1.2ã€Ribbon çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ </span> </a> </li> <li class="md-nav__item"> <a href="#513ä¿®æ”¹é»˜è®¤è´Ÿè½½å‡è¡¡ç­–ç•¥" class="md-nav__link"> <span class="md-ellipsis"> 5.1.3ã€ä¿®æ”¹é»˜è®¤è´Ÿè½½å‡è¡¡ç­–ç•¥ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#6æœåŠ¡æ–­è·¯å™¨" class="md-nav__link"> <span class="md-ellipsis"> 6ã€æœåŠ¡æ–­è·¯å™¨ </span> </a> <nav class="md-nav" aria-label="6ã€æœåŠ¡æ–­è·¯å™¨"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#61hystrix" class="md-nav__link"> <span class="md-ellipsis"> 6.1ã€Hystrix </span> </a> <nav class="md-nav" aria-label="6.1ã€Hystrix"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#611æœåŠ¡é›ªå´©ç†”æ–­é™çº§" class="md-nav__link"> <span class="md-ellipsis"> 6.1.1ã€æœåŠ¡é›ªå´©ã€ç†”æ–­ã€é™çº§ </span> </a> </li> <li class="md-nav__item"> <a href="#622æœåŠ¡ç†”æ–­çš„å®ç°" class="md-nav__link"> <span class="md-ellipsis"> 6.2.2ã€æœåŠ¡ç†”æ–­çš„å®ç° </span> </a> </li> <li class="md-nav__item"> <a href="#623æœåŠ¡é™çº§çš„å®ç°" class="md-nav__link"> <span class="md-ellipsis"> 6.2.3ã€æœåŠ¡é™çº§çš„å®ç° </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#7æœåŠ¡ç½‘å…³ç»„ä»¶" class="md-nav__link"> <span class="md-ellipsis"> 7ã€æœåŠ¡ç½‘å…³ç»„ä»¶ </span> </a> <nav class="md-nav" aria-label="7ã€æœåŠ¡ç½‘å…³ç»„ä»¶"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#71gateway" class="md-nav__link"> <span class="md-ellipsis"> 7.1ã€Gateway </span> </a> <nav class="md-nav" aria-label="7.1ã€Gateway"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#711å¼€å‘ç½‘å…³åŠ¨æ€è·¯ç”±" class="md-nav__link"> <span class="md-ellipsis"> 7.1.1ã€å¼€å‘ç½‘å…³åŠ¨æ€è·¯ç”± </span> </a> </li> <li class="md-nav__item"> <a href="#712æŸ¥çœ‹ç½‘å…³è·¯ç”±è§„åˆ™" class="md-nav__link"> <span class="md-ellipsis"> 7.1.2ã€æŸ¥çœ‹ç½‘å…³è·¯ç”±è§„åˆ™ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="SpringMVC.html" class="md-nav__link"> <span class="md-ellipsis"> SpringMVC </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5"> <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0"> <span class="md-ellipsis"> ğŸ’¾ æŒä¹…å±‚æ¡†æ¶ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> ğŸ’¾ æŒä¹…å±‚æ¡†æ¶ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6/MyBatis-Plus.html" class="md-nav__link"> <span class="md-ellipsis"> MyBatis-Plus </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6/Mybatis.html" class="md-nav__link"> <span class="md-ellipsis"> Mybatis </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6"> <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0"> <span class="md-ellipsis"> ğŸ” è®¤è¯ä¸æˆæƒ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> ğŸ” è®¤è¯ä¸æˆæƒ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/SSO.html" class="md-nav__link"> <span class="md-ellipsis"> SSO </span> </a> </li> <li class="md-nav__item"> <a href="../%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/Sa-Token.html" class="md-nav__link"> <span class="md-ellipsis"> Sa-Token </span> </a> </li> <li class="md-nav__item"> <a href="../%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/Shiro.html" class="md-nav__link"> <span class="md-ellipsis"> Shiro </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7"> <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0"> <span class="md-ellipsis"> ğŸŒ å‰ç«¯ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> ğŸŒ å‰ç«¯ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/CSS.html" class="md-nav__link"> <span class="md-ellipsis"> CSS </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/JavaScript.html" class="md-nav__link"> <span class="md-ellipsis"> JavaScript </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/Vue.html" class="md-nav__link"> <span class="md-ellipsis"> Vue </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/jQuery.html" class="md-nav__link"> <span class="md-ellipsis"> jQuery </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5"> <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0"> <span class="md-ellipsis"> æ¨¡æ¿å¼•æ“ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_7_5"> <span class="md-nav__icon md-icon"></span> æ¨¡æ¿å¼•æ“ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/Thymeleaf.html" class="md-nav__link"> <span class="md-ellipsis"> Thymeleaf </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6"> <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0"> <span class="md-ellipsis"> ç»„ä»¶åº“ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_7_6"> <span class="md-nav__icon md-icon"></span> ç»„ä»¶åº“ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/AntV-X6.html" class="md-nav__link"> <span class="md-ellipsis"> AntV-X6 </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/ApacheECharts.html" class="md-nav__link"> <span class="md-ellipsis"> ApacheECharts </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/Axios.html" class="md-nav__link"> <span class="md-ellipsis"> Axios </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/BootstrapTable.html" class="md-nav__link"> <span class="md-ellipsis"> BootstrapTable </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/DHTMLXGantt.html" class="md-nav__link"> <span class="md-ellipsis"> DHTMLXGantt </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/Element.html" class="md-nav__link"> <span class="md-ellipsis"> Element </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/FullCalendar.html" class="md-nav__link"> <span class="md-ellipsis"> FullCalendar </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/X-editable.html" class="md-nav__link"> <span class="md-ellipsis"> X-editable </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8"> <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0"> <span class="md-ellipsis"> ğŸ“Š æ•°æ®åº“ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8"> <span class="md-nav__icon md-icon"></span> ğŸ“Š æ•°æ®åº“ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/Dameng.html" class="md-nav__link"> <span class="md-ellipsis"> Dameng </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL.html" class="md-nav__link"> <span class="md-ellipsis"> MySQL </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/MySQLQuery.html" class="md-nav__link"> <span class="md-ellipsis"> MySQLQuery </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/OceanBase.html" class="md-nav__link"> <span class="md-ellipsis"> OceanBase </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/Oracle.html" class="md-nav__link"> <span class="md-ellipsis"> Oracle </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/Redis.html" class="md-nav__link"> <span class="md-ellipsis"> Redis </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/Vastbase.html" class="md-nav__link"> <span class="md-ellipsis"> Vastbase </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9"> <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0"> <span class="md-ellipsis"> ğŸ” æœç´¢å¼•æ“ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_9"> <span class="md-nav__icon md-icon"></span> ğŸ” æœç´¢å¼•æ“ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/Elasticsearch.html" class="md-nav__link"> <span class="md-ellipsis"> Elasticsearch </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10"> <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0"> <span class="md-ellipsis"> ğŸ“‡ åˆ†å¸ƒå¼å­˜å‚¨ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_10"> <span class="md-nav__icon md-icon"></span> ğŸ“‡ åˆ†å¸ƒå¼å­˜å‚¨ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/FastDFS.html" class="md-nav__link"> <span class="md-ellipsis"> FastDFS </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/MinIO.html" class="md-nav__link"> <span class="md-ellipsis"> MinIO </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11"> <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0"> <span class="md-ellipsis"> ğŸ›°ï¸ ç½‘ç»œé€šä¿¡ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_11"> <span class="md-nav__icon md-icon"></span> ğŸ›°ï¸ ç½‘ç»œé€šä¿¡ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/Encryption.html" class="md-nav__link"> <span class="md-ellipsis"> Encryption </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/HTTP.html" class="md-nav__link"> <span class="md-ellipsis"> HTTP </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/OpenVPN.html" class="md-nav__link"> <span class="md-ellipsis"> OpenVPN </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/VNC.html" class="md-nav__link"> <span class="md-ellipsis"> VNC </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/WebSocket.html" class="md-nav__link"> <span class="md-ellipsis"> WebSocket </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/frp.html" class="md-nav__link"> <span class="md-ellipsis"> frp </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12"> <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0"> <span class="md-ellipsis"> ğŸ—ƒï¸ æ–‡ä»¶å¤„ç† </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_12"> <span class="md-nav__icon md-icon"></span> ğŸ—ƒï¸ æ–‡ä»¶å¤„ç† </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_1"> <label class="md-nav__link" for="__nav_12_1" id="__nav_12_1_label" tabindex="0"> <span class="md-ellipsis"> Office </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_1_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_12_1"> <span class="md-nav__icon md-icon"></span> Office </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/ApachePOI.html" class="md-nav__link"> <span class="md-ellipsis"> ApachePOI </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/EasyExcel.html" class="md-nav__link"> <span class="md-ellipsis"> EasyExcel </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/OnlyOffice.html" class="md-nav__link"> <span class="md-ellipsis"> OnlyOffice </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/Poi-tl.html" class="md-nav__link"> <span class="md-ellipsis"> Poi-tl </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/Spire.OfficeForJava.html" class="md-nav__link"> <span class="md-ellipsis"> Spire.OfficeForJava </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_2"> <label class="md-nav__link" for="__nav_12_2" id="__nav_12_2_label" tabindex="0"> <span class="md-ellipsis"> PDF </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_2_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_12_2"> <span class="md-nav__icon md-icon"></span> PDF </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/PDF/ApachePDFBox.html" class="md-nav__link"> <span class="md-ellipsis"> ApachePDFBox </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_3"> <label class="md-nav__link" for="__nav_12_3" id="__nav_12_3_label" tabindex="0"> <span class="md-ellipsis"> XML </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_3_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_12_3"> <span class="md-nav__icon md-icon"></span> XML </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/XML/XMLParse.html" class="md-nav__link"> <span class="md-ellipsis"> XMLParse </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_4"> <label class="md-nav__link" for="__nav_12_4" id="__nav_12_4_label" tabindex="0"> <span class="md-ellipsis"> ZIP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_4_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_12_4"> <span class="md-nav__icon md-icon"></span> ZIP </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/ZIP/Zip4j.html" class="md-nav__link"> <span class="md-ellipsis"> Zip4j </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13"> <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0"> <span class="md-ellipsis"> âŒ› å®šæ—¶ä»»åŠ¡ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_13"> <span class="md-nav__icon md-icon"></span> âŒ› å®šæ—¶ä»»åŠ¡ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/XXL-JOB.html" class="md-nav__link"> <span class="md-ellipsis"> XXL-JOB </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14"> <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0"> <span class="md-ellipsis"> ğŸ§‘â€ğŸ”§ è¿ç»´ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_14"> <span class="md-nav__icon md-icon"></span> ğŸ§‘â€ğŸ”§ è¿ç»´ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E8%BF%90%E7%BB%B4/Docker.html" class="md-nav__link"> <span class="md-ellipsis"> Docker </span> </a> </li> <li class="md-nav__item"> <a href="../%E8%BF%90%E7%BB%B4/Linux.html" class="md-nav__link"> <span class="md-ellipsis"> Linux </span> </a> </li> <li class="md-nav__item"> <a href="../%E8%BF%90%E7%BB%B4/NSSM.html" class="md-nav__link"> <span class="md-ellipsis"> NSSM </span> </a> </li> <li class="md-nav__item"> <a href="../%E8%BF%90%E7%BB%B4/Nginx.html" class="md-nav__link"> <span class="md-ellipsis"> Nginx </span> </a> </li> <li class="md-nav__item"> <a href="../%E8%BF%90%E7%BB%B4/Tomcat.html" class="md-nav__link"> <span class="md-ellipsis"> Tomcat </span> </a> </li> <li class="md-nav__item"> <a href="../%E8%BF%90%E7%BB%B4/TongWeb.html" class="md-nav__link"> <span class="md-ellipsis"> TongWeb </span> </a> </li> <li class="md-nav__item"> <a href="../%E8%BF%90%E7%BB%B4/WSL.html" class="md-nav__link"> <span class="md-ellipsis"> WSL </span> </a> </li> <li class="md-nav__item"> <a href="../%E8%BF%90%E7%BB%B4/WebLogic.html" class="md-nav__link"> <span class="md-ellipsis"> WebLogic </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15"> <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0"> <span class="md-ellipsis"> ğŸ› ï¸ å¼€å‘å·¥å…· </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_15"> <span class="md-nav__icon md-icon"></span> ğŸ› ï¸ å¼€å‘å·¥å…· </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Git.html" class="md-nav__link"> <span class="md-ellipsis"> Git </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Maven.html" class="md-nav__link"> <span class="md-ellipsis"> Maven </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Node.js.html" class="md-nav__link"> <span class="md-ellipsis"> Node.js </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Swagger.html" class="md-nav__link"> <span class="md-ellipsis"> Swagger </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16"> <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0"> <span class="md-ellipsis"> ğŸ‘» å…¶ä»– </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_16"> <span class="md-nav__icon md-icon"></span> ğŸ‘» å…¶ä»– </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%85%B6%E4%BB%96/Settings.html" class="md-nav__link"> <span class="md-ellipsis"> Settings </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%85%B6%E4%BB%96/Solutions.html" class="md-nav__link"> <span class="md-ellipsis"> Solutions </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%85%B6%E4%BB%96/Weasel.html" class="md-nav__link"> <span class="md-ellipsis"> Weasel </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--secondary" aria-label="ç›®å½•"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> ç›®å½• </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#1å¾®æœåŠ¡" class="md-nav__link"> <span class="md-ellipsis"> 1ã€å¾®æœåŠ¡ </span> </a> <nav class="md-nav" aria-label="1ã€å¾®æœåŠ¡"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#11å•ä½“åº”ç”¨å’Œå¾®æœåŠ¡ç»“æ„åº”ç”¨" class="md-nav__link"> <span class="md-ellipsis"> 1.1ã€å•ä½“åº”ç”¨å’Œå¾®æœåŠ¡ç»“æ„åº”ç”¨ </span> </a> </li> <li class="md-nav__item"> <a href="#12æ¶æ„çš„æ¼”å˜" class="md-nav__link"> <span class="md-ellipsis"> 1.2ã€æ¶æ„çš„æ¼”å˜ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#2springcloud" class="md-nav__link"> <span class="md-ellipsis"> 2ã€SpringCloud </span> </a> <nav class="md-nav" aria-label="2ã€SpringCloud"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#21æ ¸å¿ƒç»„ä»¶è¯´æ˜" class="md-nav__link"> <span class="md-ellipsis"> 2.1ã€æ ¸å¿ƒç»„ä»¶è¯´æ˜ </span> </a> </li> <li class="md-nav__item"> <a href="#22å‘½åå’Œç‰ˆæœ¬é€‰æ‹©" class="md-nav__link"> <span class="md-ellipsis"> 2.2ã€å‘½åå’Œç‰ˆæœ¬é€‰æ‹© </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#2ç¯å¢ƒæ­å»º" class="md-nav__link"> <span class="md-ellipsis"> 2ã€ç¯å¢ƒæ­å»º </span> </a> </li> <li class="md-nav__item"> <a href="#3æœåŠ¡æ³¨å†Œä¸­å¿ƒ" class="md-nav__link"> <span class="md-ellipsis"> 3ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒ </span> </a> <nav class="md-nav" aria-label="3ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#31eureka" class="md-nav__link"> <span class="md-ellipsis"> 3.1ã€Eureka </span> </a> <nav class="md-nav" aria-label="3.1ã€Eureka"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#311å¼€å‘-eureka-server" class="md-nav__link"> <span class="md-ellipsis"> 3.1.1ã€å¼€å‘ Eureka Server </span> </a> </li> <li class="md-nav__item"> <a href="#312å¼€å‘-eureka-client" class="md-nav__link"> <span class="md-ellipsis"> 3.1.2ã€å¼€å‘ Eureka Client </span> </a> </li> <li class="md-nav__item"> <a href="#313eureka-server-é›†ç¾¤" class="md-nav__link"> <span class="md-ellipsis"> 3.1.3ã€Eureka Server é›†ç¾¤ </span> </a> </li> <li class="md-nav__item"> <a href="#314eureka-è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶" class="md-nav__link"> <span class="md-ellipsis"> 3.1.4ã€Eureka è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#32consul" class="md-nav__link"> <span class="md-ellipsis"> 3.2ã€Consul </span> </a> <nav class="md-nav" aria-label="3.2ã€Consul"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#321å®‰è£…-consul" class="md-nav__link"> <span class="md-ellipsis"> 3.2.1ã€å®‰è£… Consul </span> </a> </li> <li class="md-nav__item"> <a href="#322å¼€å‘-consul-client" class="md-nav__link"> <span class="md-ellipsis"> 3.2.2ã€å¼€å‘ Consul Client </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#4æœåŠ¡è°ƒç”¨ç»„ä»¶" class="md-nav__link"> <span class="md-ellipsis"> 4ã€æœåŠ¡è°ƒç”¨ç»„ä»¶ </span> </a> <nav class="md-nav" aria-label="4ã€æœåŠ¡è°ƒç”¨ç»„ä»¶"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#41resttemplate" class="md-nav__link"> <span class="md-ellipsis"> 4.1ã€RestTemplate </span> </a> </li> <li class="md-nav__item"> <a href="#42openfeign" class="md-nav__link"> <span class="md-ellipsis"> 4.2ã€OpenFeign </span> </a> <nav class="md-nav" aria-label="4.2ã€OpenFeign"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#421openfeign-æœåŠ¡è°ƒç”¨" class="md-nav__link"> <span class="md-ellipsis"> 4.2.1ã€OpenFeign æœåŠ¡è°ƒç”¨ </span> </a> </li> <li class="md-nav__item"> <a href="#422è°ƒç”¨æœåŠ¡å¹¶ä¼ å‚" class="md-nav__link"> <span class="md-ellipsis"> 4.2.2ã€è°ƒç”¨æœåŠ¡å¹¶ä¼ å‚ </span> </a> </li> <li class="md-nav__item"> <a href="#423openfeign-è¶…æ—¶è®¾ç½®" class="md-nav__link"> <span class="md-ellipsis"> 4.2.3ã€OpenFeign è¶…æ—¶è®¾ç½® </span> </a> </li> <li class="md-nav__item"> <a href="#424æ—¥å¿—å±•ç¤º" class="md-nav__link"> <span class="md-ellipsis"> 4.2.4ã€æ—¥å¿—å±•ç¤º </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#5æœåŠ¡è´Ÿè½½å‡è¡¡" class="md-nav__link"> <span class="md-ellipsis"> 5ã€æœåŠ¡è´Ÿè½½å‡è¡¡ </span> </a> <nav class="md-nav" aria-label="5ã€æœåŠ¡è´Ÿè½½å‡è¡¡"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#51ribbon" class="md-nav__link"> <span class="md-ellipsis"> 5.1ã€Ribbon </span> </a> <nav class="md-nav" aria-label="5.1ã€Ribbon"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#511ribbon-æœåŠ¡è°ƒç”¨" class="md-nav__link"> <span class="md-ellipsis"> 5.1.1ã€Ribbon æœåŠ¡è°ƒç”¨ </span> </a> </li> <li class="md-nav__item"> <a href="#512ribbon-çš„è´Ÿè½½å‡è¡¡ç­–ç•¥" class="md-nav__link"> <span class="md-ellipsis"> 5.1.2ã€Ribbon çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ </span> </a> </li> <li class="md-nav__item"> <a href="#513ä¿®æ”¹é»˜è®¤è´Ÿè½½å‡è¡¡ç­–ç•¥" class="md-nav__link"> <span class="md-ellipsis"> 5.1.3ã€ä¿®æ”¹é»˜è®¤è´Ÿè½½å‡è¡¡ç­–ç•¥ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#6æœåŠ¡æ–­è·¯å™¨" class="md-nav__link"> <span class="md-ellipsis"> 6ã€æœåŠ¡æ–­è·¯å™¨ </span> </a> <nav class="md-nav" aria-label="6ã€æœåŠ¡æ–­è·¯å™¨"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#61hystrix" class="md-nav__link"> <span class="md-ellipsis"> 6.1ã€Hystrix </span> </a> <nav class="md-nav" aria-label="6.1ã€Hystrix"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#611æœåŠ¡é›ªå´©ç†”æ–­é™çº§" class="md-nav__link"> <span class="md-ellipsis"> 6.1.1ã€æœåŠ¡é›ªå´©ã€ç†”æ–­ã€é™çº§ </span> </a> </li> <li class="md-nav__item"> <a href="#622æœåŠ¡ç†”æ–­çš„å®ç°" class="md-nav__link"> <span class="md-ellipsis"> 6.2.2ã€æœåŠ¡ç†”æ–­çš„å®ç° </span> </a> </li> <li class="md-nav__item"> <a href="#623æœåŠ¡é™çº§çš„å®ç°" class="md-nav__link"> <span class="md-ellipsis"> 6.2.3ã€æœåŠ¡é™çº§çš„å®ç° </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#7æœåŠ¡ç½‘å…³ç»„ä»¶" class="md-nav__link"> <span class="md-ellipsis"> 7ã€æœåŠ¡ç½‘å…³ç»„ä»¶ </span> </a> <nav class="md-nav" aria-label="7ã€æœåŠ¡ç½‘å…³ç»„ä»¶"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#71gateway" class="md-nav__link"> <span class="md-ellipsis"> 7.1ã€Gateway </span> </a> <nav class="md-nav" aria-label="7.1ã€Gateway"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#711å¼€å‘ç½‘å…³åŠ¨æ€è·¯ç”±" class="md-nav__link"> <span class="md-ellipsis"> 7.1.1ã€å¼€å‘ç½‘å…³åŠ¨æ€è·¯ç”± </span> </a> </li> <li class="md-nav__item"> <a href="#712æŸ¥çœ‹ç½‘å…³è·¯ç”±è§„åˆ™" class="md-nav__link"> <span class="md-ellipsis"> 7.1.2ã€æŸ¥çœ‹ç½‘å…³è·¯ç”±è§„åˆ™ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <nav class="md-path" aria-label="å¯¼èˆªæ "> <ol class="md-path__list"> <li class="md-path__item"> <a href="../index.html" class="md-path__link"> <span class="md-ellipsis"> ğŸ  é¦–é¡µ </span> </a> </li> <li class="md-path__item"> <a href="Spring.html" class="md-path__link"> <span class="md-ellipsis"> ğŸƒ Spring </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <h1 id="springcloud">SpringCloud<a class="headerlink" href="#springcloud" title="é”šç‚¹é“¾æ¥">Â¶</a></h1> <h2 id="1å¾®æœåŠ¡">1ã€å¾®æœåŠ¡<a class="headerlink" href="#1å¾®æœåŠ¡" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <p>å¾®æœåŠ¡å°±æ˜¯ç”±ä¸€ç³»åˆ—å›´ç»•è‡ªå·±ä¸šåŠ¡å¼€å‘çš„å¾®å°æœåŠ¡æ„æˆï¼Œä»–ä»¬ç‹¬ç«‹éƒ¨ç½²è¿è¡Œåœ¨è‡ªå·±çš„è¿›ç¨‹é‡Œï¼ŒåŸºäºåˆ†å¸ƒå¼è¿›è¡Œç®¡ç†ã€‚</p> <p>å¾®æœåŠ¡æ˜¯ä¸€ç§æ¶æ„ï¼Œè¿™ç§æ¶æ„æ˜¯å°†å•ä¸ªçš„æ•´ä½“åº”ç”¨ç¨‹åºåˆ†å‰²æˆæ›´å°çš„é¡¹ç›®å…³è”çš„ç‹¬ç«‹çš„æœåŠ¡ã€‚ä¸€ä¸ªæœåŠ¡é€šå¸¸å®ç°ä¸€ç»„ç‹¬ç«‹çš„ç‰¹æ€§æˆ–åŠŸèƒ½ï¼ŒåŒ…å«è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘å’Œé€‚é…å™¨ã€‚å„ä¸ªå¾®æœåŠ¡ä¹‹é—´çš„å…³è”é€šè¿‡æš´éœ² API æ¥å®ç°ã€‚è¿™äº›ç‹¬ç«‹çš„å¾®æœåŠ¡ä¸éœ€è¦éƒ¨ç½²åœ¨åŒä¸€ä¸ªè™šæ‹Ÿæœºã€åŒä¸€ä¸ªç³»ç»Ÿå’ŒåŒä¸€ä¸ªåº”ç”¨æœåŠ¡å™¨ä¸­ã€‚</p> <h3 id="11å•ä½“åº”ç”¨å’Œå¾®æœåŠ¡ç»“æ„åº”ç”¨">1.1ã€å•ä½“åº”ç”¨å’Œå¾®æœåŠ¡ç»“æ„åº”ç”¨<a class="headerlink" href="#11å•ä½“åº”ç”¨å’Œå¾®æœåŠ¡ç»“æ„åº”ç”¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p><strong>å•ä½“åº”ç”¨</strong></p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20200708224716035.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20200708224716035.png" alt="image-20200708224716035" style></a></p> <p>ä¼˜ç‚¹ï¼š</p> <ul> <li>å•ä¸€æ¶æ„æ¨¡å¼åœ¨é¡¹ç›®åˆæœŸå¾ˆå°çš„æ—¶å€™å¼€å‘æ–¹ä¾¿ï¼Œæµ‹è¯•æ–¹ä¾¿ï¼Œéƒ¨ç½²æ–¹ä¾¿ï¼Œè¿è¡Œè‰¯å¥½</li> </ul> <p>ç¼ºç‚¹ï¼š</p> <ul> <li>åº”ç”¨éšç€æ—¶é—´çš„æ¨è¿›ï¼ŒåŠ å…¥çš„åŠŸèƒ½è¶Šæ¥è¶Šå¤šï¼Œæœ€ç»ˆä¼šå˜å¾—å·¨å¤§ï¼Œä¸€ä¸ªé¡¹ç›®ä¸­å¾ˆæœ‰å¯èƒ½æ•°ç™¾ä¸‡è¡Œçš„ä»£ç ï¼Œäº’ç›¸ä¹‹é—´ç¹ççš„ jar åŒ…</li> <li>ä¹…è€Œä¹…ä¹‹ï¼Œå¼€å‘æ•ˆç‡ä½ï¼Œä»£ç ç»´æŠ¤å›°éš¾</li> <li>å¦‚æœæƒ³æ•´ä½“åº”ç”¨é‡‡ç”¨æ–°çš„æŠ€æœ¯ã€æ–°çš„æ¡†æ¶æˆ–è€…è¯­è¨€ä¼šå¾ˆå›°éš¾</li> <li>ä»»æ„æ¨¡å—çš„æ¼æ´æˆ–è€…é”™è¯¯éƒ½ä¼šå½±å“æ•´ä¸ªåº”ç”¨ï¼Œé™ä½ç³»ç»Ÿçš„å¯é æ€§</li> </ul> <p><strong>å¾®æœåŠ¡ç»“æ„åº”ç”¨</strong></p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20200723155352063.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20200723155352063.png" alt="image-20200723155352063" style></a></p> <p>ä¼˜ç‚¹ï¼š</p> <ul> <li>å°†æœåŠ¡æ‹†åˆ†æˆå¤šä¸ªå•ä¸€èŒè´£çš„å°çš„æœåŠ¡ï¼Œè¿›è¡Œå•ç‹¬éƒ¨ç½²ï¼ŒæœåŠ¡ä¹‹é—´é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡</li> <li>æ¯ä¸ªæœåŠ¡åº”è¯¥æœ‰è‡ªå·±å•ç‹¬çš„ç®¡ç†å›¢é˜Ÿï¼Œé«˜åº¦è‡ªæ²»</li> <li>æœåŠ¡å„è‡ªæœ‰è‡ªå·±å•ç‹¬çš„èŒè´£ï¼ŒæœåŠ¡ä¹‹é—´æ¾è€¦åˆï¼Œé¿å…å› ä¸€ä¸ªæ¨¡å—çš„é—®é¢˜å¯¼è‡´æœåŠ¡å´©æºƒ</li> </ul> <p>ç¼ºç‚¹ï¼š</p> <ul> <li>å¼€å‘äººå‘˜è¦å¤„ç†åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¤æ‚æ€§</li> <li>å¤šæœåŠ¡è¿ç»´éš¾åº¦ï¼Œéšç€æœåŠ¡çš„å¢åŠ ï¼Œè¿ç»´çš„å‹åŠ›ä¹Ÿåœ¨å¢å¤§</li> <li>æœåŠ¡æ²»ç† å’Œ æœåŠ¡ç›‘æ§ å…³é”®</li> </ul> <h3 id="12æ¶æ„çš„æ¼”å˜">1.2ã€æ¶æ„çš„æ¼”å˜<a class="headerlink" href="#12æ¶æ„çš„æ¼”å˜" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p><code>[å•ä¸€åº”ç”¨æ¶æ„]</code>==&gt; <code>[å‚ç›´åº”ç”¨æ¶æ„]</code> ==&gt; <code>[åˆ†å¸ƒå¼æœåŠ¡æ¶æ„]</code> ==&gt;<code>[æµåŠ¨è®¡ç®—æ¶æ„]||[å¾®æœåŠ¡æ¶æ„]</code> </p> <p><strong>All in One Application å•ä¸€æ¶æ„</strong></p> <p>èµ·åˆå½“ç½‘ç«™æµé‡å¾ˆå°æ—¶ï¼Œå°†æ‰€æœ‰åŠŸèƒ½éƒ½å†™åœ¨ä¸€ä¸ªåº”ç”¨é‡Œé¢ï¼Œå¯¹æ•´ä¸ªåº”ç”¨è¿›è¡Œéƒ¨ç½²ï¼Œä»¥å‡å°‘éƒ¨ç½²èŠ‚ç‚¹å’Œæˆæœ¬ã€‚å¯¹äºè¿™ä¸ªæ¶æ„ç®€åŒ–å¢åˆ æ”¹æŸ¥çš„å·¥ä½œé‡çš„æ•°æ®è®¿é—®æ¡†æ¶ï¼ˆORMï¼‰æ˜¯å…³é”®ã€‚</p> <p><strong>Vertical Application å‚ç›´æ¶æ„</strong></p> <p>å½“è®¿é—®é‡é€æ¸å¢å¤§ï¼Œå•ä¸€åº”ç”¨å¢åŠ æœºå™¨å¸¦æ¥çš„åŠ é€Ÿåº¦è¶Šæ¥è¶Šå°ï¼Œæå‡æ•ˆç‡çš„æ–¹æ³•ä¹‹ä¸€æ˜¯å°†åº”ç”¨æ‹†æˆäº’ä¸ç›¸å¹²çš„å‡ ä¸ªåº”ç”¨ï¼Œä»¥æå‡æ•ˆç‡ã€‚æ­¤æ—¶ï¼Œç”¨äºåŠ é€Ÿå‰ç«¯é¡µé¢å¼€å‘çš„Webæ¡†æ¶ï¼ˆMVCï¼‰æ˜¯å…³é”®ã€‚</p> <p><strong>Distributed Service åˆ†å¸ƒå¼æœåŠ¡æ¶æ„</strong></p> <p>å½“å‚ç›´åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨ä¹‹é—´äº¤äº’ä¸å¯é¿å…ï¼Œå°†æ ¸å¿ƒä¸šåŠ¡æŠ½å–å‡ºæ¥ï¼Œä½œä¸ºç‹¬ç«‹çš„æœåŠ¡ï¼Œé€æ¸å½¢æˆç¨³å®šçš„æœåŠ¡ä¸­å¿ƒï¼Œä½¿å‰ç«¯åº”ç”¨èƒ½æ›´å¿«é€Ÿçš„å“åº”å¤šå˜çš„å¸‚åœºéœ€æ±‚ã€‚æ­¤æ—¶ï¼Œç”¨äºæé«˜ä¸šåŠ¡å¤ç”¨åŠæ•´åˆçš„åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ï¼ˆRPCï¼‰æ˜¯å…³é”®ã€‚</p> <p><strong>Elastic Computing æµåŠ¨è®¡ç®—æ¶æ„å³å¾®æœåŠ¡æ¶æ„</strong></p> <p>å½“æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œå®¹é‡çš„è¯„ä¼°ï¼Œå°æœåŠ¡èµ„æºçš„æµªè´¹ç­‰é—®é¢˜é€æ¸æ˜¾ç°ï¼Œæ­¤æ—¶éœ€å¢åŠ ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒåŸºäºè®¿é—®å‹åŠ›å®æ—¶ç®¡ç†é›†ç¾¤å®¹é‡ï¼Œæé«˜é›†ç¾¤åˆ©ç”¨ç‡ã€‚æ­¤æ—¶ï¼Œç”¨äºæé«˜æœºå™¨åˆ©ç”¨ç‡çš„èµ„æºè°ƒåº¦å’Œæ²»ç†ä¸­å¿ƒï¼ˆSOAï¼‰æ˜¯å…³é”®ã€‚</p> <h2 id="2springcloud">2ã€SpringCloud<a class="headerlink" href="#2springcloud" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <p>SpringCloud ä¸ºå¼€å‘äººå‘˜æä¾›äº†åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¿«é€Ÿæ„å»ºä¸€äº›é€šç”¨æ¨¡å¼çš„å·¥å…·ï¼Œä¾‹å¦‚é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ã€æ–­è·¯å™¨ã€æ™ºèƒ½è·¯ç”±ã€å¾®ä»£ç†ã€æ§åˆ¶æ€»çº¿ã€‚åˆ†å¸ƒå¼ç³»ç»Ÿçš„åè°ƒå¯¼è‡´äº†é”…ç‚‰æ¿æ¨¡å¼ï¼Œå¼€å‘äººå‘˜ä½¿ç”¨ SpringCloud å¯ä»¥å¿«é€Ÿåœ°å»ºç«‹å®ç°è¿™äº›æ¨¡å¼çš„æœåŠ¡å’Œåº”ç”¨ç¨‹åºã€‚</p> <p>é€šä¿—ç†è§£ï¼šSpringCloud æ˜¯ä¸€ä¸ªå«æ¦‚å¤šä¸ªå­é¡¹ç›®çš„å¼€å‘å·¥å…·é›†ï¼Œé›†åˆäº†ä¼—å¤šçš„å¼€æºæ¡†æ¶ï¼Œå®ƒåˆ©ç”¨äº† SpringBoot å¼€å‘çš„ä¾¿åˆ©æ€§å®ç°äº†å¾ˆå¤šåŠŸèƒ½ï¼Œå¦‚æœåŠ¡æ³¨å†Œã€æœåŠ¡æ³¨å†Œå‘ç°ã€è´Ÿè½½å‡è¡¡ç­‰ã€‚SpringCloud åœ¨æ•´åˆè¿‡ç¨‹ä¸­ä¸»è¦æ˜¯é’ˆå¯¹ Netflix å¼€æºç»„ä»¶çš„å°è£…ã€‚SpringCloud çš„å‡ºç°çœŸæ­£çš„ç®€åŒ–äº†åˆ†å¸ƒå¼æ¶æ„çš„å¼€å‘ã€‚</p> <blockquote> <p>NetFlix æ˜¯ç¾å›½çš„ä¸€ä¸ªåœ¨çº¿è§†é¢‘ç½‘ç«™ã€å¾®æœåŠ¡ä¸šçš„ç¿˜æ¥šï¼Œå®ƒæ˜¯å…¬è®¤çš„å¤§è§„æ¨¡ç”Ÿäº§çº§å¾®æœåŠ¡çš„æ°å‡ºå®è·µè€…ï¼ŒNetFlix çš„å¼€æºç»„ä»¶å·²ç»åœ¨å®ƒå¤§è§„æ¨¡åˆ†å¸ƒå¼å¾®æœåŠ¡ç¯å¢ƒä¸­ç»è¿‡å¤šå¹´çš„ç”Ÿäº§å®æˆ˜éªŒè¯ï¼Œå› æ­¤ SpringCloud ä¸­å¾ˆå¤šç»„ä»¶éƒ½æ˜¯åŸºäºNetFlixã€‚</p> </blockquote> <h3 id="21æ ¸å¿ƒç»„ä»¶è¯´æ˜">2.1ã€æ ¸å¿ƒç»„ä»¶è¯´æ˜<a class="headerlink" href="#21æ ¸å¿ƒç»„ä»¶è¯´æ˜" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <ul> <li>EurekaServerã€Consulã€Nacos æœåŠ¡æ³¨å†Œä¸­å¿ƒç»„ä»¶</li> <li>Rabbion &amp; OpenFeign æœåŠ¡è´Ÿè½½å‡è¡¡ å’Œ æœåŠ¡è°ƒç”¨ç»„ä»¶</li> <li>Hystrix &amp; Hystrix Dashboard æœåŠ¡æ–­è·¯å™¨ å’Œ æœåŠ¡ç›‘æ§ç»„ä»¶</li> <li>Zuulã€Gateway æœåŠ¡ç½‘å…³ç»„ä»¶</li> <li>Config ç»Ÿä¸€é…ç½®ä¸­å¿ƒç»„ä»¶</li> <li>Bus æ¶ˆæ¯æ€»çº¿ç»„ä»¶</li> <li>...</li> </ul> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20200724161314786.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20200724161314786.png" alt="image-20200724161314786" style></a></p> <h3 id="22å‘½åå’Œç‰ˆæœ¬é€‰æ‹©">2.2ã€å‘½åå’Œç‰ˆæœ¬é€‰æ‹©<a class="headerlink" href="#22å‘½åå’Œç‰ˆæœ¬é€‰æ‹©" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p><strong>SpringCloud çš„å‘½å</strong></p> <p>SpringCloud æ˜¯ä¸€ä¸ªç”±ä¼—å¤šç‹¬ç«‹å­é¡¹ç›®ç»„æˆçš„å¤§å‹ç»¼åˆé¡¹ç›®ï¼ŒåŸåˆ™æ¯ä¸ªå­é¡¹ç›®ä¸Šæœ‰ä¸åŒçš„å‘å¸ƒèŠ‚å¥ï¼Œéƒ½ç»´æŠ¤è‡ªå·±å‘å¸ƒç‰ˆæœ¬å·ã€‚ä¸ºäº†æ›´å¥½çš„ç®¡ç†SpringCloud çš„ç‰ˆæœ¬ï¼Œé€šè¿‡ä¸€ä¸ªèµ„æºæ¸…å•BOM(Bill of Materials)ï¼Œä¸ºé¿å…ä¸å­é¡¹ç›®çš„å‘å¸ƒå·æ··æ·†ï¼Œæ‰€ä»¥æ²¡æœ‰é‡‡ç”¨ç‰ˆæœ¬å·çš„æ–¹å¼ï¼Œè€Œæ˜¯é€šè¿‡å‘½åçš„æ–¹å¼ã€‚</p> <p>è¿™äº›åå­—æ˜¯æŒ‰å­—æ¯é¡ºåºæ’åˆ—çš„ï¼Œå¦‚ä¼¦æ•¦åœ°é“ç«™çš„åç§°ï¼ˆâ€œå¤©ä½¿â€ æ˜¯ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œâ€œå¸ƒé‡Œæ–¯é¡¿â€ æ˜¯ç¬¬äºŒä¸ªç‰ˆæœ¬ï¼Œâ€å¡å§†ç™»â€œ æ˜¯ç¬¬ä¸‰ä¸ªç‰ˆæœ¬ï¼‰ã€‚å½“å•ä¸ªé¡¹ç›®çš„ç‚¹å‘å¸ƒç´¯ç§¯åˆ°ä¸€ä¸ªä¸´ç•Œé‡ï¼Œæˆ–è€…å…¶ä¸­ä¸€ä¸ªé¡¹ç›®ä¸­æœ‰ä¸€ä¸ªå…³é”®ç¼ºé™·éœ€è¦æ¯ä¸ªäººéƒ½å¯ä»¥ä½¿ç”¨æ—¶ï¼Œå‘å¸ƒåºåˆ—å°†æ¨å‡ºåç§°ä»¥ â€œ.SRXâ€ ç»“å°¾çš„ â€œæœåŠ¡å‘å¸ƒâ€ï¼Œå…¶ä¸­ â€œXâ€ æ˜¯ä¸€ä¸ªæ•°å­—ã€‚</p> <p><strong>SpringCloud çš„ç‰ˆæœ¬é€‰æ‹©</strong></p> <ul> <li>Angel ç‰ˆæœ¬åŸºäº SpringBoot1.2.x ç‰ˆæœ¬æ„å»ºä¸ 1.3 ç‰ˆæœ¬ä¸å…¼å®¹</li> <li>Brixton ç‰ˆæœ¬åŸºäº SpringBoot1.3.x ç‰ˆæœ¬æ„å»ºä¸ 1.2 ç‰ˆæœ¬ä¸å…¼å®¹ 2017 å¹´ Brixton and Angel release å®˜æ–¹å®£å¸ƒæŠ¥åºŸ</li> <li>Camden ç‰ˆæœ¬åŸºäº SpringBoot1.4.x ç‰ˆæœ¬æ„å»ºå¹¶åœ¨ 1.5 ç‰ˆæœ¬é€šè¿‡æµ‹è¯• 2018 å¹´ Camden release å®˜æ–¹å®£å¸ƒæŠ¥åºŸ</li> <li>Dalstonã€Edgware ç‰ˆæœ¬åŸºäº SpringBoot1.5.x ç‰ˆæœ¬æ„å»ºï¼Œç›®å‰ä¸èƒ½åœ¨ SpringBoot2.0.x ç‰ˆæœ¬ä¸­ä½¿ç”¨ Dalstonï¼ˆè¾¾å°”æ–¯é¡¿ï¼‰å°†äº 2018 å¹´ 12 æœˆå®˜æ–¹å®£å¸ƒæŠ¥åºŸ Edgware å°†éµå¾ª Spring Boot 1.5.x çš„ç”Ÿå‘½å‘¨æœŸç»“æŸ</li> <li>Finchley ç‰ˆæœ¬åŸºäº SpringBoot2.0.x ç‰ˆæœ¬è¿›è¡Œæ„å»ºï¼Œä¸èƒ½å…¼å®¹ 1.x ç‰ˆæœ¬</li> <li>Greenwich ç‰ˆæœ¬åŸºäº SpringBoot2.1.x ç‰ˆæœ¬è¿›è¡Œæ„å»ºï¼Œä¸èƒ½å…¼å®¹ 1.x ç‰ˆæœ¬</li> <li>Hoxton ç‰ˆæœ¬åŸºäº SpringBoot2.2.x ç‰ˆæœ¬è¿›è¡Œæ„å»º</li> </ul> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20200709112427684.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20200709112427684.png" alt="image-20200709112427684" style></a></p> <h2 id="2ç¯å¢ƒæ­å»º">2ã€ç¯å¢ƒæ­å»º<a class="headerlink" href="#2ç¯å¢ƒæ­å»º" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <p>è¯´æ˜ï¼š</p> <ul> <li>SpringBoot 2.2.5.RELEASE</li> <li>SpringCloud Hoxten.SR6</li> <li>Java 11</li> <li>Maven 3.8.1</li> <li>IDEA 2021.1</li> </ul> <p>æ–°å»ºä¸€ä¸ªç©ºé¡¹ç›®ï¼Œåœ¨ç©ºé¡¹ç›®ä¸­æ–°å»ºä¸€ä¸ª Maven å­é¡¹ç›®ç”¨äºç‰ˆæœ¬ç®¡ç†ï¼ˆå¯ä»¥åˆ é™¤ src ç›®å½•åªç•™ pom.xmlï¼‰:</p> <div class="language-xml highlight"><span class="filename">XML</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nt">&lt;project</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">         </span><span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">         </span><span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>com.orichalcos<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>springcloud_parent<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">    </span><span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">    </span><span class="cm">&lt;!--ç»§æ‰¿SpringBootçš„çˆ¶é¡¹ç›®--&gt;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">    </span><span class="nt">&lt;parent&gt;</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">        </span><span class="nt">&lt;version&gt;</span>2.2.5.RELEASE<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">    </span><span class="nt">&lt;/parent&gt;</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">    </span><span class="cm">&lt;!--å®šä¹‰SpringCloudä½¿ç”¨ç‰ˆæœ¬å·--&gt;</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">    </span><span class="nt">&lt;properties&gt;</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">        </span><span class="nt">&lt;maven.compiler.source&gt;</span>11<span class="nt">&lt;/maven.compiler.source&gt;</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">        </span><span class="nt">&lt;maven.compiler.target&gt;</span>11<span class="nt">&lt;/maven.compiler.target&gt;</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="w">        </span><span class="nt">&lt;spring-cloud.version&gt;</span>Hoxton.SR6<span class="nt">&lt;/spring-cloud.version&gt;</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="w">    </span><span class="nt">&lt;/properties&gt;</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="w">    </span><span class="cm">&lt;!--ç»´æŠ¤ç‰ˆæœ¬--&gt;</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="w">    </span><span class="nt">&lt;dependencyManagement&gt;</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="w">        </span><span class="nt">&lt;dependencies&gt;</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="w">            </span><span class="cm">&lt;!--ç»´æŠ¤SpringCloudç‰ˆæœ¬ä¾èµ–--&gt;</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="w">            </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="w">                </span><span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="w">                </span><span class="nt">&lt;artifactId&gt;</span>spring-cloud-dependencies<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="w">                </span><span class="nt">&lt;version&gt;</span>${spring-cloud.version}<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="w">                </span><span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="w">                </span><span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="w">            </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="w">        </span><span class="nt">&lt;/dependencies&gt;</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="w">    </span><span class="nt">&lt;/dependencyManagement&gt;</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="nt">&lt;/project&gt;</span>
</span></code></pre></div> <h2 id="3æœåŠ¡æ³¨å†Œä¸­å¿ƒ">3ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒ<a class="headerlink" href="#3æœåŠ¡æ³¨å†Œä¸­å¿ƒ" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <p>æ‰€è°“æœåŠ¡æ³¨å†Œä¸­å¿ƒå°±æ˜¯åœ¨æ•´ä¸ªçš„å¾®æœåŠ¡æ¶æ„ä¸­å•ç‹¬æå‡ºä¸€ä¸ªæœåŠ¡ï¼Œè¿™ä¸ªæœåŠ¡ä¸å®Œæˆç³»ç»Ÿçš„ä»»ä½•çš„ä¸šåŠ¡åŠŸèƒ½ï¼Œä»…ä»…ç”¨æ¥å®Œæˆå¯¹æ•´ä¸ªå¾®æœåŠ¡ç³»ç»Ÿçš„æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°ï¼Œä»¥åŠå¯¹æœåŠ¡å¥åº·çŠ¶æ€çš„ç›‘æ§å’Œç®¡ç†åŠŸèƒ½ã€‚</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20200709124952525.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20200709124952525.png" alt="image-20200709124952525" style></a></p> <p>æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼š</p> <ul> <li>å¯ä»¥å¯¹æ‰€æœ‰çš„å¾®æœåŠ¡çš„ä¿¡æ¯è¿›è¡Œå­˜å‚¨ï¼Œå¦‚å¾®æœåŠ¡çš„åç§°ã€IPã€ç«¯å£ç­‰</li> <li>å¯ä»¥åœ¨è¿›è¡ŒæœåŠ¡è°ƒç”¨æ—¶é€šè¿‡æœåŠ¡å‘ç°æŸ¥è¯¢å¯ç”¨çš„å¾®æœåŠ¡åˆ—è¡¨åŠç½‘ç»œåœ°å€è¿›è¡ŒæœåŠ¡è°ƒç”¨</li> <li>å¯ä»¥å¯¹æ‰€æœ‰çš„å¾®æœåŠ¡è¿›è¡Œå¿ƒè·³æ£€æµ‹ï¼Œå¦‚å‘ç°æŸå®ä¾‹é•¿æ—¶é—´æ— æ³•è®¿é—®ï¼Œå°±ä¼šä»æœåŠ¡æ³¨å†Œè¡¨ç§»é™¤è¯¥å®ä¾‹</li> </ul> <p>SpringCloud æ”¯æŒå¤šç§æ³¨å†Œä¸­å¿ƒï¼šEurekaã€Consulã€Zookeeperã€ä»¥åŠé˜¿é‡Œå·´å·´æ¨å‡º Nacosã€‚è¿™äº›æ³¨å†Œä¸­å¿ƒåœ¨æœ¬è´¨ä¸Šéƒ½æ˜¯ç”¨æ¥ç®¡ç†æœåŠ¡çš„æ³¨å†Œå’Œå‘ç°ä»¥åŠæœåŠ¡çŠ¶æ€çš„æ£€æŸ¥çš„ã€‚</p> <h3 id="31eureka">3.1ã€Eureka<a class="headerlink" href="#31eureka" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>Eureka æ˜¯ Netflix å¼€å‘çš„æœåŠ¡å‘ç°æ¡†æ¶ï¼Œæœ¬èº«æ˜¯ä¸€ä¸ªåŸºäº REST çš„æœåŠ¡ã€‚SpringCloud å°†å®ƒé›†æˆåœ¨å…¶å­é¡¹ç›® spring-cloud-netflix ä¸­ï¼Œä»¥å®ç°SpringCloud çš„æœåŠ¡æ³¨å†Œå’Œå‘ç°åŠŸèƒ½ã€‚</p> <p>Eureka åŒ…å«ä¸¤ä¸ªç»„ä»¶ï¼šEureka Server å’Œ Eureka Clientã€‚</p> <h4 id="311å¼€å‘-eureka-server">3.1.1ã€å¼€å‘ Eureka Server<a class="headerlink" href="#311å¼€å‘-eureka-server" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ol> <li> <p>åˆ›å»ºä¸€ä¸ª Maven é¡¹ç›®å¹¶å¼•å…¥ Eureka Server ä¾èµ–</p> <div class="language-xml highlight"><span class="filename">XML</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nt">&lt;dependencies&gt;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="nt">&lt;/dependencies&gt;</span>
</span></code></pre></div> </li> <li> <p>ç¼–å†™é…ç½®æ–‡ä»¶ application.properties</p> <div class="language-properties highlight"><span class="filename">Properties</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">#æ‰§è¡ŒæœåŠ¡ç«¯å£</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="na">server.port</span><span class="o">=</span><span class="s">8761</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c1">#æŒ‡å®šæœåŠ¡åç§° å”¯ä¸€æ ‡è¯†</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="na">spring.application.name</span><span class="o">=</span><span class="s">eurekaserver</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c1">#æŒ‡å®šæœåŠ¡æ³¨å†Œä¸­å¿ƒçš„åœ°å€</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="na">eureka.client.service-url.defaultZone</span><span class="o">=</span><span class="s">http://localhost:8761/eureka</span>
</span></code></pre></div> </li> <li> <p>ç¼–å†™å…¥å£ç±» EurekaServer8761Application.java å¹¶æ·»åŠ å¼€å¯ Eureka Server æ³¨è§£</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nd">@SpringBootApplication</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nd">@EnableEurekaServer</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EurekaServer8761Application</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">EurekaServer8761Application</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—® Eureka çš„æœåŠ¡æ³¨å†Œé¡µé¢ï¼šhttp://localhost:8761</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210713122030329.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210713122030329.png" alt="image-20210713122030329" style></a></p> </li> <li> <p>åŒæ—¶åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™æ§åˆ¶å°ä¼šæŠ¥é”™</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210713122150531.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210713122150531.png" alt="image-20210713122150531" style></a></p> <p>å‡ºç°ä¸Šè¿°é—®é¢˜åŸå› ï¼šEurekaServer ä¾èµ–å†…éƒ¨åŒ…å«äº† EurekaClient</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210714002253735.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210714002253735.png" alt="image-20210714002253735" style></a></p> <p>Server æ˜¯ä¸€ä¸ªæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œç”¨æ¥æ¥å—å®¢æˆ·ç«¯çš„æ³¨å†Œã€‚Client çš„ç‰¹æ€§ä¼šè®©å½“å‰å¯åŠ¨çš„æœåŠ¡æŠŠè‡ªå·±ä½œä¸º Eureka çš„å®¢æˆ·ç«¯è¿›è¡ŒæœåŠ¡ä¸­å¿ƒçš„æ³¨å†Œï¼Œå½“é¡¹ç›®å¯åŠ¨æ—¶æœåŠ¡æ³¨å†Œä¸­å¿ƒè¿˜æ²¡æœ‰åˆ›å»ºå¥½ï¼Œæ‰€ä»¥æ‰¾ä¸åˆ°æœåŠ¡çš„å®¢æˆ·ç«¯ç»„ä»¶å°±ç›´æ¥æŠ¥é”™äº†ï¼Œå½“å¯åŠ¨æˆåŠŸæœåŠ¡æ³¨å†Œä¸­å¿ƒåˆ›å»ºå¥½äº†ï¼ŒClient å°±èƒ½è¿›è¡Œæ³¨å†Œå¹¶ä¸”ä¸å†æŠ¥é”™å•¦ï¼</p> </li> <li> <p>å…³é—­ Eureka è‡ªå·±æ³¨å†Œè‡ªå·±</p> <div class="language-properties highlight"><span class="filename">Properties</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">#ä¸å†å°†è‡ªå·±åŒæ—¶ä½œä¸ºå®¢æˆ·ç«¯æ³¨å†Œ</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="na">eureka.client.register-with-eureka</span><span class="o">=</span><span class="s">false</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c1">#å…³é—­ä½œä¸ºå®¢æˆ·ç«¯æ—¶ä»Eureka Serverè·å–æœåŠ¡ä¿¡æ¯</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="na">eureka.client.fetch-registry</span><span class="o">=</span><span class="s">false</span>
</span></code></pre></div> </li> <li> <p>å†æ¬¡å¯åŠ¨ï¼Œå½“å‰åº”ç”¨å°±æ˜¯ä¸€ä¸ªå•çº¯ Eureka Serverï¼Œæ§åˆ¶å™¨ä¹Ÿä¸å†æŠ¥é”™</p> </li> </ol> <h4 id="312å¼€å‘-eureka-client">3.1.2ã€å¼€å‘ Eureka Client<a class="headerlink" href="#312å¼€å‘-eureka-client" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ol> <li> <p>åˆ›å»ºä¸€ä¸ª Maven å­é¡¹ç›®å¹¶å¼•å…¥ Spring Web å’Œ Eureka Client ä¾èµ–</p> <div class="language-xml highlight"><span class="filename">XML</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nt">&lt;dependencies&gt;</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="nt">&lt;/dependencies&gt;</span>
</span></code></pre></div> </li> <li> <p>ç¼–å†™é…ç½®æ–‡ä»¶ application.properties</p> <div class="language-properties highlight"><span class="filename">Properties</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1">#æ‰§è¡ŒæœåŠ¡ç«¯å£</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="na">server.port</span><span class="o">=</span><span class="s">8888</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c1">#æŒ‡å®šæœåŠ¡åç§° å”¯ä¸€æ ‡è¯†</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="na">spring.application.name</span><span class="o">=</span><span class="s">eurekaclient</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c1">#eurekaæ³¨å†Œä¸­å¿ƒåœ°å€</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="na">eureka.client.service-url.defaultZone</span><span class="o">=</span><span class="s">http://localhost:8761/eureka</span>
</span></code></pre></div> </li> <li> <p>ç¼–å†™å…¥å£ç±» EurekaClient8888Application.java å¹¶æ·»åŠ å¼€å¯ Eureka Client æ³¨è§£</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nd">@SpringBootApplication</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nd">@EnableEurekaClient</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">EurekaClient8888Application</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">EurekaClient8888Application</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>å¯åŠ¨ä¹‹å‰çš„ Eureka Serverï¼Œå†å¯åŠ¨ Eureka Client</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210714001817434.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210714001817434.png" alt="image-20210714001817434" style></a></p> </li> <li> <p>æŸ¥çœ‹ Eureka Server çš„æœåŠ¡æ³¨å†Œæƒ…å†µ</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210714001846314.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210714001846314.png" alt="image-20210714001846314" style></a></p> </li> </ol> <h4 id="313eureka-server-é›†ç¾¤">3.1.3ã€Eureka Server é›†ç¾¤<a class="headerlink" href="#313eureka-server-é›†ç¾¤" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ol> <li> <p>é¦–å…ˆåœ¨æœ¬åœ° hosts æ–‡ä»¶ä¸­é…ç½®å¦‚ä¸‹æ˜ å°„</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>127.0.0.1 peer1
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>127.0.0.1 peer2
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>127.0.0.1 peer3
</span></code></pre></div> </li> <li> <p>å°† Eureka Server çš„é…ç½®æ–‡ä»¶è½¬ä¸º application.ymlï¼Œå¢åŠ ä¸‰ä¸ª <code>profile</code>ï¼Œåˆ†åˆ«å¯¹åº”ä¸‰ä¸ª Eureka Server çš„é…ç½®</p> <div class="language-yaml highlight"><span class="filename">YAML</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nt">spring</span><span class="p">:</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">  </span><span class="nt">application</span><span class="p">:</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eruekaserver</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="nt">eureka</span><span class="p">:</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">  </span><span class="nt">client</span><span class="p">:</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">    </span><span class="nt">register-with-eureka</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">    </span><span class="nt">fetch-registry</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="nn">---</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="nt">spring</span><span class="p">:</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">  </span><span class="nt">profiles</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">peer1</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="nt">server</span><span class="p">:</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8761</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="nt">eureka</span><span class="p">:</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">  </span><span class="nt">instance</span><span class="p">:</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">peer1</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">  </span><span class="nt">client</span><span class="p">:</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">    </span><span class="nt">service-url</span><span class="p">:</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="w">      </span><span class="nt">defaultZone</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://peer2:8762/eureka,http://peer3:8763/eureka</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="nn">---</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="nt">spring</span><span class="p">:</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="w">  </span><span class="nt">profiles</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">peer2</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="nt">server</span><span class="p">:</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8762</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="nt">eureka</span><span class="p">:</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="w">  </span><span class="nt">instance</span><span class="p">:</span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">peer2</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="w">  </span><span class="nt">client</span><span class="p">:</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="w">    </span><span class="nt">service-url</span><span class="p">:</span>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a><span class="w">      </span><span class="nt">defaultZone</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://peer1:8761/eureka,http://peer3:8763/eureka</span>
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a>
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a><span class="nn">---</span>
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a><span class="nt">spring</span><span class="p">:</span>
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a><span class="w">  </span><span class="nt">profiles</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">peer3</span>
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a><span class="nt">server</span><span class="p">:</span>
</span><span id="__span-9-37"><a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8763</span>
</span><span id="__span-9-38"><a id="__codelineno-9-38" name="__codelineno-9-38" href="#__codelineno-9-38"></a><span class="nt">eureka</span><span class="p">:</span>
</span><span id="__span-9-39"><a id="__codelineno-9-39" name="__codelineno-9-39" href="#__codelineno-9-39"></a><span class="w">  </span><span class="nt">instance</span><span class="p">:</span>
</span><span id="__span-9-40"><a id="__codelineno-9-40" name="__codelineno-9-40" href="#__codelineno-9-40"></a><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">peer3</span>
</span><span id="__span-9-41"><a id="__codelineno-9-41" name="__codelineno-9-41" href="#__codelineno-9-41"></a><span class="w">  </span><span class="nt">client</span><span class="p">:</span>
</span><span id="__span-9-42"><a id="__codelineno-9-42" name="__codelineno-9-42" href="#__codelineno-9-42"></a><span class="w">    </span><span class="nt">service-url</span><span class="p">:</span>
</span><span id="__span-9-43"><a id="__codelineno-9-43" name="__codelineno-9-43" href="#__codelineno-9-43"></a><span class="w">      </span><span class="nt">defaultZone</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://peer1:8761/eureka,http://peer2:8762/eureka</span>
</span></code></pre></div> </li> <li> <p>åˆ†åˆ«å¯åŠ¨ä¸‰ä¸ªæ³¨å†Œä¸­å¿ƒï¼Œç¯å¢ƒå˜é‡ <code>spring.profiles.active</code> æ¿€æ´»å¯¹åº”çš„é›†ç¾¤é…ç½®</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210714153603951.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210714153603951.png" alt="image-20210714153603951" style></a></p> <p>å¯åŠ¨ä¹‹åè®¿é—® <code>http://peer1:8761/</code> è¿›å…¥ <code>peer1</code> è¿™ä¸ªæ³¨å†Œä¸­å¿ƒï¼Œå°±å¯ä»¥çœ‹åˆ°å¦å¤–ä¸¤ä¸ªåˆ†ç‰‡ <code>peer2ã€peer3</code>ï¼Œè¯´æ˜é›†ç¾¤ä¸­æœ‰3ä¸ªèŠ‚ç‚¹äº†</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210714154331476.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210714154331476.png" alt="image-20210714154331476" style></a></p> <p>å†å»è®¿é—®å…¶ä»–ä¸¤ä¸ªæ³¨å†Œä¸­ä¹Ÿèƒ½çœ‹åˆ°å¦å¤–ä¸¤ä¸ªåˆ†ç‰‡</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210714154403887.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210714154403887.png" alt="image-20210714154403887" style></a></p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210714154423775.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210714154423775.png" alt="image-20210714154423775" style></a></p> <p>å¹¶ä¸”å¯ä»¥çœ‹åˆ°è™½ç„¶ Eureka Client ä¹‹æ³¨å†Œåˆ°äº†ç¬¬ä¸€ä¸ª Eureka Server ä¸Šï¼Œä½†æ˜¯å¯ä»¥çœ‹åˆ° Eureka Server èŠ‚ç‚¹ä¹‹é—´çš„å®ä¾‹ä¼šç›¸äº’åŒæ­¥</p> </li> </ol> <h4 id="314eureka-è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶">3.1.4ã€Eureka è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶<a class="headerlink" href="#314eureka-è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>é¦–å…ˆ Eureka æ³¨å†Œä¸­å¿ƒå„ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¹³ç­‰çš„ï¼Œæ²¡æœ‰ ZK ä¸­è§’è‰²çš„æ¦‚å¿µï¼Œ å³ä½¿ N-1 ä¸ªèŠ‚ç‚¹æŒ‚æ‰ä¹Ÿä¸ä¼šå½±å“å…¶ä»–èŠ‚ç‚¹çš„æ­£å¸¸è¿è¡Œã€‚</p> <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœ Eureka Server åœ¨ä¸€å®šæ—¶é—´å†…ï¼ˆé»˜è®¤90ç§’ï¼‰æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªå¾®æœåŠ¡å®ä¾‹çš„å¿ƒè·³ï¼ŒEureka Server å°†ä¼šç§»é™¤è¯¥å®ä¾‹ã€‚ä½†æ˜¯å½“ç½‘ç»œåˆ†åŒºæ•…éšœå‘ç”Ÿæ—¶ï¼Œå¾®æœåŠ¡ä¸ Eureka Server ä¹‹é—´æ— æ³•æ­£å¸¸é€šä¿¡ï¼Œè€Œå¾®æœåŠ¡æœ¬èº«æ˜¯æ­£å¸¸è¿è¡Œçš„ï¼Œæ­¤æ—¶ä¸åº”è¯¥ç§»é™¤è¿™ä¸ªå¾®æœåŠ¡ï¼Œæ‰€ä»¥å¼•å…¥äº†è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ã€‚</p> <blockquote> <p><strong>Eurekaå¿ƒè·³æœºåˆ¶</strong></p> <p>åœ¨åº”ç”¨å¯åŠ¨åï¼ŒèŠ‚ç‚¹ä»¬å°†ä¼šå‘ Eureka Server å‘é€å¿ƒè·³ï¼Œé»˜è®¤å‘¨æœŸä¸º 30 ç§’ï¼Œå¦‚æœ Eureka Server åœ¨å¤šä¸ªå¿ƒè·³å‘¨æœŸå†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªèŠ‚ç‚¹çš„å¿ƒè·³ï¼ŒEureka Server å°†ä¼šä»æœåŠ¡æ³¨å†Œè¡¨ä¸­æŠŠè¿™ä¸ªæœåŠ¡èŠ‚ç‚¹ç§»é™¤ï¼ˆé»˜è®¤90ç§’ï¼‰ã€‚</p> </blockquote> <p>å¦‚æœåœ¨ Eureka Server çš„é¦–é¡µçœ‹åˆ°ä»¥ä¸‹è¿™æ®µæç¤ºï¼Œåˆ™è¯´æ˜ Eureka å·²ç»è¿›å…¥äº†ä¿æŠ¤æ¨¡å¼ã€‚ </p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210714185558794.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210714185558794.png" alt="image-20210714185558794" style></a></p> <p>Eureka Server è‡ªåŠ¨è¿›å…¥è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Œæ­¤æ—¶ä¼šå‡ºç°ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p> <ol> <li>Eureka Server ä¸å†ä»æ³¨å†Œåˆ—è¡¨ä¸­ç§»é™¤å› ä¸ºé•¿æ—¶é—´æ²¡æ”¶åˆ°å¿ƒè·³è€Œåº”è¯¥è¿‡æœŸçš„æœåŠ¡</li> <li>Eureka Server ä»ç„¶èƒ½å¤Ÿæ¥å—æ–°æœåŠ¡çš„æ³¨å†Œå’ŒæŸ¥è¯¢è¯·æ±‚ï¼Œä½†æ˜¯ä¸ä¼šè¢«åŒæ­¥åˆ°å…¶å®ƒèŠ‚ç‚¹ä¸Šï¼Œä¿è¯å½“å‰èŠ‚ç‚¹ä¾ç„¶å¯ç”¨</li> <li>å½“ç½‘ç»œç¨³å®šæ—¶ï¼Œå½“å‰ Eureka Server æ–°çš„æ³¨å†Œä¿¡æ¯ä¼šè¢«åŒæ­¥åˆ°å…¶å®ƒèŠ‚ç‚¹ä¸­</li> </ol> <p>å› æ­¤ Eureka Server å¯ä»¥å¾ˆå¥½çš„åº”å¯¹å› ç½‘ç»œæ•…éšœå¯¼è‡´éƒ¨åˆ†èŠ‚ç‚¹å¤±è”çš„æƒ…å†µï¼Œè€Œä¸ä¼šåƒ ZK é‚£æ ·å¦‚æœæœ‰ä¸€åŠä¸å¯ç”¨çš„æƒ…å†µä¼šå¯¼è‡´æ•´ä¸ªé›†ç¾¤ä¸å¯ç”¨è€Œå˜æˆç˜«ç—ªã€‚</p> <p><strong>å…³é—­è‡ªæˆ‘ä¿æŠ¤</strong></p> <ol> <li> <p>Eureka Server ç«¯ï¼šé…ç½®å…³é—­è‡ªæˆ‘ä¿æŠ¤ï¼Œå¹¶æŒ‰éœ€é…ç½® Eureka Server æ¸…ç†æ— æ•ˆèŠ‚ç‚¹çš„æ—¶é—´é—´éš”</p> <div class="language-yaml highlight"><span class="filename">YAML</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nt">eureka</span><span class="p">:</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">  </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">    </span><span class="c1">#è®¾ä¸ºfalseï¼Œå…³é—­è‡ªæˆ‘ä¿æŠ¤ </span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="nt">enable-self-preservation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"> </span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="c1">#æ¸…ç†é—´éš”ï¼ˆå•ä½æ¯«ç§’ï¼Œé»˜è®¤æ˜¯60*1000ï¼‰ </span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">    </span><span class="nt">eviction-interval-timer-in-ms</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3000</span>
</span></code></pre></div> </li> <li> <p>Eureka Client ç«¯ï¼šé…ç½®å¼€å¯å¥åº·æ£€æŸ¥ï¼Œå¹¶æŒ‰éœ€é…ç½®ç»­çº¦æ›´æ–°æ—¶é—´å’Œåˆ°æœŸæ—¶é—´</p> <div class="language-yaml highlight"><span class="filename">YAML</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nt">eureka</span><span class="p">:</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">  </span><span class="nt">instance</span><span class="p">:</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">    </span><span class="c1">#ç»­çº¦æ›´æ–°æ—¶é—´é—´éš”ï¼ˆé»˜è®¤30ç§’</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span><span class="nt">lease-renewal-interval-in-seconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span><span class="c1">#ç»­çº¦åˆ°æœŸæ—¶é—´ï¼ˆé»˜è®¤90ç§’ï¼‰ </span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="nt">lease-expiration-duration-in-seconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span></code></pre></div> </li> </ol> <p>æ³¨æ„ï¼šæ›´æ”¹ Eureka æ›´æ–°é¢‘ç‡å°†æ‰“ç ´æœåŠ¡å™¨çš„è‡ªæˆ‘ä¿æŠ¤åŠŸèƒ½ï¼Œç”Ÿäº§ç¯å¢ƒä¸‹ä¸å»ºè®®è‡ªå®šä¹‰è¿™äº›é…ç½®ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210714192047475.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210714192047475.png" alt="image-20210714192047475" style></a></p> <blockquote> <p>å…³äº Eureka 2.x çš„å¼€æºå·¥ä½œå·²ç»åœæ­¢ã€‚ä½œä¸º 2.x åˆ†æ”¯ä¸Šç°æœ‰å·¥ä½œå­˜å‚¨åº“çš„ä¸€éƒ¨åˆ†å‘å¸ƒçš„ä»£ç åº“å’Œå·¥ä»¶è¢«è§†ä¸ºä½¿ç”¨é£é™©è‡ªè´Ÿï¼Œåœ¨ 1.x ç‰ˆæœ¬é¡¹ç›®è¿˜æ˜¯æ´»è·ƒçš„ã€‚</p> </blockquote> <h3 id="32consul">3.2ã€Consul<a class="headerlink" href="#32consul" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>Consul æ˜¯ HashiCorp å…¬å¸æ¨å‡ºçš„å¼€æºå·¥å…·ï¼Œç”¨äºå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿçš„æœåŠ¡å‘ç°ä¸é…ç½®ã€‚ä¸å…¶å®ƒåˆ†å¸ƒå¼æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ–¹æ¡ˆï¼ŒConsul çš„æ–¹æ¡ˆæ›´ â€œä¸€ç«™å¼â€ï¼Œå†…ç½®äº†æœåŠ¡æ³¨å†Œä¸å‘ç°æ¡†æ¶ã€åˆ†å¸ƒä¸€è‡´æ€§åè®®å®ç°ã€å¥åº·æ£€æŸ¥ã€Key/Value å­˜å‚¨ã€å¤šæ•°æ®ä¸­å¿ƒæ–¹æ¡ˆï¼Œä¸å†éœ€è¦ä¾èµ–å…¶å®ƒå·¥å…·ï¼ˆæ¯”å¦‚ ZooKeeper ç­‰ï¼‰ã€‚ä½¿ç”¨èµ·æ¥ä¹Ÿè¾ƒä¸ºç®€å•ã€‚Consul ä½¿ç”¨ Go è¯­è¨€ç¼–å†™ï¼Œå› æ­¤å…·æœ‰å¤©ç„¶å¯ç§»æ¤æ€§ï¼ˆæ”¯æŒLinuxã€windowså’ŒMac OS Xï¼‰ï¼›å®‰è£…åŒ…ä»…åŒ…å«ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ–¹ä¾¿éƒ¨ç½²ï¼Œä¸ Docker ç­‰è½»é‡çº§å®¹å™¨å¯æ— ç¼é…åˆã€‚</p> <h4 id="321å®‰è£…-consul">3.2.1ã€å®‰è£… Consul<a class="headerlink" href="#321å®‰è£…-consul" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><strong>Windows ä¸‹å®‰è£… Consul</strong></p> <ol> <li> <p>å‰å¾€ https://www.consul.io/downloads</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210714233845045.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210714233845045.png" alt="image-20210714233845045" style></a></p> <p>é€‰æ‹©è‡ªå·±ç”µè„‘å¯¹åº”çš„ç‰ˆæœ¬ä¸‹è½½</p> </li> <li> <p>è§£å‹å®Œååªæœ‰ä¸€ä¸ªè„šæœ¬æ–‡ä»¶</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210714234043504.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210714234043504.png" alt="image-20210714234043504" style></a></p> </li> <li> <p>ä½¿ç”¨ç»ˆç«¯åˆ‡æ¢åˆ° consul.exe ç›®å½•å¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨ Consul</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210714235520532.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210714235520532.png" alt="image-20210714235520532" style></a></p> </li> <li> <p>è®¿é—® Consul çš„ WEB æœåŠ¡ç«¯å£ï¼šhttp://localhost:8500</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210714235639426.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210714235639426.png" alt="image-20210714235639426" style></a></p> <p>å·¦ä¸Šè§’ Consul logo æ—è¾¹çš„ dc1 ä¸ºæ•°æ®ä¸­å¿ƒï¼Œå¯ä»¥é€šè¿‡ <code>-datacenter</code> è¿›è¡Œè®¾ç½®ï¼š</p> <div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>consul<span class="w"> </span>agent<span class="w"> </span>-dev<span class="w"> </span>-datacenter<span class="o">=</span>aa
</span></code></pre></div> </li> </ol> <p>å¯ä»¥é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œä¸ç”¨æ›´æ”¹ç»ˆç«¯è·¯å¾„ï¼Œç›´æ¥æ‰§è¡Œ Consul å‘½ä»¤ï¼š</p> <ol> <li> <p>æ–°å»ºä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œè·¯å¾„æŒ‡å‘ consul.exe çš„æ–‡ä»¶å¤¹</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210715000050208.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210715000050208.png" alt="image-20210715000050208" style></a></p> </li> <li> <p>åœ¨ç³»ç»Ÿå˜é‡ Path ä¸­å°†åˆšåˆšæ·»åŠ çš„å˜é‡åŠ ä¸Š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210715000501565.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210715000501565.png" alt="image-20210715000501565" style></a></p> </li> <li> <p>èµ¶ç´§è¯•è¯•~</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210715000842740.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210715000842740.png" alt="image-20210715000842740" style></a></p> </li> </ol> <blockquote> <p>å¦‚æœå‰é¢ä½¿ç”¨çš„æ˜¯ Windows CMD å¼€å¯äº† Consulï¼Œè®°å¾—æŒ‰ Ctrl + C å…³é—­ï¼Œç„¶åè¿˜éœ€é‡æ–°å¯åŠ¨ CMD</p> </blockquote> <h4 id="322å¼€å‘-consul-client">3.2.2ã€å¼€å‘ Consul Client<a class="headerlink" href="#322å¼€å‘-consul-client" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ol> <li> <p>åˆ›å»ºé¡¹ç›®å¹¶å¼•å…¥ Spring Web å’Œ Consul å®¢æˆ·ç«¯ä¾èµ–</p> <div class="language-xml highlight"><span class="filename">XML</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nt">&lt;dependencies&gt;</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-consul-discovery<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="nt">&lt;/dependencies&gt;</span>
</span></code></pre></div> </li> <li> <p>ç¼–å†™é…ç½®æ–‡ä»¶ application.properties</p> <div class="language-properties highlight"><span class="filename">Properties</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="na">server.port</span><span class="o">=</span><span class="s">8889</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="c1">#æ³¨å†ŒconsulæœåŠ¡çš„ä¸»æœº</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="na">spring.application.name</span><span class="o">=</span><span class="s">consulclient</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="na">spring.cloud.consul.host</span><span class="o">=</span><span class="s">localhost</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c1">#æ³¨å†ŒconsulæœåŠ¡çš„ç«¯å£å·</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="na">spring.cloud.consul.port</span><span class="o">=</span><span class="s">8500</span>
</span></code></pre></div> </li> <li> <p>ç¼–è¾‘ ConsulClient8889Application.class å…¥å£ç±»å¹¶æ·»åŠ å¼€å¯å®¢æˆ·ç«¯å‘ç°æ³¨è§£</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nd">@SpringBootApplication</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="nd">@EnableDiscoveryClient</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConsulClient8889Application</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">ConsulClient8889Application</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>å¯åŠ¨æœåŠ¡æŸ¥çœ‹ Consul ç•Œé¢æœåŠ¡ä¿¡æ¯</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210715173835645.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210715173835645.png" alt="image-20210715173835645" style></a></p> </li> <li> <p>é»˜è®¤æƒ…å†µ Consul ç›‘æ§å¥åº·æ˜¯å¼€å¯çš„ï¼Œä½†æ˜¯å¿…é¡»ä¾èµ–å¥åº·ç›‘æ§ä¾èµ–æ‰èƒ½æ­£ç¡®ç›‘æ§å¥åº·çŠ¶æ€ï¼Œæ‰€ä»¥ç›´æ¥å¯åŠ¨ä¼šæ˜¾ç¤ºé”™è¯¯ï¼Œå¼•å…¥å¥åº·ç›‘æ§ä¾èµ–ä¹‹åæœåŠ¡æ­£å¸¸</p> <div class="language-xml highlight"><span class="filename">XML</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="cm">&lt;!-- è¿™ä¸ªåŒ…æ˜¯ç”¨åšå¥åº·åº¦ç›‘æ§çš„--&gt;</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">  </span><span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-actuator<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="nt">&lt;/dependency&gt;</span>
</span></code></pre></div> </li> <li> <p>å¼•å…¥æˆåŠŸåé‡å¯é¡¹ç›®ï¼Œåˆ·æ–° Consul ç›‘æ§é¡µé¢ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210715175633678.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210715175633678.png" alt="image-20210715175633678" style></a></p> </li> </ol> <h2 id="4æœåŠ¡è°ƒç”¨ç»„ä»¶">4ã€æœåŠ¡è°ƒç”¨ç»„ä»¶<a class="headerlink" href="#4æœåŠ¡è°ƒç”¨ç»„ä»¶" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <p>æ¥ä¸‹æ¥åœ¨æ•´ä¸ªå¾®æœåŠ¡æ¶æ„ä¸­ï¼Œæˆ‘ä»¬æ¯”è¾ƒå…³å¿ƒçš„å°±æ˜¯æœåŠ¡é—´çš„æœåŠ¡æ”¹å¦‚ä½•è°ƒç”¨ï¼Œæœ‰å“ªäº›è°ƒç”¨æ–¹å¼ï¼Ÿ</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20200713095528763.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20200713095528763.png" alt="image-20200713095528763" style></a></p> <p>åœ¨ SpringCloud ä¸­æœåŠ¡é—´è°ƒç”¨æ–¹å¼ä¸»è¦æ˜¯ä½¿ç”¨ HTTP RESTful æ–¹å¼è¿›è¡ŒæœåŠ¡é—´è°ƒç”¨</p> <h3 id="41resttemplate">4.1ã€RestTemplate<a class="headerlink" href="#41resttemplate" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>Spring æ¡†æ¶æä¾›çš„ RestTemplate ç±»å¯ç”¨äºåœ¨åº”ç”¨ä¸­è°ƒç”¨ REST æœåŠ¡ï¼Œå®ƒç®€åŒ–äº†ä¸ HTTP æœåŠ¡çš„é€šä¿¡æ–¹å¼ï¼Œç»Ÿä¸€äº† RESTful çš„æ ‡å‡†ï¼Œå°è£…äº† HTTP é“¾æ¥ï¼Œ æˆ‘ä»¬åªéœ€è¦ä¼ å…¥url åŠè¿”å›å€¼ç±»å‹å³å¯ã€‚ç›¸è¾ƒäºä¹‹å‰å¸¸ç”¨çš„ HttpClientï¼ŒRestTemplate æ˜¯ä¸€ç§æ›´ä¼˜é›…çš„è°ƒç”¨ RESTful æœåŠ¡çš„æ–¹å¼ã€‚</p> <p><strong>å‘é€ç®€å•çš„è¯·æ±‚</strong></p> <ol> <li> <p>åˆ›å»ºä¸¤ä¸ªæœåŠ¡å¹¶æ³¨å†Œåˆ° Consul æ³¨å†Œä¸­å¿ƒä¸­</p> <ul> <li>users ä»£è¡¨ç”¨æˆ·æœåŠ¡ï¼Œç«¯å£ä¸º 9999</li> <li>order ä»£è¡¨è®¢å•æœåŠ¡ï¼Œç«¯å£ä¸º 9998</li> </ul> <p>æ³¨æ„ï¼šè¿™é‡ŒæœåŠ¡ä»…ä»…ç”¨æ¥æµ‹è¯•ï¼Œæ²¡æœ‰å®é™…ä¸šåŠ¡æ„ä¹‰</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210801002648820.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210801002648820.png" alt="image-20210801002648820" style></a></p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210801002754756.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210801002754756.png" alt="image-20210801002754756" style></a></p> </li> <li> <p>åˆ›å»ºä¸€ä¸ª OrderController æä¾›æœåŠ¡ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="nd">@RestController</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">"/order"</span><span class="p">)</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">OrderController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">LOGGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">OrderController</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">    </span><span class="nd">@GetMapping</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">demo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="w">        </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"order demo..."</span><span class="p">);</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">"order demo OK!!"</span><span class="p">;</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>åˆ›å»ºä¸€ä¸ª UserController è°ƒç”¨è®¢å•æœåŠ¡ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nd">@RestController</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">"/user"</span><span class="p">)</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">LOGGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">UserController</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">    </span><span class="nd">@GetMapping</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">invokeDemo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">        </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"user demo..."</span><span class="p">);</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="w">        </span><span class="c1">//è°ƒç”¨è®¢å•æœåŠ¡ æœåŠ¡åœ°å€ï¼š http://localhost:9999/order å¿…é¡»GETæ–¹å¼ æ¥æ”¶è¿”å›å€¼ String ç±»å‹</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w">        </span><span class="n">RestTemplate</span><span class="w"> </span><span class="n">restTemplate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RestTemplate</span><span class="p">();</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">orderResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">restTemplate</span><span class="p">.</span><span class="na">getForObject</span><span class="p">(</span><span class="s">"http://localhost:9998/order"</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="w">        </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"è°ƒç”¨è®¢å•æœåŠ¡æˆåŠŸ:{}"</span><span class="p">,</span><span class="w"> </span><span class="n">orderResult</span><span class="p">);</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">"è°ƒç”¨è®¢å•æœåŠ¡æˆåŠŸ,ç»“æœä¸º:"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">orderResult</span><span class="p">;</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>å…ˆå¯åŠ¨ Consulï¼Œå†å¯åŠ¨ User æœåŠ¡å’Œ Order æœåŠ¡ï¼Œç„¶å http://localhost:9999/user æµ‹è¯•ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210804004640357.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210804004640357.png" alt="image-20210804004640357" style></a></p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210804004717424.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210804004717424.png" alt="image-20210804004717424" style></a></p> </li> </ol> <p><strong>å‘é€ GET è¯·æ±‚æ·»åŠ è¯·æ±‚å¤´ Headers å¹¶æºå¸¦å‚æ•°</strong></p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">RestTemplate</span><span class="w"> </span><span class="n">restTemplate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RestTemplate</span><span class="p">();</span><span class="w"> </span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UriComponentsBuilder</span><span class="p">.</span><span class="na">fromHttpUrl</span><span class="p">(</span><span class="s">"http://localhost:8080"</span><span class="p">)</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">                </span><span class="p">.</span><span class="na">queryParam</span><span class="p">(</span><span class="s">"name"</span><span class="p">,</span><span class="w"> </span><span class="s">"å¼ ä¸‰"</span><span class="p">)</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">                </span><span class="p">.</span><span class="na">queryParam</span><span class="p">(</span><span class="s">"sex"</span><span class="p">,</span><span class="w"> </span><span class="s">"ç”·"</span><span class="p">)</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">                </span><span class="p">.</span><span class="na">queryParam</span><span class="p">(</span><span class="s">"national"</span><span class="p">,</span><span class="w"> </span><span class="s">"ä¸­å›½"</span><span class="p">)</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">                </span><span class="p">.</span><span class="na">queryParam</span><span class="p">(</span><span class="s">"birthday"</span><span class="p">,</span><span class="w"> </span><span class="s">"199002190"</span><span class="p">)</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">().</span><span class="na">encode</span><span class="p">().</span><span class="na">toString</span><span class="p">();</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="n">HttpHeaders</span><span class="w"> </span><span class="n">headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpHeaders</span><span class="p">();</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="n">headers</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="s">"Accept"</span><span class="p">,</span><span class="w"> </span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_JSON_VALUE</span><span class="p">);</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="n">HttpEntity</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpEntity</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">headers</span><span class="p">);</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="n">JSONObject</span><span class="w"> </span><span class="n">jsonObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">restTemplate</span><span class="p">.</span><span class="na">getForObject</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="n">JSONObject</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">entity</span><span class="p">);</span>
</span></code></pre></div> <p><strong>å‘é€ POST è¯·æ±‚å¹¶æ·»åŠ è¯·æ±‚å¤´ Headers å’Œè¯·æ±‚ä½“ Body</strong></p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">RestTemplate</span><span class="w"> </span><span class="n">restTemplate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RestTemplate</span><span class="p">();</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">HttpHeaders</span><span class="w"> </span><span class="n">headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpHeaders</span><span class="p">();</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="n">headers</span><span class="p">.</span><span class="na">setContentType</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_JSON</span><span class="p">);</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="n">headers</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">"Authorization"</span><span class="p">,</span><span class="w"> </span><span class="n">token</span><span class="p">);</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="c1">// MultiValueMap&lt;String, Object&gt; map=new LinkedMultiValueMap&lt;&gt;();</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">"username"</span><span class="p">,</span><span class="w"> </span><span class="s">"Orichalcos"</span><span class="p">);</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">"password"</span><span class="p">,</span><span class="w"> </span><span class="s">"OriPass"</span><span class="p">);</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="n">HttpEntity</span><span class="o">&lt;</span><span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">httpEntity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpEntity</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">map</span><span class="p">,</span><span class="w"> </span><span class="n">headers</span><span class="p">);</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="n">JSONObject</span><span class="w"> </span><span class="n">jsonObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">restTemplate</span><span class="p">.</span><span class="na">postForObject</span><span class="p">(</span><span class="s">"url"</span><span class="p">,</span><span class="w"> </span><span class="n">httpEntity</span><span class="p">,</span><span class="w"> </span><span class="n">JSONObject</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span></code></pre></div> <blockquote> <p>å½“æ²¡æœ‰è¯·æ±‚å¤´ä¿¡æ¯æ—¶ï¼Œç”¨ <code>MultiValueMap&lt;String, Object&gt; map=new LinkedMultiValueMap&lt;&gt;();</code></p> <p>å½“æœ‰è¯·æ±‚å¤´ä¿¡æ¯æ—¶ï¼Œç”¨ <code>HashMap&lt;String, Object&gt; map = new HashMap&lt;&gt;();</code></p> </blockquote> <p>ä¸Šè¿°ä»£ç è®¾ç½®äº† <code>headers</code> é‡Œé¢çš„ <code>Content-Type</code> ä¸º <code>application/json</code> ï¼Œæ·»åŠ äº†ä¸€ä¸ª <code>Authorization</code> å±æ€§ï¼Œ<code>body</code> é‡Œè®¾ç½®äº†ç”¨æˆ·åå’Œå¯†ç ã€‚å¦‚æœæƒ³è¦è®¾ç½®æ›´å¤æ‚çš„ <code>Content_Type</code> å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">MediaType</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MediaType</span><span class="p">.</span><span class="na">parseMediaType</span><span class="p">(</span><span class="s">"application/json;charset=UTF-8"</span><span class="p">);</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">httpHeaders</span><span class="p">.</span><span class="na">setContentType</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
</span></code></pre></div> <blockquote> <p>å¦‚æœæƒ³è¦è·å–æ›´ä¸ºå®Œæ•´çš„å“åº”ï¼Œå¯ä»¥ä½¿ç”¨ <code>postForEntity()</code>ã€‚</p> <p><code>getForObject()</code> å‡½æ•°å®é™…ä¸Šæ˜¯å¯¹ <code>getForEntity()</code> å‡½æ•°çš„è¿›ä¸€æ­¥å°è£…ï¼Œå¦‚æœä½ åªå…³æ³¨è¿”å›çš„æ¶ˆæ¯ä½“çš„å†…å®¹ï¼Œå¯¹å…¶ä»–ä¿¡æ¯éƒ½ä¸å…³æ³¨ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ <code>getForObject()</code>ã€‚</p> </blockquote> <p><strong>å‘é€å…¶ä»–ç±»å‹çš„ HTTP è¯·æ±‚</strong></p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">exchange</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="n">HttpMethod</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="n">HttpEntity</span><span class="w"> </span><span class="n">requestEntity</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="w"> </span><span class="n">responseType</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="p">...</span><span class="w"> </span><span class="n">uriVariables</span><span class="p">)</span>
</span></code></pre></div> <p>å‚æ•°è¯´æ˜ï¼š</p> <ul> <li><em>url</em>ï¼šè¯·æ±‚è·¯å¾„</li> <li><em>method</em>ï¼šè¯·æ±‚çš„æ–¹æ³•ï¼ˆGETã€POSTã€PUTç­‰ï¼‰</li> <li><em>requestEntity</em>ï¼šHttpEntity å¯¹è±¡ï¼Œå°è£…äº†è¯·æ±‚å¤´å’Œè¯·æ±‚ä½“</li> <li><em>responseType</em>ï¼šè¿”å›æ•°æ®ç±»å‹</li> <li><em>uriVariables</em>ï¼šæ”¯æŒ PathVariable ç±»å‹çš„æ•°æ®ã€‚</li> </ul> <h3 id="42openfeign">4.2ã€OpenFeign<a class="headerlink" href="#42openfeign" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>Feign æ˜¯ä¸€ä¸ªå£°æ˜å¼çš„ä¼ª HTTP å®¢æˆ·ç«¯ï¼Œå®ƒä½¿å¾—å†™ HTTP å®¢æˆ·ç«¯å˜å¾—æ›´ç®€å•ã€‚ä½¿ç”¨ Feignï¼Œåªéœ€è¦åˆ›å»ºä¸€ä¸ªæ¥å£å¹¶æ·»åŠ æ³¨è§£ã€‚å®ƒå…·æœ‰å¯æ’æ‹”çš„æ³¨è§£ç‰¹æ€§ï¼Œå¯ä»¥ä½¿ç”¨ SpringMVC çš„æ³¨è§£ï¼Œå¯ä½¿ç”¨ Feign æ³¨è§£å’Œ JAX-RS æ³¨è§£ã€‚Feign æ”¯æŒå¯æ’æ‹”çš„ç¼–ç å™¨å’Œè§£ç å™¨ã€‚Feign é»˜è®¤é›†æˆäº† Ribbonï¼Œé»˜è®¤å®ç°äº†è´Ÿè½½å‡è¡¡çš„æ•ˆæœå¹¶ä¸” SpringCloud ä¸º Feign æ·»åŠ äº† SpringMVC æ³¨è§£çš„æ”¯æŒã€‚</p> <h4 id="421openfeign-æœåŠ¡è°ƒç”¨">4.2.1ã€OpenFeign æœåŠ¡è°ƒç”¨<a class="headerlink" href="#421openfeign-æœåŠ¡è°ƒç”¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ol> <li> <p>æ–°å»ºä¸¤ä¸ªæœåŠ¡ Categoryã€Productï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ° Consul ä¸­ï¼ˆProduct å¯æ ¹æ®å¯åŠ¨æ–‡ä»¶å¯åŠ¨ä¸¤ä¸ªï¼Œç”¨äºæµ‹è¯•è´Ÿè½½å‡è¡¡ï¼‰</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210822234802589.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210822234802589.png" alt="image-20210822234802589" style></a></p> </li> <li> <p>åœ¨ Product æœåŠ¡ä¸­æä¾›ä¸€ä¸ªè¢«è°ƒç”¨æ¥å£ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="nd">@RestController</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ProductController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">LOGGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">ProductController</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">"${server.port}"</span><span class="p">)</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">port</span><span class="p">;</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/product"</span><span class="p">)</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">product</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">        </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"è¿›å…¥å•†å“æœåŠ¡....."</span><span class="p">);</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">"product okï¼Œå½“å‰æä¾›æœåŠ¡çª—å£ï¼š"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">port</span><span class="p">;</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>åœ¨æœåŠ¡è°ƒç”¨æ–¹ Category ä¸­æ·»åŠ  OpenFeign ä¾èµ–ï¼š</p> <div class="language-xml highlight"><span class="filename">XML</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="cm">&lt;!--OpenFeignä¾èµ–--&gt;</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-openfeign<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="nt">&lt;/dependency&gt;</span>
</span></code></pre></div> </li> <li> <p>åœ¨ Category å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£ï¼Œå¼€å¯ OpenFeign å®¢æˆ·ç«¯è°ƒç”¨ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nd">@SpringBootApplication</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="nd">@EnableDiscoveryClient</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="c1">//å¼€å¯OpenFeignå®¢æˆ·ç«¯è°ƒç”¨</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="nd">@EnableFeignClients</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Category9995Application</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">Category9995Application</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>åœ¨ Category æœåŠ¡ä¸­æ·»åŠ ä¸€ä¸ªå®¢æˆ·ç«¯è°ƒç”¨æ¥å£ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c1">//è°ƒç”¨å•†å“æœåŠ¡æ¥å£ valueï¼šç”¨æ¥ä¹¦å†™è¢«è°ƒç”¨æœåŠ¡çš„æœåŠ¡Id</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="nd">@FeignClient</span><span class="p">(</span><span class="s">"product"</span><span class="p">)</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ProductClient</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">    </span><span class="c1">//è°ƒç”¨å•†å“æœåŠ¡</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/product"</span><span class="p">)</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">product</span><span class="p">();</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>åœ¨ Category æœåŠ¡ä¸­æ·»åŠ  Controllerï¼Œä½¿ç”¨ FeignClient å®¢æˆ·ç«¯å¯¹è±¡è°ƒç”¨æœåŠ¡ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nd">@RestController</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CategoryController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">LOGGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">CategoryController</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ProductClient</span><span class="w"> </span><span class="n">productClient</span><span class="p">;</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/category"</span><span class="p">)</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">category</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">productClient</span><span class="p">.</span><span class="na">product</span><span class="p">();</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="w">        </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"category service....."</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">"category ok...."</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="p">}</span>
</span></code></pre></div> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210822233948054.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210822233948054.png" alt="image-20210822233948054" style></a></p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210822235320696.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210822235320696.png" alt="image-20210822235320696" style></a></p> </li> </ol> <h4 id="422è°ƒç”¨æœåŠ¡å¹¶ä¼ å‚">4.2.2ã€è°ƒç”¨æœåŠ¡å¹¶ä¼ å‚<a class="headerlink" href="#422è°ƒç”¨æœåŠ¡å¹¶ä¼ å‚" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>æœåŠ¡å’ŒæœåŠ¡ä¹‹é—´é€šä¿¡ï¼Œä¸ä»…ä»…æ˜¯è°ƒç”¨ï¼Œå¾€å¾€åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­è¿˜ä¼´éšç€å‚æ•°ä¼ é€’ï¼Œæ¥ä¸‹æ¥é‡ç‚¹æ¥çœ‹çœ‹ OpenFeign åœ¨è°ƒç”¨æœåŠ¡æ—¶å¦‚ä½•ä¼ é€’å‚æ•°ã€‚</p> <p><strong>GET æ–¹å¼è°ƒç”¨æœåŠ¡ä¼ é€’å‚æ•°</strong></p> <ol> <li> <p>åœ¨ Product æœåŠ¡ä¸­æ·»åŠ å¦‚ä¸‹æ–¹æ³•ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1">//å®šä¹‰ä¸€ä¸ªæ¥æ”¶é›¶æ•£ç±»å‹å‚æ•°æ¥å£ queryString</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/test1"</span><span class="p">)</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">test1</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">    </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"name:{} age:{}"</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">);</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"test1 okï¼Œå½“å‰æœåŠ¡ç«¯å£ä¸ºï¼š"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">port</span><span class="p">;</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>åœ¨ Category æœåŠ¡ ProductClient.java ä¸­æ·»åŠ æ¥å£ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/test1"</span><span class="p">)</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="n">String</span><span class="w"> </span><span class="nf">test1</span><span class="p">(</span><span class="nd">@RequestParam</span><span class="p">(</span><span class="s">"name"</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="s">"age"</span><span class="p">)</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">age</span><span class="p">);</span>
</span></code></pre></div> </li> <li> <p>åœ¨ Category æœåŠ¡ä¸­è°ƒç”¨ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/test1"</span><span class="p">)</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">test1</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">productClient</span><span class="p">.</span><span class="na">test1</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">);</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"category ok....."</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>è®¿é—®ï¼šhttp://localhost:9995/test1?name=Orichalcos&amp;age=18</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210901000521366.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210901000521366.png" alt="image-20210901000521366" style></a></p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210831235811079.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210831235811079.png" alt="image-20210831235811079" style></a></p> </li> </ol> <p><strong>POST æ–¹å¼è°ƒç”¨æœåŠ¡ä¼ é€’å‚æ•°</strong></p> <ol> <li> <p>åœ¨ Product æœåŠ¡ä¸­æ·»åŠ å¦‚ä¸‹æ–¹æ³•ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1">//å®šä¹‰ä¸€ä¸ªæ¥æ”¶é›¶æ•£ç±»å‹å‚æ•°æ¥å£ è·¯å¾„ä¼ é€’å‚æ•°</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/test2/{id}/{name}"</span><span class="p">)</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">test2</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">"id"</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">"name"</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="w">    </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"id:{} name{}"</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"test2 okï¼Œå½“å‰æœåŠ¡ç«¯å£ä¸ºï¼š"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">port</span><span class="p">;</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>åœ¨ Category æœåŠ¡ ProductClient.java ä¸­æ·»åŠ æ¥å£ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/test2/{id}/{name}"</span><span class="p">)</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="n">String</span><span class="w"> </span><span class="nf">test2</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">"id"</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">"name"</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span></code></pre></div> </li> <li> <p>åœ¨ Category æœåŠ¡ä¸­è°ƒç”¨ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/test2/{id}/{name}"</span><span class="p">)</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">test2</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">"id"</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">"name"</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">productClient</span><span class="p">.</span><span class="na">test2</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"category ok....."</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>è®¿é—®ï¼šhttp://localhost:9995/test2/1/Orichalcos</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210901001120701.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210901001120701.png" alt="image-20210901001120701" style></a></p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210901001139833.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210901001139833.png" alt="image-20210901001139833" style></a></p> </li> </ol> <p><strong>ä¼ é€’å¯¹è±¡å‚æ•° application/json æ ¼å¼</strong></p> <ol> <li> <p>åœ¨ Product å’Œ Category æœåŠ¡ä¸­åˆ›å»ºä¸€ä¸ª Product å®ä½“ç±»ï¼Œå¹¶å¢åŠ  get/setã€æœ‰å‚æ— å‚æ„é€ å‡½æ•°ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Product</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Double</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="n">bir</span><span class="p">;</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="w">    </span><span class="p">...</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>åœ¨ Product æœåŠ¡ä¸­æ·»åŠ å¦‚ä¸‹æ–¹æ³•ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c1">//å®šä¹‰ä¸€ä¸ªæ¥æ”¶å¯¹è±¡ç±»å‹å‚æ•°æ¥å£ application/json</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="nd">@PostMapping</span><span class="p">(</span><span class="s">"/test3"</span><span class="p">)</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">test3</span><span class="p">(</span><span class="nd">@RequestBody</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="w">    </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"product:{}"</span><span class="p">,</span><span class="w"> </span><span class="n">product</span><span class="p">);</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"test3 okï¼Œå½“å‰æœåŠ¡ç«¯å£ä¸ºï¼š"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">port</span><span class="p">;</span>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>åœ¨ Category æœåŠ¡ ProductClient.java ä¸­æ·»åŠ æ¥å£ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="nd">@PostMapping</span><span class="p">(</span><span class="s">"/test3"</span><span class="p">)</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="n">String</span><span class="w"> </span><span class="nf">test3</span><span class="p">(</span><span class="nd">@RequestBody</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">product</span><span class="p">);</span>
</span></code></pre></div> </li> <li> <p>åœ¨ Category æœåŠ¡ä¸­è°ƒç”¨ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/test3"</span><span class="p">)</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">test3</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">productClient</span><span class="p">.</span><span class="na">test3</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Product</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">"Orichalcos"</span><span class="p">,</span><span class="w"> </span><span class="mf">19.9</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Date</span><span class="p">()));</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"category ok....."</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>è®¿é—®ï¼šhttp://localhost:9995/test3</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210901003708149.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210901003708149.png" alt="image-20210901003708149" style></a></p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210901003732017.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210901003732017.png" alt="image-20210901003732017" style></a></p> </li> </ol> <h4 id="423openfeign-è¶…æ—¶è®¾ç½®">4.2.3ã€OpenFeign è¶…æ—¶è®¾ç½®<a class="headerlink" href="#423openfeign-è¶…æ—¶è®¾ç½®" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒOpenFiegn åœ¨è¿›è¡ŒæœåŠ¡è°ƒç”¨æ—¶ï¼Œè¦æ±‚æœåŠ¡æä¾›æ–¹å¤„ç†ä¸šåŠ¡é€»è¾‘æ—¶é—´å¿…é¡»åœ¨ 1S å†…è¿”å›ï¼Œå¦‚æœè¶…è¿‡ 1S æ²¡æœ‰è¿”å›åˆ™ OpenFeign ä¼šç›´æ¥æŠ¥é”™ï¼Œä¸ä¼šç­‰å¾…æœåŠ¡æ‰§è¡Œï¼Œä½†æ˜¯å¾€å¾€åœ¨å¤„ç†å¤æ‚ä¸šåŠ¡é€»è¾‘æ˜¯å¯èƒ½ä¼šè¶…è¿‡ 1Sï¼Œå› æ­¤éœ€è¦ä¿®æ”¹ OpenFeign çš„é»˜è®¤æœåŠ¡è°ƒç”¨è¶…æ—¶æ—¶é—´ã€‚</p> <p>è°ƒç”¨è¶…æ—¶ä¼šå‡ºç°å¦‚ä¸‹é”™è¯¯</p> <ol> <li> <p>åœ¨æœåŠ¡æä¾›æ–¹åŠ å…¥çº¿ç¨‹ç­‰å¾…é˜»å¡æ¨¡æ‹Ÿè¶…æ—¶ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/product"</span><span class="p">)</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">product</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="w">    </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"è¿›å…¥å•†å“æœåŠ¡....."</span><span class="p">);</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="w">    </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"product okï¼Œå½“å‰æä¾›æœåŠ¡çª—å£ï¼š"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">port</span><span class="p">;</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>è¿›è¡Œå®¢æˆ·ç«¯è°ƒç”¨ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211102000512159.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211102000512159.png" alt="image-20211102000512159" style></a></p> </li> </ol> <p>ä¿®æ”¹ OpenFeign é»˜è®¤è¶…æ—¶æ—¶é—´ï¼š</p> <div class="language-properties highlight"><span class="filename">Properties</span><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="na">feign.client.config.PRODUCTS.connectTimeout</span><span class="o">=</span><span class="s">5000        #é…ç½®æŒ‡å®šæœåŠ¡è¿æ¥è¶…æ—¶</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="na">feign.client.config.PRODUCTS.readTimeout</span><span class="o">=</span><span class="s">5000           #é…ç½®æŒ‡å®šæœåŠ¡ç­‰å¾…è¶…æ—¶</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="c1">#feign.client.config.default.connectTimeout=5000        #é…ç½®æ‰€æœ‰æœåŠ¡è¿æ¥è¶…æ—¶</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="c1">#feign.client.config.default.readTimeout=5000           #é…ç½®æ‰€æœ‰æœåŠ¡ç­‰å¾…è¶…æ—¶</span>
</span></code></pre></div> <h4 id="424æ—¥å¿—å±•ç¤º">4.2.4ã€æ—¥å¿—å±•ç¤º<a class="headerlink" href="#424æ—¥å¿—å±•ç¤º" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>å¾€å¾€åœ¨æœåŠ¡è°ƒç”¨æ—¶æˆ‘ä»¬éœ€è¦è¯¦ç»†å±•ç¤º Feign çš„æ—¥å¿—ï¼Œé»˜è®¤ Feign åœ¨è°ƒç”¨æ˜¯å¹¶ä¸æ˜¯æœ€è¯¦ç»†æ—¥å¿—è¾“å‡ºï¼Œå› æ­¤åœ¨è°ƒè¯•ç¨‹åºæ—¶åº”è¯¥å¼€å¯ Feign çš„è¯¦ç»†æ—¥å¿—å±•ç¤ºã€‚Feign å¯¹æ—¥å¿—çš„å¤„ç†éå¸¸çµæ´»ï¼Œå¯ä¸ºæ¯ä¸ª Feign å®¢æˆ·ç«¯æŒ‡å®šæ—¥å¿—è®°å½•ç­–ç•¥ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯éƒ½ä¼šåˆ›å»ºä¸€ä¸ª loggerï¼Œé»˜è®¤æƒ…å†µä¸‹ logger çš„åç§°æ˜¯Feign çš„å…¨é™å®šåéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒFeign æ—¥å¿—çš„æ‰“å°åªä¼šDEBUGçº§åˆ«åšå‡ºå“åº”ã€‚</p> <p>æˆ‘ä»¬å¯ä»¥ä¸º Feign å®¢æˆ·ç«¯é…ç½®å„è‡ªçš„ logger.lever å¯¹è±¡ï¼Œå‘Šè¯‰ Feign è®°å½•é‚£äº›æ—¥å¿— logger.lever æœ‰ä»¥ä¸‹çš„å‡ ç§å€¼ï¼š</p> <ul> <li>NONE ä¸è®°å½•ä»»ä½•æ—¥å¿—</li> <li>BASIC ä»…ä»…è®°å½•è¯·æ±‚æ–¹æ³•ã€urlã€å“åº”çŠ¶æ€ä»£ç åŠæ‰§è¡Œæ—¶é—´</li> <li>HEADERS è®°å½•Basicçº§åˆ«çš„åŸºç¡€ä¸Šï¼Œè®°å½•è¯·æ±‚å’Œå“åº”çš„header</li> <li> <p>FULL è®°å½•è¯·æ±‚å’Œå“åº”çš„headerã€bodyå’Œå…ƒæ•°æ®</p> </li> <li> <p>å¼€å¯æ—¥å¿—å±•ç¤º</p> <div class="language-properties highlight"><span class="filename">Properties</span><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="na">feign.client.config.PRODUCTS.loggerLevel</span><span class="o">=</span><span class="s">full     #å¼€å¯æŒ‡å®šæœåŠ¡æ—¥å¿—å±•ç¤º</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="c1">#feign.client.config.default.loggerLevel=full     #å…¨å±€å¼€å¯æœåŠ¡æ—¥å¿—å±•ç¤º</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="na">logging.level.com.orichalcos.feignclient</span><span class="o">=</span><span class="s">debug    #æŒ‡å®šfeignè°ƒç”¨å®¢æˆ·ç«¯å¯¹è±¡æ‰€åœ¨åŒ…,å¿…é¡»æ˜¯debugçº§åˆ«</span>
</span></code></pre></div> </li> <li> <p>æµ‹è¯•æœåŠ¡è°ƒç”¨æŸ¥çœ‹æ—¥å¿—</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211102001811337.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211102001811337.png" alt="image-20211102001811337" style></a></p> </li> </ul> <h2 id="5æœåŠ¡è´Ÿè½½å‡è¡¡">5ã€æœåŠ¡è´Ÿè½½å‡è¡¡<a class="headerlink" href="#5æœåŠ¡è´Ÿè½½å‡è¡¡" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <h3 id="51ribbon">5.1ã€Ribbon<a class="headerlink" href="#51ribbon" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>Spring Cloud Ribbon æ˜¯ä¸€ä¸ªåŸºäº HTTP å’Œ TCP çš„å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å·¥å…·ï¼Œå®ƒåŸºäº Netflix Ribbon å®ç°ã€‚é€šè¿‡ Spring Cloud çš„å°è£…ï¼Œå¯ä»¥è®©æˆ‘ä»¬è½»æ¾åœ°å°†é¢å‘æœåŠ¡çš„ REST æ¨¡ç‰ˆè¯·æ±‚è‡ªåŠ¨è½¬æ¢æˆå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„æœåŠ¡è°ƒç”¨ã€‚</p> <h4 id="511ribbon-æœåŠ¡è°ƒç”¨">5.1.1ã€Ribbon æœåŠ¡è°ƒç”¨<a class="headerlink" href="#511ribbon-æœåŠ¡è°ƒç”¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><strong>å‡†å¤‡å·¥ä½œ</strong></p> <ol> <li> <p>é¡¹ç›®ä¸­å¼•å…¥ä¾èµ–ï¼š</p> <ul> <li> <p>å¦‚æœä½¿ç”¨çš„æ˜¯ Eureka Client å’Œ Consul Clientï¼Œæ— é¡»å¼•å…¥ä¾èµ–ï¼Œå› ä¸ºåœ¨ Eurekaã€Consul ä¸­é»˜è®¤é›†æˆäº† Ribbon ç»„ä»¶</p> </li> <li> <p>å¦‚æœä½¿ç”¨çš„ Client ä¸­æ²¡æœ‰ Ribbon ä¾èµ–éœ€è¦æ˜¾å¼å¼•å…¥å¦‚ä¸‹ä¾èµ–</p> <div class="language-xml highlight"><span class="filename">XML</span><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="cm">&lt;!--å¼•å…¥ribbonä¾èµ–--&gt;</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="w">  </span><span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-ribbon<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="nt">&lt;/dependency&gt;</span>
</span></code></pre></div> </li> </ul> </li> <li> <p>ä¿®æ”¹ Order æœåŠ¡çš„æ§åˆ¶å™¨</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="nd">@RestController</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">"/order"</span><span class="p">)</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">OrderController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">LOGGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">OrderController</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">"${server.port}"</span><span class="p">)</span>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">port</span><span class="p">;</span>
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a>
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a><span class="w">    </span><span class="nd">@GetMapping</span>
</span><span id="__span-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">demo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-12"><a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a><span class="w">        </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"orderè¢«è°ƒç”¨ï¼ŒæœåŠ¡ç«¯å£ä¸ºï¼š{}"</span><span class="p">,</span><span class="w"> </span><span class="n">port</span><span class="p">);</span>
</span><span id="__span-42-13"><a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">"order demo OK!!,æœåŠ¡ç«¯å£ä¸ºï¼š"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">port</span><span class="p">;</span>
</span><span id="__span-42-14"><a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-42-15"><a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>ä¿®æ”¹ Order æœåŠ¡çš„é…ç½®æ–‡ä»¶ï¼Œï¼Œå¢åŠ ä¸‰ä¸ª <code>profile</code></p> <div class="language-yaml highlight"><span class="filename">YAML</span><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="nt">spring</span><span class="p">:</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="w">  </span><span class="nt">application</span><span class="p">:</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">order</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="w">  </span><span class="nt">cloud</span><span class="p">:</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="w">    </span><span class="nt">consul</span><span class="p">:</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="w">      </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8500</span>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a><span class="nn">---</span>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a><span class="nt">spring</span><span class="p">:</span>
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a><span class="w">  </span><span class="nt">profiles</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">order9998</span>
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a><span class="nt">server</span><span class="p">:</span>
</span><span id="__span-43-13"><a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9998</span>
</span><span id="__span-43-14"><a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a>
</span><span id="__span-43-15"><a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a><span class="nn">---</span>
</span><span id="__span-43-16"><a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a><span class="nt">spring</span><span class="p">:</span>
</span><span id="__span-43-17"><a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a><span class="w">  </span><span class="nt">profiles</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">order9997</span>
</span><span id="__span-43-18"><a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a><span class="nt">server</span><span class="p">:</span>
</span><span id="__span-43-19"><a id="__codelineno-43-19" name="__codelineno-43-19" href="#__codelineno-43-19"></a><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9997</span>
</span><span id="__span-43-20"><a id="__codelineno-43-20" name="__codelineno-43-20" href="#__codelineno-43-20"></a>
</span><span id="__span-43-21"><a id="__codelineno-43-21" name="__codelineno-43-21" href="#__codelineno-43-21"></a><span class="nn">---</span>
</span><span id="__span-43-22"><a id="__codelineno-43-22" name="__codelineno-43-22" href="#__codelineno-43-22"></a><span class="nt">spring</span><span class="p">:</span>
</span><span id="__span-43-23"><a id="__codelineno-43-23" name="__codelineno-43-23" href="#__codelineno-43-23"></a><span class="w">  </span><span class="nt">profiles</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">order9996</span>
</span><span id="__span-43-24"><a id="__codelineno-43-24" name="__codelineno-43-24" href="#__codelineno-43-24"></a><span class="nt">server</span><span class="p">:</span>
</span><span id="__span-43-25"><a id="__codelineno-43-25" name="__codelineno-43-25" href="#__codelineno-43-25"></a><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9996</span>
</span></code></pre></div> </li> <li> <p>åˆ†åˆ«å¯åŠ¨ä¸‰ä¸ªæ³¨å†Œä¸­å¿ƒï¼Œç¯å¢ƒå˜é‡ <code>spring.profiles.active</code> æ¿€æ´»å¯¹åº”çš„é›†ç¾¤é…ç½®</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210805002959560.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210805002959560.png" alt="image-20210805002959560" style></a></p> </li> </ol> <p><strong>RestTemplate + Ribbon çš„è°ƒç”¨æ–¹å¼ï¼š</strong></p> <ul> <li>ä½¿ç”¨ discovery client è¿›è¡Œå®¢æˆ·ç«¯è°ƒç”¨</li> <li>ä½¿ç”¨ loadBalanceClient è¿›è¡Œå®¢æˆ·ç«¯è°ƒç”¨</li> <li>ä½¿ç”¨ @loadBalanced è¿›è¡Œå®¢æˆ·ç«¯è°ƒç”¨</li> </ul> <p><strong>DiscoveryClient</strong></p> <p>ä¿®æ”¹ User æœåŠ¡çš„æ§åˆ¶å™¨ï¼Œå¢åŠ ä»¥ä¸‹å†…å®¹</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="nd">@Autowired</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="kd">private</span><span class="w"> </span><span class="n">DiscoveryClient</span><span class="w"> </span><span class="n">discoveryClient</span><span class="p">;</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/discoveryClient"</span><span class="p">)</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">discoveryClient</span><span class="p">(){</span>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="w">    </span><span class="c1">//è·å–æœåŠ¡åˆ—è¡¨</span>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ServiceInstance</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">discoveryClient</span><span class="p">.</span><span class="na">getInstances</span><span class="p">(</span><span class="s">"order"</span><span class="p">);</span>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="w">    </span><span class="n">orders</span><span class="p">.</span><span class="na">forEach</span><span class="p">(</span><span class="n">order</span><span class="o">-&gt;</span><span class="p">{</span>
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="w">        </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"æœåŠ¡ä¸»æœºï¼šã€{}ã€‘"</span><span class="p">,</span><span class="n">order</span><span class="p">.</span><span class="na">getHost</span><span class="p">());</span>
</span><span id="__span-44-10"><a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a><span class="w">        </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"æœåŠ¡ç«¯å£ï¼šã€{}ã€‘"</span><span class="p">,</span><span class="n">order</span><span class="p">.</span><span class="na">getPort</span><span class="p">());</span>
</span><span id="__span-44-11"><a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a><span class="w">        </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"æœåŠ¡åœ°å€ï¼šã€{}ã€‘"</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="p">.</span><span class="na">getUri</span><span class="p">());</span>
</span><span id="__span-44-12"><a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-44-13"><a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a><span class="w">    </span><span class="c1">//ä»æœåŠ¡åˆ—è¡¨ä¸­éšæœºè°ƒå–ä¸€ä¸ªæœåŠ¡</span>
</span><span id="__span-44-14"><a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a><span class="w">    </span><span class="n">ServiceInstance</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="p">().</span><span class="na">nextInt</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="na">size</span><span class="p">()));</span>
</span><span id="__span-44-15"><a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a><span class="w">    </span><span class="n">RestTemplate</span><span class="w"> </span><span class="n">restTemplate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RestTemplate</span><span class="p">();</span>
</span><span id="__span-44-16"><a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">restTemplate</span><span class="p">.</span><span class="na">getForObject</span><span class="p">(</span><span class="n">order</span><span class="p">.</span><span class="na">getUri</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"/order"</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-44-17"><a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"UseræœåŠ¡è°ƒç”¨OKï¼Œ"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-44-18"><a id="__codelineno-44-18" name="__codelineno-44-18" href="#__codelineno-44-18"></a><span class="p">}</span>
</span></code></pre></div> <p>è®¿é—® http://localhost:9999/user/discoveryClient æŸ¥çœ‹ï¼Œå¯é‡å¤åˆ·æ–°æŸ¥çœ‹æ˜¯å¦åˆ‡æ¢ä¸åŒæœåŠ¡</p> <p><strong>LoadBalance Client</strong></p> <p>ä¿®æ”¹ User æœåŠ¡çš„æ§åˆ¶å™¨ï¼Œå¢åŠ ä»¥ä¸‹å†…å®¹</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="nd">@Autowired</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="kd">private</span><span class="w"> </span><span class="n">LoadBalancerClient</span><span class="w"> </span><span class="n">loadBalancerClient</span><span class="p">;</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/loadBalancerClient"</span><span class="p">)</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">loadBalancerClient</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="w">    </span><span class="c1">//æ ¹æ®è´Ÿè½½å‡è¡¡ç­–ç•¥é€‰å–æŸä¸€ä¸ªæœåŠ¡è°ƒç”¨</span>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="w">    </span><span class="n">ServiceInstance</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loadBalancerClient</span><span class="p">.</span><span class="na">choose</span><span class="p">(</span><span class="s">"order"</span><span class="p">);</span>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a><span class="w">    </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"æœåŠ¡ä¸»æœºï¼šã€{}ã€‘"</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="p">.</span><span class="na">getHost</span><span class="p">());</span>
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="w">    </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"æœåŠ¡ç«¯å£ï¼šã€{}ã€‘"</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="p">.</span><span class="na">getPort</span><span class="p">());</span>
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="w">    </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"æœåŠ¡åœ°å€ï¼šã€{}ã€‘"</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="p">.</span><span class="na">getUri</span><span class="p">());</span>
</span><span id="__span-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a><span class="w">    </span><span class="n">RestTemplate</span><span class="w"> </span><span class="n">restTemplate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RestTemplate</span><span class="p">();</span>
</span><span id="__span-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">restTemplate</span><span class="p">.</span><span class="na">getForObject</span><span class="p">(</span><span class="n">order</span><span class="p">.</span><span class="na">getUri</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">"/order"</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-45-13"><a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"UseræœåŠ¡è°ƒç”¨OKï¼Œ"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-45-14"><a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a><span class="p">}</span>
</span></code></pre></div> <p>è®¿é—® http://localhost:9999/user/loadBalancerClient æŸ¥çœ‹ï¼Œå¯é‡å¤åˆ·æ–°æŸ¥çœ‹æ˜¯å¦åˆ‡æ¢ä¸åŒæœåŠ¡</p> <p><strong>@LoadBalanced</strong></p> <p>åœ¨ User æœåŠ¡ä¸­æ–°å»ºä¸€ä¸ª BeansConfig.java æ¥æä¾› RestTemplate</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BeansConfig</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="w">    </span><span class="c1">//æ•´åˆrestTemplate + ribbon</span>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="w">    </span><span class="nd">@Bean</span>
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="w">    </span><span class="nd">@LoadBalanced</span>
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">RestTemplate</span><span class="w"> </span><span class="nf">restTemplate</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RestTemplate</span><span class="p">();</span>
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="p">}</span>
</span></code></pre></div> <p>ä¿®æ”¹ User æœåŠ¡çš„æ§åˆ¶å™¨ï¼Œå¢åŠ ä»¥ä¸‹å†…å®¹</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="c1">//è°ƒç”¨æœåŠ¡ä½ç½®æ³¨å…¥ RestTemplate</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="nd">@Autowired</span>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="kd">private</span><span class="w"> </span><span class="n">RestTemplate</span><span class="w"> </span><span class="n">restTemplate</span><span class="p">;</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/loadBalanced"</span><span class="p">)</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">loadBalanced</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a><span class="w">    </span><span class="c1">//è°ƒç”¨ï¼šä½¿ç”¨è¢«è°ƒç”¨æœåŠ¡çš„Id æ›¿ä»£ è¢«è°ƒç”¨æœåŠ¡çš„åŸŸåå’Œç«¯å£å·ï¼ˆä¸‹é¢ç¬¬ä¸€ä¸ªorderä¸ºè®¢å•æœåŠ¡çš„ç«¯å£å·ï¼‰</span>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">restTemplate</span><span class="p">.</span><span class="na">getForObject</span><span class="p">(</span><span class="s">"http://order/order"</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"UseræœåŠ¡è°ƒç”¨OKï¼Œ"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a><span class="p">}</span>
</span></code></pre></div> <p>è®¿é—® http://localhost:9999/user/loadBalanced æŸ¥çœ‹ï¼Œå¯é‡å¤åˆ·æ–°æŸ¥çœ‹æ˜¯å¦åˆ‡æ¢ä¸åŒæœåŠ¡</p> <h4 id="512ribbon-çš„è´Ÿè½½å‡è¡¡ç­–ç•¥">5.1.2ã€Ribbon çš„è´Ÿè½½å‡è¡¡ç­–ç•¥<a class="headerlink" href="#512ribbon-çš„è´Ÿè½½å‡è¡¡ç­–ç•¥" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>è¿™é‡Œå¯ä»¥ç‚¹è¿›è‡ªåŠ¨æ³¨å…¥çš„ <code>LoadBalancerClient</code>æŸ¥çœ‹å…¶æºç ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210807001718136.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210807001718136.png" alt="image-20210807001718136" style></a></p> <p>å‘ç°å¹¶æ²¡æœ‰æˆ‘ä»¬è°ƒç”¨çš„ <code>choose()</code> æ–¹æ³•ï¼Œé‚£ç›´æ¥ä» <code>choose()</code> æ–¹æ³•ä¸­ç‚¹è¿›æŸ¥çœ‹ï¼Œå‘ç°è¯¥æ–¹æ³•æ¥æºè‡ª <code>LoadBalancerClient</code> çš„çˆ¶æ¥å£ <code>ServiceInstanceChooser</code>ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210807001930520.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210807001930520.png" alt="image-20210807001930520" style></a></p> <p>ç‚¹å‡»é€‰ä¸­ <code>LoadBalancerClient</code> æŒ‰ F4 æŸ¥çœ‹å…¶å®ç°ï¼Œ<code>ServiceInstanceChooser</code> çš„ <code>choose()</code> æ–¹æ³•é»˜è®¤å®ç°ä¸º <code>RiibonLoadBalancerClient</code>ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210807002537050.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210807002537050.png" alt="image-20210807002537050" style></a></p> <p>åœ¨ <code>RiibonLoadBalancerClient</code> çš„ <code>choose()</code> æ–¹æ³•ä¸­å¯ä»¥çœ‹åˆ°å®ƒåˆè°ƒç”¨äº†è‡ªå·±çš„ <code>choose()</code> æ–¹æ³•ï¼Œç”±æ–¹æ³•ä¸­çš„ <code>getServer()</code> æ–¹æ³•è·å–æœåŠ¡ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210807002831290.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210807002831290.png" alt="image-20210807002831290" style></a></p> <p>ç»§ç»­è¿½ä¸‹å»ï¼Œå‘ç° <code>getServer()</code> åˆè°ƒç”¨äº† <code>chooseServer()</code>ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210807003135718.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210807003135718.png" alt="image-20210807003135718" style></a></p> <p>å†ç‚¹è¿›å»å°±å‘ç°è¿›å…¥äº† <code>ILoadBalancer</code> æ¥å£äº†ï¼ŒæŸ¥çœ‹æ–¹æ³•å®ç°ï¼Œå‘ç°æœ‰ä¸‰ä¸ªå®ç°ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210807003744210.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210807003744210.png" alt="image-20210807003744210" style></a></p> <p>è¿™é‡Œå¯ä»¥æ‰“ä¸ªæ–­ç‚¹ï¼Œç„¶åä½¿ç”¨ Step Into è¿½è¸ªï¼Œä¼šå‘ç°ä¼šè°ƒç”¨ <code>ZoneAwareLoadBalancer</code> çš„å®ç°ï¼Œè€Œ <code>ZoneAwareLoadBalancer</code> ä¼šè°ƒç”¨çˆ¶ç±»çš„ <code>chooseServer()</code>ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210807004001423.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210807004001423.png" alt="image-20210807004001423" style></a></p> <p>ç»§ç»­è¿½ä¸‹å»ï¼Œå‘ç°åˆ°äº† <code>BaseLoadBalancer</code> ä¸­ï¼Œè¿™é‡Œæœ‰è®¸å¤šåˆ¤æ–­ï¼Œç”¨ dbug å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°åˆ¤æ–­ä¸€è·¯èµ°åˆ°äº† <code>this.rule.choose(key)</code>ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210807004405986.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210807004405986.png" alt="image-20210807004405986" style></a></p> <p>å†ç‚¹ä¸‹å»å°±åˆ°äº†å…³é”®çš„æ¥å£ <code>IRule</code>:</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210807005034400.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210807005034400.png" alt="image-20210807005034400" style></a></p> <p>è¿™ä¸ªæ¥å£å®šä¹‰ LoadBalancer çš„ â€œè§„åˆ™â€ï¼Œè§„åˆ™å¯ä»¥è¢«çœ‹ä½œæ˜¯è´Ÿè½½å‡è¡¡çš„ç­–ç•¥ã€‚ä¼—æ‰€å‘¨çŸ¥çš„è´Ÿè½½å‡è¡¡ç­–ç•¥åŒ…æ‹¬è½®è¯¢ã€åŸºäºå“åº”æ—¶é—´ç­‰ã€‚è€Œ <code>choose()</code> ä¸Šé¢æ³¨è§£è§£é‡Šäº†ï¼šé€šè¿‡ <code>key</code> ä» <code>lb.allServers</code> ä¸­é€‰æ‹©ä¸€ä¸ªæ´»çš„æœåŠ¡å™¨ã€‚</p> <p>åˆ°äº†è¿™é‡Œå·²ç»å¾ˆæ˜æœ—äº†ï¼Œ<code>IRule</code> å°±æ˜¯æ‰€æœ‰è´Ÿè½½å‡è¡¡çš„çˆ¶æ¥å£ï¼Œç‚¹å‡»è¿™é‡Œçš„ <code>rule</code> å˜é‡å¯ä»¥çœ‹åˆ°é»˜è®¤çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ä¸ºè½®è¯¢ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210807010401158.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210807010401158.png" alt="image-20210807010401158" style></a></p> <p>å¯ä»¥é€šè¿‡ IDEA æŸ¥çœ‹ <code>IRule</code> çš„æ‰€æœ‰å®ç°ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20210807010639929.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20210807010639929.png" alt="image-20210807010639929" style></a></p> <ul> <li>RoundRobinRule è½®è®­ç­–ç•¥ï¼šæŒ‰é¡ºåºå¾ªç¯é€‰æ‹© Server</li> <li>RandomRule éšæœºç­–ç•¥ï¼šéšæœºé€‰æ‹© Server</li> <li> <p>AvailabilityFilteringRule å¯ç”¨è¿‡æ»¤ç­–ç•¥ï¼šä¼šå…ˆè¿‡æ»¤ç”±äºå¤šæ¬¡è®¿é—®æ•…éšœè€Œå¤„äºæ–­è·¯å™¨è·³é—¸çŠ¶æ€çš„æœåŠ¡ï¼Œè¿˜æœ‰å¹¶å‘çš„è¿æ¥æ•°é‡è¶…è¿‡é˜ˆå€¼çš„æœåŠ¡ï¼Œç„¶åå¯¹å‰©ä½™çš„æœåŠ¡åˆ—è¡¨æŒ‰ç…§è½®è¯¢ç­–ç•¥è¿›è¡Œè®¿é—®</p> </li> <li> <p>WeightedResponseTimeRule å“åº”æ—¶é—´åŠ æƒç­–ç•¥ï¼šæ ¹æ®å¹³å‡å“åº”çš„æ—¶é—´è®¡ç®—æ‰€æœ‰æœåŠ¡çš„æƒé‡ï¼Œå“åº”æ—¶é—´è¶Šå¿«æœåŠ¡æƒé‡è¶Šå¤§è¢«é€‰ä¸­çš„æ¦‚ç‡è¶Šé«˜ï¼Œåˆšå¯åŠ¨æ—¶å¦‚æœç»Ÿè®¡ä¿¡æ¯ä¸è¶³ï¼Œåˆ™ä½¿ç”¨RoundRobinRuleç­–ç•¥ï¼Œç­‰ç»Ÿè®¡ä¿¡æ¯è¶³å¤Ÿä¼šåˆ‡æ¢åˆ°</p> </li> <li> <p>RetryRule é‡è¯•ç­–ç•¥ï¼šå…ˆæŒ‰ç…§RoundRobinRuleçš„ç­–ç•¥è·å–æœåŠ¡ï¼Œå¦‚æœè·å–å¤±è´¥åˆ™åœ¨åˆ¶å®šæ—¶é—´å†…è¿›è¡Œé‡è¯•ï¼Œè·å–å¯ç”¨çš„æœåŠ¡</p> </li> <li> <p>BestAviableRule æœ€ä½å¹¶å‘ç­–ç•¥ï¼šä¼šå…ˆè¿‡æ»¤æ‰ç”±äºå¤šæ¬¡è®¿é—®æ•…éšœè€Œå¤„äºæ–­è·¯å™¨è·³é—¸çŠ¶æ€çš„æœåŠ¡ï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªå¹¶å‘é‡æœ€å°çš„æœåŠ¡ </p> </li> </ul> <h4 id="513ä¿®æ”¹é»˜è®¤è´Ÿè½½å‡è¡¡ç­–ç•¥">5.1.3ã€ä¿®æ”¹é»˜è®¤è´Ÿè½½å‡è¡¡ç­–ç•¥<a class="headerlink" href="#513ä¿®æ”¹é»˜è®¤è´Ÿè½½å‡è¡¡ç­–ç•¥" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>è¢«è°ƒç”¨çš„æœåŠ¡id.ribbon.NFLoadBalancerRuleClassName=com.netflix.loadbalancer.RandomRule</p> <div class="language-properties highlight"><span class="filename">Properties</span><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="c1">#ä¿®æ”¹ç”¨æˆ·æœåŠ¡è°ƒç”¨è®¢å•æœåŠ¡é»˜è®¤è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œä½¿ç”¨éšæœºç­–ç•¥</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="na">order.ribbon.NFLoadBalancerRuleClassName</span><span class="o">=</span><span class="s">com.netflix.loadbalancer.RandomRule</span>
</span></code></pre></div> <h2 id="6æœåŠ¡æ–­è·¯å™¨">6ã€æœåŠ¡æ–­è·¯å™¨<a class="headerlink" href="#6æœåŠ¡æ–­è·¯å™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <h3 id="61hystrix">6.1ã€Hystrix<a class="headerlink" href="#61hystrix" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œè®¸å¤šæœåŠ¡ä¾èµ–é¡¹ä¸å¯é¿å…åœ°ä¼šå¤±è´¥ã€‚Hystrix æ˜¯ä¸€ä¸ªåº“ï¼Œå®ƒé€šè¿‡æ·»åŠ å»¶è¿Ÿå®¹å¿å’Œå®¹é”™é€»è¾‘æ¥å¸®åŠ©æ‚¨æ§åˆ¶è¿™äº›åˆ†å¸ƒå¼æœåŠ¡ä¹‹é—´çš„äº¤äº’ã€‚Hystrix é€šè¿‡éš”ç¦»æœåŠ¡ä¹‹é—´çš„è®¿é—®ç‚¹ã€åœæ­¢å®ƒä»¬ä¹‹é—´çš„çº§è”æ•…éšœä»¥åŠæä¾›åå¤‡é€‰é¡¹æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œæ‰€æœ‰è¿™äº›éƒ½å¯ä»¥æé«˜ç³»ç»Ÿçš„æ•´ä½“å¼¹æ€§ã€‚</p> <h4 id="611æœåŠ¡é›ªå´©ç†”æ–­é™çº§">6.1.1ã€æœåŠ¡é›ªå´©ã€ç†”æ–­ã€é™çº§<a class="headerlink" href="#611æœåŠ¡é›ªå´©ç†”æ–­é™çº§" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><strong>æœåŠ¡é›ªå´©</strong></p> <p>åœ¨å¾®æœåŠ¡ä¹‹é—´è¿›è¡ŒæœåŠ¡è°ƒç”¨æ˜¯ç”±äºæŸä¸€ä¸ªæœåŠ¡æ•…éšœï¼Œå¯¼è‡´çº§è”æœåŠ¡æ•…éšœçš„ç°è±¡ï¼Œç§°ä¸ºé›ªå´©æ•ˆåº”ã€‚é›ªå´©æ•ˆåº”æè¿°çš„æ˜¯æä¾›æ–¹ä¸å¯ç”¨ï¼Œå¯¼è‡´æ¶ˆè´¹æ–¹ä¸å¯ç”¨å¹¶å°†ä¸å¯ç”¨é€æ¸æ”¾å¤§çš„è¿‡ç¨‹ã€‚</p> <p>å¦‚å­˜åœ¨å¦‚ä¸‹è°ƒç”¨é“¾è·¯ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211103234624097.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211103234624097.png" alt="image-20211103234624097" style></a></p> <p>è€Œæ­¤æ—¶ï¼ŒService A çš„æµé‡æ³¢åŠ¨å¾ˆå¤§ï¼Œæµé‡ç»å¸¸ä¼šçªç„¶æ€§å¢åŠ ï¼é‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°±ç®— Service A èƒ½æ‰›å¾—ä½è¯·æ±‚ï¼ŒService B å’ŒService C æœªå¿…èƒ½æ‰›å¾—ä½è¿™çªå‘çš„è¯·æ±‚ã€‚æ­¤æ—¶ï¼Œå¦‚æœ Service C å› ä¸ºæŠ—ä¸ä½è¯·æ±‚ï¼Œå˜å¾—ä¸å¯ç”¨ã€‚é‚£ä¹ˆ Service B çš„è¯·æ±‚ä¹Ÿä¼šé˜»å¡ï¼Œæ…¢æ…¢è€—å°½ Service B çš„çº¿ç¨‹èµ„æºï¼ŒService B å°±ä¼šå˜å¾—ä¸å¯ç”¨ã€‚ç´§æ¥ç€ï¼ŒService A ä¹Ÿä¼šä¸å¯ç”¨ï¼Œè¿™ä¸€è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211103234721085.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211103234721085.png" alt="image-20211103234721085" style></a></p> <p><strong>æœåŠ¡ç†”æ–­</strong></p> <p>â€œç†”æ–­å™¨â€ æœ¬èº«æ˜¯ä¸€ç§å¼€å…³è£…ç½®ï¼Œå½“æŸä¸ªæœåŠ¡å•å…ƒå‘ç”Ÿæ•…éšœä¹‹åï¼Œé€šè¿‡æ–­è·¯å™¨ï¼ˆhystrixï¼‰çš„æ•…éšœç›‘æ§ï¼ŒæŸä¸ªå¼‚å¸¸æ¡ä»¶è¢«è§¦å‘ï¼Œç›´æ¥ç†”æ–­æ•´ä¸ªæœåŠ¡ã€‚å‘è°ƒç”¨æ–¹æ³•è¿”å›ä¸€ä¸ªç¬¦åˆé¢„æœŸçš„ã€å¯å¤„ç†çš„å¤‡é€‰å“åº”ï¼ˆFallBackï¼‰ï¼Œè€Œä¸æ˜¯é•¿æ—¶é—´çš„ç­‰å¾…æˆ–è€…æŠ›å‡ºè°ƒç”¨æ–¹æ³•æ— æ³•å¤„ç†çš„å¼‚å¸¸ï¼Œå°±ä¿è¯äº†æœåŠ¡è°ƒç”¨æ–¹çš„çº¿ç¨‹ä¸ä¼šè¢«é•¿æ—¶é—´å ç”¨ï¼Œé¿å…æ•…éšœåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è”“å»¶ï¼Œä¹ƒè‡³é›ªå´©ã€‚å¦‚æœç›®æ ‡æœåŠ¡æƒ…å†µå¥½è½¬åˆ™æ¢å¤è°ƒç”¨ã€‚æœåŠ¡ç†”æ–­æ˜¯è§£å†³æœåŠ¡é›ªå´©çš„é‡è¦æ‰‹æ®µã€‚</p> <p>æœåŠ¡ç†”æ–­å›¾ç¤ºï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211103234923258.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211103234923258.png" alt="image-20211103234923258" style></a></p> <p><strong>æœåŠ¡é™çº§</strong></p> <p>æœåŠ¡å‹åŠ›å‰§å¢çš„æ—¶å€™æ ¹æ®å½“å‰çš„ä¸šåŠ¡æƒ…å†µåŠæµé‡å¯¹ä¸€äº›æœåŠ¡å’Œé¡µé¢æœ‰ç­–ç•¥çš„é™çº§ï¼Œä»¥æ­¤ç¼“è§£æœåŠ¡å™¨çš„å‹åŠ›ï¼Œä»¥ä¿è¯æ ¸å¿ƒä»»åŠ¡çš„è¿›è¡Œã€‚åŒæ—¶ä¿è¯éƒ¨åˆ†ç”šè‡³å¤§éƒ¨åˆ†ä»»åŠ¡å®¢æˆ·èƒ½å¾—åˆ°æ­£ç¡®çš„å“åº”ã€‚ä¹Ÿå°±æ˜¯å½“å‰çš„è¯·æ±‚å¤„ç†ä¸äº†æˆ–è€…å‡ºé”™äº†ï¼Œç»™ä¸€ä¸ªé»˜è®¤çš„è¿”å›ã€‚</p> <p>æœåŠ¡é™çº§å›¾ç¤ºï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211103235406735.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211103235406735.png" alt="image-20211103235406735" style></a></p> <p><strong>é™çº§å’Œç†”æ–­æ€»ç»“</strong></p> <p>å…±åŒç‚¹ï¼š</p> <ul> <li>ç›®çš„å¾ˆä¸€è‡´ï¼Œéƒ½æ˜¯ä»å¯ç”¨æ€§å¯é æ€§ç€æƒ³ï¼Œä¸ºé˜²æ­¢ç³»ç»Ÿçš„æ•´ä½“ç¼“æ…¢ç”šè‡³å´©æºƒï¼Œé‡‡ç”¨çš„æŠ€æœ¯æ‰‹æ®µã€‚</li> <li>æœ€ç»ˆè¡¨ç°ç±»ä¼¼ï¼Œå¯¹äºä¸¤è€…æ¥è¯´ï¼Œæœ€ç»ˆè®©ç”¨æˆ·ä½“éªŒåˆ°çš„æ˜¯æŸäº›åŠŸèƒ½æš‚æ—¶ä¸å¯è¾¾æˆ–ä¸å¯ç”¨ã€‚</li> <li>ç²’åº¦ä¸€èˆ¬éƒ½æ˜¯æœåŠ¡çº§åˆ«ï¼Œå½“ç„¶ï¼Œä¸šç•Œä¹Ÿæœ‰ä¸å°‘æ›´ç»†ç²’åº¦çš„åšæ³•ï¼Œæ¯”å¦‚åšåˆ°æ•°æ®æŒä¹…å±‚ï¼ˆå…è®¸æŸ¥è¯¢ï¼Œä¸å…è®¸å¢åˆ æ”¹ï¼‰ã€‚</li> <li>è‡ªæ²»æ€§è¦æ±‚å¾ˆé«˜ï¼Œç†”æ–­æ¨¡å¼ä¸€èˆ¬éƒ½æ˜¯æœåŠ¡åŸºäºç­–ç•¥çš„è‡ªåŠ¨è§¦å‘ï¼Œé™çº§è™½è¯´å¯äººå·¥å¹²é¢„ï¼Œä½†åœ¨å¾®æœåŠ¡æ¶æ„ä¸‹ï¼Œå®Œå…¨é äººæ˜¾ç„¶ä¸å¯èƒ½ï¼Œå¼€å…³é¢„ç½®ã€é…ç½®ä¸­å¿ƒéƒ½æ˜¯å¿…è¦æ‰‹æ®µã€‚</li> </ul> <p>ä¸åŒç‚¹ï¼š</p> <ul> <li>è§¦å‘åŸå› ä¸å¤ªä¸€æ ·ï¼ŒæœåŠ¡ç†”æ–­ä¸€èˆ¬æ˜¯æŸä¸ªæœåŠ¡ï¼ˆä¸‹æ¸¸æœåŠ¡ï¼‰æ•…éšœå¼•èµ·ï¼Œè€ŒæœåŠ¡é™çº§ä¸€èˆ¬æ˜¯ä»æ•´ä½“è´Ÿè·è€ƒè™‘ï¼›</li> <li>ç®¡ç†ç›®æ ‡çš„å±‚æ¬¡ä¸å¤ªä¸€æ ·ï¼Œç†”æ–­å…¶å®æ˜¯ä¸€ä¸ªæ¡†æ¶çº§çš„å¤„ç†ï¼Œæ¯ä¸ªå¾®æœåŠ¡éƒ½éœ€è¦ï¼ˆæ— å±‚çº§ä¹‹åˆ†ï¼‰ï¼Œè€Œé™çº§ä¸€èˆ¬éœ€è¦å¯¹ä¸šåŠ¡æœ‰å±‚çº§ä¹‹åˆ†ï¼ˆæ¯”å¦‚é™çº§ä¸€èˆ¬æ˜¯ä»æœ€å¤–å›´æœåŠ¡è¾¹ç¼˜æœåŠ¡å¼€å§‹ï¼‰</li> </ul> <p>ç†”æ–­å¿…ä¼šè§¦å‘é™çº§ï¼Œæ‰€ä»¥ç†”æ–­ä¹Ÿæ˜¯é™çº§ä¸€ç§ï¼ŒåŒºåˆ«åœ¨äºç†”æ–­æ˜¯å¯¹è°ƒç”¨é“¾è·¯çš„ä¿æŠ¤ï¼Œè€Œé™çº§æ˜¯å¯¹ç³»ç»Ÿè¿‡è½½çš„ä¸€ç§ä¿æŠ¤å¤„ç†</p> <h4 id="622æœåŠ¡ç†”æ–­çš„å®ç°">6.2.2ã€æœåŠ¡ç†”æ–­çš„å®ç°<a class="headerlink" href="#622æœåŠ¡ç†”æ–­çš„å®ç°" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ol> <li> <p>æ·»åŠ ä¸€ä¸ªå¾®æœåŠ¡ springcloud_hystrixï¼Œå¹¶å¼•å…¥ç›¸å…³ä¾èµ–ï¼š</p> <div class="language-xml highlight"><span class="filename">XML</span><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="cm">&lt;!--å¼•å…¥hystrix--&gt;</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-hystrix<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="nt">&lt;/dependency&gt;</span>
</span></code></pre></div> </li> <li> <p>é…ç½®ä¸‹ application.properties æ–‡ä»¶ï¼š</p> <div class="language-properties highlight"><span class="filename">Properties</span><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="na">server.port</span><span class="o">=</span><span class="s">8990</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="na">spring.application.name</span><span class="o">=</span><span class="s">hystrix</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="c1">#æ³¨å†Œåˆ°consul serverä¸Š</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="na">spring.cloud.consul.host</span><span class="o">=</span><span class="s">localhost</span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="na">spring.cloud.consul.port</span><span class="o">=</span><span class="s">8500</span>
</span></code></pre></div> </li> <li> <p>åœ¨ SpringApplication å…¥å£ç±»ä¸ŠåŠ å…¥å¼€å¯æ–­è·¯å™¨çš„æ³¨è§£ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="nd">@SpringBootApplication</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="nd">@EnableDiscoveryClient</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="c1">//å¼€å¯HystrixæœåŠ¡ç†”æ–­</span>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="nd">@EnableHystrix</span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Hystrix8990Application</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">Hystrix8990Application</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>ç¼–å†™ä¸€ä¸ª Controllerï¼Œä½¿ç”¨ HystrixCommand æ³¨è§£å®ç°æ–­è·¯</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="nd">@RestController</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DemoController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">LOGGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">DemoController</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/demo"</span><span class="p">)</span>
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a><span class="w">    </span><span class="c1">//æŒ‡å®šç†”æ–­æ—¶å¿«é€Ÿè¿”å›æ–¹æ³•</span>
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a><span class="w">    </span><span class="nd">@HystrixCommand</span><span class="p">(</span><span class="n">fallbackMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"testBreakFall"</span><span class="p">)</span>
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">testBreak</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a><span class="w">        </span><span class="n">LOGGER</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">"æ¥æ”¶çš„Idä¸ºï¼š{}"</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
</span><span id="__span-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-52-12"><a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="s">"æ•°æ®ä¸åˆæ³•"</span><span class="p">);</span>
</span><span id="__span-52-13"><a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-52-14"><a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">"æ¥æ”¶çš„Idä¸ºï¼š"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</span><span id="__span-52-15"><a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-52-16"><a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a>
</span><span id="__span-52-17"><a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">testBreakFall</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-52-18"><a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">"å½“å‰æ•°æ®ä¸åˆæ³•ï¼š"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</span><span id="__span-52-19"><a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-52-20"><a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>æµ‹è¯•ï¼Œè®¿é—® <a href="http://localhost:8990/demo?id=-1">localhost:8990/demo?id=-1</a> å’Œ <a href="http://localhost:8990/demo?id=1">localhost:8990/demo?id=1</a></p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211107231830649.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211107231830649.png" alt="image-20211107231830649" style></a></p> </li> </ol> <p><strong>æ–­è·¯å™¨çš„å¼€å¯æ¡ä»¶</strong></p> <p>å½“å¤šæ¬¡è°ƒç”¨é”™è¯¯å‚æ•°åï¼Œæ–­è·¯å™¨ä¼šè‡ªåŠ¨æ‰“å¼€ï¼Œæ­¤æ—¶æ­£å¸¸è°ƒç”¨ä¹Ÿä¼šå‡ºå‘æ–­è·¯å™¨ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211107232033660.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211107232033660.png" alt="image-20211107232033660" style></a></p> <p>å› ä¸ºå½“è¾¾æˆ Hystrix çš„æ‰“å¼€æ¡ä»¶åï¼Œæ–­è·¯å™¨å°±ä¼šè‡ªåŠ¨æ‰“å¼€ï¼š</p> <ol> <li>å½“æ»¡è¶³ä¸€å®šçš„é˜€å€¼çš„æ—¶å€™ï¼ˆé»˜è®¤10ç§’å†…è¶…è¿‡20ä¸ªè¯·æ±‚æ¬¡æ•°ï¼‰</li> <li>å½“å¤±è´¥ç‡è¾¾åˆ°ä¸€å®šçš„æ—¶å€™ï¼ˆé»˜è®¤10ç§’å†…è¶…è¿‡50%çš„è¯·æ±‚å¤±è´¥ï¼‰</li> </ol> <p>å½“å¼€å¯çš„æ—¶å€™ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½ä¸ä¼šè¿›è¡Œè½¬å‘ã€‚ä¸€æ®µæ—¶é—´ä¹‹åï¼ˆé»˜è®¤æ˜¯5ç§’ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™æ–­è·¯å™¨æ˜¯åŠå¼€çŠ¶æ€ï¼Œä¼šè®©å…¶ä¸­ä¸€ä¸ªè¯·æ±‚è¿›è¡Œè½¬å‘ã€‚å¦‚æœæˆåŠŸï¼Œæ–­è·¯å™¨ä¼šå…³é—­ï¼Œè‹¥å¤±è´¥ï¼Œç»§ç»­å¼€å¯ã€‚</p> <p><strong>æ–­è·¯å™¨æµç¨‹</strong></p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211107232403809.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211107232403809.png" alt="image-20211107232403809" style></a></p> <p><strong>é»˜è®¤çš„æœåŠ¡ FallBack å¤„ç†æ–¹æ³•</strong></p> <p>å¦‚æœä¸ºæ¯ä¸€ä¸ªæœåŠ¡æ–¹æ³•å¼€å‘ä¸€ä¸ªé™çº§ï¼Œå¯¹äºæˆ‘ä»¬æ¥è¯´å¯èƒ½ä¼šå‡ºç°å¤§é‡çš„ä»£ç çš„å†—ä½™ï¼Œä¸åˆ©äºç»´æŠ¤ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦åŠ å…¥é»˜è®¤æœåŠ¡é™çº§å¤„ç†æ–¹æ³•</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/default"</span><span class="p">)</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="nd">@HystrixCommand</span><span class="p">(</span><span class="n">defaultFallback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"defaultFallback"</span><span class="p">)</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">defaultTest</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="s">"å¼‚å¸¸å•¦ï¼"</span><span class="p">);</span>
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a><span class="p">}</span>
</span><span id="__span-53-6"><a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a>
</span><span id="__span-53-7"><a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">defaultFallback</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-53-8"><a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">"æ­¤ä¸ºé»˜è®¤å“åº”"</span><span class="p">;</span>
</span><span id="__span-53-9"><a id="__codelineno-53-9" name="__codelineno-53-9" href="#__codelineno-53-9"></a><span class="p">}</span>
</span></code></pre></div> <h4 id="623æœåŠ¡é™çº§çš„å®ç°">6.2.3ã€æœåŠ¡é™çº§çš„å®ç°<a class="headerlink" href="#623æœåŠ¡é™çº§çš„å®ç°" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ol> <li> <p>åˆ›å»ºä¸€ä¸ªæ–°çš„å¾®æœåŠ¡ï¼šopenfeignHystrixï¼Œå¹¶å¼•å…¥ç›¸å…³ä¾èµ–ï¼š</p> <div class="language-xml highlight"><span class="filename">XML</span><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="nt">&lt;dependencies&gt;</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a><span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a><span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-consul-discovery<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a><span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-54-10"><a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a><span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-54-11"><a id="__codelineno-54-11" name="__codelineno-54-11" href="#__codelineno-54-11"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-54-12"><a id="__codelineno-54-12" name="__codelineno-54-12" href="#__codelineno-54-12"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-actuator<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-54-13"><a id="__codelineno-54-13" name="__codelineno-54-13" href="#__codelineno-54-13"></a><span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-54-14"><a id="__codelineno-54-14" name="__codelineno-54-14" href="#__codelineno-54-14"></a><span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-54-15"><a id="__codelineno-54-15" name="__codelineno-54-15" href="#__codelineno-54-15"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-54-16"><a id="__codelineno-54-16" name="__codelineno-54-16" href="#__codelineno-54-16"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-openfeign<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-54-17"><a id="__codelineno-54-17" name="__codelineno-54-17" href="#__codelineno-54-17"></a><span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-54-18"><a id="__codelineno-54-18" name="__codelineno-54-18" href="#__codelineno-54-18"></a><span class="nt">&lt;/dependencies&gt;</span>
</span></code></pre></div> <p>å› ä¸º OpfenFeign ä¸­åŒ…å«äº† Hystrix ä¾èµ–ï¼Œæ‰€ä»¥æ— éœ€å†æ¬¡å¼•å…¥ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211107235244640.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211107235244640.png" alt="image-20211107235244640" style></a></p> </li> <li> <p>é…ç½®ä¸€ä¸‹ application.propertiesï¼Œå¹¶å¼€å¯openfeignæ”¯æŒæœåŠ¡é™çº§ï¼š</p> <div class="language-properties highlight"><span class="filename">Properties</span><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="na">server.port</span><span class="o">=</span><span class="s">8991</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="na">spring.application.name</span><span class="o">=</span><span class="s">openfeignHystrix</span>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="c1">#æ³¨å†Œåˆ°consul server</span>
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="na">spring.cloud.consul.port</span><span class="o">=</span><span class="s">8500</span>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a><span class="na">spring.cloud.consul.host</span><span class="o">=</span><span class="s">localhost</span>
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a><span class="c1">#å¼€å¯openfeignæ”¯æŒæœåŠ¡é™çº§</span>
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a><span class="na">feign.hystrix.enabled</span><span class="o">=</span><span class="s">true</span>
</span></code></pre></div> </li> <li> <p>ç¼–å†™å…¥å£ç±»ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="nd">@SpringBootApplication</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="nd">@EnableDiscoveryClient</span>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="c1">//å¼€å¯OpenFeignè°ƒç”¨</span>
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="nd">@EnableFeignClients</span>
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">OpenfeignHystrix8991Application</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-7"><a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a><span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">OpenfeignHystrix8991Application</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-56-8"><a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-56-9"><a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>ç¼–å†™ OpenFeign å®¢æˆ·ç«¯ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="nd">@FeignClient</span><span class="p">(</span><span class="s">"hystrix"</span><span class="p">)</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">HystrixClient</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/demo"</span><span class="p">)</span>
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">demo</span><span class="p">(</span><span class="nd">@RequestParam</span><span class="p">(</span><span class="s">"id"</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>å¼€å‘ fallback å¤„ç†ç±»ï¼šå®ç° HystrixClientï¼Œé‡å†™çš„æ–¹æ³•å°±æ˜¯å¯¹åº”çš„ fallback å¤„ç†</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="nd">@Configuration</span>
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">HystrixFallBack</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">HystrixClient</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">demo</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-5"><a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">"å½“å‰æœåŠ¡ä¸å¯ç”¨,è¯·ç¨åå†è¯•,id:"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</span><span id="__span-58-6"><a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-7"><a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>åœ¨ OpenFeign å®¢æˆ·ç«¯ä¸­åŠ å…¥ Hystrixï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="nd">@FeignClient</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"hystrix"</span><span class="p">,</span><span class="w"> </span><span class="n">fallback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HystrixFallBack</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
</span></code></pre></div> </li> <li> <p>ç¼–å†™ä¸€ä¸ª Controller æµ‹è¯•ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="nd">@RestController</span>
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DemoController</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a><span class="w">    </span><span class="nd">@Autowired</span>
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">HystrixClient</span><span class="w"> </span><span class="n">hystrixClient</span><span class="p">;</span>
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/test"</span><span class="p">)</span>
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9" href="#__codelineno-60-9"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hystrixClient</span><span class="p">.</span><span class="na">demo</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-60-10"><a id="__codelineno-60-10" name="__codelineno-60-10" href="#__codelineno-60-10"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">"feignHystrixè°ƒç”¨æˆåŠŸï¼š"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-60-11"><a id="__codelineno-60-11" name="__codelineno-60-11" href="#__codelineno-60-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-60-12"><a id="__codelineno-60-12" name="__codelineno-60-12" href="#__codelineno-60-12"></a><span class="p">}</span>
</span></code></pre></div> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211108000721009.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211108000721009.png" alt="image-20211108000721009" style></a></p> </li> </ol> <h2 id="7æœåŠ¡ç½‘å…³ç»„ä»¶">7ã€æœåŠ¡ç½‘å…³ç»„ä»¶<a class="headerlink" href="#7æœåŠ¡ç½‘å…³ç»„ä»¶" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <p><strong>ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘å…³ï¼Ÿ</strong></p> <p>ç½‘å…³ç»Ÿä¸€æœåŠ¡å…¥å£ï¼Œå¯æ–¹ä¾¿å®ç°å¯¹å¹³å°ä¼—å¤šæœåŠ¡æ¥å£è¿›è¡Œç®¡æ§ï¼Œå¯¹è®¿é—®æœåŠ¡çš„èº«ä»½è®¤è¯ã€é˜²æŠ¥æ–‡é‡æ”¾ä¸é˜²æ•°æ®ç¯¡æ”¹ã€åŠŸèƒ½è°ƒç”¨çš„ä¸šåŠ¡é‰´æƒã€å“åº”æ•°æ®çš„è„±æ•ã€æµé‡ä¸å¹¶å‘æ§åˆ¶ï¼Œç”šè‡³åŸºäº API è°ƒç”¨çš„è®¡é‡æˆ–è€…è®¡è´¹ç­‰ç­‰ã€‚</p> <p>ç½‘å…³ = è·¯ç”±è½¬å‘ + è¿‡æ»¤å™¨ã€‚è·¯ç”±è½¬å‘ï¼šæ¥æ”¶ä¸€åˆ‡å¤–ç•Œè¯·æ±‚ï¼Œè½¬å‘åˆ°åç«¯çš„å¾®æœåŠ¡ä¸Šå»ï¼›åœ¨æœåŠ¡ç½‘å…³ä¸­å¯ä»¥å®Œæˆä¸€ç³»åˆ—çš„æ¨ªåˆ‡åŠŸèƒ½ï¼Œä¾‹å¦‚æƒé™æ ¡éªŒã€é™æµä»¥åŠç›‘æ§ç­‰ï¼Œè¿™äº›éƒ½å¯ä»¥é€šè¿‡è¿‡æ»¤å™¨å®Œæˆã€‚</p> <p><strong>ä¸ºä»€ä¹ˆéœ€è¦ç½‘å…³ï¼Ÿ</strong></p> <ul> <li>ç½‘å…³å¯ä»¥å®ç°æœåŠ¡çš„ç»Ÿä¸€ç®¡ç†</li> <li>ç½‘å…³å¯ä»¥è§£å†³å¾®æœåŠ¡ä¸­é€šç”¨ä»£ç çš„å†—ä½™é—®é¢˜ï¼ˆå¦‚æƒé™æ§åˆ¶ã€æµé‡ç›‘æ§ã€é™æµç­‰ï¼‰</li> </ul> <p><strong>ç½‘å…³ç»„ä»¶åœ¨å¾®æœåŠ¡ä¸­æ¶æ„</strong></p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211221221738529.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211221221738529.png" alt="image-20211221221738529" style></a></p> <h3 id="71gateway">7.1ã€Gateway<a class="headerlink" href="#71gateway" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>è¿™ä¸ªé¡¹ç›®æä¾›äº†ä¸€ä¸ªåœ¨ SpringMVC ä¹‹ä¸Šæ„å»º API ç½‘å…³çš„åº“ã€‚SpringCloud Gateway æ—¨åœ¨æä¾›ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„æ–¹æ³•æ¥è·¯ç”±åˆ° APIï¼Œå¹¶ä¸º API æä¾›æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼Œæ¯”å¦‚ï¼šå®‰å…¨æ€§ã€ç›‘æ§ã€åº¦é‡å’Œå¼¹æ€§ã€‚</p> <p><strong>ç‰¹æ€§</strong></p> <ul> <li>åŸºäº SpringBoot 2.x å’Œ Spring WebFlux å’Œ Reactor æ„å»ºï¼Œå“åº”å¼å¼‚æ­¥éé˜»å¡ IO æ¨¡å‹</li> <li>åŠ¨æ€è·¯ç”±</li> <li>è¯·æ±‚è¿‡æ»¤</li> </ul> <h4 id="711å¼€å‘ç½‘å…³åŠ¨æ€è·¯ç”±">7.1.1ã€å¼€å‘ç½‘å…³åŠ¨æ€è·¯ç”±<a class="headerlink" href="#711å¼€å‘ç½‘å…³åŠ¨æ€è·¯ç”±" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>ç½‘å…³é…ç½®æœ‰ä¸¤ç§æ–¹å¼ï¼šä¸€ç§æ˜¯å¿«æ·æ–¹å¼ï¼ˆJava ä»£ç ç¼–å†™ç½‘å…³ï¼‰ï¼Œä¸€ç§æ˜¯å®Œå…¨å±•å¼€æ–¹å¼ï¼ˆé…ç½®æ–‡ä»¶æ–¹å¼ï¼‰[æ¨è]ã€‚</p> <p><strong>é…ç½®æ–‡ä»¶æ–¹å¼ï¼š</strong></p> <ol> <li> <p>åˆ›å»ºé¡¹ç›®å¼•å…¥ç½‘å…³ä¾èµ–ï¼š</p> <div class="language-xml highlight"><span class="filename">XML</span><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="nt">&lt;dependencies&gt;</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-61-6"><a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a><span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-61-7"><a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-61-8"><a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-consul-discovery<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-61-9"><a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a><span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-61-10"><a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a><span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-61-11"><a id="__codelineno-61-11" name="__codelineno-61-11" href="#__codelineno-61-11"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-61-12"><a id="__codelineno-61-12" name="__codelineno-61-12" href="#__codelineno-61-12"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-actuator<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-61-13"><a id="__codelineno-61-13" name="__codelineno-61-13" href="#__codelineno-61-13"></a><span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-61-14"><a id="__codelineno-61-14" name="__codelineno-61-14" href="#__codelineno-61-14"></a><span class="w">    </span><span class="cm">&lt;!--å¼•å…¥gatewayç½‘å…³ä¾èµ–--&gt;</span>
</span><span id="__span-61-15"><a id="__codelineno-61-15" name="__codelineno-61-15" href="#__codelineno-61-15"></a><span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-61-16"><a id="__codelineno-61-16" name="__codelineno-61-16" href="#__codelineno-61-16"></a><span class="w">        </span><span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-61-17"><a id="__codelineno-61-17" name="__codelineno-61-17" href="#__codelineno-61-17"></a><span class="w">        </span><span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-gateway<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-61-18"><a id="__codelineno-61-18" name="__codelineno-61-18" href="#__codelineno-61-18"></a><span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-61-19"><a id="__codelineno-61-19" name="__codelineno-61-19" href="#__codelineno-61-19"></a><span class="nt">&lt;/dependencies&gt;</span>
</span></code></pre></div> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="nd">@SpringBootApplication</span>
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a><span class="nd">@EnableDiscoveryClient</span>
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Gateway8989Application</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a><span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">Gateway8989Application</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>ç¼–å†™ application.yml é…ç½®æ–‡ä»¶ï¼š</p> <div class="language-yaml highlight"><span class="filename">YAML</span><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="nt">server</span><span class="p">:</span>
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8989</span>
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a><span class="nt">spring</span><span class="p">:</span>
</span><span id="__span-63-4"><a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a><span class="w">  </span><span class="nt">application</span><span class="p">:</span>
</span><span id="__span-63-5"><a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway</span>
</span><span id="__span-63-6"><a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a><span class="w">  </span><span class="nt">cloud</span><span class="p">:</span>
</span><span id="__span-63-7"><a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a><span class="w">    </span><span class="nt">consul</span><span class="p">:</span>
</span><span id="__span-63-8"><a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a><span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8500</span>
</span><span id="__span-63-9"><a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a><span class="w">      </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span>
</span><span id="__span-63-10"><a id="__codelineno-63-10" name="__codelineno-63-10" href="#__codelineno-63-10"></a><span class="w">    </span><span class="nt">gateway</span><span class="p">:</span>
</span><span id="__span-63-11"><a id="__codelineno-63-11" name="__codelineno-63-11" href="#__codelineno-63-11"></a><span class="w">      </span><span class="nt">routes</span><span class="p">:</span>
</span><span id="__span-63-12"><a id="__codelineno-63-12" name="__codelineno-63-12" href="#__codelineno-63-12"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">order_route</span><span class="w">               </span><span class="c1"># æŒ‡å®šè·¯ç”±å”¯ä¸€æ ‡è¯†</span>
</span><span id="__span-63-13"><a id="__codelineno-63-13" name="__codelineno-63-13" href="#__codelineno-63-13"></a><span class="w">          </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://localhost:9996/</span><span class="w">   </span><span class="c1"># æŒ‡å®šè·¯ç”±æœåŠ¡çš„åœ°å€</span>
</span><span id="__span-63-14"><a id="__codelineno-63-14" name="__codelineno-63-14" href="#__codelineno-63-14"></a><span class="w">          </span><span class="nt">predicates</span><span class="p">:</span>
</span><span id="__span-63-15"><a id="__codelineno-63-15" name="__codelineno-63-15" href="#__codelineno-63-15"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Path=/order/**</span><span class="w">            </span><span class="c1"># æŒ‡å®šè·¯ç”±è§„åˆ™</span>
</span><span id="__span-63-16"><a id="__codelineno-63-16" name="__codelineno-63-16" href="#__codelineno-63-16"></a>
</span><span id="__span-63-17"><a id="__codelineno-63-17" name="__codelineno-63-17" href="#__codelineno-63-17"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">product_route</span>
</span><span id="__span-63-18"><a id="__codelineno-63-18" name="__codelineno-63-18" href="#__codelineno-63-18"></a><span class="w">          </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://localhost:9993/</span>
</span><span id="__span-63-19"><a id="__codelineno-63-19" name="__codelineno-63-19" href="#__codelineno-63-19"></a><span class="w">          </span><span class="nt">predicates</span><span class="p">:</span>
</span><span id="__span-63-20"><a id="__codelineno-63-20" name="__codelineno-63-20" href="#__codelineno-63-20"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Path=/product/**</span>
</span></code></pre></div> </li> <li> <p>å¯åŠ¨ Gateway ç½‘å…³é¡¹ç›®åå‘ç°æŠ±é”™ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211226235723611.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211226235723611.png" alt="image-20211226235723611" style></a></p> <p>æ ¹æ®ä¸Šé¢æè¿°ï¼ˆDescriptionï¼‰ä¸­ä¿¡æ¯äº†è§£åˆ° GatewayAutoConfiguration è¿™ä¸ªé…ç½®ä¸­æ‰¾ä¸åˆ° ServerCodecConfig è¿™ä¸ªBeanã€‚</p> <p>ä»æºç ä¸­å¾—çŸ¥ SpringBoot åœ¨å¯åŠ¨çš„æ—¶å€™ä¼šå»åŠ è½½å®ƒçš„é…ç½®ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå«åš GatewayClassPathWarningAutoConfiguration çš„é…ç½®ç±»ä¸­æœ‰è¿™ä¹ˆä¸€è¡Œä»£ç ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211227001125725.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211227001125725.png" alt="image-20211227001125725" style></a></p> <p>ç¿»è¯‘è¿‡æ¥æ˜¯ï¼šåœ¨ classpath ä¸Šå‘ç° Spring MVCï¼Œæ­¤æ—¶ä¸ Spring Cloud Gateway ä¸å…¼å®¹ã€‚è¯·åˆ é™¤ spring-boot-starter-web ä¾èµ–é¡¹ã€‚</p> <p>å› ä¸º Spring Cloud Gateway æ˜¯åŸºäº Webflux çš„ï¼Œå¦‚æœéè¦ Web æ”¯æŒçš„è¯éœ€è¦å¯¼å…¥ <code>spring-boot-starter-webflux</code> è€Œä¸æ˜¯ <code>spring-boot-start-web</code>ã€‚é‚£æˆ‘ä»¬ç›´æ¥æŠŠ pom.xml ä¸­å…³äº <code>spring-boot-start-web</code> æ¨¡å—çš„ä¾èµ–å»æ‰å³å¯ã€‚</p> <p>å†æ¬¡å¯åŠ¨æˆåŠŸå¯åŠ¨ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/SpringCloud/image-20211227001927862.png" data-desc-position="bottom"><img src="!assets/SpringCloud/image-20211227001927862.png" alt="image-20211227001927862" style></a></p> </li> <li> <p>å¯åŠ¨è®¢å•å’Œå•†å“æœåŠ¡ï¼Œæµ‹è¯•ç½‘å…³è·¯ç”±è½¬å‘ï¼š</p> <p>æµ‹è¯•é€šè¿‡ç½‘å…³è®¿é—®è®¢å•æœåŠ¡: http://localhost:8989/order</p> <p>æµ‹è¯•é€šè¿‡ç½‘å…³è®¿é—®å•†å“æœåŠ¡: http://localhost:8989/product</p> </li> </ol> <p><strong>Java æ–¹å¼é…ç½®è·¯ç”±ï¼š</strong></p> <ol> <li> <p>ç¼–å†™ Gateway é…ç½®ç±»ï¼š</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="cm">/**</span>
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="cm"> * @author Orichalcos</span>
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a><span class="cm"> */</span>
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a><span class="nd">@Configuration</span>
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">GatewayConfig</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a><span class="w">    </span><span class="nd">@Bean</span>
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">RouteLocator</span><span class="w"> </span><span class="nf">customRouteLocator</span><span class="p">(</span><span class="n">RouteLocatorBuilder</span><span class="w"> </span><span class="n">builder</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="na">routes</span><span class="p">()</span>
</span><span id="__span-64-9"><a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a><span class="w">                </span><span class="p">.</span><span class="na">route</span><span class="p">(</span><span class="s">"category_route"</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="na">path</span><span class="p">(</span><span class="s">"/category/**"</span><span class="p">).</span><span class="na">uri</span><span class="p">(</span><span class="s">"http://localhost:9995"</span><span class="p">))</span>
</span><span id="__span-64-10"><a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a><span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
</span><span id="__span-64-11"><a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-64-12"><a id="__codelineno-64-12" name="__codelineno-64-12" href="#__codelineno-64-12"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>æµ‹è¯•é€šè¿‡ç½‘å…³è®¿é—®ç±»åˆ«æœåŠ¡ï¼šhttp://localhost:8989/category</p> </li> </ol> <h4 id="712æŸ¥çœ‹ç½‘å…³è·¯ç”±è§„åˆ™">7.1.2ã€æŸ¥çœ‹ç½‘å…³è·¯ç”±è§„åˆ™<a class="headerlink" href="#712æŸ¥çœ‹ç½‘å…³è·¯ç”±è§„åˆ™" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <aside class="md-source-file"> <span class="md-source-file__fact"> <span class="md-icon" title="æœ€åæ›´æ–°"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2026å¹´1æœˆ22æ—¥ 20:21:58 UTC">2026å¹´1æœˆ22æ—¥ 20:21:58</span> </span> <span class="md-source-file__fact"> <span class="md-icon" title="åˆ›å»ºæ—¥æœŸ"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2021å¹´4æœˆ26æ—¥ 11:39:30 UTC">2021å¹´4æœˆ26æ—¥ 11:39:30</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type="button" class="md-top md-icon" data-md-component="top" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> å›åˆ°é¡µé¢é¡¶éƒ¨ </button> </main> <footer class="md-footer"> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.top", "navigation.tracking", "navigation.instant", "navigation.path", "content.tabs.link", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script> <script src="../assets/javascripts/bundle.79ae519e.min.js"></script> <script src="../_javascripts/auto_title.js"></script>  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>