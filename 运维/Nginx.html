<!DOCTYPE html><html lang="zh" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://0richalcos.github.io/Note/%E8%BF%90%E7%BB%B4/Nginx.html"><link rel="prev" href="NSSM.html"><link rel="next" href="Tomcat.html"><link rel="icon" href="../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Nginx - éšä¾¿è®°è®°</title><link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css"><link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel="stylesheet" href="../_stylesheets/extra.css"><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal"> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a href="#1ç®€ä»‹" class="md-skip"> è·³è½¬è‡³ </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow" data-md-component="header"> <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰"> <a href="../index.html" title="éšä¾¿è®°è®°" class="md-header__button md-logo" aria-label="éšä¾¿è®°è®°" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> éšä¾¿è®°è®° </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> Nginx </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input class="md-option" data-md-color-media data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal" aria-label="åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼" type="radio" name="__palette" id="__palette_0"> <label class="md-header__button md-icon" title="åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼" for="__palette_1" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> <input class="md-option" data-md-color-media data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal" aria-label="åˆ‡æ¢åˆ°äº®è‰²æ¨¡å¼" type="radio" name="__palette" id="__palette_1"> <label class="md-header__button md-icon" title="åˆ‡æ¢åˆ°äº®è‰²æ¨¡å¼" for="__palette_0" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <div class="md-header__source"> <a href="https://github.com/0richalcos/Note" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> GitHub </div> </a> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--primary" aria-label="å¯¼èˆªæ " data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a href="../index.html" title="éšä¾¿è®°è®°" class="md-nav__button md-logo" aria-label="éšä¾¿è®°è®°" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> éšä¾¿è®°è®° </label> <div class="md-nav__source"> <a href="https://github.com/0richalcos/Note" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> GitHub </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../index.html" class="md-nav__link"> <span class="md-ellipsis"> ğŸ  é¦–é¡µ </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2"> <div class="md-nav__link md-nav__container"> <a href="../Java/Java.html" class="md-nav__link "> <span class="md-ellipsis"> â™¨ï¸ Java </span> </a> <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> â™¨ï¸ Java </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../Java/Java8.html" class="md-nav__link"> <span class="md-ellipsis"> Java 8 </span> </a> </li> <li class="md-nav__item"> <a href="../Java/JavaBasics.html" class="md-nav__link"> <span class="md-ellipsis"> Java åŸºç¡€ </span> </a> </li> <li class="md-nav__item"> <a href="../Java/JavaCollection.html" class="md-nav__link"> <span class="md-ellipsis"> Java é›†åˆ </span> </a> </li> <li class="md-nav__item"> <a href="../Java/JavaObject.html" class="md-nav__link"> <span class="md-ellipsis"> Java ç±»å’Œå¯¹è±¡ </span> </a> </li> <li class="md-nav__item"> <a href="../Java/JavaWeb.html" class="md-nav__link"> <span class="md-ellipsis"> JavaWeb </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3"> <div class="md-nav__link md-nav__container"> <a href="../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E7%AE%97%E6%B3%95/Algorithm.html" class="md-nav__link "> <span class="md-ellipsis"> ğŸ§® æ•°æ®ç»“æ„åŠç®—æ³• </span> </a> <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> ğŸ§® æ•°æ®ç»“æ„åŠç®—æ³• </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E7%AE%97%E6%B3%95/DesignPattern.html" class="md-nav__link"> <span class="md-ellipsis"> DesignPattern </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4"> <div class="md-nav__link md-nav__container"> <a href="../Spring/Spring.html" class="md-nav__link "> <span class="md-ellipsis"> ğŸƒ Spring </span> </a> <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> ğŸƒ Spring </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../Spring/SpringBoot.html" class="md-nav__link"> <span class="md-ellipsis"> SpringBoot </span> </a> </li> <li class="md-nav__item"> <a href="../Spring/SpringCloud.html" class="md-nav__link"> <span class="md-ellipsis"> SpringCloud </span> </a> </li> <li class="md-nav__item"> <a href="../Spring/SpringMVC.html" class="md-nav__link"> <span class="md-ellipsis"> SpringMVC </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5"> <div class="md-nav__link md-nav__container"> <a href="../%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6/MyBatis-Plus.html" class="md-nav__link "> <span class="md-ellipsis"> ğŸ’¾ æŒä¹…å±‚æ¡†æ¶ </span> </a> <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> ğŸ’¾ æŒä¹…å±‚æ¡†æ¶ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6/Mybatis.html" class="md-nav__link"> <span class="md-ellipsis"> Mybatis </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6"> <div class="md-nav__link md-nav__container"> <a href="../%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/SSO.html" class="md-nav__link "> <span class="md-ellipsis"> ğŸ” è®¤è¯ä¸æˆæƒ </span> </a> <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> ğŸ” è®¤è¯ä¸æˆæƒ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/Sa-Token.html" class="md-nav__link"> <span class="md-ellipsis"> Sa-Token </span> </a> </li> <li class="md-nav__item"> <a href="../%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/Shiro.html" class="md-nav__link"> <span class="md-ellipsis"> Shiro </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7"> <div class="md-nav__link md-nav__container"> <a href="../%E5%89%8D%E7%AB%AF/CSS.html" class="md-nav__link "> <span class="md-ellipsis"> ğŸŒ å‰ç«¯ </span> </a> <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> ğŸŒ å‰ç«¯ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/JavaScript.html" class="md-nav__link"> <span class="md-ellipsis"> JavaScript </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/Vue.html" class="md-nav__link"> <span class="md-ellipsis"> Vue </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/jQuery.html" class="md-nav__link"> <span class="md-ellipsis"> jQuery </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/Thymeleaf.html" class="md-nav__link"> <span class="md-ellipsis"> Thymeleaf </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5"> <div class="md-nav__link md-nav__container"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/AntV-X6.html" class="md-nav__link "> <span class="md-ellipsis"> ç»„ä»¶åº“ </span> </a> <label class="md-nav__link " for="__nav_7_5" id="__nav_7_5_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_7_5"> <span class="md-nav__icon md-icon"></span> ç»„ä»¶åº“ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/ApacheECharts.html" class="md-nav__link"> <span class="md-ellipsis"> ApacheECharts </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/Axios.html" class="md-nav__link"> <span class="md-ellipsis"> Axios </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/BootstrapTable.html" class="md-nav__link"> <span class="md-ellipsis"> BootstrapTable </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/DHTMLXGantt.html" class="md-nav__link"> <span class="md-ellipsis"> DHTMLXGantt </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/Element.html" class="md-nav__link"> <span class="md-ellipsis"> Element </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/FullCalendar.html" class="md-nav__link"> <span class="md-ellipsis"> FullCalendar </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/X-editable.html" class="md-nav__link"> <span class="md-ellipsis"> X-editable </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8"> <div class="md-nav__link md-nav__container"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/Dameng.html" class="md-nav__link "> <span class="md-ellipsis"> ğŸ“Š æ•°æ®åº“ </span> </a> <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8"> <span class="md-nav__icon md-icon"></span> ğŸ“Š æ•°æ®åº“ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL.html" class="md-nav__link"> <span class="md-ellipsis"> MySQL </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/MySQLQuery.html" class="md-nav__link"> <span class="md-ellipsis"> MySQLQuery </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/OceanBase.html" class="md-nav__link"> <span class="md-ellipsis"> OceanBase </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/Oracle.html" class="md-nav__link"> <span class="md-ellipsis"> Oracle </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/Redis.html" class="md-nav__link"> <span class="md-ellipsis"> Redis </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/Vastbase.html" class="md-nav__link"> <span class="md-ellipsis"> Vastbase </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/Elasticsearch.html" class="md-nav__link"> <span class="md-ellipsis"> Elasticsearch </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10"> <div class="md-nav__link md-nav__container"> <a href="../%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/FastDFS.html" class="md-nav__link "> <span class="md-ellipsis"> ğŸ“‡ åˆ†å¸ƒå¼å­˜å‚¨ </span> </a> <label class="md-nav__link " for="__nav_10" id="__nav_10_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_10"> <span class="md-nav__icon md-icon"></span> ğŸ“‡ åˆ†å¸ƒå¼å­˜å‚¨ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/MinIO.html" class="md-nav__link"> <span class="md-ellipsis"> MinIO </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11"> <div class="md-nav__link md-nav__container"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/Encryption.html" class="md-nav__link "> <span class="md-ellipsis"> ğŸ›°ï¸ ç½‘ç»œé€šä¿¡ </span> </a> <label class="md-nav__link " for="__nav_11" id="__nav_11_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_11"> <span class="md-nav__icon md-icon"></span> ğŸ›°ï¸ ç½‘ç»œé€šä¿¡ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/HTTP.html" class="md-nav__link"> <span class="md-ellipsis"> HTTP </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/OpenVPN.html" class="md-nav__link"> <span class="md-ellipsis"> OpenVPN </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/VNC.html" class="md-nav__link"> <span class="md-ellipsis"> VNC </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/WebSocket.html" class="md-nav__link"> <span class="md-ellipsis"> WebSocket </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/frp.html" class="md-nav__link"> <span class="md-ellipsis"> frp </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12"> <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0"> <span class="md-ellipsis"> ğŸ—ƒï¸ æ–‡ä»¶å¤„ç† </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_12"> <span class="md-nav__icon md-icon"></span> ğŸ—ƒï¸ æ–‡ä»¶å¤„ç† </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_1"> <div class="md-nav__link md-nav__container"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/ApachePOI.html" class="md-nav__link "> <span class="md-ellipsis"> Office </span> </a> <label class="md-nav__link " for="__nav_12_1" id="__nav_12_1_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_1_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_12_1"> <span class="md-nav__icon md-icon"></span> Office </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/EasyExcel.html" class="md-nav__link"> <span class="md-ellipsis"> EasyExcel </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/OnlyOffice.html" class="md-nav__link"> <span class="md-ellipsis"> OnlyOffice </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/Poi-tl.html" class="md-nav__link"> <span class="md-ellipsis"> Poi-tl </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/Spire.OfficeForJava.html" class="md-nav__link"> <span class="md-ellipsis"> Spire.OfficeForJava </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/PDF/ApachePDFBox.html" class="md-nav__link"> <span class="md-ellipsis"> ApachePDFBox </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/XML/XMLParse.html" class="md-nav__link"> <span class="md-ellipsis"> XMLParse </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/ZIP/Zip4j.html" class="md-nav__link"> <span class="md-ellipsis"> Zip4j </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/XXL-JOB.html" class="md-nav__link"> <span class="md-ellipsis"> XXL-JOB </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" checked> <div class="md-nav__link md-nav__container"> <a href="Docker.html" class="md-nav__link "> <span class="md-ellipsis"> ğŸ§‘â€ğŸ”§ è¿ç»´ </span> </a> <label class="md-nav__link " for="__nav_14" id="__nav_14_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="true"> <label class="md-nav__title" for="__nav_14"> <span class="md-nav__icon md-icon"></span> ğŸ§‘â€ğŸ”§ è¿ç»´ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="Linux.html" class="md-nav__link"> <span class="md-ellipsis"> Linux </span> </a> </li> <li class="md-nav__item"> <a href="NSSM.html" class="md-nav__link"> <span class="md-ellipsis"> NSSM </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc"> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> Nginx </span> <span class="md-nav__icon md-icon"></span> </label> <a href="Nginx.html" class="md-nav__link md-nav__link--active"> <span class="md-ellipsis"> Nginx </span> </a> <nav class="md-nav md-nav--secondary" aria-label="ç›®å½•"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> ç›®å½• </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#1ç®€ä»‹" class="md-nav__link"> <span class="md-ellipsis"> 1ã€ç®€ä»‹ </span> </a> </li> <li class="md-nav__item"> <a href="#2å®‰è£…" class="md-nav__link"> <span class="md-ellipsis"> 2ã€å®‰è£… </span> </a> <nav class="md-nav" aria-label="2ã€å®‰è£…"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#21linux-å®‰è£…" class="md-nav__link"> <span class="md-ellipsis"> 2.1ã€Linux å®‰è£… </span> </a> <nav class="md-nav" aria-label="2.1ã€Linux å®‰è£…"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#211å®‰è£…è¿è¡Œ" class="md-nav__link"> <span class="md-ellipsis"> 2.1.1ã€å®‰è£…è¿è¡Œ </span> </a> </li> <li class="md-nav__item"> <a href="#212é…ç½®æœåŠ¡" class="md-nav__link"> <span class="md-ellipsis"> 2.1.2ã€é…ç½®æœåŠ¡ </span> </a> </li> <li class="md-nav__item"> <a href="#213å¸è½½" class="md-nav__link"> <span class="md-ellipsis"> 2.1.3ã€å¸è½½ </span> </a> </li> <li class="md-nav__item"> <a href="#214å¸¸ç”¨å‘½ä»¤" class="md-nav__link"> <span class="md-ellipsis"> 2.1.4ã€å¸¸ç”¨å‘½ä»¤ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#22windows-å®‰è£…" class="md-nav__link"> <span class="md-ellipsis"> 2.2ã€Windows å®‰è£… </span> </a> <nav class="md-nav" aria-label="2.2ã€Windows å®‰è£…"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#221å®‰è£…è¿è¡Œ" class="md-nav__link"> <span class="md-ellipsis"> 2.2.1ã€å®‰è£…è¿è¡Œ </span> </a> </li> <li class="md-nav__item"> <a href="#222é…ç½®æœåŠ¡" class="md-nav__link"> <span class="md-ellipsis"> 2.2.2ã€é…ç½®æœåŠ¡ </span> </a> </li> <li class="md-nav__item"> <a href="#223å¸¸ç”¨å‘½ä»¤" class="md-nav__link"> <span class="md-ellipsis"> 2.2.3ã€å¸¸ç”¨å‘½ä»¤ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#3é…ç½®" class="md-nav__link"> <span class="md-ellipsis"> 3ã€é…ç½® </span> </a> <nav class="md-nav" aria-label="3ã€é…ç½®"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#31é…ç½®æ–‡ä»¶" class="md-nav__link"> <span class="md-ellipsis"> 3.1ã€é…ç½®æ–‡ä»¶ </span> </a> <nav class="md-nav" aria-label="3.1ã€é…ç½®æ–‡ä»¶"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#311é…ç½®æ–‡ä»¶ç»“æ„" class="md-nav__link"> <span class="md-ellipsis"> 3.1.1ã€é…ç½®æ–‡ä»¶ç»“æ„ </span> </a> </li> <li class="md-nav__item"> <a href="#312é…ç½®æ¨¡æ¿ç¤ºä¾‹" class="md-nav__link"> <span class="md-ellipsis"> 3.1.2ã€é…ç½®æ¨¡æ¿ç¤ºä¾‹ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#32æŒ‡ä»¤" class="md-nav__link"> <span class="md-ellipsis"> 3.2ã€æŒ‡ä»¤ </span> </a> <nav class="md-nav" aria-label="3.2ã€æŒ‡ä»¤"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#321location" class="md-nav__link"> <span class="md-ellipsis"> 3.2.1ã€location </span> </a> <nav class="md-nav" aria-label="3.2.1ã€location"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#ä¿®é¥°ç¬¦" class="md-nav__link"> <span class="md-ellipsis"> ä¿®é¥°ç¬¦ </span> </a> </li> <li class="md-nav__item"> <a href="#uri-æœ«å°¾æ–œæ†" class="md-nav__link"> <span class="md-ellipsis"> uri æœ«å°¾æ–œæ† </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#322map" class="md-nav__link"> <span class="md-ellipsis"> 3.2.2ã€map </span> </a> </li> <li class="md-nav__item"> <a href="#323client_max_body_size" class="md-nav__link"> <span class="md-ellipsis"> 3.2.3ã€client_max_body_size </span> </a> </li> <li class="md-nav__item"> <a href="#324include" class="md-nav__link"> <span class="md-ellipsis"> 3.2.4ã€include </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#33å†…ç½®å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3ã€å†…ç½®å˜é‡ </span> </a> <nav class="md-nav" aria-label="3.3ã€å†…ç½®å˜é‡"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#331è¯·æ±‚ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.1ã€è¯·æ±‚ç›¸å…³å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#332è¿æ¥ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.2ã€è¿æ¥ç›¸å…³å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#333å“åº”ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.3ã€å“åº”ç›¸å…³å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#334http-è¯·æ±‚å¤´ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.4ã€HTTP è¯·æ±‚å¤´ç›¸å…³å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#335ssl-ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.5ã€SSL ç›¸å…³å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#336åœ°ç†ä½ç½®ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.6ã€åœ°ç†ä½ç½®ç›¸å…³å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#337å…¶ä»–å¸¸ç”¨å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.7ã€å…¶ä»–å¸¸ç”¨å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#338æ—¥å¿—ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.8ã€æ—¥å¿—ç›¸å…³å˜é‡ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#4åº”ç”¨åœºæ™¯" class="md-nav__link"> <span class="md-ellipsis"> 4ã€åº”ç”¨åœºæ™¯ </span> </a> <nav class="md-nav" aria-label="4ã€åº”ç”¨åœºæ™¯"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#41åå‘ä»£ç†" class="md-nav__link"> <span class="md-ellipsis"> 4.1ã€åå‘ä»£ç† </span> </a> </li> <li class="md-nav__item"> <a href="#42è´Ÿè½½å‡è¡¡" class="md-nav__link"> <span class="md-ellipsis"> 4.2ã€è´Ÿè½½å‡è¡¡ </span> </a> </li> <li class="md-nav__item"> <a href="#43é™æµä¸ç†”æ–­" class="md-nav__link"> <span class="md-ellipsis"> 4.3ã€é™æµä¸ç†”æ–­ </span> </a> <nav class="md-nav" aria-label="4.3ã€é™æµä¸ç†”æ–­"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#431é™æµ" class="md-nav__link"> <span class="md-ellipsis"> 4.3.1ã€é™æµ </span> </a> </li> <li class="md-nav__item"> <a href="#432ç†”æ–­" class="md-nav__link"> <span class="md-ellipsis"> 4.3.2ã€ç†”æ–­ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#44tcpudp-å¤„ç†" class="md-nav__link"> <span class="md-ellipsis"> 4.4ã€TCP/UDP å¤„ç† </span> </a> </li> <li class="md-nav__item"> <a href="#45websocket-ä»£ç†" class="md-nav__link"> <span class="md-ellipsis"> 4.5ã€WebSocket ä»£ç† </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#4æ€§èƒ½ä¼˜åŒ–" class="md-nav__link"> <span class="md-ellipsis"> 4ã€æ€§èƒ½ä¼˜åŒ– </span> </a> <nav class="md-nav" aria-label="4ã€æ€§èƒ½ä¼˜åŒ–"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#41å…¨å±€ä¼˜åŒ–" class="md-nav__link"> <span class="md-ellipsis"> 4.1ã€å…¨å±€ä¼˜åŒ– </span> </a> </li> <li class="md-nav__item"> <a href="#42ä¸å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼˜åŒ–" class="md-nav__link"> <span class="md-ellipsis"> 4.2ã€ä¸å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼˜åŒ– </span> </a> </li> <li class="md-nav__item"> <a href="#43ä¸åç«¯æœåŠ¡ä¹‹é—´çš„ä¼˜åŒ–" class="md-nav__link"> <span class="md-ellipsis"> 4.3ã€ä¸åç«¯æœåŠ¡ä¹‹é—´çš„ä¼˜åŒ– </span> </a> </li> <li class="md-nav__item"> <a href="#44ç¼“å­˜è®¾ç½®" class="md-nav__link"> <span class="md-ellipsis"> 4.4ã€ç¼“å­˜è®¾ç½® </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="Tomcat.html" class="md-nav__link"> <span class="md-ellipsis"> Tomcat </span> </a> </li> <li class="md-nav__item"> <a href="TongWeb.html" class="md-nav__link"> <span class="md-ellipsis"> TongWeb </span> </a> </li> <li class="md-nav__item"> <a href="WSL.html" class="md-nav__link"> <span class="md-ellipsis"> WSL </span> </a> </li> <li class="md-nav__item"> <a href="WebLogic.html" class="md-nav__link"> <span class="md-ellipsis"> WebLogic </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15"> <div class="md-nav__link md-nav__container"> <a href="../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Git.html" class="md-nav__link "> <span class="md-ellipsis"> ğŸ› ï¸ å¼€å‘å·¥å…· </span> </a> <label class="md-nav__link " for="__nav_15" id="__nav_15_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_15"> <span class="md-nav__icon md-icon"></span> ğŸ› ï¸ å¼€å‘å·¥å…· </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Maven.html" class="md-nav__link"> <span class="md-ellipsis"> Maven </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Node.js.html" class="md-nav__link"> <span class="md-ellipsis"> Node.js </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Swagger.html" class="md-nav__link"> <span class="md-ellipsis"> Swagger </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16"> <div class="md-nav__link md-nav__container"> <a href="../%E5%85%B6%E4%BB%96/Settings.html" class="md-nav__link "> <span class="md-ellipsis"> ğŸ‘» å…¶ä»– </span> </a> <label class="md-nav__link " for="__nav_16" id="__nav_16_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_16"> <span class="md-nav__icon md-icon"></span> ğŸ‘» å…¶ä»– </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%85%B6%E4%BB%96/Solutions.html" class="md-nav__link"> <span class="md-ellipsis"> Solutions </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%85%B6%E4%BB%96/Weasel.html" class="md-nav__link"> <span class="md-ellipsis"> Weasel </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--secondary" aria-label="ç›®å½•"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> ç›®å½• </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#1ç®€ä»‹" class="md-nav__link"> <span class="md-ellipsis"> 1ã€ç®€ä»‹ </span> </a> </li> <li class="md-nav__item"> <a href="#2å®‰è£…" class="md-nav__link"> <span class="md-ellipsis"> 2ã€å®‰è£… </span> </a> <nav class="md-nav" aria-label="2ã€å®‰è£…"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#21linux-å®‰è£…" class="md-nav__link"> <span class="md-ellipsis"> 2.1ã€Linux å®‰è£… </span> </a> <nav class="md-nav" aria-label="2.1ã€Linux å®‰è£…"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#211å®‰è£…è¿è¡Œ" class="md-nav__link"> <span class="md-ellipsis"> 2.1.1ã€å®‰è£…è¿è¡Œ </span> </a> </li> <li class="md-nav__item"> <a href="#212é…ç½®æœåŠ¡" class="md-nav__link"> <span class="md-ellipsis"> 2.1.2ã€é…ç½®æœåŠ¡ </span> </a> </li> <li class="md-nav__item"> <a href="#213å¸è½½" class="md-nav__link"> <span class="md-ellipsis"> 2.1.3ã€å¸è½½ </span> </a> </li> <li class="md-nav__item"> <a href="#214å¸¸ç”¨å‘½ä»¤" class="md-nav__link"> <span class="md-ellipsis"> 2.1.4ã€å¸¸ç”¨å‘½ä»¤ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#22windows-å®‰è£…" class="md-nav__link"> <span class="md-ellipsis"> 2.2ã€Windows å®‰è£… </span> </a> <nav class="md-nav" aria-label="2.2ã€Windows å®‰è£…"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#221å®‰è£…è¿è¡Œ" class="md-nav__link"> <span class="md-ellipsis"> 2.2.1ã€å®‰è£…è¿è¡Œ </span> </a> </li> <li class="md-nav__item"> <a href="#222é…ç½®æœåŠ¡" class="md-nav__link"> <span class="md-ellipsis"> 2.2.2ã€é…ç½®æœåŠ¡ </span> </a> </li> <li class="md-nav__item"> <a href="#223å¸¸ç”¨å‘½ä»¤" class="md-nav__link"> <span class="md-ellipsis"> 2.2.3ã€å¸¸ç”¨å‘½ä»¤ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#3é…ç½®" class="md-nav__link"> <span class="md-ellipsis"> 3ã€é…ç½® </span> </a> <nav class="md-nav" aria-label="3ã€é…ç½®"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#31é…ç½®æ–‡ä»¶" class="md-nav__link"> <span class="md-ellipsis"> 3.1ã€é…ç½®æ–‡ä»¶ </span> </a> <nav class="md-nav" aria-label="3.1ã€é…ç½®æ–‡ä»¶"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#311é…ç½®æ–‡ä»¶ç»“æ„" class="md-nav__link"> <span class="md-ellipsis"> 3.1.1ã€é…ç½®æ–‡ä»¶ç»“æ„ </span> </a> </li> <li class="md-nav__item"> <a href="#312é…ç½®æ¨¡æ¿ç¤ºä¾‹" class="md-nav__link"> <span class="md-ellipsis"> 3.1.2ã€é…ç½®æ¨¡æ¿ç¤ºä¾‹ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#32æŒ‡ä»¤" class="md-nav__link"> <span class="md-ellipsis"> 3.2ã€æŒ‡ä»¤ </span> </a> <nav class="md-nav" aria-label="3.2ã€æŒ‡ä»¤"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#321location" class="md-nav__link"> <span class="md-ellipsis"> 3.2.1ã€location </span> </a> <nav class="md-nav" aria-label="3.2.1ã€location"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#ä¿®é¥°ç¬¦" class="md-nav__link"> <span class="md-ellipsis"> ä¿®é¥°ç¬¦ </span> </a> </li> <li class="md-nav__item"> <a href="#uri-æœ«å°¾æ–œæ†" class="md-nav__link"> <span class="md-ellipsis"> uri æœ«å°¾æ–œæ† </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#322map" class="md-nav__link"> <span class="md-ellipsis"> 3.2.2ã€map </span> </a> </li> <li class="md-nav__item"> <a href="#323client_max_body_size" class="md-nav__link"> <span class="md-ellipsis"> 3.2.3ã€client_max_body_size </span> </a> </li> <li class="md-nav__item"> <a href="#324include" class="md-nav__link"> <span class="md-ellipsis"> 3.2.4ã€include </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#33å†…ç½®å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3ã€å†…ç½®å˜é‡ </span> </a> <nav class="md-nav" aria-label="3.3ã€å†…ç½®å˜é‡"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#331è¯·æ±‚ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.1ã€è¯·æ±‚ç›¸å…³å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#332è¿æ¥ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.2ã€è¿æ¥ç›¸å…³å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#333å“åº”ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.3ã€å“åº”ç›¸å…³å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#334http-è¯·æ±‚å¤´ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.4ã€HTTP è¯·æ±‚å¤´ç›¸å…³å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#335ssl-ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.5ã€SSL ç›¸å…³å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#336åœ°ç†ä½ç½®ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.6ã€åœ°ç†ä½ç½®ç›¸å…³å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#337å…¶ä»–å¸¸ç”¨å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.7ã€å…¶ä»–å¸¸ç”¨å˜é‡ </span> </a> </li> <li class="md-nav__item"> <a href="#338æ—¥å¿—ç›¸å…³å˜é‡" class="md-nav__link"> <span class="md-ellipsis"> 3.3.8ã€æ—¥å¿—ç›¸å…³å˜é‡ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#4åº”ç”¨åœºæ™¯" class="md-nav__link"> <span class="md-ellipsis"> 4ã€åº”ç”¨åœºæ™¯ </span> </a> <nav class="md-nav" aria-label="4ã€åº”ç”¨åœºæ™¯"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#41åå‘ä»£ç†" class="md-nav__link"> <span class="md-ellipsis"> 4.1ã€åå‘ä»£ç† </span> </a> </li> <li class="md-nav__item"> <a href="#42è´Ÿè½½å‡è¡¡" class="md-nav__link"> <span class="md-ellipsis"> 4.2ã€è´Ÿè½½å‡è¡¡ </span> </a> </li> <li class="md-nav__item"> <a href="#43é™æµä¸ç†”æ–­" class="md-nav__link"> <span class="md-ellipsis"> 4.3ã€é™æµä¸ç†”æ–­ </span> </a> <nav class="md-nav" aria-label="4.3ã€é™æµä¸ç†”æ–­"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#431é™æµ" class="md-nav__link"> <span class="md-ellipsis"> 4.3.1ã€é™æµ </span> </a> </li> <li class="md-nav__item"> <a href="#432ç†”æ–­" class="md-nav__link"> <span class="md-ellipsis"> 4.3.2ã€ç†”æ–­ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#44tcpudp-å¤„ç†" class="md-nav__link"> <span class="md-ellipsis"> 4.4ã€TCP/UDP å¤„ç† </span> </a> </li> <li class="md-nav__item"> <a href="#45websocket-ä»£ç†" class="md-nav__link"> <span class="md-ellipsis"> 4.5ã€WebSocket ä»£ç† </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#4æ€§èƒ½ä¼˜åŒ–" class="md-nav__link"> <span class="md-ellipsis"> 4ã€æ€§èƒ½ä¼˜åŒ– </span> </a> <nav class="md-nav" aria-label="4ã€æ€§èƒ½ä¼˜åŒ–"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#41å…¨å±€ä¼˜åŒ–" class="md-nav__link"> <span class="md-ellipsis"> 4.1ã€å…¨å±€ä¼˜åŒ– </span> </a> </li> <li class="md-nav__item"> <a href="#42ä¸å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼˜åŒ–" class="md-nav__link"> <span class="md-ellipsis"> 4.2ã€ä¸å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼˜åŒ– </span> </a> </li> <li class="md-nav__item"> <a href="#43ä¸åç«¯æœåŠ¡ä¹‹é—´çš„ä¼˜åŒ–" class="md-nav__link"> <span class="md-ellipsis"> 4.3ã€ä¸åç«¯æœåŠ¡ä¹‹é—´çš„ä¼˜åŒ– </span> </a> </li> <li class="md-nav__item"> <a href="#44ç¼“å­˜è®¾ç½®" class="md-nav__link"> <span class="md-ellipsis"> 4.4ã€ç¼“å­˜è®¾ç½® </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <nav class="md-path" aria-label="å¯¼èˆªæ "> <ol class="md-path__list"> <li class="md-path__item"> <a href="../index.html" class="md-path__link"> <span class="md-ellipsis"> ğŸ  é¦–é¡µ </span> </a> </li> <li class="md-path__item"> <a href="Linux.html" class="md-path__link"> <span class="md-ellipsis"> ğŸ§‘â€ğŸ”§ è¿ç»´ </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <h1 id="nginx">Nginx<a class="headerlink" href="#nginx" title="é”šç‚¹é“¾æ¥">Â¶</a></h1> <h2 id="1ç®€ä»‹">1ã€ç®€ä»‹<a class="headerlink" href="#1ç®€ä»‹" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <p>Nginx ä¸ä»…æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ Web æœåŠ¡å™¨ï¼Œè¿˜å…·å¤‡è®¿é—®ä»£ç†ã€è´Ÿè½½å‡è¡¡ã€å†…å®¹ç¼“å­˜ç­‰åŠŸèƒ½ï¼Œç”¨äºå®¢æˆ·ç«¯è®¿é—®æµé‡åˆ°åå°åº”ç”¨æœåŠ¡å™¨è´Ÿè½½å‡è¡¡å’Œè¯·æ±‚è½¬å‘ã€‚å…¶åŸºäºæ¨¡å—åŒ–çš„ä»£ç æ¶æ„åŠå¯ä¸å…¶å®ƒæœ‰æ•ˆé›†æˆçš„å¯ç¼–ç¨‹ç‰¹æ€§ï¼Œä½¿å…¶å…·æœ‰å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›ã€‚Nginx ä»¥èµ„æºæ¶ˆè€—ä½ã€é«˜ç¨³å®šã€é«˜æ€§èƒ½çš„å¹¶å‘å¤„ç†èƒ½åŠ›è‘—ç§°ã€‚</p> <p><br></p> <p><strong>Nginx ç‰¹æ€§</strong></p> <ul> <li>è®¿é—®ä»£ç†ï¼š Nginx å¯ä»¥é€šè¿‡è®¿é—®è·¯å¾„ã€URL å…³é”®å­—ã€å®¢æˆ·ç«¯ IPç­‰å¤šç§æ‰‹æ®µå®ç°è®¿é—®è·¯ç”±åˆ†é…ã€‚</li> <li>åå‘ä»£ç†ï¼š å°†æ¥æ”¶åˆ°çš„è¯·æ±‚å†è½¬åˆ°åç«¯çš„ç›®æ ‡åº”ç”¨æœåŠ¡å™¨ï¼Œå¹¶æŠŠå“åº”æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚æ”¯æŒç›®å‰ç»å¤§å¤šæ•°çš„ç½‘ç»œåè®®ï¼šHTTP/FastCGI/RPC/UDP/TCP ç­‰ã€‚</li> <li>è´Ÿè½½å‡è¡¡ï¼š é€šè¿‡è‡ªèº«çš„ upstream æ¨¡å—æ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œä½¿åç«¯æœåŠ¡å™¨å¯ä»¥éå¸¸æ–¹ä¾¿åœ°è¿›è¡Œæ¨ªå‘æ‰©å±•ï¼Œä»¥åº”å¯¹é«˜å¹¶å‘ã€‚</li> <li>å†…å®¹ç¼“å­˜ï¼š Nginx æ”¯æŒé™æ€ç«™ç‚¹å’Œåç«¯åˆ†ç¦»ï¼Œå¯ä»¥æŠŠé™æ€å†…å®¹ç¼“å­˜èµ·æ¥ï¼Œä¹Ÿå¯ä»¥å°†åç«¯å˜åŒ–ä¸å¤§çš„å“åº”ç»“æœç¼“å­˜èµ·æ¥ï¼Œä½¿æ•´ä½“å®ç°äº†æ›´é«˜é€Ÿçš„ç›¸åº”èƒ½åŠ›ã€‚</li> <li>å¯æ‰©å±•æ€§ï¼š å¯å®šåˆ¶çš„æ¨¡å—åŒ–æ¶æ„æ–¹å¼ï¼Œæ›´å¤šçš„è¯­è¨€ï¼ˆC/Perl/JavaScript/Luaï¼‰æ”¯æŒå¼€å‘ç¬¬ä¸‰æ–¹æ¨¡å—å¹¶å¼•å…¥ï¼Œå¢å¼ºå¯ç¼–ç¨‹åŠæ‰©å±•èƒ½åŠ›ã€‚</li> </ul> <p><br></p> <h2 id="2å®‰è£…">2ã€å®‰è£…<a class="headerlink" href="#2å®‰è£…" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <h3 id="21linux-å®‰è£…">2.1ã€Linux å®‰è£…<a class="headerlink" href="#21linux-å®‰è£…" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <h4 id="211å®‰è£…è¿è¡Œ">2.1.1ã€å®‰è£…è¿è¡Œ<a class="headerlink" href="#211å®‰è£…è¿è¡Œ" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ol> <li> <p>å» <a href="http://nginx.org/en/download.html">å®˜ç½‘</a> ä¸‹è½½å‹ç¼©åŒ…ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/Nginx/image-20230614234051811.png" data-desc-position="bottom"><img src="!assets/Nginx/image-20230614234051811.png" alt="image-20230614234051811" style="zoom: 80%;"></a></p> </li> <li> <p>å°†ä¸‹è½½å¥½çš„åŒ…ä¸Šä¼ è‡³æœåŠ¡å™¨ï¼Œè§£å‹è‡³ <code>/usr/local</code>ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>tar<span class="w"> </span>-xzf<span class="w"> </span>nginx-1.24.0.tar.gz<span class="w"> </span>-C<span class="w"> </span>/usr/local
</span></code></pre></div> </li> <li> <p>å°†è§£å‹åçš„æ–‡ä»¶å¤¹æ”¹åä¸º <code>nginx</code> å¹¶è¿›å…¥ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># æ”¹å</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>mv<span class="w"> </span>/usr/local/nginx-1.24.0/<span class="w"> </span>/usr/local/nginx
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># è¿›å…¥</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="nb">cd</span><span class="w"> </span>/usr/local/nginx
</span></code></pre></div> </li> <li> <p>æ‰§è¡Œé…ç½®æ–‡ä»¶ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>sudo<span class="w"> </span>./configure
</span></code></pre></div> <p>å¦‚æ— é—®é¢˜ï¼Œåˆ™ç›´æ¥è¿›å…¥ç¬¬ 5 æ­¥ï¼Œå¦‚åƒä»¥ä¸‹ä¸€æ ·ç¼ºå°‘åº“ï¼Œåˆ™å…ˆå®‰è£…åº“å†ç»§ç»­ã€‚</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/Nginx/image-20230615001606389.png" data-desc-position="bottom"><img src="!assets/Nginx/image-20230615001606389.png" alt="image-20230615001606389" style></a></p> <p>è¿™é‡Œæ˜¾ç¤ºç¼ºå°‘ PCRE åº“ï¼Œå¯ä»¥ä» <a href="http://www.pcre.org/">å®˜ç½‘</a> ä¸‹è½½ï¼Œç„¶åä¸Šä¼ è‡³æœåŠ¡å™¨ã€è§£å‹ã€æ‰§è¡Œé…ç½®æ–‡ä»¶ã€å®‰è£…ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>tar<span class="w"> </span>-xzf<span class="w"> </span>pcre2-10.42.tar.gz<span class="w"> </span>-C<span class="w"> </span>/usr/local
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>mv<span class="w"> </span>/usr/local/pcre2-10.42/<span class="w"> </span>/usr/local/pcre2/
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="nb">cd</span><span class="w"> </span>/usr/local/pcre2
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>sudo<span class="w"> </span>./configure
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>sudo<span class="w"> </span>make
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>sudo<span class="w"> </span>make<span class="w"> </span>install
</span></code></pre></div> <p>å®‰è£…å®Œæˆåå†å‰å¾€ <code>/usr/local/nginx</code> ç›®å½•æ‰§è¡Œ <code>./configure</code>ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/Nginx/image-20230615003550134.png" data-desc-position="bottom"><img src="!assets/Nginx/image-20230615003550134.png" alt="image-20230615003550134" style="zoom: 33%;"></a></p> <p>è¿™é‡Œæ˜¾ç¤ºç¼ºå°‘ zlib åº“ï¼Œå¯ä»¥ä» <a href="http://www.zlib.net">å®˜ç½‘</a> ä¸‹è½½ï¼Œç„¶åä¸Šä¼ è‡³æœåŠ¡å™¨ã€è§£å‹ã€æ‰§è¡Œé…ç½®æ–‡ä»¶ã€å®‰è£…ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>tar<span class="w"> </span>-xzf<span class="w"> </span>zlib-1.2.13.tar.gz<span class="w"> </span>-C<span class="w"> </span>/usr/local
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>mv<span class="w"> </span>/usr/local/zlib-1.2.13/<span class="w"> </span>/usr/local/zlib/
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="nb">cd</span><span class="w"> </span>/usr/local/zlib
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>sudo<span class="w"> </span>./configure
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>sudo<span class="w"> </span>make
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>sudo<span class="w"> </span>make<span class="w"> </span>install
</span></code></pre></div> <p>ä¹‹åå†å‰å¾€ <code>/usr/local/nginx</code> ç›®å½•æ‰§è¡Œ <code>./configure</code>ï¼Œç¼ºå°‘åº“å°±å»å®‰è£…ï¼Œç›´åˆ° <code>./configure</code> ä¸æ˜¾ç¤ºé”™è¯¯ã€‚</p> <blockquote> <p>Nginx å¯¹ OpenSSL ä¸åšç¡¬æ€§è¦æ±‚ï¼Œåœ¨ä¸ä½¿ç”¨ SSL æ¨¡å—çš„æƒ…å†µä¸‹æ²¡æœ‰ OpenSSL ä¹Ÿå¯ä»¥å®‰è£…é€šè¿‡ï¼Œå¦‚æœéœ€è¦æ­¤åŠŸèƒ½ï¼Œè¯·å…ˆå®‰è£… OpenSSL ç„¶åæ‰§è¡Œä»¥ä¸‹é…ç½®å‘½ä»¤ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>sudo<span class="w"> </span>./configure<span class="w"> </span>--with-http_stub_status_module<span class="w"> </span>--with-http_ssl_module<span class="w"> </span>--with-openssl<span class="o">=</span>/usr/local/openssl
</span></code></pre></div> </blockquote> </li> <li> <p>ç¼–è¯‘å¹¶å®‰è£…ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>sudo<span class="w"> </span>make
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>sudo<span class="w"> </span>make<span class="w"> </span>install
</span></code></pre></div> </li> <li> <p>è¿è¡Œï¼ˆé»˜è®¤è¿è¡Œåœ¨æœåŠ¡ 80 ç«¯å£ï¼‰ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># è¿›å…¥ sbin/ ç›®å½•</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nb">cd</span><span class="w"> </span>sbin/
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c1"># è¿è¡Œ</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>./nginx
</span></code></pre></div> </li> </ol> <p><br></p> <h4 id="212é…ç½®æœåŠ¡">2.1.2ã€é…ç½®æœåŠ¡<a class="headerlink" href="#212é…ç½®æœåŠ¡" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ol> <li> <p>åˆ° <code>/usr/lib/systemd/system</code> æ–‡ä»¶å¤¹é‡Œæ–°å»º nginx.service æ–‡ä»¶æˆ–ä¿®æ”¹ç°æœ‰çš„ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>vim<span class="w"> </span>/etc/systemd/system/nginx.service
</span></code></pre></div> </li> <li> <p>æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="o">[</span>Unit<span class="o">]</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="nv">Description</span><span class="o">=</span>nginx<span class="w"> </span>service
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="nv">After</span><span class="o">=</span>network.target
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="o">[</span>Service<span class="o">]</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="nv">Type</span><span class="o">=</span>forking
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="nv">ExecStart</span><span class="o">=</span>/usr/local/nginx/sbin/nginx
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="nv">ExecReload</span><span class="o">=</span>/usr/local/nginx/sbin/nginx<span class="w"> </span>-s<span class="w"> </span>reload
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="nv">ExecStop</span><span class="o">=</span>/usr/local/nginx/sbin/nginx<span class="w"> </span>-s<span class="w"> </span>stop
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="nv">PrivateTmp</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="o">[</span>Install<span class="o">]</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</span></code></pre></div> </li> <li> <p>åœ¨ç»ˆç«¯ä»¥ä¸‹å‘½ä»¤ï¼Œåˆ·æ–°æœåŠ¡é…ç½®ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>systemctl<span class="w"> </span>daemon-reload
</span></code></pre></div> </li> <li> <p>è®¾ç½®å¼€æœºè‡ªå¯ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>nginx
</span></code></pre></div> </li> </ol> <p><br></p> <h4 id="213å¸è½½">2.1.3ã€å¸è½½<a class="headerlink" href="#213å¸è½½" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ol> <li> <p>åœæ­¢ Nginx è½¯ä»¶ï¼š </p><div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>/usr/local/nginx/sbin/nginx<span class="w"> </span>-s<span class="w"> </span>stop
</span></code></pre></div><p></p> <p>å¦‚æœä¸çŸ¥é“ Nginx çš„å®‰è£…è·¯å¾„ï¼Œå¯ä»¥é€šè¿‡ <code>ps</code> æŸ¥çœ‹ Nginx çš„ PIDï¼Œç„¶å <code>kill</code> å…¶ PIDã€‚</p> </li> <li> <p>æŸ¥æ‰¾æ ¹ä¸‹æ‰€æœ‰åå­—åŒ…å« Nginx çš„æ–‡ä»¶ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>find<span class="w"> </span>/<span class="w"> </span>-name<span class="w"> </span>nginx
</span></code></pre></div> </li> <li> <p>æ‰§è¡Œå‘½ä»¤ <code>rm -rf *</code> åˆ é™¤ Nignx å®‰è£…çš„ç›¸å…³æ–‡ä»¶ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>rm<span class="w"> </span>-rf<span class="w"> </span>/usr/local/sbin/nginx
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>...
</span></code></pre></div> </li> </ol> <p><br></p> <h4 id="214å¸¸ç”¨å‘½ä»¤">2.1.4ã€å¸¸ç”¨å‘½ä»¤<a class="headerlink" href="#214å¸¸ç”¨å‘½ä»¤" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><strong>ç®¡ç† Nginx æœåŠ¡</strong></p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nb">cd</span><span class="w"> </span>/usr/local/nginx/sbin/<span class="w">   </span><span class="c1"># è¿›å…¥ç›®å½•</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>./nginx<span class="w">                     </span><span class="c1"># å¯åŠ¨</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>./nginx<span class="w"> </span>-s<span class="w"> </span>stop<span class="w">             </span><span class="c1"># åœæ­¢</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>./nginx<span class="w"> </span>-s<span class="w"> </span>quit<span class="w">             </span><span class="c1"># å®‰å…¨é€€å‡º</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>./nginx<span class="w"> </span>-s<span class="w"> </span>reload<span class="w">           </span><span class="c1"># é‡è½½é…ç½®æ–‡ä»¶ï¼ˆä¿®æ”¹äº†é…ç½®æ–‡ä»¶éœ€è¦æ‰§è¡Œæ­¤å‘½ä»¤ æ¯”è¾ƒå¸¸ç”¨ï¼‰</span>
</span></code></pre></div> <p>å¦‚æœå·²ç»é…ç½®æœåŠ¡ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>systemctl<span class="w"> </span>start<span class="w"> </span>nginx<span class="w">       </span><span class="c1"># å¯åŠ¨</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>systemctl<span class="w"> </span>stop<span class="w"> </span>nginx<span class="w">        </span><span class="c1"># åœæ­¢</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>systemctl<span class="w"> </span>reload<span class="w"> </span>nginx<span class="w">      </span><span class="c1"># é‡è½½é…ç½®æ–‡ä»¶</span>
</span></code></pre></div> <p><br></p> <p><strong>æŸ¥çœ‹ Nginx è¿›ç¨‹</strong></p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>ps<span class="w"> </span>-aux<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>nginx<span class="w"> </span>
</span></code></pre></div> <p><br></p> <p><strong>ç¼–è¾‘é…ç½®æ–‡ä»¶</strong></p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>vim<span class="w"> </span>/usr/local/nginx/conf/nginx.conf
</span></code></pre></div> <p><br></p> <h3 id="22windows-å®‰è£…">2.2ã€Windows å®‰è£…<a class="headerlink" href="#22windows-å®‰è£…" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <h4 id="221å®‰è£…è¿è¡Œ">2.2.1ã€å®‰è£…è¿è¡Œ<a class="headerlink" href="#221å®‰è£…è¿è¡Œ" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ol> <li> <p>å» <a href="http://nginx.org/en/download.html">å®˜ç½‘</a> ä¸‹è½½å‹ç¼©åŒ…ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/Nginx/image-20230810003412376.png" data-desc-position="bottom"><img src="!assets/Nginx/image-20230810003412376.png" alt="image-20230810003412376" style></a></p> </li> <li> <p>ä¸‹è½½å®Œæˆåæ‰¾ä¸ªç›®å½•è§£å‹ç¼©ä¸€ä¸‹ï¼Œå…¶ä¸­æœ€ä¸»è¦çš„é…ç½®æ–‡ä»¶ <code>nginx.conf</code> åœ¨ conf æ–‡ä»¶å¤¹ä¸­ã€‚</p> </li> <li> <p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿è¡Œï¼ˆé»˜è®¤è¿è¡Œåœ¨æœåŠ¡ 80 ç«¯å£ï¼‰ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>start<span class="w"> </span>.<span class="se">\n</span>ginx
</span></code></pre></div> <p>æˆ–è€…ç›´æ¥åŒå‡» nginx.exeã€‚</p> </li> </ol> <p><br></p> <h4 id="222é…ç½®æœåŠ¡">2.2.2ã€é…ç½®æœåŠ¡<a class="headerlink" href="#222é…ç½®æœåŠ¡" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>ä½¿ç”¨ <code>sc</code> å‘½ä»¤æ³¨å†Œ Nginx æœåŠ¡ï¼š</p> <ol> <li> <p>é¦–å…ˆï¼Œä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼ˆCMDï¼‰æˆ– PowerShellã€‚</p> </li> <li> <p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»º Nginx æœåŠ¡ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>sc<span class="w"> </span>create<span class="w"> </span>Nginx<span class="w"> </span><span class="nv">binPath</span><span class="o">=</span><span class="w"> </span><span class="s2">"C:\Program Files\Nginx\nginx.exe"</span><span class="w"> </span><span class="nv">start</span><span class="o">=</span><span class="w"> </span>auto
</span></code></pre></div> <ul> <li><code>binPath=</code> åé¢æ˜¯ Nginx å¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚</li> <li><code>start=</code> æŒ‡å®šå¯åŠ¨ç±»å‹ï¼ˆ<code>auto</code>è¡¨ç¤ºè‡ªåŠ¨å¯åŠ¨ï¼‰ã€‚</li> <li>ç­‰å·åæœ€å¥½æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œåœ¨æ—©æœŸçš„ Windows ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ªç©ºæ ¼æ˜¯å¿…éœ€çš„ã€‚</li> <li>å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ å…¶ä»–å‚æ•°ï¼Œå¦‚ <code>DisplayName=</code> è®¾ç½®æ˜¾ç¤ºåç§°ã€‚</li> </ul> </li> <li> <p>é€šè¿‡æœåŠ¡é¡µé¢æˆ–è€…ä»¥ä¸‹å‘½ä»¤æ§åˆ¶ Nginx æœåŠ¡ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>sc<span class="w"> </span>start<span class="w"> </span>Nginx<span class="w">    </span><span class="c1"># å¯åŠ¨æœåŠ¡</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>sc<span class="w"> </span>stop<span class="w"> </span>Nginx<span class="w">     </span><span class="c1"># åœæ­¢æœåŠ¡</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>sc<span class="w"> </span>delete<span class="w"> </span>Nginx<span class="w">   </span><span class="c1"># åˆ é™¤æœåŠ¡</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>sc<span class="w"> </span>query<span class="w"> </span>Nginx<span class="w">    </span><span class="c1"># æŸ¥è¯¢æœåŠ¡çŠ¶æ€</span>
</span></code></pre></div> </li> </ol> <p><br></p> <h4 id="223å¸¸ç”¨å‘½ä»¤">2.2.3ã€å¸¸ç”¨å‘½ä»¤<a class="headerlink" href="#223å¸¸ç”¨å‘½ä»¤" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nb">cd</span><span class="w"> </span>C:<span class="se">\N</span>ginx<span class="w">                 </span><span class="c1"># è¿›å…¥ç›®å½•</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>start<span class="w"> </span>.<span class="se">\n</span>ginx<span class="w">               </span><span class="c1"># å¯åŠ¨nginxï¼Œæˆ–è€…ç›´æ¥åŒå‡»nginx.exe</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>.<span class="se">\n</span>ginx.exe<span class="w"> </span>-s<span class="w"> </span>stop<span class="w">         </span><span class="c1"># å¿«é€Ÿåœæ­¢nginx</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>.<span class="se">\n</span>ginx.exe<span class="w"> </span>-s<span class="w"> </span>quit<span class="w">         </span><span class="c1"># å®Œæ•´æœ‰åºçš„åœæ­¢nginxï¼Œå¹¶ä¿å­˜ç›¸å…³ä¿¡æ¯</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>.<span class="se">\n</span>ginx.exe<span class="w"> </span>-s<span class="w"> </span>reload<span class="w">       </span><span class="c1"># é‡æ–°è½½å…¥nginxé…ç½®ä¿¡æ¯</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>.<span class="se">\n</span>ginx.exe<span class="w"> </span>-s<span class="w"> </span>reopen<span class="w">       </span><span class="c1"># é‡æ–°æ‰“å¼€nginxçš„æ—¥å¿—æ–‡ä»¶</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>.<span class="se">\n</span>ginx.exe<span class="w"> </span>-v<span class="w">              </span><span class="c1"># æŸ¥çœ‹nginxç‰ˆæœ¬ä¿¡æ¯</span>
</span></code></pre></div> <p><br></p> <h2 id="3é…ç½®">3ã€é…ç½®<a class="headerlink" href="#3é…ç½®" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <h3 id="31é…ç½®æ–‡ä»¶">3.1ã€é…ç½®æ–‡ä»¶<a class="headerlink" href="#31é…ç½®æ–‡ä»¶" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <h4 id="311é…ç½®æ–‡ä»¶ç»“æ„">3.1.1ã€é…ç½®æ–‡ä»¶ç»“æ„<a class="headerlink" href="#311é…ç½®æ–‡ä»¶ç»“æ„" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>Nginx çš„é…ç½®æ–‡ä»¶é»˜è®¤å­˜äº <code>/etc/nginx/nginx.conf</code>ï¼Œå…¶ä¸­é€šè¿‡ <code>include</code> å¼•å…¥å…¶å®ƒç›®å½•å­é…ç½®æ–‡ä»¶ï¼ŒNginx æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="k">...</span><span class="w">              </span><span class="c1">#å…¨å±€å—</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="s">events</span><span class="w"> </span><span class="p">{</span><span class="w">         </span><span class="c1">#eventså—</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">   </span><span class="kn">...</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="err">}</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="s">http</span><span class="w">      </span><span class="c1">#httpå—</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="p">{</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">    </span><span class="kn">...</span><span class="w">   </span><span class="c1">#httpå…¨å±€å—</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">    </span><span class="s">server</span><span class="w">        </span><span class="c1">#serverå—</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">        </span><span class="kn">...</span><span class="w">       </span><span class="c1">#serverå…¨å±€å—</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="w">        </span><span class="s">location</span><span class="w"> </span><span class="s">[PATTERN]</span><span class="w">   </span><span class="c1">#locationå—</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="w">            </span><span class="kn">...</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="w">        </span><span class="err">}</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="w">        </span><span class="s">location</span><span class="w"> </span><span class="s">[PATTERN]</span><span class="w"> </span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="w">            </span><span class="kn">...</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="w">        </span><span class="err">}</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="w">    </span><span class="err">}</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="w">    </span><span class="s">server</span>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a><span class="w">      </span><span class="kn">...</span>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a><span class="w">    </span><span class="err">}</span>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a><span class="w">    </span><span class="s">...</span><span class="w">   </span><span class="c1">#httpå…¨å±€å—</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a><span class="err">}</span>
</span></code></pre></div> <ul> <li>å…¨å±€å—ï¼šé…ç½®å½±å“ Nginx å…¨å±€çš„æŒ‡ä»¤ã€‚ä¸€èˆ¬æœ‰è¿è¡Œ Nginx æœåŠ¡å™¨çš„ç”¨æˆ·ã€Nginx è¿›ç¨‹ pid å­˜æ”¾è·¯å¾„ã€æ—¥å¿—å­˜æ”¾è·¯å¾„ã€é…ç½®æ–‡ä»¶å¼•å…¥ã€å…è®¸ç”Ÿæˆ worker process æ•°ç­‰ã€‚</li> <li><code>events</code>ï¼šé…ç½®å½±å“ Nginx æœåŠ¡å™¨æˆ–ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ã€‚æœ‰æ¯ä¸ªè¿›ç¨‹çš„æœ€å¤§è¿æ¥æ•°ã€é€‰å–å“ªç§äº‹ä»¶é©±åŠ¨æ¨¡å‹å¤„ç†è¿æ¥è¯·æ±‚ã€æ˜¯å¦å…è®¸åŒæ—¶æ¥å—å¤šä¸ªç½‘è·¯è¿æ¥ã€å¼€å¯å¤šä¸ªç½‘ç»œè¿æ¥åºåˆ—åŒ–ç­‰ã€‚</li> <li><code>http</code>ï¼šå¯ä»¥åµŒå¥—å¤šä¸ª <code>server</code>ï¼Œé…ç½®ä»£ç†ã€ç¼“å­˜ã€æ—¥å¿—å®šä¹‰ç­‰ç»å¤§å¤šæ•°åŠŸèƒ½å’Œç¬¬ä¸‰æ–¹æ¨¡å—çš„é…ç½®ã€‚å¦‚æ–‡ä»¶å¼•å…¥ã€mime-type å®šä¹‰ã€æ—¥å¿—è‡ªå®šä¹‰ã€æ˜¯å¦ä½¿ç”¨ sendfile ä¼ è¾“æ–‡ä»¶ã€è¿æ¥è¶…æ—¶æ—¶é—´ã€å•è¿æ¥è¯·æ±‚æ•°ç­‰ã€‚</li> <li><code>server</code>ï¼šé…ç½®è™šæ‹Ÿä¸»æœºçš„ç›¸å…³å‚æ•°ï¼Œä¸€ä¸ª <code>http</code> ä¸­å¯ä»¥æœ‰å¤šä¸ª <code>server</code>ã€‚</li> <li><code>location</code>ï¼šé…ç½®è¯·æ±‚çš„è·¯ç”±ä»¥åŠå„ç§é¡µé¢çš„å¤„ç†æƒ…å†µã€‚</li> </ul> <p><br></p> <h4 id="312é…ç½®æ¨¡æ¿ç¤ºä¾‹">3.1.2ã€é…ç½®æ¨¡æ¿ç¤ºä¾‹<a class="headerlink" href="#312é…ç½®æ¨¡æ¿ç¤ºä¾‹" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1">####### å…¨å±€å—</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="k">worker_processes</span><span class="w">    </span><span class="s">auto</span><span class="p">;</span><span class="w">                   </span><span class="c1"># å·¥ä½œè¿›ç¨‹æ•°</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="k">error_log</span><span class="w">  </span><span class="s">/var/log/nginx/error.log</span><span class="w"> </span><span class="s">notice</span><span class="p">;</span><span class="w"> </span><span class="c1"># é”™è¯¯çº§åˆ«è®°å½•</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="k">events</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">    </span><span class="kn">worker_connections</span><span class="w">  </span><span class="mi">1024</span><span class="p">;</span><span class="w">               </span><span class="c1"># å•ä¸ªå·¥ä½œè¿›ç¨‹ï¼Œå¯æ‰¿è½½çš„æœ€å¤§è¿æ¥æ•°</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="p">}</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="k">http</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="w">    </span><span class="c1">###### MIME é…ç½®</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="w">    </span><span class="kn">include</span><span class="w">       </span><span class="s">/etc/nginx/mime.types</span><span class="p">;</span><span class="w">    </span><span class="c1"># æ–‡ä»¶æ‰©å±•åä¸æ–‡ä»¶ç±»å‹æ˜ å°„è¡¨</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="w">    </span><span class="kn">default_type</span><span class="w">  </span><span class="s">application/octet-stream</span><span class="p">;</span><span class="w"> </span><span class="c1"># mime.types ä¸åŒ…å«æ—¶çš„é»˜è®¤è®¾ç½®</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="w">    </span><span class="c1">###### è¯·æ±‚æ—¥å¿—é…ç½®</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="w">    </span><span class="kn">log_format</span><span class="w">  </span><span class="s">log-format-a</span><span class="w">  </span><span class="s">'</span><span class="nv">$remote_addr</span><span class="w"> </span><span class="s">-</span><span class="w"> </span><span class="nv">$remote_user</span><span class="w"> </span><span class="s">[</span><span class="nv">$time_local]</span><span class="w"> </span><span class="s">"</span><span class="nv">$request"</span><span class="w"> </span><span class="nv">$status</span><span class="w"> </span><span class="nv">$body_bytes_sent</span><span class="w"> </span><span class="s">"</span><span class="nv">$http_referer"</span><span class="w"> </span><span class="s">"</span><span class="nv">$http_user_agent"</span><span class="w"> </span><span class="s">"</span><span class="nv">$http_x_forwarded_for"'</span><span class="p">;</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="w">    </span><span class="kn">access_log</span><span class="w">  </span><span class="s">/var/log/nginx/access.log</span><span class="w">  </span><span class="s">log-format-a</span><span class="p">;</span><span class="w">    </span><span class="c1"># è®¿é—®æ—¥å¿—è·¯å¾„ åŠå¼•ç”¨æ ¼å¼</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="w">    </span><span class="c1">###### åç«¯å¯ç”¨æœåŠ¡é…ç½®</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="w">    </span><span class="kn">upstream</span><span class="w"> </span><span class="s">backend-server-name</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a><span class="w">        </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.101</span><span class="p">:</span><span class="mi">80</span><span class="p">;</span>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a><span class="w">        </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.102</span><span class="p">:</span><span class="mi">80</span><span class="p">;</span>
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a><span class="w">        </span><span class="c1">###### è¯·æ±‚åŒ¹é…</span>
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a><span class="w">        </span><span class="kn">listen</span><span class="w">       </span><span class="mi">80</span><span class="p">;</span><span class="w">                 </span><span class="c1"># å®¢æˆ·ç«¯è¯·æ±‚çš„ç«¯å£</span>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a><span class="w">        </span><span class="kn">server_name</span><span class="w">  </span><span class="s">_</span><span class="p">;</span><span class="w">                  </span><span class="c1"># å®¢æˆ·ç«¯è¯·æ±‚çš„åŸŸåï¼›åŒºåˆ†ä¸åŒæœåŠ¡ï¼ˆå¯å¤šä¸ªç©ºæ ¼åŒºåˆ†,æ”¯æŒæ­£åˆ™ï¼‰</span>
</span><span id="__span-24-28"><a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a>
</span><span id="__span-24-29"><a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a><span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-30"><a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a><span class="w">            </span><span class="c1">###### é‡å†™é…ç½®</span>
</span><span id="__span-24-31"><a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a><span class="w">            </span><span class="kn">rewrite</span><span class="w"> </span><span class="s">^&lt;è§„åˆ™&gt;</span>$<span class="w"> </span><span class="s">&lt;ç›®çš„åœ°&gt;</span><span class="w"> </span><span class="s">break</span><span class="p">;</span>
</span><span id="__span-24-32"><a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a>
</span><span id="__span-24-33"><a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a><span class="w">            </span><span class="c1">###### è½¬å‘åˆ°åç«¯é…ç½®</span>
</span><span id="__span-24-34"><a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a><span class="w">            </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://backend-server-name</span><span class="nv">$request_uri</span><span class="p">;</span><span class="w">    </span><span class="c1"># è½¬å‘åˆ°åå°æœåŠ¡åœ°å€ï¼Œæ¥è‡ªäº upstream é¡¹</span>
</span><span id="__span-24-35"><a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a><span class="w">            </span><span class="kn">proxy_http_version</span><span class="w"> </span><span class="mi">1</span><span class="s">.1</span><span class="p">;</span><span class="w">                               </span><span class="c1"># æŒ‡æ˜ç‰ˆæœ¬ï¼ˆ1.1é»˜è®¤ä¸ºkeep-aliveé•¿è¿æ¥ï¼Œ1.0é»˜è®¤ä¸ºçŸ­è¿æ¥ï¼‰</span>
</span><span id="__span-24-36"><a id="__codelineno-24-36" name="__codelineno-24-36" href="#__codelineno-24-36"></a><span class="w">            </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span><span class="w">                          </span><span class="c1"># ä¿æŒåŸæ¥çš„è¯·æ±‚åŸŸå</span>
</span><span id="__span-24-37"><a id="__codelineno-24-37" name="__codelineno-24-37" href="#__codelineno-24-37"></a><span class="w">            </span><span class="kn">proxy_ignore_client_abort</span><span class="w"> </span><span class="no">on</span><span class="p">;</span><span class="w">                         </span><span class="c1"># å®¢æˆ·ç«¯æ–­ç½‘æ—¶ï¼Œæ˜¯å¦ä¸­æ–­å¯¹åç«¯çš„è¯·æ±‚</span>
</span><span id="__span-24-38"><a id="__codelineno-24-38" name="__codelineno-24-38" href="#__codelineno-24-38"></a><span class="w">            </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
</span><span id="__span-24-39"><a id="__codelineno-24-39" name="__codelineno-24-39" href="#__codelineno-24-39"></a><span class="w">            </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span><span class="w"> </span><span class="c1"># ä»è¿œç¨‹å®¢æˆ·ç«¯IPåˆ°æœåŠ¡ç«¯çš„å±‚å±‚ä»£ç†è½¬å‘IPï¼Œå¤šIPè¿½åŠ ç©ºæ ¼åˆ†éš”</span>
</span><span id="__span-24-40"><a id="__codelineno-24-40" name="__codelineno-24-40" href="#__codelineno-24-40"></a>
</span><span id="__span-24-41"><a id="__codelineno-24-41" name="__codelineno-24-41" href="#__codelineno-24-41"></a><span class="w">            </span><span class="c1">###### Cookie åŸŸå/è·¯å¾„</span>
</span><span id="__span-24-42"><a id="__codelineno-24-42" name="__codelineno-24-42" href="#__codelineno-24-42"></a><span class="w">            </span><span class="kn">proxy_cookie_domain</span><span class="w"> </span><span class="p">{</span><span class="kn">backend-domain}</span><span class="w"> </span><span class="p">{</span><span class="kn">request-domain}</span><span class="p">;</span>
</span><span id="__span-24-43"><a id="__codelineno-24-43" name="__codelineno-24-43" href="#__codelineno-24-43"></a><span class="w">            </span><span class="kn">proxy_cookie_path</span><span class="w"> </span><span class="p">{</span><span class="kn">backend-path}</span><span class="w"> </span><span class="p">{</span><span class="kn">request-path}</span><span class="p">;</span>
</span><span id="__span-24-44"><a id="__codelineno-24-44" name="__codelineno-24-44" href="#__codelineno-24-44"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-24-45"><a id="__codelineno-24-45" name="__codelineno-24-45" href="#__codelineno-24-45"></a>
</span><span id="__span-24-46"><a id="__codelineno-24-46" name="__codelineno-24-46" href="#__codelineno-24-46"></a><span class="w">        </span><span class="c1">###### æŒ‡å®šæ–‡ä»¶æ‹’ç»æ‰€æœ‰è®¿é—®</span>
</span><span id="__span-24-47"><a id="__codelineno-24-47" name="__codelineno-24-47" href="#__codelineno-24-47"></a><span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="p">~</span><span class="w"> </span><span class="sr">^/(\.user.ini|\.ht|\.git|\.svn|\.project|LICENSE|README.md)</span><span class="p">{</span>
</span><span id="__span-24-48"><a id="__codelineno-24-48" name="__codelineno-24-48" href="#__codelineno-24-48"></a><span class="w">            </span><span class="kn">deny</span><span class="w"> </span><span class="s">all</span><span class="p">;</span>
</span><span id="__span-24-49"><a id="__codelineno-24-49" name="__codelineno-24-49" href="#__codelineno-24-49"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-24-50"><a id="__codelineno-24-50" name="__codelineno-24-50" href="#__codelineno-24-50"></a>
</span><span id="__span-24-51"><a id="__codelineno-24-51" name="__codelineno-24-51" href="#__codelineno-24-51"></a><span class="w">        </span><span class="c1">###### é™åˆ¶çš„å®¢æˆ·ç«¯</span>
</span><span id="__span-24-52"><a id="__codelineno-24-52" name="__codelineno-24-52" href="#__codelineno-24-52"></a><span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">\</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-53"><a id="__codelineno-24-53" name="__codelineno-24-53" href="#__codelineno-24-53"></a><span class="w">            </span><span class="kn">deny</span><span class="w"> </span><span class="mi">172</span><span class="s">.18.0.101</span><span class="p">;</span><span class="w">    </span><span class="c1"># æ‹’ç»çš„ip</span>
</span><span id="__span-24-54"><a id="__codelineno-24-54" name="__codelineno-24-54" href="#__codelineno-24-54"></a><span class="w">            </span><span class="kn">allow</span><span class="w"> </span><span class="mi">172</span><span class="s">.18.1.10</span><span class="p">;</span><span class="w">    </span><span class="c1"># å…è®¸çš„ip</span>
</span><span id="__span-24-55"><a id="__codelineno-24-55" name="__codelineno-24-55" href="#__codelineno-24-55"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-24-56"><a id="__codelineno-24-56" name="__codelineno-24-56" href="#__codelineno-24-56"></a>
</span><span id="__span-24-57"><a id="__codelineno-24-57" name="__codelineno-24-57" href="#__codelineno-24-57"></a><span class="w">        </span><span class="c1">###### å®¢æˆ·ç«¯ç¼“å­˜é…ç½®</span>
</span><span id="__span-24-58"><a id="__codelineno-24-58" name="__codelineno-24-58" href="#__codelineno-24-58"></a><span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="p">~</span><span class="sr">*</span><span class="w"> </span><span class="s">\.(js|css|jpg|svg|gif|png)</span>$<span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-59"><a id="__codelineno-24-59" name="__codelineno-24-59" href="#__codelineno-24-59"></a><span class="w">            </span><span class="kn">if</span><span class="w"> </span><span class="s">(-f</span><span class="w"> </span><span class="nv">$request_filename</span><span class="s">)</span><span class="w"> </span><span class="p">{</span><span class="w">    </span><span class="c1"># -fï¼šåªèƒ½æ˜¯æ–‡ä»¶ï¼Œå› ä¸ºè¿™ç”¨-fåˆ¤æ–­äº†</span>
</span><span id="__span-24-60"><a id="__codelineno-24-60" name="__codelineno-24-60" href="#__codelineno-24-60"></a><span class="w">                </span><span class="kn">expires</span><span class="w"> </span><span class="s">30d</span><span class="p">;</span><span class="w">               </span><span class="c1"># ç¼“å­˜æœ‰æ•ˆæ—¶é•¿ 30 å¤©</span>
</span><span id="__span-24-61"><a id="__codelineno-24-61" name="__codelineno-24-61" href="#__codelineno-24-61"></a><span class="w">                </span><span class="kn">break</span><span class="p">;</span>
</span><span id="__span-24-62"><a id="__codelineno-24-62" name="__codelineno-24-62" href="#__codelineno-24-62"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-24-63"><a id="__codelineno-24-63" name="__codelineno-24-63" href="#__codelineno-24-63"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-24-64"><a id="__codelineno-24-64" name="__codelineno-24-64" href="#__codelineno-24-64"></a>
</span><span id="__span-24-65"><a id="__codelineno-24-65" name="__codelineno-24-65" href="#__codelineno-24-65"></a><span class="w">        </span><span class="c1">###### é˜²ç›—é“¾é…ç½®</span>
</span><span id="__span-24-66"><a id="__codelineno-24-66" name="__codelineno-24-66" href="#__codelineno-24-66"></a><span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="p">~</span><span class="sr">*</span><span class="w"> </span><span class="s">\.(gif|jpg|png|bmp)</span>$<span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1"># æŒ‡å®šæ ¼å¼ç¦æ­¢çš„è¯·æ±‚æ¥æºï¼šgoogle/baidu</span>
</span><span id="__span-24-67"><a id="__codelineno-24-67" name="__codelineno-24-67" href="#__codelineno-24-67"></a><span class="w">            </span><span class="kn">valid_referers</span><span class="w"> </span><span class="s">none</span><span class="w"> </span><span class="s">blocked</span><span class="w"> </span><span class="s">*.ttlsa.com</span><span class="w"> </span><span class="s">server_names</span><span class="w"> </span><span class="p">~</span><span class="sr">\.google\.</span><span class="w"> </span><span class="p">~</span><span class="sr">\.baidu\.;</span>
</span><span id="__span-24-68"><a id="__codelineno-24-68" name="__codelineno-24-68" href="#__codelineno-24-68"></a><span class="w">            </span><span class="s">if</span><span class="w"> </span><span class="s">(</span><span class="nv">$invalid_referer</span><span class="s">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-69"><a id="__codelineno-24-69" name="__codelineno-24-69" href="#__codelineno-24-69"></a><span class="w">                </span><span class="kn">return</span><span class="w"> </span><span class="mi">403</span><span class="p">;</span><span class="w">                 </span><span class="c1"># çŠ¶æ€ç </span>
</span><span id="__span-24-70"><a id="__codelineno-24-70" name="__codelineno-24-70" href="#__codelineno-24-70"></a><span class="w">                </span><span class="c1">#rewrite ^/ http://www.ttlsa.com/403.jpg;</span>
</span><span id="__span-24-71"><a id="__codelineno-24-71" name="__codelineno-24-71" href="#__codelineno-24-71"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-24-72"><a id="__codelineno-24-72" name="__codelineno-24-72" href="#__codelineno-24-72"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-24-73"><a id="__codelineno-24-73" name="__codelineno-24-73" href="#__codelineno-24-73"></a>
</span><span id="__span-24-74"><a id="__codelineno-24-74" name="__codelineno-24-74" href="#__codelineno-24-74"></a><span class="w">        </span><span class="c1">###### (å‰ç«¯) é”™è¯¯æœºåˆ¶</span>
</span><span id="__span-24-75"><a id="__codelineno-24-75" name="__codelineno-24-75" href="#__codelineno-24-75"></a><span class="w">        </span><span class="kn">error_page</span><span class="w">  </span><span class="mi">404</span><span class="w">              </span><span class="s">/404.html</span><span class="p">;</span><span class="w">    </span><span class="c1"># é”™è¯¯ç  è½¬å‘çš„ é”™è¯¯é¡µ</span>
</span><span id="__span-24-76"><a id="__codelineno-24-76" name="__codelineno-24-76" href="#__codelineno-24-76"></a><span class="w">        </span><span class="kn">error_page</span><span class="w">  </span><span class="mi">500</span><span class="w"> </span><span class="mi">502</span><span class="w"> </span><span class="mi">503</span><span class="w"> </span><span class="mi">504</span><span class="w">  </span><span class="s">/50x.html</span><span class="p">;</span><span class="w">    </span><span class="c1"># é”™è¯¯ç  è½¬å‘çš„ é”™è¯¯é¡µ</span>
</span><span id="__span-24-77"><a id="__codelineno-24-77" name="__codelineno-24-77" href="#__codelineno-24-77"></a><span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">/50x.html</span><span class="w"> </span><span class="p">{</span><span class="w">                     </span><span class="c1"># é”™è¯¯é¡µ æŒ‡å‘çš„ é™æ€é¡µé¢</span>
</span><span id="__span-24-78"><a id="__codelineno-24-78" name="__codelineno-24-78" href="#__codelineno-24-78"></a><span class="w">            </span><span class="kn">root</span><span class="w">   </span><span class="s">/usr/share/nginx/html</span><span class="p">;</span>
</span><span id="__span-24-79"><a id="__codelineno-24-79" name="__codelineno-24-79" href="#__codelineno-24-79"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-24-80"><a id="__codelineno-24-80" name="__codelineno-24-80" href="#__codelineno-24-80"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-24-81"><a id="__codelineno-24-81" name="__codelineno-24-81" href="#__codelineno-24-81"></a><span class="p">}</span>
</span></code></pre></div> <p><br></p> <h3 id="32æŒ‡ä»¤">3.2ã€æŒ‡ä»¤<a class="headerlink" href="#32æŒ‡ä»¤" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>Nginx çš„é…ç½®ç”±æŒ‡ä»¤ï¼ˆDirectivesï¼‰ç»„æˆï¼ŒæŒ‡ä»¤æ˜¯é”®å€¼å¯¹çš„å½¢å¼ï¼Œç”¨äºé…ç½® Web æœåŠ¡å™¨ã€‚å®ƒä»¬é€šå¸¸ä½äº nginx.conf æ–‡ä»¶æˆ–é€šè¿‡ <code>include</code> è¯­å¥å¼•å…¥çš„å…¶ä»–é…ç½®æ–‡ä»¶ä¸­ã€‚æŒ‡ä»¤åˆ†ä¸ºä¸¤ç±»ï¼š</p> <ol> <li>ç®€å•æŒ‡ä»¤ï¼ˆSimple Directivesï¼‰ï¼šç”±åç§°å’Œå‚æ•°ç»„æˆï¼Œä»¥åˆ†å· <code>;</code> ç»“å°¾ã€‚ä¾‹å¦‚ï¼š<code>worker_processes auto;</code>ã€‚</li> <li>å—æŒ‡ä»¤ï¼ˆBlock Directivesï¼‰ï¼šä¸ç®€å•æŒ‡ä»¤ç»“æ„ç±»ä¼¼ï¼Œä½†ä»¥ä¸€å¯¹å¤§æ‹¬å· <code>{}</code> ç»“æŸï¼Œå¤§æ‹¬å·å†…åŒ…å«ä¸€ç»„é¢å¤–çš„æŒ‡ä»¤ã€‚</li> </ol> <p><br></p> <h4 id="321location">3.2.1ã€location<a class="headerlink" href="#321location" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>Nginx çš„ <code>location</code> æŒ‡ä»¤æ˜¯ Nginx é…ç½®ä¸­æœ€æ ¸å¿ƒå’Œæœ€å¼ºå¤§çš„éƒ¨åˆ†ä¹‹ä¸€ã€‚å®ƒå…è®¸ä½ æ ¹æ®å®¢æˆ·ç«¯è¯·æ±‚çš„ URIï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰æ¥å®šä¹‰ä¸åŒçš„é…ç½®å—ï¼Œä»è€Œå®ç°è¯·æ±‚çš„è·¯ç”±ã€å¤„ç†å’Œå“åº”ã€‚</p> <p><code>location</code> å®šä¹‰äº†ä¸€ä¸ªé…ç½®å—ï¼Œç”¨äºï¼š</p> <ul> <li>è·¯ç”±è¯·æ±‚ï¼šæ ¹æ® URL æ¨¡å¼å°†è¯·æ±‚åˆ†å‘åˆ°ä¸åŒçš„å¤„ç†é€»è¾‘ï¼ˆä¾‹å¦‚ï¼Œé™æ€æ–‡ä»¶ã€ä»£ç†åˆ°åç«¯åº”ç”¨ã€PHP è§£é‡Šå™¨ç­‰ï¼‰ã€‚</li> <li>åº”ç”¨ç‰¹å®šè®¾ç½®ï¼šä¸ºåŒ¹é…çš„ URI åº”ç”¨ç‰¹å®šçš„é…ç½®ï¼Œå¦‚æ ¹ç›®å½•ã€ç´¢å¼•æ–‡ä»¶ã€é”™è¯¯é¡µé¢ã€HTTP å¤´ç­‰ã€‚</li> <li>URL é‡å†™æˆ–é‡å®šå‘ï¼šä¿®æ”¹è¯·æ±‚çš„ URI æˆ–å°†å®¢æˆ·ç«¯é‡å®šå‘åˆ°æ–°çš„ URLã€‚</li> <li>è®¿é—®æ§åˆ¶ï¼šåŸºäº URI è·¯å¾„é™åˆ¶æˆ–å…è®¸è®¿é—®ã€‚</li> <li>ä¼˜åŒ–æ€§èƒ½ï¼šä¸ºä¸åŒç±»å‹çš„å†…å®¹ï¼ˆå¦‚é™æ€æ–‡ä»¶ï¼‰åº”ç”¨ç‰¹å®šçš„ç¼“å­˜æˆ–å‹ç¼©ç­–ç•¥ã€‚</li> </ul> <p>è¯­æ³•å¦‚ä¸‹ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="k">location</span><span class="w"> </span><span class="s">[modifier]</span><span class="w"> </span><span class="s">uri</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">    </span><span class="c1"># æŒ‡ä»¤ï¼Œä¾‹å¦‚ root, index, proxy_pass, rewrite, return ç­‰</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="p">}</span>
</span></code></pre></div> <ul> <li><em>modifier</em>ï¼šä¿®é¥°ç¬¦ï¼Œå¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®šåŒ¹é… URI çš„ç±»å‹ã€‚ä¸åŒçš„ä¿®é¥°ç¬¦å†³å®šäº† Nginx å¦‚ä½•åŒ¹é…è¯·æ±‚ URIã€‚</li> <li><em>uri</em>ï¼šè¦åŒ¹é…çš„è¯·æ±‚ URIã€‚å®ƒå¯ä»¥æ˜¯å­—é¢å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ã€‚</li> </ul> <p><br></p> <h5 id="ä¿®é¥°ç¬¦">ä¿®é¥°ç¬¦<a class="headerlink" href="#ä¿®é¥°ç¬¦" title="é”šç‚¹é“¾æ¥">Â¶</a></h5> <p>Nginx æä¾›äº†å¤šç§ä¿®é¥°ç¬¦æ¥æ§åˆ¶ <code>location</code> çš„åŒ¹é…æ–¹å¼ï¼š</p> <p><br></p> <p><strong>æ— ä¿®é¥°ç¬¦ï¼ˆPrefix Match / å‰ç¼€åŒ¹é…ï¼‰</strong></p> <ul> <li> <p>è¯­æ³•ï¼š<code>location /path/ { ... }</code></p> </li> <li> <p>ä½œç”¨ï¼šå°† URI ä½œä¸ºå‰ç¼€è¿›è¡ŒåŒ¹é…ï¼Œå³åªè¦è¯·æ±‚ URI ä»¥æŒ‡å®šè·¯å¾„å¼€å¤´ï¼Œå°±åŒ¹é…æˆåŠŸã€‚å®ƒæ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚</p> </li> <li> <p>ç‰¹ç‚¹ï¼šNginx ä¼šå°è¯•æ‰¾åˆ°æœ€é•¿åŒ¹é…çš„å‰ç¼€ã€‚</p> </li> <li> <p>ç¤ºä¾‹ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">location</span><span class="w"> </span><span class="s">/images/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">    </span><span class="kn">root</span><span class="w"> </span><span class="s">/data/www</span><span class="p">;</span><span class="w"> </span><span class="c1"># è¯·æ±‚ /images/foo.png ä¼šæŸ¥æ‰¾ /data/www/images/foo.png</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="p">}</span>
</span></code></pre></div> </li> </ul> <p><br></p> <h5 id="uri-æœ«å°¾æ–œæ†">uri æœ«å°¾æ–œæ†<a class="headerlink" href="#uri-æœ«å°¾æ–œæ†" title="é”šç‚¹é“¾æ¥">Â¶</a></h5> <p>ä¸å¸¦æ–œæ çš„é…ç½®ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="k">location</span><span class="w"> </span><span class="s">/txffc</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">    </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://localhost:8082</span><span class="p">;</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="p">}</span>
</span></code></pre></div> <p>å¯ä»¥åŒ¹é…ï¼š</p> <ul> <li>http://192.168.231.128/txffc/common</li> <li>http://192.168.231.128/txffcddd</li> <li>http://192.168.231.128/txffcddd/aabc</li> </ul> <p>å¸¦æ–œæ çš„é…ç½®ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="k">location</span><span class="w"> </span><span class="s">/txffc/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">    </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://localhost:8082</span><span class="p">;</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="p">}</span>
</span></code></pre></div> <p>å¯ä»¥åŒ¹é…ï¼š</p> <ul> <li>http://192.168.231.128/txffc/common</li> <li>http://192.168.231.128/txffc/aabb</li> </ul> <p>ä¸èƒ½åŒ¹é…ï¼š</p> <ul> <li>http://192.168.231.128/txffcddd</li> </ul> <div class="admonition tip"> <p class="admonition-title">Tip</p> <p>å¤§éƒ¨åˆ†æƒ…å†µæ¨èå¸¦æ–œæ çš„å†™æ³•ï¼ˆåŒ¹é…ä¼šæ›´å‡†ç¡®äº›ï¼‰ã€‚</p> </div> <p><br></p> <h4 id="322map">3.2.2ã€map<a class="headerlink" href="#322map" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>Nginx çš„ <code>map</code> æŒ‡ä»¤æ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”çµæ´»çš„å·¥å…·ï¼Œå®ƒå…è®¸æ‚¨æ ¹æ®ä¸€ä¸ªå˜é‡çš„å€¼æ¥åˆ›å»ºå¦ä¸€ä¸ªæ–°å˜é‡çš„å€¼ã€‚è¿™åœ¨éœ€è¦åŸºäºç‰¹å®šæ¡ä»¶åŠ¨æ€è®¾ç½® Nginx é…ç½®æ—¶éå¸¸æœ‰ç”¨ï¼Œå¹¶ä¸”èƒ½æœ‰æ•ˆé¿å…ä½¿ç”¨ Nginx æ–‡æ¡£ä¸­é€šå¸¸ä¸é¼“åŠ±çš„ <code>if</code> è¯­å¥ï¼Œå› ä¸º <code>if</code> è¯­å¥æœ‰æ—¶å¯èƒ½å¯¼è‡´ä¸å¯é¢„æµ‹çš„è¡Œä¸ºã€‚</p> <p><code>map</code> æŒ‡ä»¤çš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªæ˜ å°„è¡¨ï¼Œè¯¥è¡¨å°†é”®ä¸å€¼å…³è”èµ·æ¥ï¼Œç„¶åå¯ä»¥åœ¨æ•´ä¸ª Nginx é…ç½®ä¸­ä½¿ç”¨è¿™ä¸ªæ˜ å°„è¡¨ã€‚æ‚¨å¯ä»¥å°†å…¶è§†ä¸ºç¼–ç¨‹è¯­è¨€ä¸­çš„ <code>case</code> è¯­å¥ï¼Œæ ¹æ®è¾“å…¥å€¼åŒ¹é…ä¸åŒçš„æ¡ä»¶ï¼Œå¹¶è¿”å›ç›¸åº”çš„è¾“å‡ºå€¼ã€‚</p> <p>map æŒ‡ä»¤å¿…é¡»åœ¨ Nginx é…ç½®æ–‡ä»¶çš„ <code>http</code> ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ã€‚å…¶åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="k">http</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">    </span><span class="kn">map</span><span class="w"> </span><span class="s">&lt;è¾“å…¥å˜é‡&gt;</span><span class="w"> </span><span class="s">&lt;è¾“å‡ºå˜é‡&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="w">        </span><span class="kn">[&lt;åŒ¹é…æ¡ä»¶1&gt;]</span><span class="w"> </span><span class="s">&lt;å€¼1&gt;</span><span class="p">;</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w">        </span><span class="kn">[&lt;åŒ¹é…æ¡ä»¶2&gt;]</span><span class="w"> </span><span class="s">&lt;å€¼2&gt;</span><span class="p">;</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="w">        </span><span class="kn">...</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="w">        </span><span class="s">default</span><span class="w"> </span><span class="s">&lt;é»˜è®¤å€¼&gt;</span><span class="p">;</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="p">}</span>
</span></code></pre></div> <ul> <li><em>è¾“å…¥å˜é‡</em>ï¼šè¿™æ˜¯ <code>map</code> æŒ‡ä»¤è¦æ£€æŸ¥å’ŒåŒ¹é…çš„ Nginx å˜é‡ï¼ˆä¾‹å¦‚ <code>$host</code>ã€<code>$uri</code>ã€<code>$http_user_agent</code> ç­‰ï¼‰ã€‚</li> <li><em>è¾“å‡ºå˜é‡</em>ï¼šè¿™æ˜¯æ ¹æ®åŒ¹é…æ¡ä»¶å°†è¦è®¾ç½®çš„æ–°å˜é‡çš„åç§°ã€‚è¿™ä¸ªå˜é‡æ˜¯å…¨å±€çš„ï¼Œä¸€æ—¦å®šä¹‰ï¼Œå°±å¯ä»¥åœ¨ <code>http</code> å—çš„ä»»ä½•åœ°æ–¹è®¿é—®ã€‚</li> <li><em>åŒ¹é…æ¡ä»¶</em>ï¼šå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ­£åˆ™è¡¨è¾¾å¼æˆ– <code>hostnames</code> å…³é”®å­—ã€‚å½“è¾“å…¥å˜é‡çš„å€¼ä¸æŸä¸ªæ¡ä»¶åŒ¹é…æ—¶ï¼Œè¾“å‡ºå˜é‡å°†è¢«èµ‹äºˆç›¸åº”çš„å€¼ã€‚</li> <li><em>å€¼</em>ï¼šå½“åŒ¹é…æ¡ä»¶æˆåŠŸæ—¶ï¼Œèµ‹äºˆè¾“å‡ºå˜é‡çš„å€¼ã€‚</li> <li><em>default é»˜è®¤å€¼</em>ï¼šå¦‚æœè¾“å…¥å˜é‡çš„å€¼ä¸ä»»ä½•å®šä¹‰çš„åŒ¹é…æ¡ä»¶éƒ½ä¸ç¬¦ï¼Œåˆ™ä½¿ç”¨ <code>default</code> æŒ‡å®šçš„å€¼ã€‚è¿™æ˜¯å¯é€‰çš„ï¼Œä½†é€šå¸¸å»ºè®®è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ã€‚</li> </ul> <p><code>map</code> æŒ‡ä»¤åœ¨ Nginx é…ç½®ä¸­å®šä¹‰åï¼Œå¹¶ä¸ä¼šç«‹å³ä¸ºè¾“å‡ºå˜é‡èµ‹å€¼ã€‚ç›¸åï¼Œå®ƒä¼šåœ¨è¾“å‡ºå˜é‡è¢«å¼•ç”¨æ—¶æ‰è¿›è¡Œæ±‚å€¼å’Œèµ‹å€¼ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœè¯·æ±‚æµä¸è§¦åŠé…ç½®ä¸­ä½¿ç”¨äº† <code>map</code> å˜é‡çš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆ <code>map</code> å˜é‡çš„æŸ¥æ‰¾å°±ä¸ä¼šæ‰§è¡Œï¼Œä»è€Œä¸ä¼šå¢åŠ é¢å¤–çš„å¼€é”€ã€‚</p> <p><br></p> <p><strong>ç¤ºä¾‹</strong></p> <p>è¿™ä¸ªä¾‹å­æ ¹æ®ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²å°† <code>$browser</code> å˜é‡è®¾ç½®ä¸ºä¸åŒçš„æµè§ˆå™¨åç§°ï¼Œå¦‚æœéƒ½ä¸åŒ¹é…åˆ™é»˜è®¤ä¸º "Unknown"ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="k">http</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="w">    </span><span class="kn">map</span><span class="w"> </span><span class="nv">$http_user_agent</span><span class="w"> </span><span class="nv">$browser</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="w">        </span><span class="kn">default</span><span class="w"> </span><span class="s">"Unknown"</span><span class="p">;</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="w">        </span><span class="kn">~*chrome</span><span class="w"> </span><span class="s">"Chrome"</span><span class="p">;</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="w">        </span><span class="kn">~*firefox</span><span class="w"> </span><span class="s">"Firefox"</span><span class="p">;</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="w">        </span><span class="kn">~*safari</span><span class="w"> </span><span class="s">"Safari"</span><span class="p">;</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="w">        </span><span class="kn">~*opera</span><span class="w"> </span><span class="s">"Opera"</span><span class="p">;</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="w">        </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="w">            </span><span class="kn">add_header</span><span class="w"> </span><span class="s">X-Browser</span><span class="w"> </span><span class="nv">$browser</span><span class="p">;</span>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="w">            </span><span class="c1"># ... å…¶ä»–é…ç½®</span>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a><span class="p">}</span>
</span></code></pre></div> <p><br></p> <h4 id="323client_max_body_size">3.2.3ã€client_max_body_size<a class="headerlink" href="#323client_max_body_size" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>Nginx ä¸­çš„ <code>client_max_body_size</code> æŒ‡ä»¤ç”¨äºè®¾ç½®å…è®¸çš„å®¢æˆ·ç«¯è¯·æ±‚ä½“çš„æœ€å¤§å€¼ã€‚è¿™ä¸ªæŒ‡ä»¤å¯¹äºæ§åˆ¶ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ä»¥åŠé˜²æ­¢æ½œåœ¨çš„æ‹’ç»æœåŠ¡ï¼ˆDoSï¼‰æ”»å‡»è‡³å…³é‡è¦ã€‚</p> <p><code>client_max_body_size</code> çš„ä¸»è¦ä½œç”¨æ˜¯é™åˆ¶é€šè¿‡ POST ç­‰æ–¹æ³•å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®é‡ã€‚å½“å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚æµè§ˆå™¨ï¼‰å‘é€çš„è¯·æ±‚ä½“è¶…è¿‡äº†åœ¨ Nginx é…ç½®ä¸­è®¾å®šçš„è¿™ä¸ªå€¼æ—¶ï¼ŒNginx å°†ä¼šæ‹’ç»è¯¥è¯·æ±‚ï¼Œå¹¶å‘å®¢æˆ·ç«¯è¿”å›ä¸€ä¸ª "413 Request Entity Too Large" çš„é”™è¯¯ã€‚</p> <p><br></p> <p><strong>è¯­æ³•å’Œé»˜è®¤å€¼</strong></p> <p>è¯¥æŒ‡ä»¤çš„è¯­æ³•éå¸¸ç®€å•ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="k">client_max_body_size</span><span class="w"> </span><span class="s">size</span><span class="p">;</span>
</span></code></pre></div> <p>å…¶ä¸­ <em>size</em> å¯ä»¥æ˜¯ä»¥ä¸‹å•ä½ï¼š</p> <ul> <li>k æˆ– Kï¼ˆåƒå­—èŠ‚ï¼‰</li> <li>m æˆ– Mï¼ˆå…†å­—èŠ‚ï¼‰</li> <li>g æˆ– Gï¼ˆåƒå…†å­—èŠ‚ï¼‰</li> </ul> <p>é»˜è®¤å€¼ï¼š å¦‚æœæ²¡æœ‰æ˜ç¡®è®¾ç½®ï¼Œ<code>client_max_body_size</code> çš„é»˜è®¤å€¼ä¸º 1å…†å­—èŠ‚ï¼ˆ1mï¼‰ã€‚</p> <div class="admonition warning"> <p class="admonition-title">Caution</p> <p>å°† <code>client_max_body_size</code> çš„å€¼è®¾ç½®ä¸º 0 ä¼šç¦ç”¨å¯¹å®¢æˆ·ç«¯è¯·æ±‚ä½“å¤§å°çš„æ£€æŸ¥ã€‚è¿™æ„å‘³ç€ Nginx å°†æ¥å—ä»»æ„å¤§å°çš„è¯·æ±‚ä½“ã€‚è™½ç„¶è¿™åœ¨æŸäº›ç‰¹å®šåœºæ™¯ä¸‹å¯èƒ½æœ‰ç”¨ï¼Œä½†é€šå¸¸ä¸æ¨èè¿™æ ·åšï¼Œå› ä¸ºå®ƒä¼šå¸¦æ¥å®‰å…¨é£é™©ï¼Œä¾‹å¦‚å®¹æ˜“å—åˆ° DoS æ”»å‡»ã€‚</p> </div> <p><br></p> <p><strong>é…ç½®ä¸Šä¸‹æ–‡</strong></p> <p><code>client_max_body_size</code> å¯ä»¥åœ¨ Nginx é…ç½®æ–‡ä»¶çš„ä»¥ä¸‹ä¸‰ä¸ªä¸Šä¸‹æ–‡ä¸­è¿›è¡Œè®¾ç½®ï¼Œå…¶ä½œç”¨åŸŸé€çº§ç»†åŒ–ï¼š</p> <ul> <li>http å—ï¼š åœ¨è¿™é‡Œè®¾ç½®å°†å¯¹æ‰€æœ‰çš„è™šæ‹Ÿä¸»æœºï¼ˆ<code>server</code> å—ï¼‰ç”Ÿæ•ˆï¼Œä½œä¸ºå…¨å±€é»˜è®¤å€¼ã€‚</li> <li>server å—ï¼š åœ¨è¿™é‡Œè®¾ç½®å°†è¦†ç›– <code>http</code> å—ä¸­çš„é…ç½®ï¼Œä»…å¯¹è¯¥ç‰¹å®šçš„è™šæ‹Ÿä¸»æœºçš„ç”Ÿæ•ˆã€‚</li> <li>location å—ï¼š è¿™æ˜¯æœ€ç²¾ç»†çš„æ§åˆ¶çº§åˆ«ï¼Œä»…å¯¹åŒ¹é…è¯¥ <code>location</code> çš„è¯·æ±‚ç”Ÿæ•ˆï¼Œä¼šè¦†ç›– <code>server</code> å’Œ <code>http</code> å—ä¸­çš„è®¾ç½®ã€‚</li> </ul> <div class="admonition tip"> <p class="admonition-title">Tip</p> <p>ä¸ºäº†æœåŠ¡å™¨å®‰å…¨ï¼Œä¸å»ºè®®åœ¨ <code>http</code> æˆ– <code>server</code> å—ä¸­å°† <code>client_max_body_size</code> è®¾ç½®å¾—éå¸¸å¤§ã€‚</p> <p>å¦‚æœæœ‰æ–‡ä»¶ä¸Šä¼ éœ€æ±‚ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯ä»…ä¸ºä½ å¤„ç†æ–‡ä»¶ä¸Šä¼ çš„ç‰¹å®š URIï¼ˆæˆ–è·¯å¾„ï¼‰æ”¾å®½é™åˆ¶ã€‚</p> </div> <p><br></p> <h4 id="324include">3.2.4ã€include<a class="headerlink" href="#324include" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><code>include</code> æŒ‡ä»¤æ˜¯ Nginx é…ç½®æ¨¡å—åŒ–çš„æ ¸å¿ƒã€‚å®ƒçš„å·¥ä½œåŸç†éå¸¸ç®€å•ï¼šåœ¨ Nginx è¯»å–é…ç½®æ—¶ï¼Œå°†ç›®æ ‡æ–‡ä»¶çš„å†…å®¹åŸå°ä¸åŠ¨åœ°â€œç²˜è´´â€åˆ° <code>include</code> æŒ‡ä»¤æ‰€åœ¨çš„ä½ç½®ã€‚</p> <p><br></p> <p><strong>è¯­æ³•æ ¼å¼</strong></p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="k">include</span><span class="w"> </span><span class="n">&lt;file</span><span class="w"> </span><span class="k">|</span><span class="w"> </span><span class="s">mask&gt;</span><span class="p">;</span>
</span></code></pre></div> <ul> <li> <p><em>file</em>ï¼šæŒ‡å‘ç¡¬ç›˜ä¸Šå”¯ä¸€çš„ã€ç¡®å®šçš„æ–‡ä»¶ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="k">include</span><span class="w"> </span><span class="n">mime.types</span>;<span class="w">                 </span><span class="c1"># ç›¸å¯¹è·¯å¾„</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="k">include</span><span class="w"> </span><span class="n">C:/nginx/conf/proxy.conf</span>;<span class="w">   </span><span class="c1"># ç»å¯¹è·¯å¾„</span>
</span></code></pre></div> </li> <li> <p><em>mask</em>ï¼šä½¿ç”¨ Shell é£æ ¼çš„é€šé…ç¬¦ï¼ˆGlobï¼‰æ¥åŒ¹é…å¤šä¸ªæ–‡ä»¶ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="k">include</span><span class="w"> </span><span class="n">projects/*.conf</span>;<span class="w">      </span><span class="c1"># åŠ è½½ projects ç›®å½•ä¸‹æ‰€æœ‰ .conf æ–‡ä»¶</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="k">include</span><span class="w"> </span><span class="n">vhosts/site-*.conf</span>;<span class="w">   </span><span class="c1"># åŠ è½½ä»¥ site- å¼€å¤´çš„ conf æ–‡ä»¶</span>
</span></code></pre></div> </li> </ul> <p><br></p> <p><strong>ä½œç”¨åŸŸ</strong></p> <p><code>include</code> æŒ‡ä»¤éå¸¸çµæ´»ï¼Œå‡ ä¹å¯ä»¥æ”¾åœ¨ Nginx é…ç½®çš„ä»»ä½•å±‚çº§ï¼š</p> <table> <thead> <tr> <th>ä½œç”¨åŸŸ</th> <th>ç”¨é€”ä¸¾ä¾‹</th> <th>ç¤ºä¾‹ä»£ç </th> </tr> </thead> <tbody> <tr> <td><code>http</code></td> <td>å¼•å…¥ MIME ç±»å‹ã€æ—¥å¿—æ ¼å¼ã€å¼•å…¥å­ server é…ç½®æ–‡ä»¶</td> <td><code>include mime.types;</code> <br><code>include servers/*.conf;</code></td> </tr> <tr> <td><code>server</code></td> <td>å¼•å…¥ <code>location</code> åˆ—è¡¨ã€SSL è¯ä¹¦é…ç½®ã€é”™è¯¯é¡µé¢é…ç½®</td> <td><code>include locations/*.conf;</code> <br><code>include ssl_params.conf;</code></td> </tr> <tr> <td><code>location</code></td> <td>å¼•å…¥åå‘ä»£ç†çš„å…¬å…± Headerã€è·¨åŸŸï¼ˆCORSï¼‰è®¾ç½®ã€è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆIP ç™½åå•ï¼‰</td> <td><code>include proxy_params;</code> <br><code>include allow_ips.conf;</code></td> </tr> <tr> <td><code>upstream</code></td> <td>å¼•å…¥åç«¯æœåŠ¡å™¨åˆ—è¡¨</td> <td><code>include backends.conf;</code></td> </tr> </tbody> </table> <p><br></p> <p><strong>å¸¸ç”¨æ’é”™ä¸æ£€æŸ¥å‘½ä»¤</strong></p> <p>å½“æ–‡ä»¶è¢«æ‹†æ•£åï¼Œå¦‚æœéœ€è¦æ£€æŸ¥æœ€ç»ˆé…ç½®æ˜¯å¦æ­£ç¡®ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>nginx<span class="w"> </span>-T
</span></code></pre></div> <p>æ­¤å‘½ä»¤ä¼šè§£ææ‰€æœ‰ <code>include</code> å¹¶å°†å†…å®¹æ‰“å°å‡ºæ¥ï¼Œè®©ä½ çœ‹åˆ° Nginx å®é™…æ‰§è¡Œçš„å®Œæ•´ä»£ç ã€‚</p> <p><br></p> <h3 id="33å†…ç½®å˜é‡">3.3ã€å†…ç½®å˜é‡<a class="headerlink" href="#33å†…ç½®å˜é‡" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>Nginx æä¾›äº†è®¸å¤šå†…ç½®å˜é‡ï¼ˆBuilt-in Variablesï¼‰ï¼Œå®ƒä»¬å¯ä»¥æ•è·å…³äºè¯·æ±‚ã€å“åº”ã€æœåŠ¡å™¨å’Œè¿æ¥çš„åŠ¨æ€ä¿¡æ¯ã€‚è¿™äº›å˜é‡åœ¨é…ç½®æ–‡ä»¶ä¸­éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥ç”¨äºæ—¥å¿—è®°å½•ã€æ¡ä»¶åˆ¤æ–­ã€é‡å®šå‘ã€URLé‡å†™å’Œä»£ç†è®¾ç½®ç­‰[][18]ã€‚å˜é‡é€šå¸¸ä»¥ <code>$</code> ç¬¦å·å¼€å¤´ã€‚</p> <p><br></p> <h4 id="331è¯·æ±‚ç›¸å…³å˜é‡">3.3.1ã€è¯·æ±‚ç›¸å…³å˜é‡<a class="headerlink" href="#331è¯·æ±‚ç›¸å…³å˜é‡" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ul> <li><code>$host</code>ï¼šè¯·æ±‚ä¸­çš„ä¸»æœºåï¼Œä¼˜å…ˆä½¿ç”¨ <code>Host</code> å¤´éƒ¨å­—æ®µä¸­çš„å€¼ï¼Œå¦åˆ™ä½¿ç”¨æœåŠ¡å™¨åç§°ã€‚</li> <li><code>$http_host</code>ï¼šä¸ <code>$host</code> ç±»ä¼¼ï¼Œè·å–è¯·æ±‚å¤´ä¸­çš„ <code>Host</code> å€¼ã€‚</li> <li><code>$uri</code>ï¼šå½“å‰è¯·æ±‚çš„URIï¼Œå¯èƒ½åŒ…å«æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚</li> <li><code>$document_uri</code>ï¼šä¸ <code>$uri</code> ç±»ä¼¼ï¼Œä½†ä¸åŒ…å«æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚</li> <li><code>$request_uri</code>ï¼šåŒ…å«å®Œæ•´çš„è¯·æ±‚URIï¼ŒåŒ…æ‹¬æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå¦‚ <code>/index.php?page=1</code>ã€‚</li> <li><code>$args</code>ï¼šè¯·æ±‚ä¸­çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå¦‚ <code>page=1</code>ã€‚</li> <li><code>$is_args</code>ï¼šå¦‚æœè¯·æ±‚åŒ…å«æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œåˆ™å€¼ä¸º <code>?</code>ï¼Œå¦åˆ™ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</li> <li><code>$request_method</code>ï¼šè¯·æ±‚æ–¹æ³•ï¼Œå¦‚ <code>GET</code>ã€<code>POST</code> ç­‰ã€‚</li> <li><code>$query_string</code>ï¼šä¸ <code>$args</code> ç›¸åŒï¼Œè·å–è¯·æ±‚ä¸­çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚</li> <li><code>$request_filename</code>ï¼šè¯·æ±‚çš„æ–‡ä»¶è·¯å¾„ï¼ˆæ ¹ç›®å½•å¼€å§‹çš„å®Œæ•´è·¯å¾„ï¼‰ã€‚</li> <li><code>$request_body</code>ï¼šå®¢æˆ·ç«¯è¯·æ±‚çš„ä¸»ä½“å†…å®¹ã€‚</li> <li><code>$request_body_file</code>ï¼šä¿å­˜å®¢æˆ·ç«¯è¯·æ±‚ä¸»ä½“çš„ä¸´æ—¶æ–‡ä»¶åã€‚</li> </ul> <p><br></p> <h4 id="332è¿æ¥ç›¸å…³å˜é‡">3.3.2ã€è¿æ¥ç›¸å…³å˜é‡<a class="headerlink" href="#332è¿æ¥ç›¸å…³å˜é‡" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ul> <li><code>$remote_addr</code>ï¼šå®¢æˆ·ç«¯çš„IPåœ°å€ã€‚</li> <li><code>$remote_port</code>ï¼šå®¢æˆ·ç«¯çš„ç«¯å£å·ã€‚</li> <li><code>$server_addr</code>ï¼šæœåŠ¡å™¨çš„IPåœ°å€ã€‚</li> <li><code>$server_port</code>ï¼šæœåŠ¡å™¨çš„ç«¯å£å·ã€‚</li> <li><code>$server_name</code>ï¼šå¤„ç†è¯·æ±‚çš„æœåŠ¡å™¨åç§°ã€‚</li> <li><code>$connection</code>ï¼šå½“å‰è¿æ¥çš„è¿æ¥å·ã€‚</li> <li><code>$connection_requests</code>ï¼šå½“å‰è¿æ¥å·²å¤„ç†çš„è¯·æ±‚æ•°é‡ã€‚</li> </ul> <p><br></p> <h4 id="333å“åº”ç›¸å…³å˜é‡">3.3.3ã€å“åº”ç›¸å…³å˜é‡<a class="headerlink" href="#333å“åº”ç›¸å…³å˜é‡" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ul> <li><code>$status</code>ï¼šå“åº”çš„çŠ¶æ€ç ï¼Œå¦‚ <code>200</code>ã€<code>404</code> ç­‰ã€‚</li> <li><code>$body_bytes_sent</code>ï¼šå“åº”ä¸­å‘é€çš„ä¸»ä½“å†…å®¹å­—èŠ‚æ•°ï¼Œä¸åŒ…æ‹¬å“åº”å¤´éƒ¨ã€‚</li> <li><code>$bytes_sent</code>ï¼šå“åº”ä¸­å‘é€çš„æ€»å­—èŠ‚æ•°ï¼ŒåŒ…æ‹¬å¤´éƒ¨å’Œä¸»ä½“å†…å®¹ã€‚</li> <li><code>$sent_http_*</code>ï¼šå“åº”å¤´ä¸­çš„è‡ªå®šä¹‰å˜é‡ï¼Œå¦‚ <code>$sent_http_content_type</code> è¡¨ç¤ºå“åº”çš„ <code>Content-Type</code> å¤´éƒ¨å­—æ®µã€‚</li> </ul> <p><br></p> <h4 id="334http-è¯·æ±‚å¤´ç›¸å…³å˜é‡">3.3.4ã€HTTP è¯·æ±‚å¤´ç›¸å…³å˜é‡<a class="headerlink" href="#334http-è¯·æ±‚å¤´ç›¸å…³å˜é‡" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ul> <li><code>$http_user_agent</code>ï¼šè¯·æ±‚çš„ <code>User-Agent</code> å¤´éƒ¨å­—æ®µçš„å€¼ã€‚</li> <li><code>$http_referer</code>ï¼šè¯·æ±‚çš„ <code>Referer</code> å¤´éƒ¨å­—æ®µçš„å€¼ã€‚</li> <li><code>$http_cookie</code>ï¼šè¯·æ±‚çš„ <code>Cookie</code> å¤´éƒ¨å­—æ®µçš„å€¼ã€‚</li> <li><code>$http_\*</code>ï¼šç”¨äºè®¿é—®ä»»æ„çš„è¯·æ±‚å¤´å­—æ®µï¼Œå¦‚ <code>$http_accept</code> è¡¨ç¤º <code>Accept</code> å¤´éƒ¨å­—æ®µçš„å€¼ã€‚</li> </ul> <p><br></p> <h4 id="335ssl-ç›¸å…³å˜é‡">3.3.5ã€SSL ç›¸å…³å˜é‡<a class="headerlink" href="#335ssl-ç›¸å…³å˜é‡" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ul> <li><code>$ssl_protocol</code>ï¼šå½“å‰è¯·æ±‚ä½¿ç”¨çš„ SSL åè®®ç‰ˆæœ¬ï¼Œå¦‚ <code>TLSv1.2</code>ã€‚</li> <li><code>$ssl_cipher</code>ï¼šå½“å‰ SSL è¿æ¥ä¸­ä½¿ç”¨çš„åŠ å¯†å¥—ä»¶ã€‚</li> <li><code>$ssl_client_cert</code>ï¼šå®¢æˆ·ç«¯è¯ä¹¦çš„è¯¦ç»†å†…å®¹ã€‚</li> <li><code>$ssl_client_fingerprint</code>ï¼šå®¢æˆ·ç«¯è¯ä¹¦çš„ SHA1 æŒ‡çº¹ã€‚</li> </ul> <p><br></p> <h4 id="336åœ°ç†ä½ç½®ç›¸å…³å˜é‡">3.3.6ã€åœ°ç†ä½ç½®ç›¸å…³å˜é‡<a class="headerlink" href="#336åœ°ç†ä½ç½®ç›¸å…³å˜é‡" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ul> <li><code>$geoip_country_code</code>ï¼šåŸºäº IP åœ°å€çš„å›½å®¶ä»£ç ï¼ˆå¦‚æœå¯ç”¨äº† GeoIP æ¨¡å—ï¼‰ã€‚</li> <li><code>$geoip_country_name</code>ï¼šåŸºäº IP åœ°å€çš„å›½å®¶åç§°ï¼ˆå¦‚æœå¯ç”¨äº† GeoIP æ¨¡å—ï¼‰ã€‚</li> </ul> <p><br></p> <h4 id="337å…¶ä»–å¸¸ç”¨å˜é‡">3.3.7ã€å…¶ä»–å¸¸ç”¨å˜é‡<a class="headerlink" href="#337å…¶ä»–å¸¸ç”¨å˜é‡" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ul> <li><code>$scheme</code>ï¼šè¯·æ±‚ä½¿ç”¨çš„åè®®ï¼Œé€šå¸¸æ˜¯ <code>http</code> æˆ– <code>https</code>ã€‚</li> <li><code>$document_root</code>ï¼šå½“å‰è¯·æ±‚çš„æ–‡æ¡£æ ¹ç›®å½•è·¯å¾„ã€‚</li> <li><code>$realpath_root</code>ï¼šå½“å‰è¯·æ±‚çš„æ–‡ä»¶çš„å®é™…ç‰©ç†è·¯å¾„ã€‚</li> <li><code>$limit_rate</code>ï¼šç”¨äºé™é€Ÿçš„å˜é‡ï¼Œå¯ä»¥åŠ¨æ€è®¾ç½®å“åº”çš„é€Ÿç‡ã€‚</li> <li><code>$pid</code>ï¼šNginx å·¥ä½œè¿›ç¨‹çš„ PIDã€‚</li> <li><code>$msec</code>ï¼šå½“å‰æ—¶é—´çš„æ¯«ç§’æ•°ã€‚</li> <li><code>$time_iso8601</code>ï¼šå½“å‰æ—¶é—´çš„ ISO 8601 æ ¼å¼ã€‚</li> <li><code>$time_local</code>ï¼šå½“å‰æ—¶é—´çš„æœ¬åœ°æ—¶é—´æ ¼å¼ã€‚</li> </ul> <p><br></p> <h4 id="338æ—¥å¿—ç›¸å…³å˜é‡">3.3.8ã€æ—¥å¿—ç›¸å…³å˜é‡<a class="headerlink" href="#338æ—¥å¿—ç›¸å…³å˜é‡" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <ul> <li><code>$request_time</code>ï¼šè¯·æ±‚å¤„ç†çš„æ€»æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚</li> <li><code>$upstream_response_time</code>ï¼šåç«¯æœåŠ¡å™¨å“åº”çš„æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚</li> <li><code>$upstream_addr</code>ï¼šåç«¯æœåŠ¡å™¨çš„åœ°å€ã€‚</li> <li><code>$upstream_status</code>ï¼šåç«¯æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚</li> </ul> <p><br></p> <h2 id="4åº”ç”¨åœºæ™¯">4ã€åº”ç”¨åœºæ™¯<a class="headerlink" href="#4åº”ç”¨åœºæ™¯" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <h3 id="41åå‘ä»£ç†">4.1ã€åå‘ä»£ç†<a class="headerlink" href="#41åå‘ä»£ç†" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>Nginx ä»£æ›¿æœåŠ¡ç«¯æ¥æ”¶è¯·æ±‚ï¼Œå¸¸ç”¨äºæœåŠ¡å™¨é›†ç¾¤ç¯å¢ƒï¼Œåå‘ä»£ç†å±è”½äº†å…·ä½“æŸä¸ªæœåŠ¡å™¨çš„åœ°å€ï¼Œå®¢æˆ·ç«¯ä¸çŸ¥é“æœ€ç»ˆè¯·æ±‚æ˜¯å“ªä¸ª Server å¤„ç†ï¼Œåå‘ä»£ç†å’Œ Server ç«¯åœ¨åŒä¸€ç½‘ç»œç¯å¢ƒä¸‹ï¼Œé€šå¸¸ä¸ºå†…ç½‘ã€‚</p> <p>å®¢æˆ·ç«¯è®¿é—®ç›®æ ‡æœåŠ¡å™¨ï¼Œåœ¨ç›®æ ‡æœåŠ¡å†…éƒ¨æœ‰ä¸€ä¸ªç»Ÿä¸€æ¥å…¥ç½‘å…³ï¼Œç”¨æ¥å°†è¯·æ±‚è½¬å‘è‡³åç«¯çœŸæ­£å¤„ç†çš„æœåŠ¡å™¨å¹¶è¿”å›ç»“æœã€‚è¿™ä¸ªè¿‡ç¨‹å½“ä¸­å®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“å®é™…æœåŠ¡å™¨åœ°å€ï¼Œä»£ç†å¯¹å®¢æˆ·ç«¯è€Œè¨€æ˜¯é€æ˜çš„ã€‚</p> <p><br></p> <p><strong>ç›¸å…³æŒ‡ä»¤</strong></p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="c1">#### åŸºæœ¬ä»£ç†å‚æ•°</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="k">proxy_pass</span><span class="w"> </span><span class="s">http://backend</span><span class="w">                       </span><span class="c1"># ä»£ç†æœåŠ¡</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="c1">#### è¯·æ±‚å’Œå“åº”å¤´è®¾ç½®</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="s">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span><span class="w">                    </span><span class="c1"># ä¸ºè½¬å‘çš„è¯·æ±‚è®¾ç½®ç‰¹å®šçš„HTTPå¤´</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="k">proxy_hide_header</span><span class="w"> </span><span class="s">X-Powered-By</span><span class="p">;</span><span class="w">                 </span><span class="c1"># éšè—ä¸Šæ¸¸æœåŠ¡å™¨å“åº”ä¸­æŒ‡å®šçš„å¤´éƒ¨å­—æ®µ</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="k">proxy_pass_header</span><span class="w"> </span><span class="s">Set-Cookie</span><span class="p">;</span><span class="w">                   </span><span class="c1"># å°†ä¸Šæ¸¸æœåŠ¡å™¨å“åº”ä¸­çš„æŒ‡å®šå¤´éƒ¨å­—æ®µä¼ é€’ç»™å®¢æˆ·ç«¯</span>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="k">proxy_set_body</span><span class="w"> </span><span class="nv">$request_body</span><span class="p">;</span><span class="w">                   </span><span class="c1"># è®¾ç½®è½¬å‘åˆ°ä¸Šæ¸¸æœåŠ¡å™¨çš„è¯·æ±‚ä½“</span>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="k">proxy_method</span><span class="w"> </span><span class="s">POST</span><span class="p">;</span><span class="w">                              </span><span class="c1"># ä¿®æ”¹è½¬å‘åˆ°ä¸Šæ¸¸æœåŠ¡å™¨çš„HTTPæ–¹æ³•</span>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="k">proxy_redirect</span><span class="w"> </span><span class="s">http://backend</span><span class="w"> </span><span class="s">http://frontend</span><span class="p">;</span><span class="w">  </span><span class="c1"># å°†ä¸Šæ¸¸æœåŠ¡å™¨çš„é‡å®šå‘URLä¿®æ”¹ä¸ºå®¢æˆ·ç«¯å¯è®¿é—®çš„URL</span>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a><span class="c1">#### è¿æ¥è®¾ç½®</span>
</span><span id="__span-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a><span class="k">proxy_connect_timeout</span><span class="w"> </span><span class="s">90s</span><span class="p">;</span><span class="w">                      </span><span class="c1"># ä¸ä¸Šæ¸¸æœåŠ¡å™¨å»ºç«‹è¿æ¥çš„è¶…æ—¶æ—¶é—´</span>
</span><span id="__span-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a><span class="k">proxy_send_timeout</span><span class="w"> </span><span class="s">90s</span><span class="p">;</span><span class="w">                         </span><span class="c1"># å‘ä¸Šæ¸¸æœåŠ¡å™¨å‘é€è¯·æ±‚çš„è¶…æ—¶æ—¶é—´</span>
</span><span id="__span-36-15"><a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a><span class="k">proxy_read_timeout</span><span class="w"> </span><span class="s">90s</span><span class="p">;</span><span class="w">                         </span><span class="c1"># ä»ä¸Šæ¸¸æœåŠ¡å™¨è¯»å–å“åº”çš„è¶…æ—¶æ—¶é—´</span>
</span><span id="__span-36-16"><a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a><span class="k">proxy_buffer_size</span><span class="w"> </span><span class="mi">4k</span><span class="p">;</span><span class="w">                           </span><span class="c1"># è®¾ç½®ä»ä¸Šæ¸¸æœåŠ¡å™¨è¯»å–çš„å•ä¸ªç¼“å†²åŒºçš„å¤§å°</span>
</span><span id="__span-36-17"><a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a><span class="k">proxy_buffers</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">32k</span><span class="p">;</span><span class="w">                            </span><span class="c1"># å®šä¹‰ä»ä¸Šæ¸¸æœåŠ¡å™¨è¯»å–å“åº”çš„ç¼“å†²åŒºæ•°é‡å’Œå¤§å°</span>
</span><span id="__span-36-18"><a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a><span class="k">proxy_busy_buffers_size</span><span class="w"> </span><span class="mi">64k</span><span class="p">;</span><span class="w">                    </span><span class="c1"># å½“ä»£ç†å“åº”è¾ƒå¤§æ—¶ï¼Œå¯ä»¥è®¾ç½®ä¸€ä¸ªé¢å¤–çš„ç¼“å†²åŒº</span>
</span><span id="__span-36-19"><a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a><span class="k">proxy_temp_file_write_size</span><span class="w"> </span><span class="mi">64k</span><span class="p">;</span><span class="w">                 </span><span class="c1"># è®¾ç½®å†™å…¥ä¸´æ—¶æ–‡ä»¶çš„æœ€å¤§å¤§å°</span>
</span><span id="__span-36-20"><a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a>
</span><span id="__span-36-21"><a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a><span class="c1">#### ç¼“å­˜è®¾ç½®</span>
</span><span id="__span-36-22"><a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a><span class="k">proxy_cache</span><span class="w"> </span><span class="s">my_cache</span><span class="p">;</span><span class="w">                           </span><span class="c1"># å¯ç”¨ç¼“å­˜å¹¶æŒ‡å®šç¼“å­˜åŒºåŸŸ</span>
</span><span id="__span-36-23"><a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a><span class="k">proxy_cache_key</span><span class="w"> </span><span class="nv">$scheme$proxy_host$request_uri</span><span class="p">;</span><span class="w"> </span><span class="c1"># å®šä¹‰ç¼“å­˜æ¡ç›®çš„é”®</span>
</span><span id="__span-36-24"><a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a><span class="k">proxy_cache_valid</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="mi">302</span><span class="w"> </span><span class="mi">10m</span><span class="p">;</span><span class="w">                  </span><span class="c1"># å®šä¹‰ç¼“å­˜çš„æœ‰æ•ˆæ—¶é—´</span>
</span><span id="__span-36-25"><a id="__codelineno-36-25" name="__codelineno-36-25" href="#__codelineno-36-25"></a><span class="k">proxy_cache_min_uses</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">                         </span><span class="c1"># è®¾ç½®ä¸€ä¸ªè¯·æ±‚å¿…é¡»è®¿é—®çš„æ¬¡æ•°æ‰èƒ½è¢«ç¼“å­˜</span>
</span><span id="__span-36-26"><a id="__codelineno-36-26" name="__codelineno-36-26" href="#__codelineno-36-26"></a><span class="k">proxy_cache_use_stale</span><span class="w"> </span><span class="s">error</span><span class="w"> </span><span class="s">timeout</span><span class="w"> </span><span class="s">updating</span><span class="p">;</span><span class="w">   </span><span class="c1"># åœ¨ä¸Šæ¸¸æœåŠ¡å™¨ä¸å¯ç”¨æ—¶ï¼Œä½¿ç”¨é™ˆæ—§çš„ç¼“å­˜</span>
</span><span id="__span-36-27"><a id="__codelineno-36-27" name="__codelineno-36-27" href="#__codelineno-36-27"></a><span class="k">proxy_cache_bypass</span><span class="w"> </span><span class="nv">$cookie_nocache</span><span class="p">;</span><span class="w">             </span><span class="c1"># æŒ‡å®šåœ¨ç‰¹å®šæ¡ä»¶ä¸‹ç»•è¿‡ç¼“å­˜</span>
</span><span id="__span-36-28"><a id="__codelineno-36-28" name="__codelineno-36-28" href="#__codelineno-36-28"></a>
</span><span id="__span-36-29"><a id="__codelineno-36-29" name="__codelineno-36-29" href="#__codelineno-36-29"></a><span class="c1">#### SSLè®¾ç½®</span>
</span><span id="__span-36-30"><a id="__codelineno-36-30" name="__codelineno-36-30" href="#__codelineno-36-30"></a><span class="k">proxy_ssl_certificate</span><span class="w"> </span><span class="s">/etc/nginx/ssl/client.crt</span><span class="p">;</span><span class="w">        </span><span class="c1"># æŒ‡å®šç”¨äºä¸ä¸Šæ¸¸æœåŠ¡å™¨é€šä¿¡çš„å®¢æˆ·ç«¯è¯ä¹¦</span>
</span><span id="__span-36-31"><a id="__codelineno-36-31" name="__codelineno-36-31" href="#__codelineno-36-31"></a><span class="k">proxy_ssl_certificate_key</span><span class="w"> </span><span class="s">/etc/nginx/ssl/client.key</span><span class="p">;</span><span class="w">    </span><span class="c1"># æŒ‡å®šç”¨äºä¸ä¸Šæ¸¸æœåŠ¡å™¨é€šä¿¡çš„å®¢æˆ·ç«¯è¯ä¹¦å¯†é’¥</span>
</span><span id="__span-36-32"><a id="__codelineno-36-32" name="__codelineno-36-32" href="#__codelineno-36-32"></a><span class="k">proxy_ssl_protocols</span><span class="w"> </span><span class="s">TLSv1.2</span><span class="w"> </span><span class="s">TLSv1.3</span><span class="p">;</span><span class="w">                    </span><span class="c1"># è®¾ç½®Nginxä¸ä¸Šæ¸¸æœåŠ¡å™¨é€šä¿¡æ—¶ä½¿ç”¨çš„SSL/TLSåè®®</span>
</span><span id="__span-36-33"><a id="__codelineno-36-33" name="__codelineno-36-33" href="#__codelineno-36-33"></a><span class="k">proxy_ssl_ciphers</span><span class="w"> </span><span class="s">HIGH:!aNULL:!MD5</span><span class="p">;</span><span class="w">                     </span><span class="c1"># è®¾ç½®Nginxä¸ä¸Šæ¸¸æœåŠ¡å™¨é€šä¿¡æ—¶ä½¿ç”¨çš„åŠ å¯†å¥—ä»¶</span>
</span><span id="__span-36-34"><a id="__codelineno-36-34" name="__codelineno-36-34" href="#__codelineno-36-34"></a><span class="k">proxy_ssl_verify</span><span class="w"> </span><span class="no">on</span><span class="p">;</span><span class="w">                                    </span><span class="c1"># å¯ç”¨æˆ–ç¦ç”¨å¯¹ä¸Šæ¸¸æœåŠ¡å™¨è¯ä¹¦çš„éªŒè¯</span>
</span><span id="__span-36-35"><a id="__codelineno-36-35" name="__codelineno-36-35" href="#__codelineno-36-35"></a><span class="k">proxy_ssl_verify_depth</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">                               </span><span class="c1"># è®¾ç½®éªŒè¯ä¸Šæ¸¸æœåŠ¡å™¨è¯ä¹¦æ—¶çš„æœ€å¤§é“¾æ·±åº¦</span>
</span></code></pre></div> <p><br></p> <p><strong>è·¯å¾„æœ«å°¾æ˜¯å¦å¸¦æ–œæ†</strong></p> <p>å¦‚æœ <code>proxy_pass</code> ä¸å¸¦æ–œæ ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="k">location</span><span class="w"> </span><span class="s">/txffc/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="w">    </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://localhost:8082</span><span class="p">;</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="p">}</span>
</span></code></pre></div> <p>è®¿é—® URL æ˜¯ http://192.168.231.128/txffc/commonï¼ŒæŒ‡å‘çš„åœ°å€å®é™…æ˜¯ï¼šhttp://localhost:8082/txffc/commonï¼Œå³ Nginx ä¼šæŠŠåŒ…æ‹¬åŒ¹é…åˆ°çš„å†…å®¹éƒ½è¿½åŠ åˆ° <code>proxy_pass</code> åœ°å€åé¢ã€‚</p> <p>å¦‚æœ <code>proxy_pass</code> å¸¦ä¸Šæ–œæ ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="k">location</span><span class="w"> </span><span class="s">/txffc/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="w">    </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://localhost:8082/</span><span class="p">;</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="p">}</span>
</span></code></pre></div> <p>è®¿é—® URL æ˜¯ http://192.168.231.128/txffc/commonï¼ŒæŒ‡å‘çš„åœ°å€å®é™…æ˜¯ï¼šhttp://localhost:8082/commonï¼Œå³ Nginx ä¸ä¼šæŠŠåŒ¹é…åˆ°çš„å†…å®¹è¿½åŠ åˆ° <code>proxy_pass</code> åœ°å€åé¢ã€‚</p> <div class="admonition tip"> <p class="admonition-title">Tip</p> <p>å¤§éƒ¨åˆ†æƒ…å†µæ¨èå¸¦æ–œæ çš„ <code>proxy_pass</code> å†™æ³•ï¼ˆæ§åˆ¶æ›´æ¸…æ™°ï¼‰ã€‚</p> </div> <p><br></p> <p><strong>é…ç½®ç¤ºä¾‹</strong></p> <p>ä¸‹é¢æ˜¯ä¸€ä¸ªå‰åç«¯åˆ†ç¦»éƒ¨ç½²çš„ç¤ºä¾‹ï¼ŒæŠŠå‰ç«¯ç«™ç‚¹éƒ¨ç½²åˆ° Nginxï¼ŒNginx åå‘ä»£ç†åç«¯æœåŠ¡ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="k">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">xxx.com</span><span class="p">;</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="w">    </span><span class="c1"># å‰ç«¯é…ç½®</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="w">        </span><span class="c1"># å‰ç«¯ç«™ç‚¹è·¯å¾„</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="w">        </span><span class="kn">root</span><span class="w"> </span><span class="s">/home/vue/dist</span><span class="p">;</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a><span class="w">        </span><span class="kn">index</span><span class="w"> </span><span class="s">index.html</span>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="w">    </span><span class="err">}</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a><span class="w">    </span><span class="c1"># åç«¯é…ç½®</span>
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a><span class="w">    </span><span class="s">location</span><span class="w"> </span><span class="s">/api/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a><span class="w">        </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">host</span><span class="w"> </span><span class="nv">$HOST</span><span class="p">;</span>
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a><span class="w">        </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://192.168.1.101:8081/</span><span class="p">;</span>
</span><span id="__span-39-16"><a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-39-17"><a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a><span class="p">}</span>
</span></code></pre></div> <p><br></p> <h3 id="42è´Ÿè½½å‡è¡¡">4.2ã€è´Ÿè½½å‡è¡¡<a class="headerlink" href="#42è´Ÿè½½å‡è¡¡" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>åœ¨é…ç½®é¡¹ <code>upstream</code> ä¸­ï¼Œè´Ÿè´£æä¾›å¯ç”¨çš„æœåŠ¡åœ°å€åˆ—è¡¨å¹¶ä¸”å¯ä»¥æŒ‡å®šè´Ÿè½½å‡è¡¡çš„å®ç°æ–¹å¼ã€‚</p> <p><br></p> <p><strong>è½®è¯¢-Round-Robin</strong></p> <p>å°†è®¿é—®æŒ‰åºä¾æ¬¡è¯·æ±‚åˆ°åç«¯å„ä¸ªæœåŠ¡å™¨ä¸Šï¼Œèƒ½ç¡®ä¿å¹³å‡è´Ÿè½½ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="k">upstream</span><span class="w"> </span><span class="s">backend-a</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.101</span><span class="p">:</span><span class="mi">80</span><span class="p">;</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.102</span><span class="p">:</span><span class="mi">80</span><span class="p">;</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="p">}</span>
</span></code></pre></div> <p><br></p> <p><strong>æƒé‡-Weight</strong></p> <p>æŒ‰ç™¾åˆ†æ¯”è¯·æ±‚åˆ°åç«¯æœåŠ¡å™¨ä¸Šï¼Œå¸¸ç”¨åˆ°ç¡¬ä»¶é…ç½®ä¸åŒçš„åœºæ™¯ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="k">upstream</span><span class="w"> </span><span class="s">backend-b</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.101</span><span class="p">:</span><span class="mi">80</span><span class="w"> </span><span class="s">weight=3</span><span class="p">;</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.102</span><span class="p">:</span><span class="mi">80</span><span class="w"> </span><span class="s">weight=7</span><span class="p">;</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="p">}</span>
</span></code></pre></div> <p><br></p> <p><strong>æœ€å°‘è¿æ¥-Least-Connect</strong></p> <p>å¤„ç†è¯·æ±‚å°‘çš„åç«¯æœåŠ¡ä¼˜å…ˆæ¥æ”¶æ–°è¯·æ±‚ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="k">upstream</span><span class="w"> </span><span class="s">backend-c</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="w">    </span><span class="kn">least_conn</span><span class="p">;</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.101</span><span class="p">:</span><span class="mi">80</span><span class="p">;</span>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.102</span><span class="p">:</span><span class="mi">80</span><span class="p">;</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="p">}</span>
</span></code></pre></div> <p><br></p> <p><strong>IP-Hash</strong></p> <p>ç›¸åŒçš„è®¿é—® IP è½åˆ°åç«¯åŒä¸ªæœåŠ¡å™¨ä¸Šï¼Œæ‰€ä»¥æ”¯æŒä¼šè¯ä¿æŒï¼Œä½†ä¸æ˜¯ç»å¯¹å¹³å‡è´Ÿè½½ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="k">upstream</span><span class="w"> </span><span class="s">backend-d</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="w">    </span><span class="kn">ip_hash</span><span class="p">;</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.101</span><span class="p">:</span><span class="mi">80</span><span class="p">;</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.102</span><span class="p">:</span><span class="mi">80</span><span class="p">;</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="p">}</span>
</span></code></pre></div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>ç¬¬ä¸‰æ–¹çš„ä¼šè¯ä¿æŒ sticky_cookie_insertï¼ŒåŒæ—¶æ”¯æŒè´Ÿè½½å‡è¡¡ã€‚</p> </div> <p><br></p> <h3 id="43é™æµä¸ç†”æ–­">4.3ã€é™æµä¸ç†”æ–­<a class="headerlink" href="#43é™æµä¸ç†”æ–­" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <h4 id="431é™æµ">4.3.1ã€é™æµ<a class="headerlink" href="#431é™æµ" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>é€šè¿‡å¯¹å¹¶å‘/è¯·æ±‚è¿›è¡Œé™é€Ÿæ¥ä¿æŠ¤ç³»ç»Ÿï¼Œé˜²æ­¢ç³»ç»Ÿè¿‡è½½ç˜«ç—ªè€Œä¸èƒ½æä¾›æœåŠ¡ï¼›ä¸ºäº†æ›´å¥½æ§åˆ¶æ•´ä¸ªç³»ç»Ÿçš„è´Ÿè½½æƒ…å†µï¼Œå³ä½¿é˜»æ­¢äº†æŸäº›è¯·æ±‚ï¼Œç³»ç»Ÿç»§ç»­æä¾›æœåŠ¡ã€‚</p> <p><br></p> <p><strong>http_limit_conn</strong></p> <p>å•ä¸ª IP åŒæ—¶å…è®¸çš„è¿æ¥é™åˆ¶ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="k">http</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="w">    </span><span class="c1"># è¿æ¥é™æµå®šä¹‰</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="w">    </span><span class="c1"># - $binary_remote_addrï¼šé™åˆ¶å¯¹è±¡(å®¢æˆ·ç«¯)</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="w">    </span><span class="c1"># - zoneï¼šé™åˆ¶è‡ªå®šä¹‰åç§°</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="w">    </span><span class="c1"># - 10ï¼šå†…å­˜ä¸­ç”¨10å…†ç©ºé—´å­˜å‚¨è¿æ¥è®°å½•</span>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="w">    </span><span class="kn">limit_conn_zone</span><span class="w"> </span><span class="nv">$binary_remote_addr</span><span class="w"> </span><span class="s">zone=</span><span class="p">{</span><span class="kn">limits-name}:10m</span><span class="p">;</span>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/search/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-10"><a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a>
</span><span id="__span-44-11"><a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a><span class="w">            </span><span class="c1"># å•ä¸ªIPåŒæ—¶å…è®¸å»ºç«‹å¤šå°‘è¿æ¥ï¼ˆå¹¶å‘é™åˆ¶ï¼‰</span>
</span><span id="__span-44-12"><a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a><span class="w">            </span><span class="kn">limit_conn</span><span class="w"> </span><span class="p">{</span><span class="kn">limits-name}</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-44-13"><a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-44-14"><a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-44-15"><a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a><span class="p">}</span>
</span></code></pre></div> <p><br></p> <p><strong>http_limit_req</strong></p> <p>å•ä¸ª IP è¯·æ±‚é¢‘ç‡çš„é™åˆ¶ï¼ˆæ¬¡/æ¯ç§’ï¼‰ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="k">http</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="w">    </span><span class="c1"># è¯·æ±‚é™æµå®šä¹‰</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="w">    </span><span class="c1"># - $binary_remote_addrï¼šé™åˆ¶å¯¹è±¡(å®¢æˆ·ç«¯)</span>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="w">    </span><span class="c1"># - zoneï¼šå®šä¹‰é™åˆ¶(ç­–ç•¥)åç§°</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="w">    </span><span class="c1"># - 10mï¼šç”¨åå…†ç©ºé—´è®°å½•è®¿é—®æ¬¡æ•°</span>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="w">    </span><span class="c1"># - rateï¼šæ¯ç§’10æ¬¡çš„è¯·æ±‚å¤„ç†é€Ÿç‡</span>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="w">    </span><span class="kn">limit_req_zone</span><span class="w"> </span><span class="nv">$binary_remote_addr</span><span class="w"> </span><span class="s">zone=</span><span class="p">{</span><span class="kn">limits-name}:10m</span><span class="w"> </span><span class="s">rate=1r/s</span><span class="p">;</span>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a><span class="w">    </span><span class="c1"># è¯·æ±‚é™æµå®šä¹‰</span>
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="w">    </span><span class="c1"># - $server_nameï¼šé™åˆ¶å¯¹è±¡ï¼Œå¯¹æŒ‡å®šæœåŠ¡å™¨è¯·æ±‚çš„é™åˆ¶</span>
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="w">    </span><span class="kn">limit_req_zone</span><span class="w"> </span><span class="nv">$server_name</span><span class="w"> </span><span class="s">zone=</span><span class="p">{</span><span class="kn">limits-name}:10m</span><span class="w"> </span><span class="s">rate=10r/s</span><span class="p">;</span>
</span><span id="__span-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a>
</span><span id="__span-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-13"><a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a><span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/search/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-14"><a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a><span class="w">            </span><span class="c1"># å¼•ç”¨ä»¥ä¸Šå®šä¹‰çš„é™æµç­–ç•¥ï¼Œåšä»¥ä¸‹è®¾å®šï¼ˆæ¼æ¡¶æ–¹å¼ï¼‰</span>
</span><span id="__span-45-15"><a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a><span class="w">            </span><span class="c1"># - burstï¼šæœ€å¤šæ¥æ”¶5ä¸ªæ’é˜Ÿç”¨æˆ·IPï¼Œå¤„äºç­‰å¾…å¤„ç†çŠ¶æ€ï¼ˆå®¹é‡ï¼‰</span>
</span><span id="__span-45-16"><a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a><span class="w">            </span><span class="c1"># - nodelayï¼šè¶…å‡ºæ’é˜Ÿä¹‹å¤–çš„æ›´å¤šè¯·æ±‚ï¼Œæ‹’ç»å¹¶è¿”å›503ï¼ˆæº¢å‡ºï¼‰</span>
</span><span id="__span-45-17"><a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a><span class="w">            </span><span class="kn">limit_req</span><span class="w"> </span><span class="s">zone=</span><span class="p">{</span><span class="kn">limits-name}</span><span class="w"> </span><span class="s">[burst=5]</span><span class="w"> </span><span class="s">[nodelay]</span><span class="p">;</span>
</span><span id="__span-45-18"><a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-45-19"><a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-45-20"><a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a><span class="p">}</span>
</span></code></pre></div> <p><br></p> <p><strong>http_limit_rate</strong></p> <p>å‘å®¢æˆ·ç«¯ä¼ è¾“å“åº”çš„é€Ÿç‡é™åˆ¶ï¼ˆå­—èŠ‚/æ¯ç§’/æ¯è¿æ¥ï¼Œ0 ä¸é™åˆ¶ï¼‰ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="k">http</span><span class="w"> </span><span class="p">{</span><span class="w">   </span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/download/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="w">            </span><span class="c1"># å¸¦å®½é™åˆ¶</span>
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="w">            </span><span class="kn">limit_rate_after</span><span class="w"> </span><span class="mi">5m</span><span class="p">;</span><span class="w"> </span><span class="c1"># åˆå§‹é™é€Ÿ5m</span>
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a><span class="w">            </span><span class="kn">limit_rate</span><span class="w"> </span><span class="mi">500k</span><span class="p">;</span><span class="w">     </span><span class="c1"># è¶…å‡ºåé™é€Ÿ500k</span>
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="p">}</span>
</span></code></pre></div> <p><br></p> <h4 id="432ç†”æ–­">4.3.2ã€ç†”æ–­<a class="headerlink" href="#432ç†”æ–­" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>å½“åç«¯æœåŠ¡å‘ç”ŸæŒ‡å®šé¢‘ç‡é”™è¯¯åï¼ŒNginx è§¦å‘ç†”æ–­æªæ–½ï¼Œä¸å†è¯·æ±‚æ­¤åç«¯æœåŠ¡ï¼Œç›´æ¥è¿”å›é»˜è®¤å†…å®¹åˆ°ç”¨æˆ·ç«¯ã€‚</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="k">upstream</span><span class="w"> </span><span class="s">http_backend</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="w">    </span><span class="c1"># 10så†…å‡ºç°3æ¬¡é”™è¯¯ï¼Œè¯¥æœåŠ¡å™¨å°†è¢«è§†ä¸ºä¸å¯ç”¨(ç†”æ–­)</span>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.101</span><span class="p">:</span><span class="mi">8080</span><span class="w"> </span><span class="s">max_fails=3</span><span class="w"> </span><span class="s">fail_timeout=10s</span><span class="p">;</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.102</span><span class="p">:</span><span class="mi">8080</span><span class="w"> </span><span class="s">max_fails=3</span><span class="w"> </span><span class="s">fail_timeout=10s</span><span class="p">;</span>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="p">}</span>
</span></code></pre></div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>å½“ç„¶ä¹Ÿæœ‰å®¹é”™æœºåˆ¶ï¼ŒNginx é»˜è®¤è‡ªåŠ¨è½¬å‘å…¶å®ƒæœåŠ¡å†è¯·æ±‚ï¼Œç›¸å…³é…ç½®ï¼š<code>proxy_next_upstream</code></p> </div> <p><br></p> <h3 id="44tcpudp-å¤„ç†">4.4ã€TCP/UDP å¤„ç†<a class="headerlink" href="#44tcpudp-å¤„ç†" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>Nginx Stream æ¨¡å—æ˜¯ Nginx çš„ä¸€ä¸ªæ‰©å±•æ¨¡å—ï¼ˆ1.9.0 å¼€å§‹åŠ å…¥ï¼‰ï¼Œä¸»è¦ç”¨äºå¤„ç†å››å±‚åè®®ï¼ˆä¼ è¾“å±‚ï¼‰çš„æµé‡ï¼Œå¦‚ TCP å’Œ UDPã€‚</p> <p>ä¸ä¼ ç»Ÿçš„ <code>http</code> å—ä¸åŒï¼Œ<code>stream</code> å—ä¸ç”¨äºå¤„ç† HTTP è¯·æ±‚ï¼Œè€Œæ˜¯ç”¨äºå¤„ç†è¯¸å¦‚æ•°æ®åº“è¿æ¥ã€é‚®ä»¶æœåŠ¡æˆ–å…¶ä»–åŸºäº TCP/UDP çš„åº”ç”¨ç¨‹åºçš„æµé‡ã€‚</p> <p><code>stream</code> æ¨¡å—ç”¨æ³•å’Œ <code>http</code> æ¨¡å—å·®ä¸å¤šï¼Œè¯­æ³•å‡ ä¹ä¸€è‡´ã€‚</p> <p><br></p> <p><strong><code>stream</code> å—çš„ä¸»è¦åŠŸèƒ½</strong></p> <ul> <li>TCP/UDP è´Ÿè½½å‡è¡¡ï¼š<code>stream</code> å—å¯ä»¥é…ç½® Nginx ä½œä¸º TCP æˆ– UDP çš„åå‘ä»£ç†ï¼Œå°†æ¥è‡ªå®¢æˆ·ç«¯çš„æµé‡åˆ†å‘åˆ°å¤šä¸ªä¸Šæ¸¸æœåŠ¡å™¨ï¼Œä»è€Œå®ç°è´Ÿè½½å‡è¡¡ã€‚</li> <li>SSL å¸è½½ï¼š<code>stream</code> å—æ”¯æŒåœ¨ Nginx ä¸Šç»ˆæ­¢ SSL/TLS è¿æ¥ï¼Œä»è€Œå‡å°‘åç«¯æœåŠ¡å™¨çš„è´Ÿæ‹…ã€‚</li> <li>åŸºäº SNI çš„è·¯ç”±ï¼šé€šè¿‡æœåŠ¡å™¨åç§°æŒ‡ç¤ºï¼ˆSNIï¼‰ï¼Œ<code>stream</code> å—å¯ä»¥åŸºäº SSL æ¡æ‰‹ä¸­çš„ SNI ä¿¡æ¯å°†æµé‡è·¯ç”±åˆ°ä¸åŒçš„ä¸Šæ¸¸æœåŠ¡å™¨ã€‚</li> <li>è®¿é—®æ§åˆ¶ï¼šæ”¯æŒé€šè¿‡é™åˆ¶æ¨¡å—è®¾ç½® IP è®¿é—®æ§åˆ¶ã€‚</li> </ul> <p><br></p> <p><strong>é…ç½®ç¤ºä¾‹</strong></p> <p>ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ <code>stream</code> å—é…ç½®ç¤ºä¾‹ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="k">stream</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="w">    </span><span class="c1"># å®šä¹‰ä¸€ç»„ä¸Šæ¸¸æœåŠ¡å™¨ï¼Œç”¨äºè´Ÿè½½å‡è¡¡ã€‚</span>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="w">    </span><span class="kn">upstream</span><span class="w"> </span><span class="s">backend</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="w">        </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.101</span><span class="p">:</span><span class="mi">3306</span><span class="p">;</span>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a><span class="w">        </span><span class="kn">server</span><span class="w"> </span><span class="n">192.168.1.102</span><span class="p">:</span><span class="mi">3306</span><span class="p">;</span>
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a>
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a><span class="w">        </span><span class="kn">listen</span><span class="w"> </span><span class="mi">3306</span><span class="p">;</span><span class="w">                </span><span class="c1"># æŒ‡å®šNginxç›‘å¬çš„ç«¯å£æˆ–IPåœ°å€ã€‚</span>
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a><span class="w">        </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">backend</span><span class="p">;</span><span class="w">         </span><span class="c1"># å°†æµé‡è½¬å‘åˆ°æŒ‡å®šçš„ä¸Šæ¸¸æœåŠ¡å™¨æˆ–æœåŠ¡å™¨ç»„ã€‚</span>
</span><span id="__span-48-11"><a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a><span class="w">        </span><span class="kn">proxy_timeout</span><span class="w"> </span><span class="s">1s</span><span class="p">;</span><span class="w">           </span><span class="c1"># å®šä¹‰ä»£ç†è¿æ¥çš„è¶…æ—¶æ—¶é—´ã€‚</span>
</span><span id="__span-48-12"><a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a><span class="w">        </span><span class="kn">proxy_connect_timeout</span><span class="w"> </span><span class="s">1s</span><span class="p">;</span><span class="w">   </span><span class="c1"># è®¾ç½®è¿æ¥åˆ°ä¸Šæ¸¸æœåŠ¡å™¨çš„è¶…æ—¶æ—¶é—´ã€‚</span>
</span><span id="__span-48-13"><a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-48-14"><a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a><span class="p">}</span>
</span></code></pre></div> <div class="admonition warning"> <p class="admonition-title">Caution</p> <p><code>stream</code> å—é…ç½®ä¸ <code>http</code> å—å¹¶åˆ—ã€‚</p> </div> <p><br></p> <h3 id="45websocket-ä»£ç†">4.5ã€WebSocket ä»£ç†<a class="headerlink" href="#45websocket-ä»£ç†" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>è¦å°†å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥ä» HTTP/1.1 è½¬æ¢ä¸º WebSocketï¼Œå¯ä»¥ä½¿ç”¨ HTTP/1.1 ä¸­çš„ <a href="https://tools.ietf.org/html/rfc2616#section-14.42">åè®®åˆ‡æ¢</a> æœºåˆ¶ã€‚</p> <p>ç„¶è€Œï¼Œæœ‰ä¸€ä¸ªå¾®å¦™çš„åœ°æ–¹ï¼šç”±äº <code>Upgrade</code> æ˜¯ä¸€ä¸ª<a href="https://tools.ietf.org/html/rfc2616#section-13.5.1">é€è·³</a>ï¼ˆhop-by-hopï¼‰å¤´ï¼Œå®ƒä¸ä¼šä»å®¢æˆ·ç«¯ä¼ é€’åˆ°ä»£ç†æœåŠ¡å™¨ã€‚å½“ä½¿ç”¨è½¬å‘ä»£ç†æ—¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨ <code>CONNECT</code> æ–¹æ³•æ¥è§„é¿æ­¤é—®é¢˜ã€‚ç„¶è€Œï¼Œè¿™ä¸é€‚ç”¨äºåå‘ä»£ç†ï¼Œå› ä¸ºå®¢æˆ·ç«¯ä¸çŸ¥é“ä»»ä½•ä»£ç†æœåŠ¡å™¨ï¼Œè¿™éœ€è¦åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šè¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚</p> <p>è‡ª 1.3.13 ç‰ˆæœ¬ä»¥æ¥ï¼ŒNginx å®ç°äº†ç‰¹æ®Šçš„æ“ä½œæ¨¡å¼ï¼Œå¦‚æœä»£ç†æœåŠ¡å™¨è¿”å›ä¸€ä¸ª 101å“åº”ç ï¼ˆäº¤æ¢åè®®ï¼‰ï¼Œåˆ™å®¢æˆ·æœºå’Œä»£ç†æœåŠ¡å™¨ä¹‹é—´å°†å»ºç«‹éš§é“ï¼Œå®¢æˆ·ç«¯ é€šè¿‡è¯·æ±‚ä¸­çš„ <code>Upgrade</code> å¤´æ¥è¯·æ±‚åè®®äº¤æ¢ã€‚</p> <p>å¦‚ä¸Šæ‰€è¿°ï¼ŒåŒ…æ‹¬ <code>Upgrade</code> å’Œ <code>Connection</code> çš„é€è·³å¤´ä¸ä¼šä»å®¢æˆ·ç«¯ä¼ é€’åˆ°ä»£ç†æœåŠ¡å™¨ï¼Œå› æ­¤ä¸ºäº†ä½¿ä»£ç†æœåŠ¡å™¨çŸ¥é“å®¢æˆ·ç«¯å°†åè®®åˆ‡æ¢åˆ° WebSocket çš„æ„å›¾ï¼Œè¿™äº›å¤´å¿…é¡»æ˜ç¡®åœ°ä¼ é€’ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="k">location</span><span class="w"> </span><span class="s">/chat/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="w">    </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://backend</span><span class="p">;</span>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="w">    </span><span class="kn">proxy_http_version</span><span class="w"> </span><span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="w">    </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Upgrade</span><span class="w"> </span><span class="nv">$http_upgrade</span><span class="p">;</span>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="w">    </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Connection</span><span class="w"> </span><span class="s">"upgrade"</span><span class="p">;</span>
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="p">}</span>
</span></code></pre></div> <p>ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­æ˜¯ï¼Œå¯¹ä»£ç†æœåŠ¡å™¨çš„è¯·æ±‚ä¸­çš„ <code>Connection</code> å¤´å­—æ®µçš„å€¼å–å†³äºå®¢æˆ·ç«¯è¯·æ±‚å¤´ä¸­çš„ <code>Upgrade</code> å­—æ®µçš„å­˜åœ¨ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="k">http</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="w">    </span><span class="kn">map</span><span class="w"> </span><span class="nv">$http_upgrade</span><span class="w"> </span><span class="nv">$connection_upgrade</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="w">        </span><span class="kn">default</span><span class="w"> </span><span class="s">upgrade</span><span class="p">;</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="w">        </span><span class="kn">''</span><span class="w">      </span><span class="s">close</span><span class="p">;</span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="w">        </span><span class="kn">...</span>
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a>
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="w">        </span><span class="s">location</span><span class="w"> </span><span class="s">/chat/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a><span class="w">            </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://backend</span><span class="p">;</span>
</span><span id="__span-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a><span class="w">            </span><span class="kn">proxy_http_version</span><span class="w"> </span><span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span><span id="__span-50-13"><a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a><span class="w">            </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Upgrade</span><span class="w"> </span><span class="nv">$http_upgrade</span><span class="p">;</span>
</span><span id="__span-50-14"><a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a><span class="w">            </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Connection</span><span class="w"> </span><span class="nv">$connection_upgrade</span><span class="p">;</span>
</span><span id="__span-50-15"><a id="__codelineno-50-15" name="__codelineno-50-15" href="#__codelineno-50-15"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-50-16"><a id="__codelineno-50-16" name="__codelineno-50-16" href="#__codelineno-50-16"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div> <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä»£ç†åŠ¡å™¨åœ¨ 60 ç§’å†…æ²¡æœ‰ä¼ è¾“ä»»ä½•æ•°æ®ï¼Œè¿æ¥å°†è¢«å…³é—­ã€‚è¿™ä¸ªè¶…æ—¶å¯ä»¥é€šè¿‡ <code>proxy_read_timeout</code> æŒ‡ä»¤æ¥å¢åŠ ã€‚ æˆ–è€…ï¼Œä»£ç†æœåŠ¡å™¨å¯ä»¥é…ç½®ä¸ºå®šæœŸå‘é€ WebSocket ping å¸§ä»¥é‡ç½®è¶…æ—¶å¹¶æ£€æŸ¥è¿æ¥æ˜¯å¦ä»ç„¶æ´»è·ƒã€‚</p> <p><br></p> <h2 id="4æ€§èƒ½ä¼˜åŒ–">4ã€æ€§èƒ½ä¼˜åŒ–<a class="headerlink" href="#4æ€§èƒ½ä¼˜åŒ–" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <h3 id="41å…¨å±€ä¼˜åŒ–">4.1ã€å…¨å±€ä¼˜åŒ–<a class="headerlink" href="#41å…¨å±€ä¼˜åŒ–" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="c1">## å·¥ä½œè¿›ç¨‹æ•°</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="k">worker_processes</span><span class="w"> </span><span class="s">auto</span><span class="p">;</span><span class="w">           </span><span class="c1"># å»ºè®® CPUæ ¸å¿ƒæ•°|CPUçº¿ç¨‹æ•°</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="c1">## æœ€å¤§æ”¯æŒçš„è¿æ¥(open-file)æ•°é‡ï¼›æœ€å¤§å€¼å—é™äº Linux open files (ulimit -n)</span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="c1">## å»ºè®®å…¬å¼ï¼šworker_rlimit_nofile &gt; worker_processes * worker_connections</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="k">worker_rlimit_nofile</span><span class="w">    </span><span class="mi">65535</span><span class="p">;</span>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a><span class="k">events</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a><span class="w">    </span><span class="kn">use</span><span class="w"> </span><span class="s">epoll</span><span class="p">;</span><span class="w">                   </span><span class="c1"># é«˜æ•ˆçš„IOå¤šè·¯å¤ç”¨ï¼ˆRedHat6+ éƒ½æ”¯æŒ epollï¼‰</span>
</span><span id="__span-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="w">    </span><span class="kn">multi_accept</span><span class="w"> </span><span class="no">on</span><span class="p">;</span><span class="w">             </span><span class="c1"># è®¾ç½®ä¸€ä¸ªè¿›ç¨‹æ˜¯å¦åŒæ—¶æ¥å—å¤šä¸ªç½‘ç»œè¿æ¥</span>
</span><span id="__span-51-11"><a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a><span class="w">    </span><span class="kn">worker_connections</span><span class="w">  </span><span class="mi">10240</span><span class="p">;</span><span class="w">   </span><span class="c1"># å•ä¸ªå·¥ä½œè¿›ç¨‹ï¼Œå¯æ‰¿è½½çš„æœ€å¤§è¿æ¥æ•°ï¼›</span>
</span><span id="__span-51-12"><a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a><span class="p">}</span>
</span></code></pre></div> <p><br></p> <h3 id="42ä¸å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼˜åŒ–">4.2ã€ä¸å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼˜åŒ–<a class="headerlink" href="#42ä¸å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼˜åŒ–" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="k">http</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a><span class="w">    </span><span class="c1">###### é›¶æ‹·è´æŠ€æœ¯</span>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="w">    </span><span class="kn">sendfile</span><span class="w"> </span><span class="no">on</span><span class="p">;</span><span class="w">            </span><span class="c1"># å¼€å¯ä¸è¯»åˆ°(åº”ç”¨æœ¬èº«)å†…å­˜ï¼Œç›´æ¥é€šè¿‡ç³»ç»Ÿå‘å‡ºæ•°æ®</span>
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a><span class="w">    </span><span class="c1">#sendfile_max_chunk 2m; # æ¯ä¸ªè¿›ç¨‹æ¯æ¬¡è°ƒç”¨ä¼ è¾“æ•°é‡ä¸èƒ½å¤§äºè®¾å®šçš„å€¼ï¼Œé»˜è®¤0ä¸ºæ— ä¸Šé™ã€‚</span>
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a>
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a><span class="w">    </span><span class="c1">###### ç½‘ç»œä¼ è¾“</span>
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a><span class="w">    </span><span class="c1"># onï¼šç´¯ç§¯åˆ°ä¸€å®šå®¹é‡çš„æ•°æ®å†å‘ï¼Œå‘é€æ¬¡æ•°å°‘</span>
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a><span class="w">    </span><span class="c1"># offï¼šæœ‰æ•°æ®å°±å‘ï¼Œå‘é€æ¬¡æ•°å¤šï¼Œå ç”¨ç½‘ç»œèµ„æº</span>
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a><span class="w">    </span><span class="kn">tcp_nopush</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
</span><span id="__span-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a>
</span><span id="__span-52-12"><a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a><span class="w">    </span><span class="c1">###### é•¿è¿æ¥ï¼›ç”¨æˆ·ç«¯æ¯”è¾ƒåˆ†æ•£ï¼Œkeepalive é»˜è®¤å€¼å·²ç»è¶³å¤Ÿï¼Œä¸ªäººä¸å»ºè®®é‡è®¾</span>
</span><span id="__span-52-13"><a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a>
</span><span id="__span-52-14"><a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a><span class="w">    </span><span class="c1">###### å“åº”æ•°æ® å¼€å¯å‹ç¼©æ¨¡å¼</span>
</span><span id="__span-52-15"><a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a><span class="w">    </span><span class="kn">gzip</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
</span><span id="__span-52-16"><a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a><span class="w">    </span><span class="kn">gzip_vary</span><span class="w"> </span><span class="no">on</span><span class="p">;</span><span class="w">                                </span><span class="c1"># ä¸ºå…¼å®¹è€æµè§ˆå™¨ï¼Œè¿½åŠ åˆ°Headerçš„å‹ç¼©æ ‡æ³¨</span>
</span><span id="__span-52-17"><a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a><span class="w">    </span><span class="kn">gzip_proxied</span><span class="w"> </span><span class="s">any</span><span class="p">;</span><span class="w">                            </span><span class="c1"># æ‰€æœ‰ä»£ç†è¯·æ±‚éƒ½å‹ç¼©ï¼Œä¹Ÿå¯æŒ‡å®šç±»å‹</span>
</span><span id="__span-52-18"><a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a><span class="w">    </span><span class="kn">gzip_comp_level</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">                           </span><span class="c1"># å‹ç¼©ç­‰çº§1-9(æ¯”ä¾‹)ç­‰çº§è¶Šå¤§ å‹ç¼©è¶Šé«˜ è¶Šè€—CPU</span>
</span><span id="__span-52-19"><a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a><span class="w">    </span><span class="kn">gzip_min_length</span><span class="w"> </span><span class="mi">128</span><span class="p">;</span><span class="w">                         </span><span class="c1"># å‹ç¼©å‰æï¼Œå½“è¿”å›å†…å®¹å¤§äºæŒ‡å®šæ—¶å†å‹ç¼©</span>
</span><span id="__span-52-20"><a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a><span class="w">    </span><span class="kn">gzip_types</span><span class="w"> </span><span class="s">text/css</span><span class="w"> </span><span class="s">text/xml</span><span class="w"> </span><span class="s">image/svg+xml</span><span class="p">;</span><span class="w">  </span><span class="c1"># æŒ‡å®šå‹ç¼©çš„æ–‡ä»¶ç±»å‹ï¼›æ›´å¤šå‹ç¼©é¡¹å¯å‚è€ƒ mime.types</span>
</span><span id="__span-52-21"><a id="__codelineno-52-21" name="__codelineno-52-21" href="#__codelineno-52-21"></a><span class="p">}</span>
</span></code></pre></div> <p><br></p> <h3 id="43ä¸åç«¯æœåŠ¡ä¹‹é—´çš„ä¼˜åŒ–">4.3ã€ä¸åç«¯æœåŠ¡ä¹‹é—´çš„ä¼˜åŒ–<a class="headerlink" href="#43ä¸åç«¯æœåŠ¡ä¹‹é—´çš„ä¼˜åŒ–" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="k">http</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="w">    </span><span class="kn">upstream</span><span class="w"> </span><span class="s">backend_A</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="w">        </span><span class="c1"># ...</span>
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a>
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a><span class="w">        </span><span class="c1"># é•¿è¿æ¥ï¼›æ‰€æœ‰è¯·æ±‚æ±‡èšåˆ°åç«¯æœåŠ¡å™¨ï¼Œå¹¶å‘æ—¶æ˜¯æœ‰å¿…è¦åœ¨æ­¤åŸºç¡€ä¸Šé‡é… keepalive çš„</span>
</span><span id="__span-53-6"><a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a><span class="w">        </span><span class="c1"># ä»¥ä¸‹ keepalive éœ€è¦ http 1.1 ç‰ˆæœ¬ï¼Œå¹¶ä¸” header connection close</span>
</span><span id="__span-53-7"><a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a><span class="w">        </span><span class="kn">keepalive</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w">           </span><span class="c1"># æ¯ä¸ªWorkerä¸åç«¯çš„è¿æ¥æ± ä¸­ï¼Œä¿æŒæŒ‡å®šé‡çš„ç©ºé—²è¿æ¥æ•°ï¼ˆQPSçš„10%ï¼‰</span>
</span><span id="__span-53-8"><a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a><span class="w">        </span><span class="kn">keepalive_time</span><span class="w"> </span><span class="s">1h</span><span class="p">;</span><span class="w">       </span><span class="c1"># æ¯ä¸ªé•¿è¿æ¥çš„(å¿™ç¢Œ+ç©ºé—²)æ€»æ—¶é•¿ï¼Œè¶…å‡ºåå¼ºåˆ¶å¤±æ•ˆ</span>
</span><span id="__span-53-9"><a id="__codelineno-53-9" name="__codelineno-53-9" href="#__codelineno-53-9"></a><span class="w">        </span><span class="kn">keepalive_timeout</span><span class="w"> </span><span class="s">60s</span><span class="p">;</span><span class="w">   </span><span class="c1"># æ¯ä¸ªé•¿è¿æ¥ï¼Œæœ€å¤§ç©ºé—²æ—¶é•¿ï¼Œè¶…å‡ºåè‡ªåŠ¨å…³é—­é•¿è¿æ¥</span>
</span><span id="__span-53-10"><a id="__codelineno-53-10" name="__codelineno-53-10" href="#__codelineno-53-10"></a><span class="w">        </span><span class="kn">keepalive_requests</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="c1"># æ¯æ¬¡é•¿è¿æ¥æ”¯æŒçš„ Request æ¬¡æ•°ï¼Œè¶…å‡ºåè‡ªåŠ¨å…³é—­</span>
</span><span id="__span-53-11"><a id="__codelineno-53-11" name="__codelineno-53-11" href="#__codelineno-53-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-53-12"><a id="__codelineno-53-12" name="__codelineno-53-12" href="#__codelineno-53-12"></a>
</span><span id="__span-53-13"><a id="__codelineno-53-13" name="__codelineno-53-13" href="#__codelineno-53-13"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-53-14"><a id="__codelineno-53-14" name="__codelineno-53-14" href="#__codelineno-53-14"></a><span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">\</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-53-15"><a id="__codelineno-53-15" name="__codelineno-53-15" href="#__codelineno-53-15"></a><span class="w">            </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://backend_A</span><span class="p">;</span>
</span><span id="__span-53-16"><a id="__codelineno-53-16" name="__codelineno-53-16" href="#__codelineno-53-16"></a><span class="w">            </span><span class="kn">proxy_http_version</span><span class="w"> </span><span class="mi">1</span><span class="s">.1</span><span class="p">;</span><span class="w">            </span><span class="c1"># 1.1 æ”¯æŒ keep-live</span>
</span><span id="__span-53-17"><a id="__codelineno-53-17" name="__codelineno-53-17" href="#__codelineno-53-17"></a><span class="w">            </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">connection</span><span class="w"> </span><span class="s">""</span><span class="p">;</span><span class="w">    </span><span class="c1"># è¦†ç›–å®¢æˆ·ç«¯çš„è¿æ¥å¤´</span>
</span><span id="__span-53-18"><a id="__codelineno-53-18" name="__codelineno-53-18" href="#__codelineno-53-18"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-53-19"><a id="__codelineno-53-19" name="__codelineno-53-19" href="#__codelineno-53-19"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-53-20"><a id="__codelineno-53-20" name="__codelineno-53-20" href="#__codelineno-53-20"></a><span class="p">}</span>
</span></code></pre></div> <p><br></p> <h3 id="44ç¼“å­˜è®¾ç½®">4.4ã€ç¼“å­˜è®¾ç½®<a class="headerlink" href="#44ç¼“å­˜è®¾ç½®" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>ä¹Ÿå°±æ˜¯æŠŠå®¢æˆ·ç«¯è®¿é—®çš„æ•°æ®æ”¾åˆ°ç¼“å­˜ä¸­ï¼Œç¼“å­˜å¯ä»¥å­˜åˆ°æµè§ˆå™¨ä¸­ï¼Œä¹Ÿå¯ä»¥å­˜åˆ° Nginx ä¸­ï¼Œå½“ç”¨æˆ·ç«¯å‘èµ·è¯·æ±‚æ—¶ï¼Œç›´æ¥å°†ç¼“å­˜ä¸­å¯¹åº”çš„ç»“æœè¿”å›ç»™ç”¨æˆ·ç«¯ï¼Œå‡å°‘äº†å¤§é‡çš„é‡å¤è¯·æ±‚ã€‚</p> <p>å‰ç«¯èµ„æºæ–‡ä»¶ css/js/image ç¼“å­˜åˆ°æµè§ˆå™¨ï¼Œä»¥å‡å°‘æµè§ˆå™¨å‘ Nginx çš„è¯·æ±‚ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="k">http</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="w">    </span><span class="c1">###### é™æ€èµ„æºæ–‡ä»¶ç¼“å­˜ï¼ˆcss/js/imageï¼‰[HTTP1.1]</span>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a><span class="w">    </span><span class="c1"># - publicï¼šå¯è¢«ä»»ä½•å¯¹è±¡ç¼“å­˜ï¼ˆä¸é™æµè§ˆå™¨ï¼‰</span>
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a><span class="w">    </span><span class="c1"># - max-ageï¼šè®¾å®šç¼“å­˜æœ‰æ•ˆæœŸ(ç§’)</span>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a><span class="w">    </span><span class="c1"># - privateï¼šç§æœ‰ç¼“å­˜ï¼›å¦‚ï¼šä»…æµè§ˆå™¨ç¼“å­˜ï¼Œå…¬å…±ä»£ç†æœåŠ¡å™¨ä¸ç¼“å­˜</span>
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a><span class="w">    </span><span class="c1"># - no-cacheï¼šå¯ç¼“å­˜ï¼Œæ¯æ¬¡éªŒè¯æœ‰æ•ˆæ€§ï¼Œæœ‰æ•ˆæ—¶è·³è¿‡å“åº”ä½“çš„å›ä¼ </span>
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a><span class="w">    </span><span class="c1"># - no-storeï¼šè¯·æ±‚ä¸å“åº”ï¼Œä¸ä½¿ç”¨ä»»ä½•ç¼“å­˜</span>
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a><span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Cache-Control</span><span class="w"> </span><span class="s">private,max-age=60</span><span class="p">;</span><span class="w">    </span><span class="c1"># ä»…åœ¨æµè§ˆå™¨ç¼“å­˜60ç§’</span>
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a><span class="w">    </span><span class="c1"># HTTP1.0 ç‰ˆæœ¬è®¾ç½®æ–¹å¼ä¸ºï¼šExpires 1m;ï¼ˆä¸æ”¯æŒå¼ºåˆ¶åˆ·æ–°ï¼‰</span>
</span><span id="__span-54-10"><a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a><span class="p">}</span>
</span></code></pre></div> <p>å˜æ›´é¢‘ç‡è¾ƒå°‘çš„åç«¯åº”ç”¨æ¥å£è¿”å›æ•°æ®ç¼“å­˜åˆ°ç£ç›˜ï¼ŒNginx ç›´æ¥è¯»ç£ç›˜æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå‡å°‘ Nginx å‘åç«¯æœåŠ¡çš„è¯·æ±‚ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="k">http</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="w">    </span><span class="c1">###### å®šä¹‰ç¼“å­˜æ•°æ®çš„å­˜å‚¨</span>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="w">    </span><span class="c1"># - pathï¼šç£ç›˜å¿…é¡»å­˜åœ¨çš„ç›®å½•</span>
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="w">    </span><span class="c1"># - levelsï¼šç¼“å­˜ç›®å½•ç»“æ„ï¼Œ1-3å±‚çº§</span>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a><span class="w">    </span><span class="c1"># - keys_zoneï¼šç¼“å­˜å®šä¹‰çš„åç§°åŠç©ºé—´å¤§å°</span>
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a><span class="w">    </span><span class="c1"># - inactiveï¼šå®šä¹‰è¶…å‡ºæœªä½¿ç”¨æ—¶é•¿åè‡ªåŠ¨åˆ é™¤</span>
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a><span class="w">    </span><span class="kn">proxy_cache_path</span><span class="w"> </span><span class="p">{</span><span class="kn">path}</span><span class="w"> </span><span class="s">levels=1:2</span><span class="w"> </span><span class="s">keys_zone=</span><span class="p">{</span><span class="kn">cache-name}:50m</span><span class="w"> </span><span class="s">inactive=1d</span><span class="p">;</span>
</span><span id="__span-55-8"><a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a>
</span><span id="__span-55-9"><a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a><span class="w">    </span><span class="kn">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-10"><a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a><span class="w">        </span><span class="c1"># ...</span>
</span><span id="__span-55-11"><a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a><span class="w">        </span><span class="kn">location</span><span class="w"> </span><span class="s">/api/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-12"><a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a><span class="w">            </span><span class="kn">proxy_cache</span><span class="w"> </span><span class="p">{</span><span class="kn">cache-name}</span><span class="p">;</span><span class="w">     </span><span class="c1"># å¼•ç”¨ä»¥ä¸Šå®šä¹‰çš„ç¼“å­˜åç§°</span>
</span><span id="__span-55-13"><a id="__codelineno-55-13" name="__codelineno-55-13" href="#__codelineno-55-13"></a><span class="w">            </span><span class="kn">proxy_cache_valid</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="mi">302</span><span class="p">;</span><span class="w">    </span><span class="c1"># æŒ‡å®šè¿”å›çŠ¶æ€æ‰è¿›è¡Œç¼“å­˜</span>
</span><span id="__span-55-14"><a id="__codelineno-55-14" name="__codelineno-55-14" href="#__codelineno-55-14"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-55-15"><a id="__codelineno-55-15" name="__codelineno-55-15" href="#__codelineno-55-15"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-55-16"><a id="__codelineno-55-16" name="__codelineno-55-16" href="#__codelineno-55-16"></a><span class="p">}</span>
</span></code></pre></div> <aside class="md-source-file"> <span class="md-source-file__fact"> <span class="md-icon" title="æœ€åæ›´æ–°"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2026å¹´1æœˆ22æ—¥ 20:21:58 UTC">2026å¹´1æœˆ22æ—¥ 20:21:58</span> </span> <span class="md-source-file__fact"> <span class="md-icon" title="åˆ›å»ºæ—¥æœŸ"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2023å¹´6æœˆ14æ—¥ 16:52:35 UTC">2023å¹´6æœˆ14æ—¥ 16:52:35</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type="button" class="md-top md-icon" data-md-component="top" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> å›åˆ°é¡µé¢é¡¶éƒ¨ </button> </main> <footer class="md-footer"> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.top", "navigation.indexes", "navigation.tracking", "navigation.instant", "navigation.path", "content.tabs.link", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script> <script src="../assets/javascripts/bundle.79ae519e.min.js"></script> <script src="../_javascripts/auto_title.js"></script>  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>