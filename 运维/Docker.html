<!DOCTYPE html><html lang="zh" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://0richalcos.github.io/Note/%E8%BF%90%E7%BB%B4/Docker.html"><link rel="prev" href="../%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/XXL-JOB.html"><link rel="next" href="Linux.html"><link rel="icon" href="../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Docker - éšä¾¿è®°è®°</title><link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css"><link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel="stylesheet" href="../_stylesheets/extra.css"><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal"> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a href="#1ç®€ä»‹" class="md-skip"> è·³è½¬è‡³ </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow" data-md-component="header"> <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰"> <a href="../index.html" title="éšä¾¿è®°è®°" class="md-header__button md-logo" aria-label="éšä¾¿è®°è®°" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> éšä¾¿è®°è®° </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> Docker </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input class="md-option" data-md-color-media data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal" aria-label="åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼" type="radio" name="__palette" id="__palette_0"> <label class="md-header__button md-icon" title="åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼" for="__palette_1" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> <input class="md-option" data-md-color-media data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal" aria-label="åˆ‡æ¢åˆ°äº®è‰²æ¨¡å¼" type="radio" name="__palette" id="__palette_1"> <label class="md-header__button md-icon" title="åˆ‡æ¢åˆ°äº®è‰²æ¨¡å¼" for="__palette_0" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required> <label class="md-search__icon md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class="md-search__options" aria-label="æŸ¥æ‰¾"> <button type="reset" class="md-search__icon md-icon" title="æ¸…ç©ºå½“å‰å†…å®¹" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“ </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a href="https://github.com/0richalcos/Note" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> GitHub </div> </a> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--primary" aria-label="å¯¼èˆªæ " data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a href="../index.html" title="éšä¾¿è®°è®°" class="md-nav__button md-logo" aria-label="éšä¾¿è®°è®°" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> éšä¾¿è®°è®° </label> <div class="md-nav__source"> <a href="https://github.com/0richalcos/Note" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> GitHub </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../index.html" class="md-nav__link"> <span class="md-ellipsis"> ğŸ  é¦–é¡µ </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2"> <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0"> <span class="md-ellipsis"> â™¨ï¸ Java </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> â™¨ï¸ Java </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../Java/Java.html" class="md-nav__link"> <span class="md-ellipsis"> Java </span> </a> </li> <li class="md-nav__item"> <a href="../Java/Java8.html" class="md-nav__link"> <span class="md-ellipsis"> Java 8 </span> </a> </li> <li class="md-nav__item"> <a href="../Java/JavaBasics.html" class="md-nav__link"> <span class="md-ellipsis"> Java åŸºç¡€ </span> </a> </li> <li class="md-nav__item"> <a href="../Java/JavaCollection.html" class="md-nav__link"> <span class="md-ellipsis"> Java é›†åˆ </span> </a> </li> <li class="md-nav__item"> <a href="../Java/JavaObject.html" class="md-nav__link"> <span class="md-ellipsis"> Java ç±»å’Œå¯¹è±¡ </span> </a> </li> <li class="md-nav__item"> <a href="../Java/JavaWeb.html" class="md-nav__link"> <span class="md-ellipsis"> JavaWeb </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3"> <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0"> <span class="md-ellipsis"> ğŸ§® æ•°æ®ç»“æ„åŠç®—æ³• </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> ğŸ§® æ•°æ®ç»“æ„åŠç®—æ³• </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E7%AE%97%E6%B3%95/Algorithm.html" class="md-nav__link"> <span class="md-ellipsis"> Algorithm </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E7%AE%97%E6%B3%95/DesignPattern.html" class="md-nav__link"> <span class="md-ellipsis"> DesignPattern </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4"> <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0"> <span class="md-ellipsis"> ğŸƒ Spring </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> ğŸƒ Spring </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../Spring/Spring.html" class="md-nav__link"> <span class="md-ellipsis"> Spring </span> </a> </li> <li class="md-nav__item"> <a href="../Spring/SpringBoot.html" class="md-nav__link"> <span class="md-ellipsis"> SpringBoot </span> </a> </li> <li class="md-nav__item"> <a href="../Spring/SpringCloud.html" class="md-nav__link"> <span class="md-ellipsis"> SpringCloud </span> </a> </li> <li class="md-nav__item"> <a href="../Spring/SpringMVC.html" class="md-nav__link"> <span class="md-ellipsis"> SpringMVC </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5"> <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0"> <span class="md-ellipsis"> ğŸ’¾ æŒä¹…å±‚æ¡†æ¶ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> ğŸ’¾ æŒä¹…å±‚æ¡†æ¶ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6/MyBatis-Plus.html" class="md-nav__link"> <span class="md-ellipsis"> MyBatis-Plus </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6/Mybatis.html" class="md-nav__link"> <span class="md-ellipsis"> Mybatis </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6"> <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0"> <span class="md-ellipsis"> ğŸ” è®¤è¯ä¸æˆæƒ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> ğŸ” è®¤è¯ä¸æˆæƒ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/SSO.html" class="md-nav__link"> <span class="md-ellipsis"> SSO </span> </a> </li> <li class="md-nav__item"> <a href="../%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/Sa-Token.html" class="md-nav__link"> <span class="md-ellipsis"> Sa-Token </span> </a> </li> <li class="md-nav__item"> <a href="../%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/Shiro.html" class="md-nav__link"> <span class="md-ellipsis"> Shiro </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7"> <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0"> <span class="md-ellipsis"> ğŸŒ å‰ç«¯ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> ğŸŒ å‰ç«¯ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/CSS.html" class="md-nav__link"> <span class="md-ellipsis"> CSS </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/JavaScript.html" class="md-nav__link"> <span class="md-ellipsis"> JavaScript </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/Vue.html" class="md-nav__link"> <span class="md-ellipsis"> Vue </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/jQuery.html" class="md-nav__link"> <span class="md-ellipsis"> jQuery </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5"> <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0"> <span class="md-ellipsis"> æ¨¡æ¿å¼•æ“ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_7_5"> <span class="md-nav__icon md-icon"></span> æ¨¡æ¿å¼•æ“ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/Thymeleaf.html" class="md-nav__link"> <span class="md-ellipsis"> Thymeleaf </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6"> <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0"> <span class="md-ellipsis"> ç»„ä»¶åº“ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_7_6"> <span class="md-nav__icon md-icon"></span> ç»„ä»¶åº“ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/AntV-X6.html" class="md-nav__link"> <span class="md-ellipsis"> AntV-X6 </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/ApacheECharts.html" class="md-nav__link"> <span class="md-ellipsis"> ApacheECharts </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/Axios.html" class="md-nav__link"> <span class="md-ellipsis"> Axios </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/BootstrapTable.html" class="md-nav__link"> <span class="md-ellipsis"> BootstrapTable </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/DHTMLXGantt.html" class="md-nav__link"> <span class="md-ellipsis"> DHTMLXGantt </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/Element.html" class="md-nav__link"> <span class="md-ellipsis"> Element </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/FullCalendar.html" class="md-nav__link"> <span class="md-ellipsis"> FullCalendar </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/X-editable.html" class="md-nav__link"> <span class="md-ellipsis"> X-editable </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8"> <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0"> <span class="md-ellipsis"> ğŸ“Š æ•°æ®åº“ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8"> <span class="md-nav__icon md-icon"></span> ğŸ“Š æ•°æ®åº“ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/Dameng.html" class="md-nav__link"> <span class="md-ellipsis"> Dameng </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL.html" class="md-nav__link"> <span class="md-ellipsis"> MySQL </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/MySQLQuery.html" class="md-nav__link"> <span class="md-ellipsis"> MySQLQuery </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/OceanBase.html" class="md-nav__link"> <span class="md-ellipsis"> OceanBase </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/Oracle.html" class="md-nav__link"> <span class="md-ellipsis"> Oracle </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/Redis.html" class="md-nav__link"> <span class="md-ellipsis"> Redis </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/Vastbase.html" class="md-nav__link"> <span class="md-ellipsis"> Vastbase </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9"> <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0"> <span class="md-ellipsis"> ğŸ” æœç´¢å¼•æ“ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_9"> <span class="md-nav__icon md-icon"></span> ğŸ” æœç´¢å¼•æ“ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/Elasticsearch.html" class="md-nav__link"> <span class="md-ellipsis"> Elasticsearch </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10"> <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0"> <span class="md-ellipsis"> ğŸ“‡ åˆ†å¸ƒå¼å­˜å‚¨ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_10"> <span class="md-nav__icon md-icon"></span> ğŸ“‡ åˆ†å¸ƒå¼å­˜å‚¨ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/FastDFS.html" class="md-nav__link"> <span class="md-ellipsis"> FastDFS </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/MinIO.html" class="md-nav__link"> <span class="md-ellipsis"> MinIO </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11"> <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0"> <span class="md-ellipsis"> ğŸ›°ï¸ ç½‘ç»œé€šä¿¡ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_11"> <span class="md-nav__icon md-icon"></span> ğŸ›°ï¸ ç½‘ç»œé€šä¿¡ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/Encryption.html" class="md-nav__link"> <span class="md-ellipsis"> Encryption </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/HTTP.html" class="md-nav__link"> <span class="md-ellipsis"> HTTP </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/OpenVPN.html" class="md-nav__link"> <span class="md-ellipsis"> OpenVPN </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/VNC.html" class="md-nav__link"> <span class="md-ellipsis"> VNC </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/WebSocket.html" class="md-nav__link"> <span class="md-ellipsis"> WebSocket </span> </a> </li> <li class="md-nav__item"> <a href="../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/frp.html" class="md-nav__link"> <span class="md-ellipsis"> frp </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12"> <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0"> <span class="md-ellipsis"> ğŸ—ƒï¸ æ–‡ä»¶å¤„ç† </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_12"> <span class="md-nav__icon md-icon"></span> ğŸ—ƒï¸ æ–‡ä»¶å¤„ç† </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_1"> <label class="md-nav__link" for="__nav_12_1" id="__nav_12_1_label" tabindex="0"> <span class="md-ellipsis"> Office </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_1_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_12_1"> <span class="md-nav__icon md-icon"></span> Office </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/ApachePOI.html" class="md-nav__link"> <span class="md-ellipsis"> ApachePOI </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/EasyExcel.html" class="md-nav__link"> <span class="md-ellipsis"> EasyExcel </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/OnlyOffice.html" class="md-nav__link"> <span class="md-ellipsis"> OnlyOffice </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/Poi-tl.html" class="md-nav__link"> <span class="md-ellipsis"> Poi-tl </span> </a> </li> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/Spire.OfficeForJava.html" class="md-nav__link"> <span class="md-ellipsis"> Spire.OfficeForJava </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_2"> <label class="md-nav__link" for="__nav_12_2" id="__nav_12_2_label" tabindex="0"> <span class="md-ellipsis"> PDF </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_2_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_12_2"> <span class="md-nav__icon md-icon"></span> PDF </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/PDF/ApachePDFBox.html" class="md-nav__link"> <span class="md-ellipsis"> ApachePDFBox </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_3"> <label class="md-nav__link" for="__nav_12_3" id="__nav_12_3_label" tabindex="0"> <span class="md-ellipsis"> XML </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_3_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_12_3"> <span class="md-nav__icon md-icon"></span> XML </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/XML/XMLParse.html" class="md-nav__link"> <span class="md-ellipsis"> XMLParse </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_4"> <label class="md-nav__link" for="__nav_12_4" id="__nav_12_4_label" tabindex="0"> <span class="md-ellipsis"> ZIP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_4_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_12_4"> <span class="md-nav__icon md-icon"></span> ZIP </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/ZIP/Zip4j.html" class="md-nav__link"> <span class="md-ellipsis"> Zip4j </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13"> <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0"> <span class="md-ellipsis"> âŒ› å®šæ—¶ä»»åŠ¡ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_13"> <span class="md-nav__icon md-icon"></span> âŒ› å®šæ—¶ä»»åŠ¡ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/XXL-JOB.html" class="md-nav__link"> <span class="md-ellipsis"> XXL-JOB </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" checked> <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0"> <span class="md-ellipsis"> ğŸ§‘â€ğŸ”§ è¿ç»´ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="true"> <label class="md-nav__title" for="__nav_14"> <span class="md-nav__icon md-icon"></span> ğŸ§‘â€ğŸ”§ è¿ç»´ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc"> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> Docker </span> <span class="md-nav__icon md-icon"></span> </label> <a href="Docker.html" class="md-nav__link md-nav__link--active"> <span class="md-ellipsis"> Docker </span> </a> <nav class="md-nav md-nav--secondary" aria-label="ç›®å½•"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> ç›®å½• </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#1ç®€ä»‹" class="md-nav__link"> <span class="md-ellipsis"> 1ã€ç®€ä»‹ </span> </a> <nav class="md-nav" aria-label="1ã€ç®€ä»‹"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#11æ¦‚è¿°" class="md-nav__link"> <span class="md-ellipsis"> 1.1ã€æ¦‚è¿° </span> </a> <nav class="md-nav" aria-label="1.1ã€æ¦‚è¿°"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#111ä»€ä¹ˆæ˜¯-docker" class="md-nav__link"> <span class="md-ellipsis"> 1.1.1ã€ä»€ä¹ˆæ˜¯ Docker </span> </a> </li> <li class="md-nav__item"> <a href="#112ä¸ºä»€ä¹ˆè¦ç”¨-docker" class="md-nav__link"> <span class="md-ellipsis"> 1.1.2ã€ä¸ºä»€ä¹ˆè¦ç”¨ Docker </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#12åŸºæœ¬æ¦‚å¿µ" class="md-nav__link"> <span class="md-ellipsis"> 1.2ã€åŸºæœ¬æ¦‚å¿µ </span> </a> <nav class="md-nav" aria-label="1.2ã€åŸºæœ¬æ¦‚å¿µ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#121é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 1.2.1ã€é•œåƒ </span> </a> </li> <li class="md-nav__item"> <a href="#122å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 1.2.2ã€å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#123ä»“åº“" class="md-nav__link"> <span class="md-ellipsis"> 1.2.3ã€ä»“åº“ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#13å®‰è£…-docker" class="md-nav__link"> <span class="md-ellipsis"> 1.3ã€å®‰è£… Docker </span> </a> <nav class="md-nav" aria-label="1.3ã€å®‰è£… Docker"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#131windows" class="md-nav__link"> <span class="md-ellipsis"> 1.3.1ã€Windows </span> </a> </li> <li class="md-nav__item"> <a href="#132éº’éºŸ" class="md-nav__link"> <span class="md-ellipsis"> 1.3.2ã€éº’éºŸ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#14é•œåƒåŠ é€Ÿå™¨" class="md-nav__link"> <span class="md-ellipsis"> 1.4ã€é•œåƒåŠ é€Ÿå™¨ </span> </a> <nav class="md-nav" aria-label="1.4ã€é•œåƒåŠ é€Ÿå™¨"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#141windows" class="md-nav__link"> <span class="md-ellipsis"> 1.4.1ã€Windows </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#2ä½¿ç”¨é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2ã€ä½¿ç”¨é•œåƒ </span> </a> <nav class="md-nav" aria-label="2ã€ä½¿ç”¨é•œåƒ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#21è·å–é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2.1ã€è·å–é•œåƒ </span> </a> </li> <li class="md-nav__item"> <a href="#22åˆ—å‡ºé•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2.2ã€åˆ—å‡ºé•œåƒ </span> </a> <nav class="md-nav" aria-label="2.2ã€åˆ—å‡ºé•œåƒ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#221ä¸­é—´å±‚é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2.2.1ã€ä¸­é—´å±‚é•œåƒ </span> </a> </li> <li class="md-nav__item"> <a href="#222åˆ—å‡ºéƒ¨åˆ†é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2.2.2ã€åˆ—å‡ºéƒ¨åˆ†é•œåƒ </span> </a> </li> <li class="md-nav__item"> <a href="#233ä»¥ç‰¹å®šæ ¼å¼æ˜¾ç¤º" class="md-nav__link"> <span class="md-ellipsis"> 2.3.3ã€ä»¥ç‰¹å®šæ ¼å¼æ˜¾ç¤º </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#23åˆ é™¤æœ¬åœ°é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2.3ã€åˆ é™¤æœ¬åœ°é•œåƒ </span> </a> </li> <li class="md-nav__item"> <a href="#24ä¿å­˜å’ŒåŠ è½½é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2.4ã€ä¿å­˜å’ŒåŠ è½½é•œåƒ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#3æ“ä½œå®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3ã€æ“ä½œå®¹å™¨ </span> </a> <nav class="md-nav" aria-label="3ã€æ“ä½œå®¹å™¨"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#31å¯åŠ¨å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.1ã€å¯åŠ¨å®¹å™¨ </span> </a> <nav class="md-nav" aria-label="3.1ã€å¯åŠ¨å®¹å™¨"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#311æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.1.1ã€æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#312å¯åŠ¨å·²ç»ˆæ­¢å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.1.2ã€å¯åŠ¨å·²ç»ˆæ­¢å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#313å®ˆæŠ¤æ€å¯åŠ¨å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.1.3ã€å®ˆæŠ¤æ€å¯åŠ¨å®¹å™¨ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#32ç»ˆæ­¢å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.2ã€ç»ˆæ­¢å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#33è¿›å…¥å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.3ã€è¿›å…¥å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#34å¯¼å‡ºå’Œå¯¼å…¥" class="md-nav__link"> <span class="md-ellipsis"> 3.4ã€å¯¼å‡ºå’Œå¯¼å…¥ </span> </a> </li> <li class="md-nav__item"> <a href="#35åˆ é™¤å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.5ã€åˆ é™¤å®¹å™¨ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#4è®¿é—®ä»“åº“" class="md-nav__link"> <span class="md-ellipsis"> 4ã€è®¿é—®ä»“åº“ </span> </a> <nav class="md-nav" aria-label="4ã€è®¿é—®ä»“åº“"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#41docker-hub" class="md-nav__link"> <span class="md-ellipsis"> 4.1ã€Docker Hub </span> </a> </li> <li class="md-nav__item"> <a href="#42ç§æœ‰ä»“åº“" class="md-nav__link"> <span class="md-ellipsis"> 4.2ã€ç§æœ‰ä»“åº“ </span> </a> <nav class="md-nav" aria-label="4.2ã€ç§æœ‰ä»“åº“"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#421å®‰è£…-docker-registry" class="md-nav__link"> <span class="md-ellipsis"> 4.2.1ã€å®‰è£… docker-registry </span> </a> </li> <li class="md-nav__item"> <a href="#422ä½¿ç”¨ç§æœ‰ä»“åº“" class="md-nav__link"> <span class="md-ellipsis"> 4.2.2ã€ä½¿ç”¨ç§æœ‰ä»“åº“ </span> </a> </li> <li class="md-nav__item"> <a href="#423é…ç½®é-https-åœ°å€" class="md-nav__link"> <span class="md-ellipsis"> 4.2.3ã€é…ç½®é https åœ°å€ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#5æ•°æ®ç®¡ç†" class="md-nav__link"> <span class="md-ellipsis"> 5ã€æ•°æ®ç®¡ç† </span> </a> <nav class="md-nav" aria-label="5ã€æ•°æ®ç®¡ç†"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#51æ•°æ®å·" class="md-nav__link"> <span class="md-ellipsis"> 5.1ã€æ•°æ®å· </span> </a> <nav class="md-nav" aria-label="5.1ã€æ•°æ®å·"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#511åˆ›å»ºæ•°æ®å·" class="md-nav__link"> <span class="md-ellipsis"> 5.1.1ã€åˆ›å»ºæ•°æ®å· </span> </a> </li> <li class="md-nav__item"> <a href="#512ä½¿ç”¨æ•°æ®å·å¯åŠ¨å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 5.1.2ã€ä½¿ç”¨æ•°æ®å·å¯åŠ¨å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#513åˆ é™¤æ•°æ®å·" class="md-nav__link"> <span class="md-ellipsis"> 5.1.3ã€åˆ é™¤æ•°æ®å· </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#52ç»‘å®šæŒ‚è½½" class="md-nav__link"> <span class="md-ellipsis"> 5.2ã€ç»‘å®šæŒ‚è½½ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#6ä½¿ç”¨ç½‘ç»œ" class="md-nav__link"> <span class="md-ellipsis"> 6ã€ä½¿ç”¨ç½‘ç»œ </span> </a> <nav class="md-nav" aria-label="6ã€ä½¿ç”¨ç½‘ç»œ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#61å¤–éƒ¨è®¿é—®å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 6.1ã€å¤–éƒ¨è®¿é—®å®¹å™¨ </span> </a> <nav class="md-nav" aria-label="6.1ã€å¤–éƒ¨è®¿é—®å®¹å™¨"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#611æŸ¥çœ‹æ˜ å°„ç«¯å£é…ç½®" class="md-nav__link"> <span class="md-ellipsis"> 6.1.1ã€æŸ¥çœ‹æ˜ å°„ç«¯å£é…ç½® </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#62å®¹å™¨äº’è”" class="md-nav__link"> <span class="md-ellipsis"> 6.2ã€å®¹å™¨äº’è” </span> </a> <nav class="md-nav" aria-label="6.2ã€å®¹å™¨äº’è”"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#621æ–°å»ºç½‘ç»œ" class="md-nav__link"> <span class="md-ellipsis"> 6.2.1ã€æ–°å»ºç½‘ç»œ </span> </a> </li> <li class="md-nav__item"> <a href="#622è¿æ¥å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 6.2.2ã€è¿æ¥å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#623æµ‹è¯•äº’è”" class="md-nav__link"> <span class="md-ellipsis"> 6.2.3ã€æµ‹è¯•äº’è” </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#63é…ç½®-dns" class="md-nav__link"> <span class="md-ellipsis"> 6.3ã€é…ç½® DNS </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#7æ„å»ºé•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 7ã€æ„å»ºé•œåƒ </span> </a> <nav class="md-nav" aria-label="7ã€æ„å»ºé•œåƒ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#71dockerfile-å®šåˆ¶é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 7.1ã€Dockerfile å®šåˆ¶é•œåƒ </span> </a> <nav class="md-nav" aria-label="7.1ã€Dockerfile å®šåˆ¶é•œåƒ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#711from" class="md-nav__link"> <span class="md-ellipsis"> 7.1.1ã€FROM </span> </a> </li> <li class="md-nav__item"> <a href="#712run" class="md-nav__link"> <span class="md-ellipsis"> 7.1.2ã€RUN </span> </a> </li> <li class="md-nav__item"> <a href="#713æ„å»ºé•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 7.1.3ã€æ„å»ºé•œåƒ </span> </a> </li> <li class="md-nav__item"> <a href="#714é•œåƒæ„å»ºä¸Šä¸‹æ–‡" class="md-nav__link"> <span class="md-ellipsis"> 7.1.4ã€é•œåƒæ„å»ºä¸Šä¸‹æ–‡ </span> </a> </li> <li class="md-nav__item"> <a href="#715build-çš„å…¶å®ƒç”¨æ³•" class="md-nav__link"> <span class="md-ellipsis"> 7.1.5ã€build çš„å…¶å®ƒç”¨æ³• </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#72dockerfile-æŒ‡ä»¤è¯¦è§£" class="md-nav__link"> <span class="md-ellipsis"> 7.2ã€Dockerfile æŒ‡ä»¤è¯¦è§£ </span> </a> <nav class="md-nav" aria-label="7.2ã€Dockerfile æŒ‡ä»¤è¯¦è§£"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#721copy" class="md-nav__link"> <span class="md-ellipsis"> 7.2.1ã€COPY </span> </a> </li> <li class="md-nav__item"> <a href="#722add" class="md-nav__link"> <span class="md-ellipsis"> 7.2.2ã€ADD </span> </a> </li> <li class="md-nav__item"> <a href="#723cmd" class="md-nav__link"> <span class="md-ellipsis"> 7.2.3ã€CMD </span> </a> </li> <li class="md-nav__item"> <a href="#724entrypoint" class="md-nav__link"> <span class="md-ellipsis"> 7.2.4ã€ENTRYPOINT </span> </a> </li> <li class="md-nav__item"> <a href="#725env" class="md-nav__link"> <span class="md-ellipsis"> 7.2.5ã€ENV </span> </a> </li> <li class="md-nav__item"> <a href="#726arg" class="md-nav__link"> <span class="md-ellipsis"> 7.2.6ã€ARG </span> </a> </li> <li class="md-nav__item"> <a href="#727volume" class="md-nav__link"> <span class="md-ellipsis"> 7.2.7ã€VOLUME </span> </a> </li> <li class="md-nav__item"> <a href="#728expose" class="md-nav__link"> <span class="md-ellipsis"> 7.2.8ã€EXPOSE </span> </a> </li> <li class="md-nav__item"> <a href="#729workdir" class="md-nav__link"> <span class="md-ellipsis"> 7.2.9ã€WORKDIR </span> </a> </li> <li class="md-nav__item"> <a href="#7210user" class="md-nav__link"> <span class="md-ellipsis"> 7.2.10ã€USER </span> </a> </li> <li class="md-nav__item"> <a href="#7211healthcheck" class="md-nav__link"> <span class="md-ellipsis"> 7.2.11ã€HEALTHCHECK </span> </a> </li> <li class="md-nav__item"> <a href="#7212onbuild" class="md-nav__link"> <span class="md-ellipsis"> 7.2.12ã€ONBUILD </span> </a> </li> <li class="md-nav__item"> <a href="#7213label" class="md-nav__link"> <span class="md-ellipsis"> 7.2.13ã€LABEL </span> </a> </li> <li class="md-nav__item"> <a href="#7214shell" class="md-nav__link"> <span class="md-ellipsis"> 7.2.14ã€SHELL </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#73docker-buildx" class="md-nav__link"> <span class="md-ellipsis"> 7.3ã€Docker Buildx </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="Linux.html" class="md-nav__link"> <span class="md-ellipsis"> Linux </span> </a> </li> <li class="md-nav__item"> <a href="NSSM.html" class="md-nav__link"> <span class="md-ellipsis"> NSSM </span> </a> </li> <li class="md-nav__item"> <a href="Nginx.html" class="md-nav__link"> <span class="md-ellipsis"> Nginx </span> </a> </li> <li class="md-nav__item"> <a href="Tomcat.html" class="md-nav__link"> <span class="md-ellipsis"> Tomcat </span> </a> </li> <li class="md-nav__item"> <a href="TongWeb.html" class="md-nav__link"> <span class="md-ellipsis"> TongWeb </span> </a> </li> <li class="md-nav__item"> <a href="WSL.html" class="md-nav__link"> <span class="md-ellipsis"> WSL </span> </a> </li> <li class="md-nav__item"> <a href="WebLogic.html" class="md-nav__link"> <span class="md-ellipsis"> WebLogic </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15"> <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0"> <span class="md-ellipsis"> ğŸ› ï¸ å¼€å‘å·¥å…· </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_15"> <span class="md-nav__icon md-icon"></span> ğŸ› ï¸ å¼€å‘å·¥å…· </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Git.html" class="md-nav__link"> <span class="md-ellipsis"> Git </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Maven.html" class="md-nav__link"> <span class="md-ellipsis"> Maven </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Node.js.html" class="md-nav__link"> <span class="md-ellipsis"> Node.js </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Swagger.html" class="md-nav__link"> <span class="md-ellipsis"> Swagger </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16"> <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0"> <span class="md-ellipsis"> ğŸ‘» å…¶ä»– </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_16"> <span class="md-nav__icon md-icon"></span> ğŸ‘» å…¶ä»– </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../%E5%85%B6%E4%BB%96/Settings.html" class="md-nav__link"> <span class="md-ellipsis"> Settings </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%85%B6%E4%BB%96/Solutions.html" class="md-nav__link"> <span class="md-ellipsis"> Solutions </span> </a> </li> <li class="md-nav__item"> <a href="../%E5%85%B6%E4%BB%96/Weasel.html" class="md-nav__link"> <span class="md-ellipsis"> Weasel </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--secondary" aria-label="ç›®å½•"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> ç›®å½• </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#1ç®€ä»‹" class="md-nav__link"> <span class="md-ellipsis"> 1ã€ç®€ä»‹ </span> </a> <nav class="md-nav" aria-label="1ã€ç®€ä»‹"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#11æ¦‚è¿°" class="md-nav__link"> <span class="md-ellipsis"> 1.1ã€æ¦‚è¿° </span> </a> <nav class="md-nav" aria-label="1.1ã€æ¦‚è¿°"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#111ä»€ä¹ˆæ˜¯-docker" class="md-nav__link"> <span class="md-ellipsis"> 1.1.1ã€ä»€ä¹ˆæ˜¯ Docker </span> </a> </li> <li class="md-nav__item"> <a href="#112ä¸ºä»€ä¹ˆè¦ç”¨-docker" class="md-nav__link"> <span class="md-ellipsis"> 1.1.2ã€ä¸ºä»€ä¹ˆè¦ç”¨ Docker </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#12åŸºæœ¬æ¦‚å¿µ" class="md-nav__link"> <span class="md-ellipsis"> 1.2ã€åŸºæœ¬æ¦‚å¿µ </span> </a> <nav class="md-nav" aria-label="1.2ã€åŸºæœ¬æ¦‚å¿µ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#121é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 1.2.1ã€é•œåƒ </span> </a> </li> <li class="md-nav__item"> <a href="#122å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 1.2.2ã€å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#123ä»“åº“" class="md-nav__link"> <span class="md-ellipsis"> 1.2.3ã€ä»“åº“ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#13å®‰è£…-docker" class="md-nav__link"> <span class="md-ellipsis"> 1.3ã€å®‰è£… Docker </span> </a> <nav class="md-nav" aria-label="1.3ã€å®‰è£… Docker"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#131windows" class="md-nav__link"> <span class="md-ellipsis"> 1.3.1ã€Windows </span> </a> </li> <li class="md-nav__item"> <a href="#132éº’éºŸ" class="md-nav__link"> <span class="md-ellipsis"> 1.3.2ã€éº’éºŸ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#14é•œåƒåŠ é€Ÿå™¨" class="md-nav__link"> <span class="md-ellipsis"> 1.4ã€é•œåƒåŠ é€Ÿå™¨ </span> </a> <nav class="md-nav" aria-label="1.4ã€é•œåƒåŠ é€Ÿå™¨"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#141windows" class="md-nav__link"> <span class="md-ellipsis"> 1.4.1ã€Windows </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#2ä½¿ç”¨é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2ã€ä½¿ç”¨é•œåƒ </span> </a> <nav class="md-nav" aria-label="2ã€ä½¿ç”¨é•œåƒ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#21è·å–é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2.1ã€è·å–é•œåƒ </span> </a> </li> <li class="md-nav__item"> <a href="#22åˆ—å‡ºé•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2.2ã€åˆ—å‡ºé•œåƒ </span> </a> <nav class="md-nav" aria-label="2.2ã€åˆ—å‡ºé•œåƒ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#221ä¸­é—´å±‚é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2.2.1ã€ä¸­é—´å±‚é•œåƒ </span> </a> </li> <li class="md-nav__item"> <a href="#222åˆ—å‡ºéƒ¨åˆ†é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2.2.2ã€åˆ—å‡ºéƒ¨åˆ†é•œåƒ </span> </a> </li> <li class="md-nav__item"> <a href="#233ä»¥ç‰¹å®šæ ¼å¼æ˜¾ç¤º" class="md-nav__link"> <span class="md-ellipsis"> 2.3.3ã€ä»¥ç‰¹å®šæ ¼å¼æ˜¾ç¤º </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#23åˆ é™¤æœ¬åœ°é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2.3ã€åˆ é™¤æœ¬åœ°é•œåƒ </span> </a> </li> <li class="md-nav__item"> <a href="#24ä¿å­˜å’ŒåŠ è½½é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 2.4ã€ä¿å­˜å’ŒåŠ è½½é•œåƒ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#3æ“ä½œå®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3ã€æ“ä½œå®¹å™¨ </span> </a> <nav class="md-nav" aria-label="3ã€æ“ä½œå®¹å™¨"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#31å¯åŠ¨å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.1ã€å¯åŠ¨å®¹å™¨ </span> </a> <nav class="md-nav" aria-label="3.1ã€å¯åŠ¨å®¹å™¨"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#311æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.1.1ã€æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#312å¯åŠ¨å·²ç»ˆæ­¢å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.1.2ã€å¯åŠ¨å·²ç»ˆæ­¢å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#313å®ˆæŠ¤æ€å¯åŠ¨å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.1.3ã€å®ˆæŠ¤æ€å¯åŠ¨å®¹å™¨ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#32ç»ˆæ­¢å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.2ã€ç»ˆæ­¢å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#33è¿›å…¥å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.3ã€è¿›å…¥å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#34å¯¼å‡ºå’Œå¯¼å…¥" class="md-nav__link"> <span class="md-ellipsis"> 3.4ã€å¯¼å‡ºå’Œå¯¼å…¥ </span> </a> </li> <li class="md-nav__item"> <a href="#35åˆ é™¤å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 3.5ã€åˆ é™¤å®¹å™¨ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#4è®¿é—®ä»“åº“" class="md-nav__link"> <span class="md-ellipsis"> 4ã€è®¿é—®ä»“åº“ </span> </a> <nav class="md-nav" aria-label="4ã€è®¿é—®ä»“åº“"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#41docker-hub" class="md-nav__link"> <span class="md-ellipsis"> 4.1ã€Docker Hub </span> </a> </li> <li class="md-nav__item"> <a href="#42ç§æœ‰ä»“åº“" class="md-nav__link"> <span class="md-ellipsis"> 4.2ã€ç§æœ‰ä»“åº“ </span> </a> <nav class="md-nav" aria-label="4.2ã€ç§æœ‰ä»“åº“"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#421å®‰è£…-docker-registry" class="md-nav__link"> <span class="md-ellipsis"> 4.2.1ã€å®‰è£… docker-registry </span> </a> </li> <li class="md-nav__item"> <a href="#422ä½¿ç”¨ç§æœ‰ä»“åº“" class="md-nav__link"> <span class="md-ellipsis"> 4.2.2ã€ä½¿ç”¨ç§æœ‰ä»“åº“ </span> </a> </li> <li class="md-nav__item"> <a href="#423é…ç½®é-https-åœ°å€" class="md-nav__link"> <span class="md-ellipsis"> 4.2.3ã€é…ç½®é https åœ°å€ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#5æ•°æ®ç®¡ç†" class="md-nav__link"> <span class="md-ellipsis"> 5ã€æ•°æ®ç®¡ç† </span> </a> <nav class="md-nav" aria-label="5ã€æ•°æ®ç®¡ç†"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#51æ•°æ®å·" class="md-nav__link"> <span class="md-ellipsis"> 5.1ã€æ•°æ®å· </span> </a> <nav class="md-nav" aria-label="5.1ã€æ•°æ®å·"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#511åˆ›å»ºæ•°æ®å·" class="md-nav__link"> <span class="md-ellipsis"> 5.1.1ã€åˆ›å»ºæ•°æ®å· </span> </a> </li> <li class="md-nav__item"> <a href="#512ä½¿ç”¨æ•°æ®å·å¯åŠ¨å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 5.1.2ã€ä½¿ç”¨æ•°æ®å·å¯åŠ¨å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#513åˆ é™¤æ•°æ®å·" class="md-nav__link"> <span class="md-ellipsis"> 5.1.3ã€åˆ é™¤æ•°æ®å· </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#52ç»‘å®šæŒ‚è½½" class="md-nav__link"> <span class="md-ellipsis"> 5.2ã€ç»‘å®šæŒ‚è½½ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#6ä½¿ç”¨ç½‘ç»œ" class="md-nav__link"> <span class="md-ellipsis"> 6ã€ä½¿ç”¨ç½‘ç»œ </span> </a> <nav class="md-nav" aria-label="6ã€ä½¿ç”¨ç½‘ç»œ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#61å¤–éƒ¨è®¿é—®å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 6.1ã€å¤–éƒ¨è®¿é—®å®¹å™¨ </span> </a> <nav class="md-nav" aria-label="6.1ã€å¤–éƒ¨è®¿é—®å®¹å™¨"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#611æŸ¥çœ‹æ˜ å°„ç«¯å£é…ç½®" class="md-nav__link"> <span class="md-ellipsis"> 6.1.1ã€æŸ¥çœ‹æ˜ å°„ç«¯å£é…ç½® </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#62å®¹å™¨äº’è”" class="md-nav__link"> <span class="md-ellipsis"> 6.2ã€å®¹å™¨äº’è” </span> </a> <nav class="md-nav" aria-label="6.2ã€å®¹å™¨äº’è”"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#621æ–°å»ºç½‘ç»œ" class="md-nav__link"> <span class="md-ellipsis"> 6.2.1ã€æ–°å»ºç½‘ç»œ </span> </a> </li> <li class="md-nav__item"> <a href="#622è¿æ¥å®¹å™¨" class="md-nav__link"> <span class="md-ellipsis"> 6.2.2ã€è¿æ¥å®¹å™¨ </span> </a> </li> <li class="md-nav__item"> <a href="#623æµ‹è¯•äº’è”" class="md-nav__link"> <span class="md-ellipsis"> 6.2.3ã€æµ‹è¯•äº’è” </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#63é…ç½®-dns" class="md-nav__link"> <span class="md-ellipsis"> 6.3ã€é…ç½® DNS </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#7æ„å»ºé•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 7ã€æ„å»ºé•œåƒ </span> </a> <nav class="md-nav" aria-label="7ã€æ„å»ºé•œåƒ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#71dockerfile-å®šåˆ¶é•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 7.1ã€Dockerfile å®šåˆ¶é•œåƒ </span> </a> <nav class="md-nav" aria-label="7.1ã€Dockerfile å®šåˆ¶é•œåƒ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#711from" class="md-nav__link"> <span class="md-ellipsis"> 7.1.1ã€FROM </span> </a> </li> <li class="md-nav__item"> <a href="#712run" class="md-nav__link"> <span class="md-ellipsis"> 7.1.2ã€RUN </span> </a> </li> <li class="md-nav__item"> <a href="#713æ„å»ºé•œåƒ" class="md-nav__link"> <span class="md-ellipsis"> 7.1.3ã€æ„å»ºé•œåƒ </span> </a> </li> <li class="md-nav__item"> <a href="#714é•œåƒæ„å»ºä¸Šä¸‹æ–‡" class="md-nav__link"> <span class="md-ellipsis"> 7.1.4ã€é•œåƒæ„å»ºä¸Šä¸‹æ–‡ </span> </a> </li> <li class="md-nav__item"> <a href="#715build-çš„å…¶å®ƒç”¨æ³•" class="md-nav__link"> <span class="md-ellipsis"> 7.1.5ã€build çš„å…¶å®ƒç”¨æ³• </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#72dockerfile-æŒ‡ä»¤è¯¦è§£" class="md-nav__link"> <span class="md-ellipsis"> 7.2ã€Dockerfile æŒ‡ä»¤è¯¦è§£ </span> </a> <nav class="md-nav" aria-label="7.2ã€Dockerfile æŒ‡ä»¤è¯¦è§£"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#721copy" class="md-nav__link"> <span class="md-ellipsis"> 7.2.1ã€COPY </span> </a> </li> <li class="md-nav__item"> <a href="#722add" class="md-nav__link"> <span class="md-ellipsis"> 7.2.2ã€ADD </span> </a> </li> <li class="md-nav__item"> <a href="#723cmd" class="md-nav__link"> <span class="md-ellipsis"> 7.2.3ã€CMD </span> </a> </li> <li class="md-nav__item"> <a href="#724entrypoint" class="md-nav__link"> <span class="md-ellipsis"> 7.2.4ã€ENTRYPOINT </span> </a> </li> <li class="md-nav__item"> <a href="#725env" class="md-nav__link"> <span class="md-ellipsis"> 7.2.5ã€ENV </span> </a> </li> <li class="md-nav__item"> <a href="#726arg" class="md-nav__link"> <span class="md-ellipsis"> 7.2.6ã€ARG </span> </a> </li> <li class="md-nav__item"> <a href="#727volume" class="md-nav__link"> <span class="md-ellipsis"> 7.2.7ã€VOLUME </span> </a> </li> <li class="md-nav__item"> <a href="#728expose" class="md-nav__link"> <span class="md-ellipsis"> 7.2.8ã€EXPOSE </span> </a> </li> <li class="md-nav__item"> <a href="#729workdir" class="md-nav__link"> <span class="md-ellipsis"> 7.2.9ã€WORKDIR </span> </a> </li> <li class="md-nav__item"> <a href="#7210user" class="md-nav__link"> <span class="md-ellipsis"> 7.2.10ã€USER </span> </a> </li> <li class="md-nav__item"> <a href="#7211healthcheck" class="md-nav__link"> <span class="md-ellipsis"> 7.2.11ã€HEALTHCHECK </span> </a> </li> <li class="md-nav__item"> <a href="#7212onbuild" class="md-nav__link"> <span class="md-ellipsis"> 7.2.12ã€ONBUILD </span> </a> </li> <li class="md-nav__item"> <a href="#7213label" class="md-nav__link"> <span class="md-ellipsis"> 7.2.13ã€LABEL </span> </a> </li> <li class="md-nav__item"> <a href="#7214shell" class="md-nav__link"> <span class="md-ellipsis"> 7.2.14ã€SHELL </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#73docker-buildx" class="md-nav__link"> <span class="md-ellipsis"> 7.3ã€Docker Buildx </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <nav class="md-path" aria-label="å¯¼èˆªæ "> <ol class="md-path__list"> <li class="md-path__item"> <a href="../index.html" class="md-path__link"> <span class="md-ellipsis"> ğŸ  é¦–é¡µ </span> </a> </li> <li class="md-path__item"> <a href="Docker.html" class="md-path__link"> <span class="md-ellipsis"> ğŸ§‘â€ğŸ”§ è¿ç»´ </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <h1 id="docker">Docker<a class="headerlink" href="#docker" title="é”šç‚¹é“¾æ¥">Â¶</a></h1> <h2 id="1ç®€ä»‹">1ã€ç®€ä»‹<a class="headerlink" href="#1ç®€ä»‹" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <h3 id="11æ¦‚è¿°">1.1ã€æ¦‚è¿°<a class="headerlink" href="#11æ¦‚è¿°" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <h4 id="111ä»€ä¹ˆæ˜¯-docker">1.1.1ã€ä»€ä¹ˆæ˜¯ Docker<a class="headerlink" href="#111ä»€ä¹ˆæ˜¯-docker" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>Docker æœ€åˆæ˜¯ dotCloud å…¬å¸åˆ›å§‹äºº Solomon Hykes åœ¨æ³•å›½æœŸé—´å‘èµ·çš„ä¸€ä¸ªå…¬å¸å†…éƒ¨é¡¹ç›®ï¼Œå®ƒæ˜¯åŸºäº dotCloud å…¬å¸å¤šå¹´äº‘æœåŠ¡æŠ€æœ¯çš„ä¸€æ¬¡é©æ–°ï¼Œå¹¶äº 2013 å¹´ 3 æœˆä»¥ Apache 2.0 æˆæƒåè®®å¼€æºï¼Œä¸»è¦é¡¹ç›®ä»£ç åœ¨ GitHub ä¸Šè¿›è¡Œç»´æŠ¤ã€‚Docker é¡¹ç›®åæ¥è¿˜åŠ å…¥äº† Linux åŸºé‡‘ä¼šï¼Œå¹¶æˆç«‹æ¨åŠ¨ å¼€æ”¾å®¹å™¨è”ç›Ÿï¼ˆOCIï¼‰ã€‚</p> <p>Docker è‡ªå¼€æºåå—åˆ°å¹¿æ³›çš„å…³æ³¨å’Œè®¨è®ºï¼Œè‡³ä»Šå…¶ GitHub é¡¹ç›® å·²ç»è¶…è¿‡ 5 ä¸‡ 7 åƒä¸ªæ˜Ÿæ ‡å’Œä¸€ä¸‡å¤šä¸ª forkã€‚ç”šè‡³ç”±äº Docker é¡¹ç›®çš„ç«çˆ†ï¼Œåœ¨ 2013 å¹´åº•ï¼ŒdotCloud å…¬å¸å†³å®šæ”¹åä¸º Dockerã€‚Docker æœ€åˆæ˜¯åœ¨ Ubuntu 12.04 ä¸Šå¼€å‘å®ç°çš„ï¼›Red Hat åˆ™ä» RHEL 6.5 å¼€å§‹å¯¹ Docker è¿›è¡Œæ”¯æŒï¼›Google ä¹Ÿåœ¨å…¶ PaaS äº§å“ä¸­å¹¿æ³›åº”ç”¨ Dockerã€‚</p> <p>Docker ä½¿ç”¨ Google å…¬å¸æ¨å‡ºçš„ Go è¯­è¨€è¿›è¡Œå¼€å‘å®ç°ï¼ŒåŸºäº Linux å†…æ ¸çš„ cgroupã€namespace ä»¥åŠ OverlayFS ç±»çš„ Union FS ç­‰æŠ€æœ¯ï¼Œå¯¹è¿›ç¨‹è¿›è¡Œå°è£…éš”ç¦»ï¼Œå±äº æ“ä½œç³»ç»Ÿå±‚é¢çš„è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚ç”±äºéš”ç¦»çš„è¿›ç¨‹ç‹¬ç«‹äºå®¿ä¸»å’Œå…¶å®ƒçš„éš”ç¦»çš„è¿›ç¨‹ï¼Œå› æ­¤ä¹Ÿç§°å…¶ä¸ºå®¹å™¨ã€‚æœ€åˆå®ç°æ˜¯åŸºäº LXCï¼Œä» 0.7 ç‰ˆæœ¬ä»¥åå¼€å§‹å»é™¤ LXCï¼Œè½¬è€Œä½¿ç”¨è‡ªè¡Œå¼€å‘çš„ libcontainerï¼Œä» 1.11 ç‰ˆæœ¬å¼€å§‹ï¼Œåˆ™è¿›ä¸€æ­¥æ¼”è¿›ä¸ºä½¿ç”¨ runc å’Œ containerdã€‚</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/Docker/QQ_1726405952388.png" data-desc-position="bottom"><img src="!assets/Docker/QQ_1726405952388.png" alt="QQ_1726405952388" style="zoom:33%;"></a></p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>runc æ˜¯ä¸€ä¸ª Linux å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºæ ¹æ® OCI å®¹å™¨è¿è¡Œæ—¶è§„èŒƒ åˆ›å»ºå’Œè¿è¡Œå®¹å™¨ã€‚</p> <p>containerd æ˜¯ä¸€ä¸ªå®ˆæŠ¤ç¨‹åºï¼Œå®ƒç®¡ç†å®¹å™¨ç”Ÿå‘½å‘¨æœŸï¼Œæä¾›äº†åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šæ‰§è¡Œå®¹å™¨å’Œç®¡ç†é•œåƒçš„æœ€å°åŠŸèƒ½é›†ã€‚</p> </div> <p>Docker åœ¨å®¹å™¨çš„åŸºç¡€ä¸Šï¼Œè¿›è¡Œäº†è¿›ä¸€æ­¥çš„å°è£…ï¼Œä»æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œäº’è”åˆ°è¿›ç¨‹éš”ç¦»ç­‰ç­‰ï¼Œæå¤§çš„ç®€åŒ–äº†å®¹å™¨çš„åˆ›å»ºå’Œç»´æŠ¤ã€‚ä½¿å¾— Docker æŠ€æœ¯æ¯”è™šæ‹ŸæœºæŠ€æœ¯æ›´ä¸ºè½»ä¾¿ã€å¿«æ·ã€‚</p> <p>Docker å’Œä¼ ç»Ÿè™šæ‹ŸåŒ–æ–¹å¼çš„ä¸åŒä¹‹å¤„ã€‚ä¼ ç»Ÿè™šæ‹ŸæœºæŠ€æœ¯æ˜¯è™šæ‹Ÿå‡ºä¸€å¥—ç¡¬ä»¶åï¼Œåœ¨å…¶ä¸Šè¿è¡Œä¸€ä¸ªå®Œæ•´æ“ä½œç³»ç»Ÿï¼Œåœ¨è¯¥ç³»ç»Ÿä¸Šå†è¿è¡Œæ‰€éœ€åº”ç”¨è¿›ç¨‹ï¼›è€Œå®¹å™¨å†…çš„åº”ç”¨è¿›ç¨‹ç›´æ¥è¿è¡Œäºå®¿ä¸»çš„å†…æ ¸ï¼Œå®¹å™¨å†…æ²¡æœ‰è‡ªå·±çš„å†…æ ¸ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰è¿›è¡Œç¡¬ä»¶è™šæ‹Ÿã€‚å› æ­¤å®¹å™¨è¦æ¯”ä¼ ç»Ÿè™šæ‹Ÿæœºæ›´ä¸ºè½»ä¾¿ã€‚</p> <h4 id="112ä¸ºä»€ä¹ˆè¦ç”¨-docker">1.1.2ã€ä¸ºä»€ä¹ˆè¦ç”¨ Docker<a class="headerlink" href="#112ä¸ºä»€ä¹ˆè¦ç”¨-docker" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>ä½œä¸ºä¸€ç§æ–°å…´çš„è™šæ‹ŸåŒ–æ–¹å¼ï¼ŒDocker è·Ÿä¼ ç»Ÿçš„è™šæ‹ŸåŒ–æ–¹å¼ç›¸æ¯”å…·æœ‰ä¼—å¤šçš„ä¼˜åŠ¿ã€‚</p> <p><strong>æ›´é«˜æ•ˆçš„åˆ©ç”¨ç³»ç»Ÿèµ„æº</strong></p> <p>ç”±äºå®¹å™¨ä¸éœ€è¦è¿›è¡Œç¡¬ä»¶è™šæ‹Ÿä»¥åŠè¿è¡Œå®Œæ•´æ“ä½œç³»ç»Ÿç­‰é¢å¤–å¼€é”€ï¼ŒDocker å¯¹ç³»ç»Ÿèµ„æºçš„åˆ©ç”¨ç‡æ›´é«˜ã€‚æ— è®ºæ˜¯åº”ç”¨æ‰§è¡Œé€Ÿåº¦ã€å†…å­˜æŸè€—æˆ–è€…æ–‡ä»¶å­˜å‚¨é€Ÿåº¦ï¼Œéƒ½è¦æ¯”ä¼ ç»Ÿè™šæ‹ŸæœºæŠ€æœ¯æ›´é«˜æ•ˆã€‚å› æ­¤ï¼Œç›¸æ¯”è™šæ‹ŸæœºæŠ€æœ¯ï¼Œä¸€ä¸ªç›¸åŒé…ç½®çš„ä¸»æœºï¼Œå¾€å¾€å¯ä»¥è¿è¡Œæ›´å¤šæ•°é‡çš„åº”ç”¨ã€‚</p> <p><strong>æ›´å¿«é€Ÿçš„å¯åŠ¨æ—¶é—´</strong></p> <p>ä¼ ç»Ÿçš„è™šæ‹ŸæœºæŠ€æœ¯å¯åŠ¨åº”ç”¨æœåŠ¡å¾€å¾€éœ€è¦æ•°åˆ†é’Ÿï¼Œè€Œ Docker å®¹å™¨åº”ç”¨ï¼Œç”±äºç›´æ¥è¿è¡Œäºå®¿ä¸»å†…æ ¸ï¼Œæ— éœ€å¯åŠ¨å®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œå› æ­¤å¯ä»¥åšåˆ°ç§’çº§ã€ç”šè‡³æ¯«ç§’çº§çš„å¯åŠ¨æ—¶é—´ã€‚å¤§å¤§çš„èŠ‚çº¦äº†å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²çš„æ—¶é—´ã€‚</p> <p><strong>ä¸€è‡´çš„è¿è¡Œç¯å¢ƒ</strong></p> <p>å¼€å‘è¿‡ç¨‹ä¸­ä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯ç¯å¢ƒä¸€è‡´æ€§é—®é¢˜ã€‚ç”±äºå¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒä¸ä¸€è‡´ï¼Œå¯¼è‡´æœ‰äº› bug å¹¶æœªåœ¨å¼€å‘è¿‡ç¨‹ä¸­è¢«å‘ç°ã€‚è€Œ Docker çš„é•œåƒæä¾›äº†é™¤å†…æ ¸å¤–å®Œæ•´çš„è¿è¡Œæ—¶ç¯å¢ƒï¼Œç¡®ä¿äº†åº”ç”¨è¿è¡Œç¯å¢ƒä¸€è‡´æ€§ï¼Œä»è€Œä¸ä¼šå†å‡ºç°ã€Œè¿™æ®µä»£ç åœ¨æˆ‘æœºå™¨ä¸Šæ²¡é—®é¢˜å•Šã€è¿™ç±»é—®é¢˜ã€‚</p> <p><strong>æŒç»­äº¤ä»˜å’Œéƒ¨ç½²</strong></p> <p>å¯¹å¼€å‘å’Œè¿ç»´ï¼ˆDevOpsï¼‰äººå‘˜æ¥è¯´ï¼Œæœ€å¸Œæœ›çš„å°±æ˜¯ä¸€æ¬¡åˆ›å»ºæˆ–é…ç½®ï¼Œå¯ä»¥åœ¨ä»»æ„åœ°æ–¹æ­£å¸¸è¿è¡Œã€‚</p> <p>ä½¿ç”¨ Docker å¯ä»¥é€šè¿‡å®šåˆ¶åº”ç”¨é•œåƒæ¥å®ç°æŒç»­é›†æˆã€æŒç»­äº¤ä»˜ã€éƒ¨ç½²ã€‚å¼€å‘äººå‘˜å¯ä»¥é€šè¿‡ Dockerfile æ¥è¿›è¡Œé•œåƒæ„å»ºï¼Œå¹¶ç»“åˆæŒç»­é›†æˆï¼ˆContinuous Integrationï¼‰ç³»ç»Ÿè¿›è¡Œé›†æˆæµ‹è¯•ï¼Œè€Œè¿ç»´äººå‘˜åˆ™å¯ä»¥ç›´æ¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¿«é€Ÿéƒ¨ç½²è¯¥é•œåƒï¼Œç”šè‡³ç»“åˆæŒç»­éƒ¨ç½²ï¼ˆContinuous Delivery/Deploymentï¼‰ç³»ç»Ÿè¿›è¡Œè‡ªåŠ¨éƒ¨ç½²ã€‚</p> <p>è€Œä¸”ä½¿ç”¨ Dockerfile ä½¿é•œåƒæ„å»ºé€æ˜åŒ–ï¼Œä¸ä»…ä»…å¼€å‘å›¢é˜Ÿå¯ä»¥ç†è§£åº”ç”¨è¿è¡Œç¯å¢ƒï¼Œä¹Ÿæ–¹ä¾¿è¿ç»´å›¢é˜Ÿç†è§£åº”ç”¨è¿è¡Œæ‰€éœ€æ¡ä»¶ï¼Œå¸®åŠ©æ›´å¥½çš„ç”Ÿäº§ç¯å¢ƒä¸­éƒ¨ç½²è¯¥é•œåƒã€‚</p> <p><strong>æ›´è½»æ¾çš„è¿ç§»</strong></p> <p>ç”±äº Docker ç¡®ä¿äº†æ‰§è¡Œç¯å¢ƒçš„ä¸€è‡´æ€§ï¼Œä½¿å¾—åº”ç”¨çš„è¿ç§»æ›´åŠ å®¹æ˜“ã€‚Docker å¯ä»¥åœ¨å¾ˆå¤šå¹³å°ä¸Šè¿è¡Œï¼Œæ— è®ºæ˜¯ç‰©ç†æœºã€è™šæ‹Ÿæœºã€å…¬æœ‰äº‘ã€ç§æœ‰äº‘ï¼Œç”šè‡³æ˜¯ç¬”è®°æœ¬ï¼Œå…¶è¿è¡Œç»“æœæ˜¯ä¸€è‡´çš„ã€‚å› æ­¤ç”¨æˆ·å¯ä»¥å¾ˆè½»æ˜“çš„å°†åœ¨ä¸€ä¸ªå¹³å°ä¸Šè¿è¡Œçš„åº”ç”¨ï¼Œè¿ç§»åˆ°å¦ä¸€ä¸ªå¹³å°ä¸Šï¼Œè€Œä¸ç”¨æ‹…å¿ƒè¿è¡Œç¯å¢ƒçš„å˜åŒ–å¯¼è‡´åº”ç”¨æ— æ³•æ­£å¸¸è¿è¡Œçš„æƒ…å†µã€‚</p> <p><strong>æ›´è½»æ¾çš„ç»´æŠ¤å’Œæ‰©å±•</strong></p> <p>Docker ä½¿ç”¨çš„åˆ†å±‚å­˜å‚¨ä»¥åŠé•œåƒçš„æŠ€æœ¯ï¼Œä½¿å¾—åº”ç”¨é‡å¤éƒ¨åˆ†çš„å¤ç”¨æ›´ä¸ºå®¹æ˜“ï¼Œä¹Ÿä½¿å¾—åº”ç”¨çš„ç»´æŠ¤æ›´æ–°æ›´åŠ ç®€å•ï¼ŒåŸºäºåŸºç¡€é•œåƒè¿›ä¸€æ­¥æ‰©å±•é•œåƒä¹Ÿå˜å¾—éå¸¸ç®€å•ã€‚æ­¤å¤–ï¼ŒDocker å›¢é˜ŸåŒå„ä¸ªå¼€æºé¡¹ç›®å›¢é˜Ÿä¸€èµ·ç»´æŠ¤äº†ä¸€å¤§æ‰¹é«˜è´¨é‡çš„ å®˜æ–¹é•œåƒï¼Œæ—¢å¯ä»¥ç›´æ¥åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Œåˆå¯ä»¥ä½œä¸ºåŸºç¡€è¿›ä¸€æ­¥å®šåˆ¶ï¼Œå¤§å¤§çš„é™ä½äº†åº”ç”¨æœåŠ¡çš„é•œåƒåˆ¶ä½œæˆæœ¬ã€‚</p> <p><strong>å¯¹æ¯”ä¼ ç»Ÿè™šæ‹Ÿæœºæ€»ç»“</strong></p> <table> <thead> <tr> <th style="text-align: left;">ç‰¹æ€§</th> <th style="text-align: left;">å®¹å™¨</th> <th style="text-align: left;">è™šæ‹Ÿæœº</th> </tr> </thead> <tbody> <tr> <td style="text-align: left;">å¯åŠ¨</td> <td style="text-align: left;">ç§’çº§</td> <td style="text-align: left;">åˆ†é’Ÿçº§</td> </tr> <tr> <td style="text-align: left;">ç¡¬ç›˜ä½¿ç”¨</td> <td style="text-align: left;">ä¸€èˆ¬ä¸º MB</td> <td style="text-align: left;">ä¸€èˆ¬ä¸º GB</td> </tr> <tr> <td style="text-align: left;">æ€§èƒ½</td> <td style="text-align: left;">æ¥è¿‘åŸç”Ÿ</td> <td style="text-align: left;">å¼±äº</td> </tr> <tr> <td style="text-align: left;">ç³»ç»Ÿæ”¯æŒé‡</td> <td style="text-align: left;">å•æœºæ”¯æŒä¸Šåƒä¸ªå®¹å™¨</td> <td style="text-align: left;">ä¸€èˆ¬å‡ åä¸ª</td> </tr> </tbody> </table> <h3 id="12åŸºæœ¬æ¦‚å¿µ">1.2ã€åŸºæœ¬æ¦‚å¿µ<a class="headerlink" href="#12åŸºæœ¬æ¦‚å¿µ" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>Docker åŒ…æ‹¬ä¸‰ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p> <ul> <li>é•œåƒï¼ˆImageï¼‰</li> <li>å®¹å™¨ï¼ˆContainerï¼‰</li> <li>ä»“åº“ï¼ˆRepositoryï¼‰</li> </ul> <p>ç†è§£äº†è¿™ä¸‰ä¸ªæ¦‚å¿µï¼Œå°±ç†è§£äº† Docker çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚</p> <h4 id="121é•œåƒ">1.2.1ã€é•œåƒ<a class="headerlink" href="#121é•œåƒ" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæ“ä½œç³»ç»Ÿåˆ†ä¸ºå†…æ ¸å’Œç”¨æˆ·ç©ºé—´ã€‚å¯¹äº Linux è€Œè¨€ï¼Œå†…æ ¸å¯åŠ¨åï¼Œä¼šæŒ‚è½½ root æ–‡ä»¶ç³»ç»Ÿä¸ºå…¶æä¾›ç”¨æˆ·ç©ºé—´æ”¯æŒã€‚è€Œ Docker é•œåƒï¼ˆImageï¼‰ï¼Œå°±ç›¸å½“äºæ˜¯ä¸€ä¸ª root æ–‡ä»¶ç³»ç»Ÿã€‚æ¯”å¦‚å®˜æ–¹é•œåƒ ubuntu:18.04 å°±åŒ…å«äº†å®Œæ•´çš„ä¸€å¥— Ubuntu 18.04 æœ€å°ç³»ç»Ÿçš„ root æ–‡ä»¶ç³»ç»Ÿã€‚</p> <p>Docker é•œåƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ç³»ç»Ÿï¼Œé™¤äº†æä¾›å®¹å™¨è¿è¡Œæ—¶æ‰€éœ€çš„ç¨‹åºã€åº“ã€èµ„æºã€é…ç½®ç­‰æ–‡ä»¶å¤–ï¼Œè¿˜åŒ…å«äº†ä¸€äº›ä¸ºè¿è¡Œæ—¶å‡†å¤‡çš„ä¸€äº›é…ç½®å‚æ•°ï¼ˆå¦‚åŒ¿åå·ã€ç¯å¢ƒå˜é‡ã€ç”¨æˆ·ç­‰ï¼‰ã€‚é•œåƒä¸åŒ…å«ä»»ä½•åŠ¨æ€æ•°æ®ï¼Œå…¶å†…å®¹åœ¨æ„å»ºä¹‹åä¹Ÿä¸ä¼šè¢«æ”¹å˜ã€‚</p> <p><strong>åˆ†å±‚å­˜å‚¨</strong></p> <p>å› ä¸ºé•œåƒåŒ…å«æ“ä½œç³»ç»Ÿå®Œæ•´çš„ root æ–‡ä»¶ç³»ç»Ÿï¼Œå…¶ä½“ç§¯å¾€å¾€æ˜¯åºå¤§çš„ï¼Œå› æ­¤åœ¨ Docker è®¾è®¡æ—¶ï¼Œå°±å……åˆ†åˆ©ç”¨ Union FS çš„æŠ€æœ¯ï¼Œå°†å…¶è®¾è®¡ä¸ºåˆ†å±‚å­˜å‚¨çš„æ¶æ„ã€‚æ‰€ä»¥ä¸¥æ ¼æ¥è¯´ï¼Œé•œåƒå¹¶éæ˜¯åƒä¸€ä¸ª ISO é‚£æ ·çš„æ‰“åŒ…æ–‡ä»¶ï¼Œé•œåƒåªæ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„æ¦‚å¿µï¼Œå…¶å®é™…ä½“ç°å¹¶éç”±ä¸€ä¸ªæ–‡ä»¶ç»„æˆï¼Œè€Œæ˜¯ç”±ä¸€ç»„æ–‡ä»¶ç³»ç»Ÿç»„æˆï¼Œæˆ–è€…è¯´ï¼Œç”±å¤šå±‚æ–‡ä»¶ç³»ç»Ÿè”åˆç»„æˆã€‚</p> <p>é•œåƒæ„å»ºæ—¶ï¼Œä¼šä¸€å±‚å±‚æ„å»ºï¼Œå‰ä¸€å±‚æ˜¯åä¸€å±‚çš„åŸºç¡€ã€‚æ¯ä¸€å±‚æ„å»ºå®Œå°±ä¸ä¼šå†å‘ç”Ÿæ”¹å˜ï¼Œåä¸€å±‚ä¸Šçš„ä»»ä½•æ”¹å˜åªå‘ç”Ÿåœ¨è‡ªå·±è¿™ä¸€å±‚ã€‚æ¯”å¦‚ï¼Œåˆ é™¤å‰ä¸€å±‚æ–‡ä»¶çš„æ“ä½œï¼Œå®é™…ä¸æ˜¯çœŸçš„åˆ é™¤å‰ä¸€å±‚çš„æ–‡ä»¶ï¼Œè€Œæ˜¯ä»…åœ¨å½“å‰å±‚æ ‡è®°ä¸ºè¯¥æ–‡ä»¶å·²åˆ é™¤ã€‚åœ¨æœ€ç»ˆå®¹å™¨è¿è¡Œçš„æ—¶å€™ï¼Œè™½ç„¶ä¸ä¼šçœ‹åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯å®é™…ä¸Šè¯¥æ–‡ä»¶ä¼šä¸€ç›´è·Ÿéšé•œåƒã€‚å› æ­¤ï¼Œåœ¨æ„å»ºé•œåƒçš„æ—¶å€™ï¼Œéœ€è¦é¢å¤–å°å¿ƒï¼Œæ¯ä¸€å±‚å°½é‡åªåŒ…å«è¯¥å±‚éœ€è¦æ·»åŠ çš„ä¸œè¥¿ï¼Œä»»ä½•é¢å¤–çš„ä¸œè¥¿åº”è¯¥åœ¨è¯¥å±‚æ„å»ºç»“æŸå‰æ¸…ç†æ‰ã€‚</p> <p>åˆ†å±‚å­˜å‚¨çš„ç‰¹å¾è¿˜ä½¿å¾—é•œåƒçš„å¤ç”¨ã€å®šåˆ¶å˜çš„æ›´ä¸ºå®¹æ˜“ã€‚ç”šè‡³å¯ä»¥ç”¨ä¹‹å‰æ„å»ºå¥½çš„é•œåƒä½œä¸ºåŸºç¡€å±‚ï¼Œç„¶åè¿›ä¸€æ­¥æ·»åŠ æ–°çš„å±‚ï¼Œä»¥å®šåˆ¶è‡ªå·±æ‰€éœ€çš„å†…å®¹ï¼Œæ„å»ºæ–°çš„é•œåƒã€‚</p> <h4 id="122å®¹å™¨">1.2.2ã€å®¹å™¨<a class="headerlink" href="#122å®¹å™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>é•œåƒï¼ˆImageï¼‰å’Œå®¹å™¨ï¼ˆContainerï¼‰çš„å…³ç³»ï¼Œå°±åƒæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­çš„ç±»å’Œå®ä¾‹ ä¸€æ ·ï¼Œé•œåƒæ˜¯é™æ€çš„å®šä¹‰ï¼Œå®¹å™¨æ˜¯é•œåƒè¿è¡Œæ—¶çš„å®ä½“ã€‚å®¹å™¨å¯ä»¥è¢«åˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤ã€æš‚åœç­‰ã€‚</p> <p>å®¹å™¨çš„å®è´¨æ˜¯è¿›ç¨‹ï¼Œä½†ä¸ç›´æ¥åœ¨å®¿ä¸»æ‰§è¡Œçš„è¿›ç¨‹ä¸åŒï¼Œå®¹å™¨è¿›ç¨‹è¿è¡Œäºå±äºè‡ªå·±çš„ç‹¬ç«‹çš„å‘½åç©ºé—´ã€‚å› æ­¤å®¹å™¨å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„ root æ–‡ä»¶ç³»ç»Ÿã€è‡ªå·±çš„ç½‘ç»œé…ç½®ã€è‡ªå·±çš„è¿›ç¨‹ç©ºé—´ï¼Œç”šè‡³è‡ªå·±çš„ç”¨æˆ· ID ç©ºé—´ã€‚å®¹å™¨å†…çš„è¿›ç¨‹æ˜¯è¿è¡Œåœ¨ä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒé‡Œï¼Œä½¿ç”¨èµ·æ¥ï¼Œå°±å¥½åƒæ˜¯åœ¨ä¸€ä¸ªç‹¬ç«‹äºå®¿ä¸»çš„ç³»ç»Ÿä¸‹æ“ä½œä¸€æ ·ã€‚è¿™ç§ç‰¹æ€§ä½¿å¾—å®¹å™¨å°è£…çš„åº”ç”¨æ¯”ç›´æ¥åœ¨å®¿ä¸»è¿è¡Œæ›´åŠ å®‰å…¨ã€‚ä¹Ÿå› ä¸ºè¿™ç§éš”ç¦»çš„ç‰¹æ€§ï¼Œå¾ˆå¤šäººåˆå­¦ Docker æ—¶å¸¸å¸¸ä¼šæ··æ·†å®¹å™¨å’Œè™šæ‹Ÿæœºã€‚</p> <p>å‰é¢è®²è¿‡é•œåƒä½¿ç”¨çš„æ˜¯åˆ†å±‚å­˜å‚¨ï¼Œå®¹å™¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æ¯ä¸€ä¸ªå®¹å™¨è¿è¡Œæ—¶ï¼Œæ˜¯ä»¥é•œåƒä¸ºåŸºç¡€å±‚ï¼Œåœ¨å…¶ä¸Šåˆ›å»ºä¸€ä¸ªå½“å‰å®¹å™¨çš„å­˜å‚¨å±‚ï¼Œæˆ‘ä»¬å¯ä»¥ç§°è¿™ä¸ªä¸ºäº†å®¹å™¨è¿è¡Œæ—¶è¯»å†™è€Œå‡†å¤‡çš„å­˜å‚¨å±‚ä¸ºå®¹å™¨å­˜å‚¨å±‚ã€‚</p> <p>å®¹å™¨å­˜å‚¨å±‚çš„ç”Ÿå­˜å‘¨æœŸå’Œå®¹å™¨ä¸€æ ·ï¼Œå®¹å™¨æ¶ˆäº¡æ—¶ï¼Œå®¹å™¨å­˜å‚¨å±‚ä¹Ÿéšä¹‹æ¶ˆäº¡ã€‚å› æ­¤ï¼Œä»»ä½•ä¿å­˜äºå®¹å™¨å­˜å‚¨å±‚çš„ä¿¡æ¯éƒ½ä¼šéšå®¹å™¨åˆ é™¤è€Œä¸¢å¤±ã€‚</p> <p>æŒ‰ç…§ Docker æœ€ä½³å®è·µçš„è¦æ±‚ï¼Œå®¹å™¨ä¸åº”è¯¥å‘å…¶å­˜å‚¨å±‚å†…å†™å…¥ä»»ä½•æ•°æ®ï¼Œå®¹å™¨å­˜å‚¨å±‚è¦ä¿æŒæ— çŠ¶æ€åŒ–ã€‚æ‰€æœ‰çš„æ–‡ä»¶å†™å…¥æ“ä½œï¼Œéƒ½åº”è¯¥ä½¿ç”¨æ•°æ®å·ï¼ˆVolumeï¼‰ã€æˆ–è€…ç»‘å®šå®¿ä¸»ç›®å½•ï¼Œåœ¨è¿™äº›ä½ç½®çš„è¯»å†™ä¼šè·³è¿‡å®¹å™¨å­˜å‚¨å±‚ï¼Œç›´æ¥å¯¹å®¿ä¸»ï¼ˆæˆ–ç½‘ç»œå­˜å‚¨ï¼‰å‘ç”Ÿè¯»å†™ï¼Œå…¶æ€§èƒ½å’Œç¨³å®šæ€§æ›´é«˜ã€‚</p> <p>æ•°æ®å·çš„ç”Ÿå­˜å‘¨æœŸç‹¬ç«‹äºå®¹å™¨ï¼Œå®¹å™¨æ¶ˆäº¡ï¼Œæ•°æ®å·ä¸ä¼šæ¶ˆäº¡ã€‚å› æ­¤ï¼Œä½¿ç”¨æ•°æ®å·åï¼Œå®¹å™¨åˆ é™¤æˆ–è€…é‡æ–°è¿è¡Œä¹‹åï¼Œæ•°æ®å´ä¸ä¼šä¸¢å¤±ã€‚</p> <h4 id="123ä»“åº“">1.2.3ã€ä»“åº“<a class="headerlink" href="#123ä»“åº“" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>é•œåƒæ„å»ºå®Œæˆåï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„åœ¨å½“å‰å®¿ä¸»æœºä¸Šè¿è¡Œï¼Œä½†æ˜¯ï¼Œå¦‚æœéœ€è¦åœ¨å…¶å®ƒæœåŠ¡å™¨ä¸Šä½¿ç”¨è¿™ä¸ªé•œåƒï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªé›†ä¸­çš„å­˜å‚¨ã€åˆ†å‘é•œåƒçš„æœåŠ¡ï¼ŒDocker Registry å°±æ˜¯è¿™æ ·çš„æœåŠ¡ã€‚</p> <p>ä¸€ä¸ª Docker Registry ä¸­å¯ä»¥åŒ…å«å¤šä¸ªä»“åº“ï¼ˆRepositoryï¼‰ï¼Œæ¯ä¸ªä»“åº“å¯ä»¥åŒ…å«å¤šä¸ªæ ‡ç­¾ï¼ˆTagï¼‰ï¼Œæ¯ä¸ªæ ‡ç­¾å¯¹åº”ä¸€ä¸ªé•œåƒã€‚</p> <p>é€šå¸¸ï¼Œä¸€ä¸ªä»“åº“ä¼šåŒ…å«åŒä¸€ä¸ªè½¯ä»¶ä¸åŒç‰ˆæœ¬çš„é•œåƒï¼Œè€Œæ ‡ç­¾å°±å¸¸ç”¨äºå¯¹åº”è¯¥è½¯ä»¶çš„å„ä¸ªç‰ˆæœ¬ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>&lt;ä»“åº“å&gt;:&lt;æ ‡ç­¾&gt;</code> çš„æ ¼å¼æ¥æŒ‡å®šå…·ä½“æ˜¯è¿™ä¸ªè½¯ä»¶å“ªä¸ªç‰ˆæœ¬çš„é•œåƒã€‚å¦‚æœä¸ç»™å‡ºæ ‡ç­¾ï¼Œå°†ä»¥ latest ä½œä¸ºé»˜è®¤æ ‡ç­¾ã€‚</p> <p>ä»¥ Ubuntu é•œåƒä¸ºä¾‹ï¼Œubuntu æ˜¯ä»“åº“çš„åå­—ï¼Œå…¶å†…åŒ…å«æœ‰ä¸åŒçš„ç‰ˆæœ¬æ ‡ç­¾ï¼Œå¦‚ï¼š16.04ã€18.04ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>ubuntu:16.04</code> æˆ–è€… <code>ubuntu:18.04</code> æ¥å…·ä½“æŒ‡å®šæ‰€éœ€å“ªä¸ªç‰ˆæœ¬çš„é•œåƒã€‚å¦‚æœå¿½ç•¥äº†æ ‡ç­¾ï¼Œæ¯”å¦‚ ubuntuï¼Œé‚£å°†è§†ä¸º <code>ubuntu:latest</code>ã€‚</p> <p>ä»“åº“åç»å¸¸ä»¥ä¸¤æ®µå¼è·¯å¾„å½¢å¼å‡ºç°ï¼Œæ¯”å¦‚ <code>jwilder/nginx-proxy</code>ï¼Œå‰è€…å¾€å¾€æ„å‘³ç€ Docker Registry å¤šç”¨æˆ·ç¯å¢ƒä¸‹çš„ç”¨æˆ·åï¼Œåè€…åˆ™å¾€å¾€æ˜¯å¯¹åº”çš„è½¯ä»¶åã€‚ä½†è¿™å¹¶éç»å¯¹ï¼Œå–å†³äºæ‰€ä½¿ç”¨çš„å…·ä½“ Docker Registry çš„è½¯ä»¶æˆ–æœåŠ¡ã€‚</p> <p><strong>Docker Registry å…¬å¼€æœåŠ¡</strong></p> <p>Docker Registry å…¬å¼€æœåŠ¡æ˜¯å¼€æ”¾ç»™ç”¨æˆ·ä½¿ç”¨ã€å…è®¸ç”¨æˆ·ç®¡ç†é•œåƒçš„ Registry æœåŠ¡ã€‚ä¸€èˆ¬è¿™ç±»å…¬å¼€æœåŠ¡å…è®¸ç”¨æˆ·å…è´¹ä¸Šä¼ ã€ä¸‹è½½å…¬å¼€çš„é•œåƒï¼Œå¹¶å¯èƒ½æä¾›æ”¶è´¹æœåŠ¡ä¾›ç”¨æˆ·ç®¡ç†ç§æœ‰é•œåƒã€‚</p> <p>æœ€å¸¸ä½¿ç”¨çš„ Registry å…¬å¼€æœåŠ¡æ˜¯å®˜æ–¹çš„ Docker Hubï¼Œè¿™ä¹Ÿæ˜¯é»˜è®¤çš„ Registryï¼Œå¹¶æ‹¥æœ‰å¤§é‡çš„é«˜è´¨é‡çš„å®˜æ–¹é•œåƒã€‚é™¤æ­¤ä»¥å¤–ï¼Œè¿˜æœ‰ Red Hat çš„ Quay.ioã€Google çš„ Google Container Registryï¼ˆKubernetes çš„é•œåƒä½¿ç”¨çš„å°±æ˜¯è¿™ä¸ªæœåŠ¡ï¼‰ã€ä»£ç æ‰˜ç®¡å¹³å° GitHub æ¨å‡ºçš„ ghcr.ioã€‚</p> <p>ç”±äºæŸäº›åŸå› ï¼Œåœ¨å›½å†…è®¿é—®è¿™äº›æœåŠ¡å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ã€‚å›½å†…çš„ä¸€äº›äº‘æœåŠ¡å•†æä¾›äº†é’ˆå¯¹ Docker Hub çš„é•œåƒæœåŠ¡ï¼ˆRegistry Mirrorï¼‰ï¼Œè¿™äº›é•œåƒæœåŠ¡è¢«ç§°ä¸ºåŠ é€Ÿå™¨ã€‚å¸¸è§çš„æœ‰é˜¿é‡Œäº‘åŠ é€Ÿå™¨ã€DaoCloud åŠ é€Ÿå™¨ç­‰ã€‚ä½¿ç”¨åŠ é€Ÿå™¨ä¼šç›´æ¥ä»å›½å†…çš„åœ°å€ä¸‹è½½ Docker Hub çš„é•œåƒï¼Œæ¯”ç›´æ¥ä» Docker Hub ä¸‹è½½é€Ÿåº¦ä¼šæé«˜å¾ˆå¤šã€‚</p> <p>å›½å†…ä¹Ÿæœ‰ä¸€äº›äº‘æœåŠ¡å•†æä¾›ç±»ä¼¼äº Docker Hub çš„å…¬å¼€æœåŠ¡ã€‚æ¯”å¦‚ç½‘æ˜“äº‘é•œåƒæœåŠ¡ã€DaoCloud é•œåƒå¸‚åœºã€é˜¿é‡Œäº‘é•œåƒåº“ç­‰ã€‚</p> <p><strong>ç§æœ‰ Docker Registry</strong></p> <p>é™¤äº†ä½¿ç”¨å…¬å¼€æœåŠ¡å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥åœ¨æœ¬åœ°æ­å»ºç§æœ‰ Docker Registryã€‚Docker å®˜æ–¹æä¾›äº† Docker Registry é•œåƒï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨åšä¸ºç§æœ‰ Registry æœåŠ¡ã€‚</p> <p>å¼€æºçš„ Docker Registry é•œåƒåªæä¾›äº† Docker Registry API çš„æœåŠ¡ç«¯å®ç°ï¼Œè¶³ä»¥æ”¯æŒ Docker å‘½ä»¤ï¼Œä¸å½±å“ä½¿ç”¨ã€‚ä½†ä¸åŒ…å«å›¾å½¢ç•Œé¢ï¼Œä»¥åŠé•œåƒç»´æŠ¤ã€ç”¨æˆ·ç®¡ç†ã€è®¿é—®æ§åˆ¶ç­‰é«˜çº§åŠŸèƒ½ã€‚</p> <p>é™¤äº†å®˜æ–¹çš„ Docker Registry å¤–ï¼Œè¿˜æœ‰ç¬¬ä¸‰æ–¹è½¯ä»¶å®ç°äº† Docker Registry APIï¼Œç”šè‡³æä¾›äº†ç”¨æˆ·ç•Œé¢ä»¥åŠä¸€äº›é«˜çº§åŠŸèƒ½ã€‚æ¯”å¦‚ Harbor å’Œ Sonatype Nexusã€‚</p> <h3 id="13å®‰è£…-docker">1.3ã€å®‰è£… Docker<a class="headerlink" href="#13å®‰è£…-docker" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>Docker åˆ†ä¸º stableã€test å’Œ nightly ä¸‰ä¸ªæ›´æ–°é¢‘é“ã€‚</p> <p>å®˜æ–¹ç½‘ç«™ä¸Šæœ‰å„ç§ç¯å¢ƒä¸‹çš„å¢ƒä¸‹çš„<a href="https://docs.docker.com/get-docker/">å®‰è£…æŒ‡å—</a>ï¼Œè¿™é‡Œä¸»è¦ä»‹ç» Docker åœ¨ Windowsä¸Šçš„å®‰è£…ã€‚</p> <h4 id="131windows">1.3.1ã€Windows<a class="headerlink" href="#131windows" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><strong>ç³»ç»Ÿè¦æ±‚</strong></p> <p><a href="https://docs.docker.com/docker-for-windows/install/">Docker Desktop for Windows</a> æ”¯æŒ 64 ä½ç‰ˆæœ¬çš„ Windows 10 Proï¼Œä¸”å¿…é¡»å¼€å¯ Hyper-Vï¼ˆè‹¥ç‰ˆæœ¬ä¸º v1903 åŠä»¥ä¸Šåˆ™æ— éœ€å¼€å¯ Hyper-Vï¼‰ï¼Œæˆ–è€… 64 ä½ç‰ˆæœ¬çš„ Windows 10 Home v1903 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚</p> <p><strong>å®‰è£…</strong></p> <ul> <li> <p>æ‰‹åŠ¨ä¸‹è½½å®‰è£…ï¼š</p> <p>ç‚¹å‡»<a href="https://desktop.docker.com/win/main/amd64/Docker Desktop Installer.exe">é“¾æ¥</a>ä¸‹è½½ Docker Desktop for Windowsï¼Œä¸‹è½½å¥½ä¹‹ååŒå‡» <code>Docker Desktop Installer.exe</code> å¼€å§‹å®‰è£…ã€‚</p> </li> <li> <p>ä½¿ç”¨ <code>winget</code> å®‰è£…ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>winget<span class="w"> </span>install<span class="w"> </span>Docker.DockerDesktop
</span></code></pre></div> </li> </ul> <p><strong>åœ¨ WSL2 è¿è¡Œ Docker</strong></p> <p>è‹¥ä½ çš„ Windows ç‰ˆæœ¬ä¸º Windows 10 ä¸“ä¸šç‰ˆæˆ–å®¶åº­ç‰ˆ v1903 åŠä»¥ä¸Šç‰ˆæœ¬å¯ä»¥ä½¿ç”¨ WSL2 è¿è¡Œ Dockerï¼Œå…·ä½“è¯·æŸ¥çœ‹ <a href="https://docs.docker.com/docker-for-windows/wsl/">Docker Desktop WSL 2 backend</a>ã€‚</p> <p><strong>è¿è¡Œ</strong></p> <p>åœ¨ Windows æœç´¢æ è¾“å…¥ Dockerï¼Œç‚¹å‡» Docker Desktop å¼€å§‹è¿è¡Œã€‚</p> <p>Docker å¯åŠ¨ä¹‹åä¼šåœ¨ Windows ä»»åŠ¡æ å‡ºç°é²¸é±¼å›¾æ ‡ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/Docker/QQ_1726423569359.png" data-desc-position="bottom"><img src="!assets/Docker/QQ_1726423569359.png" alt="QQ_1726423569359" style="zoom: 25%;"></a></p> <p>ç­‰å¾…ç‰‡åˆ»ï¼Œå½“é²¸é±¼å›¾æ ‡é™æ­¢æ—¶ï¼Œè¯´æ˜ Docker å¯åŠ¨æˆåŠŸï¼Œä¹‹åä½ å¯ä»¥æ‰“å¼€ PowerShell ä½¿ç”¨ Dockerã€‚</p> <p><strong>å¼€æ”¾è¿œç¨‹ API è®¿é—®</strong></p> <p>æ‰“å¼€è®¾ç½®ï¼Œå‹¾é€‰ä»¥ä¸‹é€‰é¡¹å³å¯é€šè¿‡ 2375 ç«¯å£è®¿é—®ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/Docker/image-20251209140546243.png" data-desc-position="bottom"><img src="!assets/Docker/image-20251209140546243.png" alt="image-20251209140546243" style="zoom: 50%;"></a></p> <p>è®¿é—® http://localhost:2375/version æµ‹è¯•ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/Docker/image-20251209140828779.png" data-desc-position="bottom"><img src="!assets/Docker/image-20251209140828779.png" alt="image-20251209140828779" style="zoom:50%;"></a></p> <div class="admonition warning"> <p class="admonition-title">Caution</p> <p>æ­¤æ–¹æ³•å¼€å¯æ²¡æœ‰å®‰å…¨è®¿é—®ï¼Œä»…é™å†…ç½‘æˆ–è€…æœ¬åœ°å­¦ä¹ ä½¿ç”¨ï¼Œæœ€å¥½é…ç½®ä¸€å±‚ Nginx åå‘ä»£ç†æˆ–è€…å¼€å¯ HTTPS è®¿é—®ã€‚</p> <p>é™„ä¸Š Nginx åå‘ä»£ç†é…ç½®ï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">location</span><span class="w"> </span><span class="s">/docker/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">       </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://localhost:2375/</span><span class="p">;</span><span class="w"> </span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">       </span><span class="kn">client_max_body_size</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">       </span><span class="kn">proxy_connect_timeout</span><span class="w"> </span><span class="mi">3600</span><span class="p">;</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">       </span><span class="kn">proxy_send_timeout</span><span class="w"> </span><span class="mi">3600</span><span class="p">;</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">       </span><span class="kn">proxy_read_timeout</span><span class="w"> </span><span class="mi">3600</span><span class="p">;</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">       </span><span class="kn">send_timeout</span><span class="w"> </span><span class="mi">3600</span><span class="p">;</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">       </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Host</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">       </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">X-Real-IP</span><span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">       </span><span class="kn">proxy_http_version</span><span class="w"> </span><span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">       </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Upgrade</span><span class="w"> </span><span class="nv">$http_upgrade</span><span class="p">;</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">       </span><span class="kn">proxy_set_header</span><span class="w"> </span><span class="s">Connection</span><span class="w"> </span><span class="s">upgrade</span><span class="p">;</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="p">}</span>
</span></code></pre></div> </div> <h4 id="132éº’éºŸ">1.3.2ã€éº’éºŸ<a class="headerlink" href="#132éº’éºŸ" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>éº’éºŸ-Kylin ä½œä¸ºä¸­å›½å›½äº§æ“ä½œç³»ç»Ÿï¼ŒåŸºäº Linux å¼€å‘çš„å•†ä¸šæ“ä½œç³»ç»Ÿã€‚é’ˆå¯¹ä¸­å›½å›½ä¼å¤®ä¼å¼€å‘çš„ç³»ç»Ÿï¼Œéº’éºŸã€ç»Ÿä¿¡å¤§ä½“éƒ½ä¼šæ¥è§¦è¿‡ã€‚æ—¢ç„¶æ˜¯åŸºäº Linux å¼€å‘çš„ï¼Œè½¯ä»¶æŒ‰ç…§å°±å¯ä»¥å…ˆå°è¯• Linux å¯¹åº”æ¶æ„çš„ç‰ˆæœ¬ï¼Œå¦‚æœè¿è¡Œæœ‰é—®é¢˜ï¼Œå†åœ¨å¯¹åº”çš„æ“ä½œç³»ç»Ÿä¸Šè¿›è¡Œç¼–è¯‘æ“ä½œã€‚</p> <p>é€šè¿‡ <code>arch</code> å‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿæ¶æ„ï¼Œä¸€èˆ¬ä¼šè¾“å‡º <code>x86_64</code>ã€<code>armel</code> ã€<code>aarch64</code> ç­‰ï¼Œåœ¨é€‰æ‹©å¯¹åº”è½¯ä»¶ç‰ˆæœ¬æ—¶ä¹Ÿè¦é€‰æ‹©å¯¹åº”çš„æ¶æ„ã€‚</p> <ol> <li> <p>åœ¨ <a href="https://download.docker.com/linux/static/stable/">Docker ä¸‹è½½åœ°å€</a> é€‰æ‹©å¯¹åº”çš„æ¶æ„ï¼Œç„¶åä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬å³å¯ï¼›å¦‚æœæœåŠ¡å™¨å¯ä»¥è”ç½‘ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å¤åˆ¶å‘½ä»¤ä¸‹è½½ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>wget<span class="w"> </span>https://download.docker.com/linux/static/stable/x86_64/docker-20.10.19.tgz
</span></code></pre></div> </li> <li> <p>å°†å®‰è£…åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¹‹åï¼Œæ‰§è¡Œå‘½ä»¤å®Œæˆè§£å‹ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>tar<span class="w"> </span>-xzf<span class="w"> </span>docker-20.10.19.tgz
</span></code></pre></div> <p>ç§»åŠ¨è§£å‹åçš„å…¨éƒ¨å†…å®¹åˆ° <code>/usr/bin</code> ä¸‹ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>mv<span class="w"> </span>docker/*<span class="w"> </span>/usr/bin/
</span></code></pre></div> </li> <li> <p>ç¼–è¾‘ <code>docker.service</code> æ–‡ä»¶ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>vi<span class="w"> </span>/usr/lib/systemd/system/docker.service
</span></code></pre></div> <p>å¤åˆ¶å¦‚ä¸‹å†…å®¹ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="o">[</span>Unit<span class="o">]</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nv">Description</span><span class="o">=</span>Docker<span class="w"> </span>Application<span class="w"> </span>Container<span class="w"> </span>Engine
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nv">Documentation</span><span class="o">=</span>https://docs.docker.com
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="nv">After</span><span class="o">=</span>network-online.target<span class="w"> </span>firewalld.service
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="nv">Wants</span><span class="o">=</span>network-online.target
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="o">[</span>Service<span class="o">]</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="nv">Type</span><span class="o">=</span>notify
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="nv">ExecStart</span><span class="o">=</span>/usr/bin/dockerd
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="nv">ExecReload</span><span class="o">=</span>/bin/kill<span class="w"> </span>-s<span class="w"> </span>HUP<span class="w"> </span><span class="nv">$MAINPID</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="nv">LimitNOFILE</span><span class="o">=</span>infinity
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="nv">LimitNPROC</span><span class="o">=</span>infinity
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="nv">TimeoutStartSec</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="nv">Delegate</span><span class="o">=</span>yes
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="nv">KillMode</span><span class="o">=</span>process
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="nv">Restart</span><span class="o">=</span>on-failure
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="nv">StartLimitBurst</span><span class="o">=</span><span class="m">3</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="nv">StartLimitInterval</span><span class="o">=</span>60s
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="o">[</span>Install<span class="o">]</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</span></code></pre></div> </li> <li> <p>æ·»åŠ  docker.service æ–‡ä»¶çš„æƒé™ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>chmod<span class="w"> </span>+x<span class="w"> </span>/usr/lib/systemd/system/docker.service
</span></code></pre></div> <p>é€šçŸ¥ systemd å®ˆæŠ¤è¿›ç¨‹é‡æ–°è¯»å–é…ç½®æ–‡ä»¶ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>systemctl<span class="w"> </span>daemon-reload
</span></code></pre></div> </li> <li> <p>å¯åŠ¨ Dockerï¼Œè®¾ç½®å¼€æœºå¯åŠ¨ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>systemctl<span class="w"> </span>start<span class="w"> </span>docker
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>docker
</span></code></pre></div> </li> <li> <p>éªŒè¯ Docker å®‰è£…æ˜¯å¦æˆåŠŸï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>docker<span class="w"> </span>-v
</span></code></pre></div> <p>è¾“å‡ºå¯¹åº”ç‰ˆæœ¬ï¼Œå³æ˜¯æˆåŠŸï¼</p> </li> </ol> <h3 id="14é•œåƒåŠ é€Ÿå™¨">1.4ã€é•œåƒåŠ é€Ÿå™¨<a class="headerlink" href="#14é•œåƒåŠ é€Ÿå™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>å›½å†…ä» Docker Hub æ‹‰å–é•œåƒæœ‰æ—¶ä¼šé‡åˆ°å›°éš¾ï¼Œæ­¤æ—¶å¯ä»¥é…ç½®é•œåƒåŠ é€Ÿå™¨ã€‚å›½å†…å¾ˆå¤šäº‘æœåŠ¡å•†éƒ½æä¾›äº†å›½å†…åŠ é€Ÿå™¨æœåŠ¡ï¼Œä¾‹å¦‚ï¼š</p> <ul> <li>é˜¿é‡Œäº‘åŠ é€Ÿå™¨ï¼šç‚¹å‡»ç®¡ç†æ§åˆ¶å° =&gt; ç™»å½•è´¦å· =&gt; å·¦ä¾§é•œåƒå·¥å…· =&gt; é•œåƒåŠ é€Ÿå™¨ =&gt; å¤åˆ¶åŠ é€Ÿå™¨åœ°å€ã€‚</li> <li>ç½‘æ˜“äº‘åŠ é€Ÿå™¨ï¼šhttps://hub-mirror.c.163.comã€‚</li> <li>ç™¾åº¦äº‘åŠ é€Ÿå™¨ï¼šhttps://mirror.baidubce.comã€‚</li> </ul> <p>ç”±äºé•œåƒæœåŠ¡å¯èƒ½å‡ºç°å®•æœºï¼Œå»ºè®®åŒæ—¶é…ç½®å¤šä¸ªé•œåƒã€‚å„ä¸ªé•œåƒç«™æµ‹è¯•ç»“æœè¯·åˆ° <a href="https://github.com/docker-practice/docker-registry-cn-mirror-test/actions">docker-practice/docker-registry-cn-mirror-test</a> æŸ¥çœ‹ã€‚</p> <p><strong>æ£€æŸ¥åŠ é€Ÿå™¨æ˜¯å¦ç”Ÿæ•ˆ</strong></p> <p>æ‰§è¡Œ <code>docker system info</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker info</code>ï¼‰ï¼Œå¦‚æœä»ç»“æœä¸­çœ‹åˆ°äº†å¦‚ä¸‹å†…å®¹ï¼Œè¯´æ˜é…ç½®æˆåŠŸï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>Registry Mirrors:
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a> https://hub-mirror.c.163.com/
</span></code></pre></div> <p><strong>ä¸å†æä¾›æœåŠ¡çš„é•œåƒ</strong></p> <p>æŸäº›é•œåƒä¸å†æä¾›æœåŠ¡ï¼Œæ·»åŠ æ— ç”¨çš„é•œåƒåŠ é€Ÿå™¨ï¼Œä¼šæ‹–æ…¢é•œåƒæ‹‰å–é€Ÿåº¦ï¼Œä½ å¯ä»¥ä»é•œåƒé…ç½®åˆ—è¡¨ä¸­åˆ é™¤å®ƒä»¬ã€‚</p> <p>å»ºè®® watch <a href="https://github.com/docker-practice/docker-registry-cn-mirror-test">é•œåƒæµ‹è¯•</a>è¿™ä¸ª GitHub ä»“åº“ï¼Œè¿™é‡Œä¼šæ›´æ–°å„ä¸ªé•œåƒåœ°å€çš„çŠ¶æ€ã€‚</p> <h4 id="141windows">1.4.1ã€Windows<a class="headerlink" href="#141windows" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>å¯¹äºä½¿ç”¨ Windows çš„ç”¨æˆ·ï¼Œåœ¨ Docker Desktop ä¸­æ‰“å¼€é…ç½®çª—å£ååœ¨å·¦ä¾§å¯¼èˆªèœå•é€‰æ‹© Docker Engineï¼Œç¼–è¾‘å³ä¾§çš„ json æ–‡ä»¶ï¼Œä¹‹åç‚¹å‡» Apply &amp; Restart ä¿å­˜å Docker å°±ä¼šé‡å¯å¹¶åº”ç”¨é…ç½®çš„é•œåƒåœ°å€äº†ã€‚</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>{
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>  "registry-mirrors": [
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>    "https://hub-mirror.c.163.com",
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>    "https://mirror.baidubce.com"
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>  ]
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>}
</span></code></pre></div> <h2 id="2ä½¿ç”¨é•œåƒ">2ã€ä½¿ç”¨é•œåƒ<a class="headerlink" href="#2ä½¿ç”¨é•œåƒ" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <p>Docker è¿è¡Œå®¹å™¨å‰éœ€è¦æœ¬åœ°å­˜åœ¨å¯¹åº”çš„é•œåƒï¼Œå¦‚æœæœ¬åœ°ä¸å­˜åœ¨è¯¥é•œåƒï¼ŒDocker ä¼šä»é•œåƒä»“åº“ä¸‹è½½è¯¥é•œåƒã€‚</p> <p>Docker ç®¡ç†é•œåƒçš„ä¸»è¦å‘½ä»¤ä¸º <code>docker image</code>ï¼Œå…¶ä¸‹åŒ…å«ä»¥ä¸‹å­å‘½ä»¤ï¼š</p> <table> <thead> <tr> <th style="text-align: left;">å‘½ä»¤</th> <th style="text-align: left;">æè¿°</th> </tr> </thead> <tbody> <tr> <td style="text-align: left;"><code>docker image history</code></td> <td style="text-align: left;">æ˜¾ç¤ºé•œåƒçš„å†å²è®°å½•ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker image import</code></td> <td style="text-align: left;">ä» tarball å¯¼å…¥å†…å®¹ä»¥åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿé•œåƒã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker image inspect</code></td> <td style="text-align: left;">æ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒçš„è¯¦ç»†ä¿¡æ¯ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker image load</code></td> <td style="text-align: left;">ä» tar å­˜æ¡£æˆ– STDIN åŠ è½½é•œåƒã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker image prune</code></td> <td style="text-align: left;">ç§»é™¤æœªä½¿ç”¨çš„é•œåƒã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker image rm</code></td> <td style="text-align: left;">ç§»é™¤ä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker image save</code></td> <td style="text-align: left;">å°†ä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒä¿å­˜åˆ° tar å­˜æ¡£ï¼ˆé»˜è®¤æƒ…å†µä¸‹æµå¼ä¼ è¾“åˆ° STDOUTï¼‰ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker image tag</code></td> <td style="text-align: left;">åˆ›å»ºä¸€ä¸ªæŒ‡å‘ SOURCE_IMAGE çš„ TARGET_IMAGE æ ‡ç­¾ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker image ls</code></td> <td style="text-align: left;">åˆ—å‡ºé•œåƒã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker image pull</code></td> <td style="text-align: left;">ä» Registry ä¸‹è½½é•œåƒã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker image push</code></td> <td style="text-align: left;">å°†é•œåƒä¸Šä¼ åˆ° Registryã€‚</td> </tr> </tbody> </table> <h3 id="21è·å–é•œåƒ">2.1ã€è·å–é•œåƒ<a class="headerlink" href="#21è·å–é•œåƒ" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p><a href="https://hub.docker.com/search?q=&amp;type=image">Docker Hub</a> ä¸Šæœ‰å¤§é‡çš„é«˜è´¨é‡çš„é•œåƒå¯ä»¥ç”¨ï¼Œä» Docker é•œåƒä»“åº“è·å–é•œåƒçš„å‘½ä»¤æ˜¯ <code>docker image pull</code>ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker pull</code>ï¼‰ã€‚å…¶å‘½ä»¤æ ¼å¼ä¸ºï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>docker<span class="w"> </span>pull<span class="w"> </span><span class="o">[</span>é€‰é¡¹<span class="o">]</span><span class="w"> </span><span class="o">[</span>Docker<span class="w"> </span>Registry<span class="w"> </span>åœ°å€<span class="o">[</span>:ç«¯å£å·<span class="o">]</span>/<span class="o">]</span>ä»“åº“å<span class="o">[</span>:æ ‡ç­¾<span class="o">]</span>
</span></code></pre></div> <p>å…·ä½“çš„é€‰é¡¹å¯ä»¥é€šè¿‡ <code>docker pull --help</code> å‘½ä»¤çœ‹åˆ°ï¼Œè¿™é‡Œè¯´ä¸€ä¸‹é•œåƒåç§°çš„æ ¼å¼ï¼š</p> <ul> <li><em>Docker Registry åœ°å€</em>ï¼šåœ°å€çš„æ ¼å¼ä¸€èˆ¬æ˜¯ <code>&lt;åŸŸå/IP&gt;[:ç«¯å£å·]</code>ã€‚é»˜è®¤åœ°å€æ˜¯ Docker Hubï¼ˆdocker.ioï¼‰ã€‚</li> <li><em>ä»“åº“å</em>ï¼šå¦‚ä¹‹å‰æ‰€è¯´ï¼Œè¿™é‡Œçš„ä»“åº“åæ˜¯ä¸¤æ®µå¼åç§°ï¼Œå³ <code>&lt;ç”¨æˆ·å&gt;/&lt;è½¯ä»¶å&gt;</code>ã€‚å¯¹äº Docker Hubï¼Œå¦‚æœä¸ç»™å‡ºç”¨æˆ·åï¼Œåˆ™é»˜è®¤ä¸º libraryï¼Œä¹Ÿå°±æ˜¯å®˜æ–¹é•œåƒã€‚</li> </ul> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>$ docker pull ubuntu:18.04
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>18.04: Pulling from library/ubuntu
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>92dc2a97ff99: Pull complete
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>be13a9d27eb8: Pull complete
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>c8299583700a: Pull complete
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>Digest: sha256:4bc3ae6596938cb0d9e5ac51a1152ec9dcac2a1c50829c74abd9c4361e321b26
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>Status: Downloaded newer image for ubuntu:18.04
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>docker.io/library/ubuntu:18.04
</span></code></pre></div> <p>ä¸Šé¢çš„å‘½ä»¤ä¸­æ²¡æœ‰ç»™å‡º Docker é•œåƒä»“åº“åœ°å€ï¼Œå› æ­¤å°†ä¼šä» Docker Hubï¼ˆdocker.ioï¼‰è·å–é•œåƒã€‚è€Œé•œåƒåç§°æ˜¯ <code>ubuntu:18.04</code>ï¼Œå› æ­¤å°†ä¼šè·å–å®˜æ–¹é•œåƒ <code>library/ubuntu</code> ä»“åº“ä¸­æ ‡ç­¾ä¸º 18.04 çš„é•œåƒã€‚<code>docker pull</code> å‘½ä»¤çš„è¾“å‡ºç»“æœæœ€åä¸€è¡Œç»™å‡ºäº†é•œåƒçš„å®Œæ•´åç§°ï¼Œå³ï¼š <code>docker.io/library/ubuntu:18.04</code>ã€‚</p> <p>ä»ä¸‹è½½è¿‡ç¨‹ä¸­å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¹‹å‰æåŠçš„åˆ†å±‚å­˜å‚¨çš„æ¦‚å¿µï¼Œé•œåƒæ˜¯ç”±å¤šå±‚å­˜å‚¨æ‰€æ„æˆã€‚ä¸‹è½½ä¹Ÿæ˜¯ä¸€å±‚å±‚çš„å»ä¸‹è½½ï¼Œå¹¶éå•ä¸€æ–‡ä»¶ã€‚ä¸‹è½½è¿‡ç¨‹ä¸­ç»™å‡ºäº†æ¯ä¸€å±‚çš„ ID çš„å‰ 12 ä½ã€‚å¹¶ä¸”ä¸‹è½½ç»“æŸåï¼Œç»™å‡ºè¯¥é•œåƒå®Œæ•´çš„ sha256 çš„æ‘˜è¦ï¼Œä»¥ç¡®ä¿ä¸‹è½½ä¸€è‡´æ€§ã€‚</p> <p>åœ¨ä½¿ç”¨ä¸Šé¢å‘½ä»¤çš„æ—¶å€™ï¼Œä½ å¯èƒ½ä¼šå‘ç°ï¼Œä½ æ‰€çœ‹åˆ°çš„å±‚ ID ä»¥åŠ sha256 çš„æ‘˜è¦å’Œè¿™é‡Œçš„ä¸ä¸€æ ·ã€‚è¿™æ˜¯å› ä¸ºå®˜æ–¹é•œåƒæ˜¯ä¸€ç›´åœ¨ç»´æŠ¤çš„ï¼Œæœ‰ä»»ä½•æ–°çš„ bugï¼Œæˆ–è€…ç‰ˆæœ¬æ›´æ–°ï¼Œéƒ½ä¼šè¿›è¡Œä¿®å¤å†ä»¥åŸæ¥çš„æ ‡ç­¾å‘å¸ƒï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ä»»ä½•ä½¿ç”¨è¿™ä¸ªæ ‡ç­¾çš„ç”¨æˆ·å¯ä»¥è·å¾—æ›´å®‰å…¨ã€æ›´ç¨³å®šçš„é•œåƒã€‚</p> <h3 id="22åˆ—å‡ºé•œåƒ">2.2ã€åˆ—å‡ºé•œåƒ<a class="headerlink" href="#22åˆ—å‡ºé•œåƒ" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>è¦æƒ³åˆ—å‡ºå·²ç»ä¸‹è½½ä¸‹æ¥çš„é•œåƒï¼Œå¯ä»¥ä½¿ç”¨ <code>docker image ls</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker images</code>ï¼‰ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>$ docker images
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>REPOSITORY           TAG                 IMAGE ID            CREATED             SIZE
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>redis                latest              5f515359c7f8        5 days ago          183 MB
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>nginx                latest              05a60462f8ba        5 days ago          181 MB
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>mongo                3.2                 fe9198c04d62        5 days ago          342 MB
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>&lt;none&gt;               &lt;none&gt;              00285df0df87        5 days ago          342 MB
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>ubuntu               18.04               329ed837d508        3 days ago          63.3MB
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>ubuntu               bionic              329ed837d508        3 days ago          63.3MB
</span></code></pre></div> <p>åˆ—è¡¨åŒ…å«äº† ä»“åº“åã€æ ‡ç­¾ã€é•œåƒ IDã€åˆ›å»ºæ—¶é—´ä»¥åŠæ‰€å ç”¨çš„ç©ºé—´ã€‚</p> <p>é•œåƒ ID åˆ™æ˜¯é•œåƒçš„å”¯ä¸€æ ‡è¯†ï¼Œä¸€ä¸ªé•œåƒå¯ä»¥å¯¹åº”å¤šä¸ªæ ‡ç­¾ã€‚å› æ­¤ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¯ä»¥çœ‹åˆ° <code>ubuntu:18.04</code> å’Œ <code>ubuntu:bionic</code> æ‹¥æœ‰ç›¸åŒçš„ IDï¼Œå› ä¸ºå®ƒä»¬å¯¹åº”çš„æ˜¯åŒä¸€ä¸ªé•œåƒã€‚</p> <p><strong>é•œåƒä½“ç§¯</strong></p> <p>å¦‚æœä»”ç»†è§‚å¯Ÿä¼šæ³¨æ„åˆ°è¿™é‡Œæ ‡è¯†çš„æ‰€å ç”¨ç©ºé—´å’Œåœ¨ Docker Hub ä¸Šçœ‹åˆ°çš„é•œåƒå¤§å°ä¸åŒã€‚æ¯”å¦‚ <code>ubuntu:18.04</code> é•œåƒå¤§å°åœ¨è¿™é‡Œæ˜¯ 63.3 MBï¼Œä½†æ˜¯åœ¨ <a href="https://hub.docker.com/layers/ubuntu/library/ubuntu/bionic/images/sha256-32776cc92b5810ce72e77aca1d949de1f348e1d281d3f00ebcc22a3adcdc9f42?context=explore">Docker Hub</a> æ˜¾ç¤ºçš„å´æ˜¯ 25.47 MBã€‚è¿™æ˜¯å› ä¸º Docker Hub ä¸­æ˜¾ç¤ºçš„ä½“ç§¯æ˜¯å‹ç¼©åçš„ä½“ç§¯ã€‚åœ¨é•œåƒä¸‹è½½å’Œä¸Šä¼ è¿‡ç¨‹ä¸­é•œåƒæ˜¯ä¿æŒç€å‹ç¼©çŠ¶æ€çš„ï¼Œå› æ­¤ Docker Hub æ‰€æ˜¾ç¤ºçš„å¤§å°æ˜¯ç½‘ç»œä¼ è¾“ä¸­æ›´å…³å¿ƒçš„æµé‡å¤§å°ã€‚è€Œ <code>docker images</code> æ˜¾ç¤ºçš„æ˜¯é•œåƒä¸‹è½½åˆ°æœ¬åœ°åå±•å¼€çš„å¤§å°ï¼Œå‡†ç¡®è¯´æ˜¯å±•å¼€åçš„å„å±‚æ‰€å ç©ºé—´çš„æ€»å’Œï¼Œå› ä¸ºé•œåƒåˆ°æœ¬åœ°åï¼ŒæŸ¥çœ‹ç©ºé—´çš„æ—¶å€™æ›´å…³å¿ƒçš„æ˜¯æœ¬åœ°ç£ç›˜ç©ºé—´å ç”¨çš„å¤§å°ã€‚</p> <p>å¦å¤–ä¸€ä¸ªéœ€è¦æ³¨æ„çš„é—®é¢˜æ˜¯ <code>docker images</code> åˆ—è¡¨ä¸­çš„é•œåƒä½“ç§¯æ€»å’Œå¹¶éæ˜¯æ‰€æœ‰é•œåƒå®é™…ç¡¬ç›˜æ¶ˆè€—ã€‚ç”±äº Docker é•œåƒæ˜¯å¤šå±‚å­˜å‚¨ç»“æ„ï¼Œå¹¶ä¸”å¯ä»¥ç»§æ‰¿ã€å¤ç”¨ï¼Œå› æ­¤ä¸åŒé•œåƒå¯èƒ½ä¼šå› ä¸ºä½¿ç”¨ç›¸åŒçš„åŸºç¡€é•œåƒï¼Œä»è€Œæ‹¥æœ‰å…±åŒçš„å±‚ã€‚ç”±äº Docker ä½¿ç”¨ Union FSï¼Œç›¸åŒçš„å±‚åªéœ€è¦ä¿å­˜ä¸€ä»½å³å¯ï¼Œå› æ­¤å®é™…é•œåƒç¡¬ç›˜å ç”¨ç©ºé—´å¾ˆå¯èƒ½è¦æ¯”è¿™ä¸ªåˆ—è¡¨é•œåƒå¤§å°çš„æ€»å’Œè¦å°çš„å¤šã€‚</p> <p>ä½ å¯ä»¥é€šè¿‡ <code>docker system df</code> å‘½ä»¤æ¥ä¾¿æ·çš„æŸ¥çœ‹é•œåƒã€å®¹å™¨ã€æ•°æ®å·æ‰€å ç”¨çš„ç©ºé—´ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>$ docker system df
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>TYPE                TOTAL               ACTIVE              SIZE                RECLAIMABLE
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>Images              24                  0                   1.992GB             1.992GB (100%)
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>Containers          1                   0                   62.82MB             62.82MB (100%)
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>Local Volumes       9                   0                   652.2MB             652.2MB (100%)
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>Build Cache                                                 0B                  0B
</span></code></pre></div> <p><strong>è™šæ‚¬é•œåƒ</strong></p> <p>ä¸Šé¢çš„é•œåƒåˆ—è¡¨ä¸­ï¼Œè¿˜å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç‰¹æ®Šçš„é•œåƒï¼Œè¿™ä¸ªé•œåƒæ—¢æ²¡æœ‰ä»“åº“åï¼Œä¹Ÿæ²¡æœ‰æ ‡ç­¾ï¼Œå‡ä¸º <code>&lt;none&gt;</code>ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>&lt;none&gt;               &lt;none&gt;              00285df0df87        5 days ago          342 MB
</span></code></pre></div> <p>è¿™ä¸ªé•œåƒåŸæœ¬æ˜¯æœ‰é•œåƒåå’Œæ ‡ç­¾çš„ï¼ŒåŸæ¥ä¸º <code>mongo:3.2</code>ï¼Œéšç€å®˜æ–¹é•œåƒç»´æŠ¤ï¼Œå‘å¸ƒäº†æ–°ç‰ˆæœ¬åï¼Œé‡æ–° <code>docker pull mongo:3.2</code> æ—¶ï¼Œ<code>mongo:3.2</code> è¿™ä¸ªé•œåƒåè¢«è½¬ç§»åˆ°äº†æ–°ä¸‹è½½çš„é•œåƒèº«ä¸Šï¼Œè€Œæ—§çš„é•œåƒä¸Šçš„è¿™ä¸ªåç§°åˆ™è¢«å–æ¶ˆï¼Œä»è€Œæˆä¸ºäº† <code>&lt;none&gt;</code>ã€‚é™¤äº† <code>docker pull</code> å¯èƒ½å¯¼è‡´è¿™ç§æƒ…å†µï¼Œ<code>docker build</code> ä¹ŸåŒæ ·å¯ä»¥å¯¼è‡´è¿™ç§ç°è±¡ã€‚ç”±äºæ–°æ—§é•œåƒåŒåï¼Œæ—§é•œåƒåç§°è¢«å–æ¶ˆï¼Œä»è€Œå‡ºç°ä»“åº“åã€æ ‡ç­¾å‡ä¸º <code>&lt;none&gt;</code> çš„é•œåƒã€‚è¿™ç±»æ— æ ‡ç­¾é•œåƒä¹Ÿè¢«ç§°ä¸ºè™šæ‚¬é•œåƒï¼ˆdangling imageï¼‰ï¼Œå¯ä»¥ç”¨ <code>docker images -f dangling=true</code> å‘½ä»¤ä¸“é—¨æ˜¾ç¤ºè¿™ç±»é•œåƒï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>$ docker images -f dangling=true
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>&lt;none&gt;              &lt;none&gt;              00285df0df87        5 days ago          342 MB
</span></code></pre></div> <p>ä¸€èˆ¬æ¥è¯´ï¼Œè™šæ‚¬é•œåƒå·²ç»å¤±å»äº†å­˜åœ¨çš„ä»·å€¼ï¼Œæ˜¯å¯ä»¥éšæ„åˆ é™¤çš„ï¼Œå¯ä»¥ç”¨ <code>docker image prune</code> å‘½ä»¤åˆ é™¤ã€‚</p> <h4 id="221ä¸­é—´å±‚é•œåƒ">2.2.1ã€ä¸­é—´å±‚é•œåƒ<a class="headerlink" href="#221ä¸­é—´å±‚é•œåƒ" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>ä¸ºäº†åŠ é€Ÿé•œåƒæ„å»ºã€é‡å¤åˆ©ç”¨èµ„æºï¼ŒDocker ä¼šåˆ©ç”¨ä¸­é—´å±‚é•œåƒã€‚æ‰€ä»¥åœ¨ä½¿ç”¨ä¸€æ®µæ—¶é—´åï¼Œå¯èƒ½ä¼šçœ‹åˆ°ä¸€äº›ä¾èµ–çš„ä¸­é—´å±‚é•œåƒã€‚é»˜è®¤çš„ <code>docker images</code> åˆ—è¡¨ä¸­åªä¼šæ˜¾ç¤ºé¡¶å±‚é•œåƒï¼Œå¦‚æœå¸Œæœ›æ˜¾ç¤ºåŒ…æ‹¬ä¸­é—´å±‚é•œåƒåœ¨å†…çš„æ‰€æœ‰é•œåƒçš„è¯ï¼Œéœ€è¦åŠ  <code>-a</code> å‚æ•°ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>docker<span class="w"> </span>images<span class="w"> </span>-a
</span></code></pre></div> <p>è¿™æ ·ä¼šçœ‹åˆ°å¾ˆå¤šæ— æ ‡ç­¾çš„é•œåƒï¼Œä¸ä¹‹å‰çš„è™šæ‚¬é•œåƒä¸åŒï¼Œè¿™äº›æ— æ ‡ç­¾çš„é•œåƒå¾ˆå¤šéƒ½æ˜¯ä¸­é—´å±‚é•œåƒï¼Œæ˜¯å…¶å®ƒé•œåƒæ‰€ä¾èµ–çš„é•œåƒã€‚è¿™äº›æ— æ ‡ç­¾é•œåƒä¸åº”è¯¥åˆ é™¤ï¼Œå¦åˆ™ä¼šå¯¼è‡´ä¸Šå±‚é•œåƒå› ä¸ºä¾èµ–ä¸¢å¤±è€Œå‡ºé”™ã€‚å®é™…ä¸Šï¼Œè¿™äº›é•œåƒä¹Ÿæ²¡å¿…è¦åˆ é™¤ï¼Œå› ä¸ºä¹‹å‰è¯´è¿‡ï¼Œç›¸åŒçš„å±‚åªä¼šå­˜ä¸€éï¼Œè€Œè¿™äº›é•œåƒæ˜¯åˆ«çš„é•œåƒçš„ä¾èµ–ï¼Œå› æ­¤å¹¶ä¸ä¼šå› ä¸ºå®ƒä»¬è¢«åˆ—å‡ºæ¥è€Œå¤šå­˜äº†ä¸€ä»½ï¼Œæ— è®ºå¦‚ä½•ä½ ä¹Ÿä¼šéœ€è¦å®ƒä»¬ã€‚åªè¦åˆ é™¤é‚£äº›ä¾èµ–å®ƒä»¬çš„é•œåƒåï¼Œè¿™äº›ä¾èµ–çš„ä¸­é—´å±‚é•œåƒä¹Ÿä¼šè¢«è¿å¸¦åˆ é™¤ã€‚</p> <h4 id="222åˆ—å‡ºéƒ¨åˆ†é•œåƒ">2.2.2ã€åˆ—å‡ºéƒ¨åˆ†é•œåƒ<a class="headerlink" href="#222åˆ—å‡ºéƒ¨åˆ†é•œåƒ" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>ä¸åŠ ä»»ä½•å‚æ•°çš„æƒ…å†µä¸‹ï¼Œ<code>docker images</code> ä¼šåˆ—å‡ºæ‰€æœ‰é¡¶å±‚é•œåƒï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬åªå¸Œæœ›åˆ—å‡ºéƒ¨åˆ†é•œåƒã€‚<code>docker images</code> æœ‰å¥½å‡ ä¸ªå‚æ•°å¯ä»¥å¸®åŠ©åšåˆ°è¿™ä¸ªäº‹æƒ…ã€‚</p> <p>æ ¹æ®ä»“åº“ååˆ—å‡ºé•œåƒï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>$ docker images ubuntu
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>ubuntu              18.04               329ed837d508        3 days ago          63.3MB
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>ubuntu              bionic              329ed837d508        3 days ago          63.3MB
</span></code></pre></div> <p>åˆ—å‡ºç‰¹å®šçš„æŸä¸ªé•œåƒï¼Œä¹Ÿå°±æ˜¯è¯´æŒ‡å®šä»“åº“åå’Œæ ‡ç­¾ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>$ docker images ubuntu:18.04
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>ubuntu              18.04               329ed837d508        3 days ago          63.3MB
</span></code></pre></div> <p>é™¤æ­¤ä»¥å¤–ï¼Œ<code>docker images</code> è¿˜æ”¯æŒå¼ºå¤§çš„è¿‡æ»¤å™¨å‚æ•° <code>--filter</code>ï¼Œæˆ–è€…ç®€å†™ <code>-f</code>ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸Œæœ›çœ‹åˆ°åœ¨ <code>mongo:3.2</code> ä¹‹åå»ºç«‹çš„é•œåƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>$ docker images -f since=mongo:3.2
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>redis               latest              5f515359c7f8        5 days ago          183 MB
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>nginx               latest              05a60462f8ba        5 days ago          181 MB
</span></code></pre></div> <p>æƒ³æŸ¥çœ‹æŸä¸ªä½ç½®ä¹‹å‰çš„é•œåƒä¹Ÿå¯ä»¥ï¼Œåªéœ€è¦æŠŠ <code>since</code> æ¢æˆ <code>before</code> å³å¯ã€‚</p> <p>æ­¤å¤–ï¼Œå¦‚æœé•œåƒæ„å»ºæ—¶å®šä¹‰äº† <code>LABEL</code> è¿˜å¯ä»¥é€šè¿‡ <code>LABEL</code> æ¥è¿‡æ»¤ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>docker<span class="w"> </span>images<span class="w"> </span>-f<span class="w"> </span><span class="nv">label</span><span class="o">=</span>com.example.version<span class="o">=</span><span class="m">0</span>.1
</span></code></pre></div> <h4 id="233ä»¥ç‰¹å®šæ ¼å¼æ˜¾ç¤º">2.3.3ã€ä»¥ç‰¹å®šæ ¼å¼æ˜¾ç¤º<a class="headerlink" href="#233ä»¥ç‰¹å®šæ ¼å¼æ˜¾ç¤º" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>é»˜è®¤æƒ…å†µä¸‹ <code>docker images</code> ä¼šè¾“å‡ºä¸€ä¸ªå®Œæ•´çš„è¡¨æ ¼ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶éæ‰€æœ‰æ—¶å€™éƒ½ä¼šéœ€è¦è¿™äº›å†…å®¹ã€‚æ¯”å¦‚ï¼Œåˆšæ‰åˆ é™¤è™šæ‚¬é•œåƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨ <code>docker images</code> æŠŠæ‰€æœ‰çš„è™šæ‚¬é•œåƒçš„ ID åˆ—å‡ºæ¥ï¼Œç„¶åæ‰å¯ä»¥äº¤ç»™ <code>docker rmi</code> å‘½ä»¤ä½œä¸ºå‚æ•°æ¥åˆ é™¤æŒ‡å®šçš„è¿™äº›é•œåƒï¼Œè¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°äº† <code>-q</code> å‚æ•°ï¼ˆquietï¼šåªæ˜¾ç¤ºé•œåƒ IDï¼Œä¸æ˜¾ç¤ºå…¶ä»–ä¿¡æ¯ï¼‰ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>$ docker images -q
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>5f515359c7f8
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>05a60462f8ba
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>fe9198c04d62
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>00285df0df87
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>329ed837d508
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>329ed837d508
</span></code></pre></div> <p><code>--filter</code> é…åˆ <code>-q</code> äº§ç”Ÿå‡ºæŒ‡å®šèŒƒå›´çš„ ID åˆ—è¡¨ï¼Œç„¶åé€ç»™å¦ä¸€ä¸ª <code>docker</code> å‘½ä»¤ä½œä¸ºå‚æ•°ï¼Œä»è€Œé’ˆå¯¹è¿™ç»„å®ä½“æˆæ‰¹çš„è¿›è¡ŒæŸç§æ“ä½œçš„åšæ³•åœ¨ Docker å‘½ä»¤è¡Œä½¿ç”¨è¿‡ç¨‹ä¸­éå¸¸å¸¸è§ï¼Œä¸ä»…ä»…æ˜¯é•œåƒï¼Œå°†æ¥æˆ‘ä»¬ä¼šåœ¨å„ä¸ªå‘½ä»¤ä¸­çœ‹åˆ°è¿™ç±»æ­é…ä»¥å®Œæˆå¾ˆå¼ºå¤§çš„åŠŸèƒ½ã€‚å› æ­¤æ¯æ¬¡åœ¨æ–‡æ¡£çœ‹åˆ°è¿‡æ»¤å™¨åï¼Œå¯ä»¥å¤šæ³¨æ„ä¸€ä¸‹å®ƒä»¬çš„ç”¨æ³•ã€‚</p> <p>å¦å¤–ä¸€äº›æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½åªæ˜¯å¯¹è¡¨æ ¼çš„ç»“æ„ä¸æ»¡æ„ï¼Œå¸Œæœ›è‡ªå·±ç»„ç»‡åˆ—ï¼›æˆ–è€…ä¸å¸Œæœ›æœ‰æ ‡é¢˜ï¼Œè¿™æ ·æ–¹ä¾¿å…¶å®ƒç¨‹åºè§£æç»“æœç­‰ï¼Œè¿™å°±ç”¨åˆ°äº† <code>docker images --format</code> å‘½ä»¤å’Œ <a href="https://gohugo.io/templates/introduction/">Go çš„æ¨¡æ¿è¯­æ³•</a>ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>docker<span class="w"> </span>images<span class="w"> </span>--format<span class="w"> </span><span class="s2">"{{.&lt;å­—æ®µåç§°&gt;}}"</span>
</span></code></pre></div> <p>å…¶ä¸­ï¼Œå­—æ®µåç§°æ˜¯ Docker é•œåƒçš„å±æ€§å­—æ®µï¼Œæ”¯æŒçš„å­—æ®µåŒ…æ‹¬ï¼š</p> <ul> <li><code>Repository</code>ï¼šé•œåƒä»“åº“åç§°</li> <li><code>Tag</code>ï¼šé•œåƒæ ‡ç­¾ã€‚</li> <li><code>ID</code>ï¼šé•œåƒ IDã€‚</li> <li><code>CreatedSince</code>ï¼šé•œåƒåˆ›å»ºæ—¶é—´ï¼ˆç›¸å¯¹æ—¶é—´ï¼‰ã€‚</li> <li><code>Size</code>ï¼šé•œåƒå¤§å°ã€‚</li> <li><code>Digest</code>ï¼šé•œåƒæ‘˜è¦ï¼ˆä»…é€‚ç”¨äºæŸäº›é•œåƒï¼‰ã€‚</li> </ul> <p>æ¯”å¦‚ï¼Œä¸‹é¢çš„å‘½ä»¤ä¼šç›´æ¥åˆ—å‡ºé•œåƒç»“æœï¼Œå¹¶ä¸”åªåŒ…å«é•œåƒ ID å’Œä»“åº“åï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>$ docker images --format "{{.ID}}: {{.Repository}}"
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>5f515359c7f8: redis
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>05a60462f8ba: nginx
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>fe9198c04d62: mongo
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>00285df0df87: &lt;none&gt;
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>329ed837d508: ubuntu
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>329ed837d508: ubuntu
</span></code></pre></div> <p>æˆ–è€…æ‰“ç®—ä»¥è¡¨æ ¼ç­‰è·æ˜¾ç¤ºï¼Œå¹¶ä¸”æœ‰æ ‡é¢˜è¡Œï¼Œå’Œé»˜è®¤ä¸€æ ·ï¼Œä¸è¿‡è‡ªå·±å®šä¹‰åˆ—ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>$ docker images --format "table {{.ID}}\t{{.Repository}}\t{{.Tag}}"
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>IMAGE ID            REPOSITORY          TAG
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>5f515359c7f8        redis               latest
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>05a60462f8ba        nginx               latest
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>fe9198c04d62        mongo               3.2
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>00285df0df87        &lt;none&gt;              &lt;none&gt;
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>329ed837d508        ubuntu              18.04
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>329ed837d508        ubuntu              bionic
</span></code></pre></div> <h3 id="23åˆ é™¤æœ¬åœ°é•œåƒ">2.3ã€åˆ é™¤æœ¬åœ°é•œåƒ<a class="headerlink" href="#23åˆ é™¤æœ¬åœ°é•œåƒ" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>å¦‚æœè¦åˆ é™¤æœ¬åœ°çš„é•œåƒï¼Œå¯ä»¥ä½¿ç”¨ <code>docker image rm</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker rmi</code>ï¼‰ï¼Œå…¶æ ¼å¼ä¸ºï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>docker<span class="w"> </span>rmi<span class="w"> </span><span class="o">[</span>é€‰é¡¹<span class="o">]</span><span class="w"> </span>&lt;é•œåƒ1&gt;<span class="w"> </span><span class="o">[</span>&lt;é•œåƒ2&gt;<span class="w"> </span>...<span class="o">]</span>
</span></code></pre></div> <p><strong>ç”¨ IDã€é•œåƒåã€æ‘˜è¦åˆ é™¤é•œåƒ</strong></p> <p>å…¶ä¸­ï¼Œ<code>&lt;é•œåƒ&gt;</code> å¯ä»¥æ˜¯é•œåƒçŸ­ IDã€é•œåƒé•¿ IDã€é•œåƒåæˆ–è€…é•œåƒæ‘˜è¦ã€‚</p> <p>æ¯”å¦‚æˆ‘ä»¬æœ‰è¿™ä¹ˆä¸€äº›é•œåƒï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>$ docker images
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>REPOSITORY                  TAG                 IMAGE ID            CREATED             SIZE
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>centos                      latest              0584b3d2cf6d        3 weeks ago         196.5 MB
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>redis                       alpine              501ad78535f0        3 weeks ago         21.03 MB
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>docker                      latest              cf693ec9b5c7        3 weeks ago         105.1 MB
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>nginx                       latest              e43d811ce2f4        5 weeks ago         181.5 MB
</span></code></pre></div> <p>æˆ‘ä»¬å¯ä»¥ç”¨é•œåƒçš„å®Œæ•´ IDï¼ˆä¹Ÿç§°ä¸ºé•¿ IDï¼‰ï¼Œæ¥åˆ é™¤é•œåƒã€‚ä½¿ç”¨è„šæœ¬çš„æ—¶å€™å¯èƒ½ä¼šç”¨é•¿ IDï¼Œä½†æ˜¯äººå·¥è¾“å…¥å°±å¤ªç´¯äº†ï¼Œæ‰€ä»¥æ›´å¤šçš„æ—¶å€™æ˜¯ç”¨çŸ­ ID æ¥åˆ é™¤é•œåƒã€‚<code>docker images</code> é»˜è®¤åˆ—å‡ºçš„å°±å·²ç»æ˜¯çŸ­ ID äº†ï¼Œä¸€èˆ¬å–å‰ 3 ä¸ªå­—ç¬¦ä»¥ä¸Šï¼Œåªè¦è¶³å¤ŸåŒºåˆ†äºåˆ«çš„é•œåƒå°±å¯ä»¥äº†ã€‚</p> <p>æ¯”å¦‚è¿™é‡Œï¼Œå¦‚æœæˆ‘ä»¬è¦åˆ é™¤ <code>redis:alpine</code> é•œåƒï¼Œå¯ä»¥æ‰§è¡Œï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>$ docker rmi 501
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>Untagged: redis:alpine
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>Untagged: redis@sha256:f1ed3708f538b537eb9c2a7dd50dc90a706f7debd7e1196c9264edeea521a86d
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>Deleted: sha256:501ad78535f015d88872e13fa87a828425117e3d28075d0c117932b05bf189b7
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>Deleted: sha256:96167737e29ca8e9d74982ef2a0dda76ed7b430da55e321c071f0dbff8c2899b
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>Deleted: sha256:32770d1dcf835f192cafd6b9263b7b597a1778a403a109e2cc2ee866f74adf23
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>Deleted: sha256:127227698ad74a5846ff5153475e03439d96d4b1c7f2a449c7a826ef74a2d2fa
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>Deleted: sha256:1333ecc582459bac54e1437335c0816bc17634e131ea0cc48daa27d32c75eab3
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>Deleted: sha256:4fc455b921edf9c4aea207c51ab39b10b06540c8b4825ba57b3feed1668fa7c7
</span></code></pre></div> <p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨<code>é•œåƒå</code>ï¼Œä¹Ÿå°±æ˜¯ <code>&lt;ä»“åº“å&gt;:&lt;æ ‡ç­¾&gt;</code>ï¼Œæ¥åˆ é™¤é•œåƒï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>$ docker rmi centos
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>Untagged: centos:latest
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>Untagged: centos@sha256:b2f9d1c0ff5f87a4743104d099a3d561002ac500db1b9bfa02a783a46e0d366c
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>Deleted: sha256:0584b3d2cf6d235ee310cf14b54667d889887b838d3f3d3033acd70fc3c48b8a
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>Deleted: sha256:97ca462ad9eeae25941546209454496e1d66749d53dfa2ee32bf1faabd239d38
</span></code></pre></div> <p>å½“ç„¶ï¼Œæ›´ç²¾ç¡®çš„æ˜¯ä½¿ç”¨é•œåƒæ‘˜è¦åˆ é™¤é•œåƒï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>$ docker images --digests
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>REPOSITORY                  TAG                 DIGEST                                                                    IMAGE ID            CREATED             SIZE
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>node                        slim                sha256:b4f0e0bdeb578043c1ea6862f0d40cc4afe32a4a582f3be235a3b164422be228   6e0c4c8e3913        3 weeks ago         214 MB
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>$ docker rmi node@sha256:b4f0e0bdeb578043c1ea6862f0d40cc4afe32a4a582f3be235a3b164422be228
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>Untagged: node@sha256:b4f0e0bdeb578043c1ea6862f0d40cc4afe32a4a582f3be235a3b164422be228
</span></code></pre></div> <p><strong>Untagged å’Œ Deleted</strong></p> <p>å¦‚æœè§‚å¯Ÿä¸Šé¢è¿™å‡ ä¸ªå‘½ä»¤çš„è¿è¡Œè¾“å‡ºä¿¡æ¯çš„è¯ï¼Œä½ ä¼šæ³¨æ„åˆ°åˆ é™¤è¡Œä¸ºåˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ <code>Untagged</code>ï¼Œå¦ä¸€ç±»æ˜¯ <code>Deleted</code>ã€‚æˆ‘ä»¬ä¹‹å‰ä»‹ç»è¿‡ï¼Œé•œåƒçš„å”¯ä¸€æ ‡è¯†æ˜¯å…¶ ID å’Œæ‘˜è¦ï¼Œè€Œä¸€ä¸ªé•œåƒå¯ä»¥æœ‰å¤šä¸ªæ ‡ç­¾ã€‚</p> <p>å› æ­¤å½“æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢å‘½ä»¤åˆ é™¤é•œåƒçš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯åœ¨è¦æ±‚åˆ é™¤æŸä¸ªæ ‡ç­¾çš„é•œåƒã€‚æ‰€ä»¥é¦–å…ˆéœ€è¦åšçš„æ˜¯å°†æ»¡è¶³æˆ‘ä»¬è¦æ±‚çš„æ‰€æœ‰é•œåƒæ ‡ç­¾éƒ½å–æ¶ˆï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çœ‹åˆ°çš„ <code>Untagged</code> çš„ä¿¡æ¯ã€‚å› ä¸ºä¸€ä¸ªé•œåƒå¯ä»¥å¯¹åº”å¤šä¸ªæ ‡ç­¾ï¼Œå› æ­¤å½“æˆ‘ä»¬åˆ é™¤äº†æ‰€æŒ‡å®šçš„æ ‡ç­¾åï¼Œå¯èƒ½è¿˜æœ‰åˆ«çš„æ ‡ç­¾æŒ‡å‘äº†è¿™ä¸ªé•œåƒï¼Œå¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œé‚£ä¹ˆ <code>Delete</code> è¡Œä¸ºå°±ä¸ä¼šå‘ç”Ÿã€‚æ‰€ä»¥å¹¶éæ‰€æœ‰çš„ <code>docker rmi</code> éƒ½ä¼šäº§ç”Ÿåˆ é™¤é•œåƒçš„è¡Œä¸ºï¼Œæœ‰å¯èƒ½ä»…ä»…æ˜¯å–æ¶ˆäº†æŸä¸ªæ ‡ç­¾è€Œå·²ã€‚</p> <p>å½“è¯¥é•œåƒæ‰€æœ‰çš„æ ‡ç­¾éƒ½è¢«å–æ¶ˆäº†ï¼Œè¯¥é•œåƒå¾ˆå¯èƒ½ä¼šå¤±å»äº†å­˜åœ¨çš„æ„ä¹‰ï¼Œå› æ­¤ä¼šè§¦å‘åˆ é™¤è¡Œä¸ºã€‚é•œåƒæ˜¯å¤šå±‚å­˜å‚¨ç»“æ„ï¼Œå› æ­¤åœ¨åˆ é™¤çš„æ—¶å€™ä¹Ÿæ˜¯ä»ä¸Šå±‚å‘åŸºç¡€å±‚æ–¹å‘ä¾æ¬¡è¿›è¡Œåˆ¤æ–­åˆ é™¤ã€‚é•œåƒçš„å¤šå±‚ç»“æ„è®©é•œåƒå¤ç”¨å˜å¾—éå¸¸å®¹æ˜“ï¼Œå› æ­¤å¾ˆæœ‰å¯èƒ½æŸä¸ªå…¶å®ƒé•œåƒæ­£ä¾èµ–äºå½“å‰é•œåƒçš„æŸä¸€å±‚ã€‚è¿™ç§æƒ…å†µï¼Œä¾æ—§ä¸ä¼šè§¦å‘åˆ é™¤è¯¥å±‚çš„è¡Œä¸ºã€‚ç›´åˆ°æ²¡æœ‰ä»»ä½•å±‚ä¾èµ–å½“å‰å±‚æ—¶ï¼Œæ‰ä¼šçœŸå®çš„åˆ é™¤å½“å‰å±‚ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆï¼Œæœ‰æ—¶å€™ä¼šå¥‡æ€ªï¼Œä¸ºä»€ä¹ˆæ˜æ˜æ²¡æœ‰åˆ«çš„æ ‡ç­¾æŒ‡å‘è¿™ä¸ªé•œåƒï¼Œä½†æ˜¯å®ƒè¿˜æ˜¯å­˜åœ¨çš„åŸå› ï¼Œä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šå‘ç°æ‰€åˆ é™¤çš„å±‚æ•°å’Œè‡ªå·± <code>docker pull</code> çœ‹åˆ°çš„å±‚æ•°ä¸ä¸€æ ·çš„åŸå› ã€‚</p> <p>é™¤äº†é•œåƒä¾èµ–ä»¥å¤–ï¼Œè¿˜éœ€è¦æ³¨æ„çš„æ˜¯å®¹å™¨å¯¹é•œåƒçš„ä¾èµ–ã€‚å¦‚æœæœ‰ç”¨è¿™ä¸ªé•œåƒå¯åŠ¨çš„å®¹å™¨å­˜åœ¨ï¼ˆå³ä½¿å®¹å™¨æ²¡æœ‰è¿è¡Œï¼‰ï¼Œé‚£ä¹ˆåŒæ ·ä¸å¯ä»¥åˆ é™¤è¿™ä¸ªé•œåƒã€‚ä¹‹å‰è®²è¿‡ï¼Œå®¹å™¨æ˜¯ä»¥é•œåƒä¸ºåŸºç¡€ï¼Œå†åŠ ä¸€å±‚å®¹å™¨å­˜å‚¨å±‚ï¼Œç»„æˆè¿™æ ·çš„å¤šå±‚å­˜å‚¨ç»“æ„å»è¿è¡Œçš„ã€‚å› æ­¤è¯¥é•œåƒå¦‚æœè¢«è¿™ä¸ªå®¹å™¨æ‰€ä¾èµ–çš„ï¼Œé‚£ä¹ˆåˆ é™¤å¿…ç„¶ä¼šå¯¼è‡´æ•…éšœã€‚å¦‚æœè¿™äº›å®¹å™¨æ˜¯ä¸éœ€è¦çš„ï¼Œåº”è¯¥å…ˆå°†å®ƒä»¬åˆ é™¤ï¼Œç„¶åå†æ¥åˆ é™¤é•œåƒã€‚</p> <p><strong>ç”¨ <code>docker images</code> å‘½ä»¤æ¥é…åˆ</strong></p> <p>åƒå…¶å®ƒå¯ä»¥æ‰¿æ¥å¤šä¸ªå®ä½“çš„å‘½ä»¤ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨ <code>docker images -q</code> æ¥é…åˆä½¿ç”¨ <code>docker rmi</code>ï¼Œè¿™æ ·å¯ä»¥æˆæ‰¹çš„åˆ é™¤å¸Œæœ›åˆ é™¤çš„é•œåƒã€‚</p> <p>æ¯”å¦‚ï¼Œæˆ‘ä»¬éœ€è¦åˆ é™¤æ‰€æœ‰ä»“åº“åä¸º <code>redis</code> çš„é•œåƒï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>docker<span class="w"> </span>rmi<span class="w"> </span><span class="k">$(</span>docker<span class="w"> </span>images<span class="w"> </span>-q<span class="w"> </span>redis<span class="k">)</span>
</span></code></pre></div> <p>æˆ–è€…åˆ é™¤æ‰€æœ‰åœ¨ <code>mongo:3.2</code> ä¹‹å‰çš„é•œåƒï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>docker<span class="w"> </span>rmi<span class="w"> </span><span class="k">$(</span>docker<span class="w"> </span>images<span class="w"> </span>-q<span class="w"> </span>-f<span class="w"> </span><span class="nv">before</span><span class="o">=</span>mongo:3.2<span class="k">)</span>
</span></code></pre></div> <p>å……åˆ†åˆ©ç”¨ä½ çš„æƒ³è±¡åŠ›å’Œ Linux å‘½ä»¤è¡Œçš„å¼ºå¤§ï¼Œä½ å¯ä»¥å®Œæˆå¾ˆå¤šéå¸¸èµçš„åŠŸèƒ½ã€‚</p> <h3 id="24ä¿å­˜å’ŒåŠ è½½é•œåƒ">2.4ã€ä¿å­˜å’ŒåŠ è½½é•œåƒ<a class="headerlink" href="#24ä¿å­˜å’ŒåŠ è½½é•œåƒ" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <h2 id="3æ“ä½œå®¹å™¨">3ã€æ“ä½œå®¹å™¨<a class="headerlink" href="#3æ“ä½œå®¹å™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <p>å®¹å™¨æ˜¯ Docker åˆä¸€æ ¸å¿ƒæ¦‚å¿µã€‚</p> <p>ç®€å•çš„è¯´ï¼Œå®¹å™¨æ˜¯ç‹¬ç«‹è¿è¡Œçš„ä¸€ä¸ªæˆ–ä¸€ç»„åº”ç”¨ï¼Œä»¥åŠå®ƒä»¬çš„è¿è¡Œæ€ç¯å¢ƒã€‚å¯¹åº”çš„ï¼Œè™šæ‹Ÿæœºå¯ä»¥ç†è§£ä¸ºæ¨¡æ‹Ÿè¿è¡Œçš„ä¸€æ•´å¥—æ“ä½œç³»ç»Ÿï¼ˆæä¾›äº†è¿è¡Œæ€ç¯å¢ƒå’Œå…¶ä»–ç³»ç»Ÿç¯å¢ƒï¼‰å’Œè·‘åœ¨ä¸Šé¢çš„åº”ç”¨ã€‚</p> <p>Docker ç®¡ç†å®¹å™¨çš„å‘½ä»¤ä¸º <code>docker container</code>ï¼Œå…¶ä¸‹æœ‰ä»¥ä¸‹å­å‘½ä»¤ï¼š</p> <table> <thead> <tr> <th style="text-align: left;">å‘½ä»¤</th> <th style="text-align: left;">æè¿°</th> </tr> </thead> <tbody> <tr> <td style="text-align: left;"><code>docker container attach</code></td> <td style="text-align: left;">å°†æœ¬åœ°æ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯æµé™„åŠ åˆ°æ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container commit</code></td> <td style="text-align: left;">æ ¹æ®å®¹å™¨çš„æ›´æ”¹åˆ›å»ºæ–°çš„é•œåƒã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container cp</code></td> <td style="text-align: left;">å¤åˆ¶å®¹å™¨å’Œæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¹‹é—´çš„æ–‡ä»¶/æ–‡ä»¶å¤¹ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container create</code></td> <td style="text-align: left;">åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container diff</code></td> <td style="text-align: left;">æ£€æŸ¥å®¹å™¨æ–‡ä»¶ç³»ç»Ÿä¸Šæ–‡ä»¶æˆ–ç›®å½•çš„æ›´æ”¹ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container export</code></td> <td style="text-align: left;">å°†å®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿå¯¼å‡ºä¸º tar å­˜æ¡£ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container inspect</code></td> <td style="text-align: left;">æ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨çš„è¯¦ç»†ä¿¡æ¯ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container kill</code></td> <td style="text-align: left;">ç»ˆæ­¢ä¸€ä¸ªæˆ–å¤šä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container logs</code></td> <td style="text-align: left;">è·å–å®¹å™¨çš„æ—¥å¿—ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container pause</code></td> <td style="text-align: left;">æš‚åœä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ä¸­çš„æ‰€æœ‰è¿›ç¨‹ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container port</code></td> <td style="text-align: left;">åˆ—å‡ºå®¹å™¨çš„ç«¯å£æ˜ å°„æˆ–ç‰¹å®šæ˜ å°„ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container prune</code></td> <td style="text-align: left;">åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container rename</code></td> <td style="text-align: left;">é‡å‘½åå®¹å™¨ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container restart</code></td> <td style="text-align: left;">é‡å¯ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container rm</code></td> <td style="text-align: left;">åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container start</code></td> <td style="text-align: left;">å¯åŠ¨ä¸€ä¸ªæˆ–å¤šä¸ªå·²åœæ­¢çš„å®¹å™¨ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container stats</code></td> <td style="text-align: left;">æ˜¾ç¤ºå®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µç»Ÿè®¡ä¿¡æ¯çš„å®æ—¶æµã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container stop</code></td> <td style="text-align: left;">åœæ­¢ä¸€ä¸ªæˆ–å¤šä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container top</code></td> <td style="text-align: left;">æ˜¾ç¤ºå®¹å™¨çš„è¿è¡Œè¿›ç¨‹ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container unpause</code></td> <td style="text-align: left;">å–æ¶ˆæš‚åœä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ä¸­çš„æ‰€æœ‰è¿›ç¨‹ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container update</code></td> <td style="text-align: left;">æ›´æ–°ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨çš„é…ç½®ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container wait</code></td> <td style="text-align: left;">é˜»å¡ç›´åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨åœæ­¢ï¼Œç„¶åæ‰“å°å®ƒä»¬çš„é€€å‡ºä»£ç ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container exec</code></td> <td style="text-align: left;">åœ¨æ­£åœ¨è¿è¡Œçš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container ls</code></td> <td style="text-align: left;">åˆ—å‡ºå®¹å™¨ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker container run</code></td> <td style="text-align: left;">æ ¹æ®é•œåƒåˆ›å»ºå¹¶è¿è¡Œæ–°å®¹å™¨ã€‚</td> </tr> </tbody> </table> <h3 id="31å¯åŠ¨å®¹å™¨">3.1ã€å¯åŠ¨å®¹å™¨<a class="headerlink" href="#31å¯åŠ¨å®¹å™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>å¯åŠ¨å®¹å™¨æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯åŸºäºé•œåƒæ–°å»ºä¸€ä¸ªå®¹å™¨å¹¶å¯åŠ¨ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å°†åœ¨ç»ˆæ­¢çŠ¶æ€ï¼ˆ<code>exited</code>ï¼‰çš„å®¹å™¨é‡æ–°å¯åŠ¨ã€‚</p> <p>å› ä¸º Docker çš„å®¹å™¨å®åœ¨å¤ªè½»é‡çº§äº†ï¼Œå¾ˆå¤šæ—¶å€™ç”¨æˆ·éƒ½æ˜¯éšæ—¶åˆ é™¤å’Œæ–°åˆ›å»ºå®¹å™¨ã€‚</p> <h4 id="311æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨">3.1.1ã€æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨<a class="headerlink" href="#311æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>æ‰€éœ€è¦çš„å‘½ä»¤ä¸»è¦ä¸º <code>docker container run</code>ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker run</code>ï¼‰ã€‚</p> <p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„å‘½ä»¤è¾“å‡ºä¸€ä¸ª â€œHello Worldâ€ï¼Œä¹‹åç»ˆæ­¢å®¹å™¨ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>$ docker run ubuntu:18.04 /bin/echo 'Hello world'
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>Hello world
</span></code></pre></div> <p>è¿™è·Ÿåœ¨æœ¬åœ°ç›´æ¥æ‰§è¡Œ <code>/bin/echo 'hello world'</code> å‡ ä¹æ„Ÿè§‰ä¸å‡ºä»»ä½•åŒºåˆ«ã€‚</p> <p>ä¸‹é¢çš„å‘½ä»¤åˆ™å¯åŠ¨ä¸€ä¸ª bash ç»ˆç«¯ï¼Œå…è®¸ç”¨æˆ·è¿›è¡Œäº¤äº’ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>$ docker run -t -i ubuntu:18.04 /bin/bash
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>root@af8bae53bdd3:/#
</span></code></pre></div> <p>å…¶ä¸­ï¼Œ<code>-t</code> é€‰é¡¹è®© Docker åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ï¼ˆpseudo-ttyï¼‰å¹¶ç»‘å®šåˆ°å®¹å™¨çš„æ ‡å‡†è¾“å…¥ä¸Šï¼Œ <code>-i</code> åˆ™è®©å®¹å™¨çš„æ ‡å‡†è¾“å…¥ä¿æŒæ‰“å¼€ã€‚</p> <p>åœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ‰€åˆ›å»ºçš„ç»ˆç«¯æ¥è¾“å…¥å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>root@af8bae53bdd3:/# pwd
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>/
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>root@af8bae53bdd3:/# ls
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>bin boot dev etc home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var
</span></code></pre></div> <p>å½“åˆ©ç”¨ <code>docker run</code> æ¥åˆ›å»ºå®¹å™¨æ—¶ï¼ŒDocker åœ¨åå°è¿è¡Œçš„æ ‡å‡†æ“ä½œåŒ…æ‹¬ï¼š</p> <ul> <li>æ£€æŸ¥æœ¬åœ°æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„é•œåƒï¼Œä¸å­˜åœ¨å°±ä» registry ä¸‹è½½ã€‚</li> <li>åˆ©ç”¨é•œåƒåˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªå®¹å™¨ã€‚</li> <li>åˆ†é…ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨åªè¯»çš„é•œåƒå±‚å¤–é¢æŒ‚è½½ä¸€å±‚å¯è¯»å†™å±‚ã€‚</li> <li>ä»å®¿ä¸»ä¸»æœºé…ç½®çš„ç½‘æ¡¥æ¥å£ä¸­æ¡¥æ¥ä¸€ä¸ªè™šæ‹Ÿæ¥å£åˆ°å®¹å™¨ä¸­å»ã€‚</li> <li>ä»åœ°å€æ± é…ç½®ä¸€ä¸ª ip åœ°å€ç»™å®¹å™¨ã€‚</li> <li>æ‰§è¡Œç”¨æˆ·æŒ‡å®šçš„åº”ç”¨ç¨‹åºã€‚</li> <li>æ‰§è¡Œå®Œæ¯•åå®¹å™¨è¢«ç»ˆæ­¢ã€‚</li> </ul> <h4 id="312å¯åŠ¨å·²ç»ˆæ­¢å®¹å™¨">3.1.2ã€å¯åŠ¨å·²ç»ˆæ­¢å®¹å™¨<a class="headerlink" href="#312å¯åŠ¨å·²ç»ˆæ­¢å®¹å™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>å¯ä»¥åˆ©ç”¨ <code>docker container start</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker start</code>ï¼‰ï¼Œç›´æ¥å°†ä¸€ä¸ªå·²ç»ç»ˆæ­¢ï¼ˆ<code>exited</code>ï¼‰çš„å®¹å™¨å¯åŠ¨è¿è¡Œã€‚</p> <p>å®¹å™¨çš„æ ¸å¿ƒä¸ºæ‰€æ‰§è¡Œçš„åº”ç”¨ç¨‹åºï¼Œæ‰€éœ€è¦çš„èµ„æºéƒ½æ˜¯åº”ç”¨ç¨‹åºè¿è¡Œæ‰€å¿…éœ€çš„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¹¶æ²¡æœ‰å…¶å®ƒçš„èµ„æºã€‚å¯ä»¥åœ¨ä¼ªç»ˆç«¯ä¸­åˆ©ç”¨ <code>ps</code> æˆ– <code>top</code> æ¥æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯ã€‚</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>root@ba267838cc1b:/# ps
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>  PID TTY          TIME CMD
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>    1 ?        00:00:00 bash
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>   11 ?        00:00:00 ps
</span></code></pre></div> <p>å¯è§ï¼Œå®¹å™¨ä¸­ä»…è¿è¡Œäº†æŒ‡å®šçš„ bash åº”ç”¨ã€‚è¿™ç§ç‰¹ç‚¹ä½¿å¾— Docker å¯¹èµ„æºçš„åˆ©ç”¨ç‡æé«˜ï¼Œæ˜¯è´§çœŸä»·å®çš„è½»é‡çº§è™šæ‹ŸåŒ–ã€‚</p> <h4 id="313å®ˆæŠ¤æ€å¯åŠ¨å®¹å™¨">3.1.3ã€å®ˆæŠ¤æ€å¯åŠ¨å®¹å™¨<a class="headerlink" href="#313å®ˆæŠ¤æ€å¯åŠ¨å®¹å™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>æ›´å¤šçš„æ—¶å€™ï¼Œéœ€è¦è®© Docker åœ¨åå°è¿è¡Œè€Œä¸æ˜¯ç›´æ¥æŠŠæ‰§è¡Œå‘½ä»¤çš„ç»“æœè¾“å‡ºåœ¨å½“å‰å®¿ä¸»æœºä¸‹ã€‚æ­¤æ—¶ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ  <code>-d</code> å‚æ•°æ¥å®ç°ã€‚</p> <p>å¦‚æœä¸ä½¿ç”¨ <code>-d</code> å‚æ•°è¿è¡Œå®¹å™¨ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>$ docker run ubuntu:18.04 /bin/sh -c "while true; do echo hello world; sleep 1; done"
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>hello world
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>hello world
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>hello world
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>hello world
</span></code></pre></div> <p>å®¹å™¨ä¼šæŠŠè¾“å‡ºçš„ç»“æœï¼ˆSTDOUTï¼‰æ‰“å°åˆ°å®¿ä¸»æœºä¸Šé¢ã€‚</p> <p>å¦‚æœä½¿ç”¨äº† <code>-d</code> å‚æ•°è¿è¡Œå®¹å™¨ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>$ docker run -d ubuntu:18.04 /bin/sh -c "while true; do echo hello world; sleep 1; done"
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>77b2dc01fe0f3f1265df143181e7b9af5e05279a884f4776ee75350ea9d8017a
</span></code></pre></div> <p>å¯åŠ¨åä¼šè¿”å›ä¸€ä¸ªå”¯ä¸€çš„ IDï¼Œæ­¤æ—¶å®¹å™¨ä¼šåœ¨åå°è¿è¡Œå¹¶ä¸ä¼šæŠŠè¾“å‡ºçš„ç»“æœï¼ˆSTDOUTï¼‰æ‰“å°åˆ°å®¿ä¸»æœºä¸Šé¢ã€‚</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>å®¹å™¨æ˜¯å¦ä¼šé•¿ä¹…è¿è¡Œï¼Œæ˜¯å’Œ <code>docker run</code> æŒ‡å®šçš„å‘½ä»¤æœ‰å…³ï¼Œå’Œ <code>-d</code> å‚æ•°æ— å…³ã€‚</p> </div> <p>å¯ä»¥é€šè¿‡ <code>docker container ls</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker ps</code>ï¼‰æ¥æŸ¥çœ‹å®¹å™¨ä¿¡æ¯ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>$ docker ps
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>CONTAINER ID  IMAGE         COMMAND               CREATED        STATUS       PORTS NAMES
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>77b2dc01fe0f  ubuntu:18.04  /bin/sh -c 'while tr  2 minutes ago  Up 1 minute        agitated_wright
</span></code></pre></div> <p>è¦è·å–å®¹å™¨çš„è¾“å‡ºä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡ <code>docker container logs</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker logs</code>ï¼‰ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>$ docker logs [container ID or NAMES]
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>hello world
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>hello world
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>hello world
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a>. . .
</span></code></pre></div> <h3 id="32ç»ˆæ­¢å®¹å™¨">3.2ã€ç»ˆæ­¢å®¹å™¨<a class="headerlink" href="#32ç»ˆæ­¢å®¹å™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>å¯ä»¥ä½¿ç”¨ <code>docker container stop</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker stop</code>ï¼‰æ¥ç»ˆæ­¢ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ã€‚</p> <p>æ­¤å¤–ï¼Œå½“ Docker å®¹å™¨ä¸­æŒ‡å®šçš„åº”ç”¨ç»ˆç»“æ—¶ï¼Œå®¹å™¨ä¹Ÿè‡ªåŠ¨ç»ˆæ­¢ã€‚</p> <p>ä¾‹å¦‚å¯¹äºä¸Šä¸€ç« èŠ‚ä¸­åªå¯åŠ¨äº†ä¸€ä¸ªç»ˆç«¯çš„å®¹å™¨ï¼Œç”¨æˆ·é€šè¿‡ <code>exit</code> å‘½ä»¤æˆ– <code>Ctrl+d</code> æ¥é€€å‡ºç»ˆç«¯æ—¶ï¼Œæ‰€åˆ›å»ºçš„å®¹å™¨ç«‹åˆ»ç»ˆæ­¢ã€‚</p> <p>ç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨å¯ä»¥ç”¨ <code>docker ps -a</code> å‘½ä»¤çœ‹åˆ°ã€‚ä¾‹å¦‚ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>$ docker ps -a
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>CONTAINER ID        IMAGE                    COMMAND                CREATED             STATUS                          PORTS               NAMES
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>ba267838cc1b        ubuntu:18.04             "/bin/bash"            30 minutes ago      Exited (0) About a minute ago                       trusting_newton
</span></code></pre></div> <p>å¤„äºç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨ï¼Œå¯ä»¥é€šè¿‡ <code>docker start</code> å‘½ä»¤æ¥é‡æ–°å¯åŠ¨ã€‚</p> <p>æ­¤å¤–ï¼Œ<code>docker container restart</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker restart</code>ï¼‰ä¼šå°†ä¸€ä¸ªè¿è¡Œæ€çš„å®¹å™¨ç»ˆæ­¢ï¼Œç„¶åå†é‡æ–°å¯åŠ¨å®ƒã€‚</p> <h3 id="33è¿›å…¥å®¹å™¨">3.3ã€è¿›å…¥å®¹å™¨<a class="headerlink" href="#33è¿›å…¥å®¹å™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>åœ¨ä½¿ç”¨ <code>-d</code> å‚æ•°æ—¶ï¼Œå®¹å™¨å¯åŠ¨åä¼šè¿›å…¥åå°ã€‚</p> <p>æŸäº›æ—¶å€™éœ€è¦è¿›å…¥å®¹å™¨è¿›è¡Œæ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ <code>docker container attach</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker attach</code>ï¼‰æˆ– <code>docker container exec</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker exec</code>ï¼‰ï¼Œæ¨èä½¿ç”¨ <code>docker exec</code> å‘½ä»¤ã€‚</p> <p><strong><code>docker attach</code> å‘½ä»¤</strong></p> <p>ä¸‹é¢ç¤ºä¾‹å¦‚ä½•ä½¿ç”¨ <code>docker attach</code> å‘½ä»¤ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>$ docker run -itd ubuntu
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>243c32535da7d142fb0e6df616a3c3ada0b8ab417937c853a9e1c251f499f550
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>$ docker ps
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a>243c32535da7        ubuntu:latest       "/bin/bash"         18 seconds ago      Up 17 seconds                           nostalgic_hypatia
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a>$ docker attach 243c
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a>root@243c32535da7:/#
</span></code></pre></div> <div class="admonition tip"> <p class="admonition-title">Important</p> <p>å¦‚æœä»è¿™ä¸ª STDOUT ä¸­ <code>exit</code>ï¼Œä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢ã€‚</p> </div> <p><strong><code>docker exec</code> å‘½ä»¤</strong></p> <p><code>docker exec</code> åè¾¹å¯ä»¥è·Ÿå¤šä¸ªå‚æ•°ï¼Œè¿™é‡Œä¸»è¦è¯´æ˜ <code>-i</code>ã€<code>-t</code> å‚æ•°ã€‚</p> <p>åªç”¨ <code>-i</code> å‚æ•°æ—¶ï¼Œç”±äºæ²¡æœ‰åˆ†é…ä¼ªç»ˆç«¯ï¼Œç•Œé¢æ²¡æœ‰æˆ‘ä»¬ç†Ÿæ‚‰çš„ Linux å‘½ä»¤æç¤ºç¬¦ï¼Œä½†å‘½ä»¤æ‰§è¡Œç»“æœä»ç„¶å¯ä»¥è¿”å›ã€‚</p> <p>å½“ <code>-i</code>ã€<code>-t</code> å‚æ•°ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œåˆ™å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç†Ÿæ‚‰çš„ Linux å‘½ä»¤æç¤ºç¬¦ã€‚</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>$ docker run -itd ubuntu
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>69d137adef7a8a689cbcb059e94da5489d3cddd240ff675c640c8d96e84fe1f6
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>$ docker ps
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>69d137adef7a        ubuntu:latest       "/bin/bash"         18 seconds ago      Up 17 seconds                           zealous_swirles
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a>$ docker exec -i 69d1 bash
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a>ls
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a>bin
</span><span id="__span-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a>boot
</span><span id="__span-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a>dev
</span><span id="__span-45-13"><a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a>...
</span><span id="__span-45-14"><a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a>
</span><span id="__span-45-15"><a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a>$ docker exec -it 69d1 bash
</span><span id="__span-45-16"><a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a>root@69d137adef7a:/#
</span></code></pre></div> <div class="admonition tip"> <p class="admonition-title">Important</p> <p>å¦‚æœä»è¿™ä¸ª STDOUT ä¸­ <code>exit</code>ï¼Œä¸ä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ¨èä½¿ç”¨ <code>docker exec</code> çš„åŸå› ã€‚</p> </div> <h3 id="34å¯¼å‡ºå’Œå¯¼å…¥">3.4ã€å¯¼å‡ºå’Œå¯¼å…¥<a class="headerlink" href="#34å¯¼å‡ºå’Œå¯¼å…¥" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p><strong>å¯¼å‡ºå®¹å™¨</strong></p> <p>å¦‚æœè¦å¯¼å‡ºæœ¬åœ°æŸä¸ªå®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ <code>docker container export</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker export</code>ï¼‰ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>$ docker ps -a
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                    PORTS               NAMES
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>7691a814370e        ubuntu:18.04        "/bin/bash"         36 hours ago        Exited (0) 21 hours ago                       test
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>$ docker export 7691a814370e &gt; ubuntu.tar
</span></code></pre></div> <p>è¿™æ ·å°†å¯¼å‡ºå®¹å™¨å¿«ç…§åˆ°æœ¬åœ°æ–‡ä»¶ã€‚</p> <p><strong>å¯¼å…¥å®¹å™¨å¿«ç…§</strong></p> <p>å¯ä»¥ä½¿ç”¨ <code>docker image import</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker import</code>ï¼‰ä»å®¹å™¨å¿«ç…§æ–‡ä»¶ä¸­å†å¯¼å…¥ä¸ºé•œåƒï¼Œä¾‹å¦‚ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>$ cat ubuntu.tar | docker import - test/ubuntu:v1.0
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>$ docker images
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>REPOSITORY          TAG                 IMAGE ID            CREATED              VIRTUAL SIZE
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>test/ubuntu         v1.0                9d37a6082e97        About a minute ago   171.3 MB
</span></code></pre></div> <p>æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®š URL æˆ–è€…æŸä¸ªç›®å½•æ¥å¯¼å…¥ï¼Œä¾‹å¦‚ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>docker<span class="w"> </span>import<span class="w"> </span>http://example.com/exampleimage.tgz<span class="w"> </span>example/imagerepo
</span></code></pre></div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>ç”¨æˆ·æ—¢å¯ä»¥ä½¿ç”¨ <code>docker import</code> æ¥å¯¼å…¥ä¸€ä¸ªå®¹å™¨å¿«ç…§åˆ°æœ¬åœ°é•œåƒåº“ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>docker load</code> æ¥å¯¼å…¥é•œåƒå­˜å‚¨æ–‡ä»¶åˆ°æœ¬åœ°é•œåƒåº“ã€‚è¿™ä¸¤è€…çš„åŒºåˆ«åœ¨äºå®¹å™¨å¿«ç…§æ–‡ä»¶å°†ä¸¢å¼ƒæ‰€æœ‰çš„å†å²è®°å½•å’Œå…ƒæ•°æ®ä¿¡æ¯ï¼ˆå³ä»…ä¿å­˜å®¹å™¨å½“æ—¶çš„å¿«ç…§çŠ¶æ€ï¼‰ï¼Œè€Œé•œåƒå­˜å‚¨æ–‡ä»¶å°†ä¿å­˜å®Œæ•´è®°å½•ï¼Œä½“ç§¯ä¹Ÿè¦å¤§ã€‚æ­¤å¤–ï¼Œä»å®¹å™¨å¿«ç…§æ–‡ä»¶å¯¼å…¥æ—¶å¯ä»¥é‡æ–°æŒ‡å®šæ ‡ç­¾ç­‰å…ƒæ•°æ®ä¿¡æ¯ã€‚</p> </div> <h3 id="35åˆ é™¤å®¹å™¨">3.5ã€åˆ é™¤å®¹å™¨<a class="headerlink" href="#35åˆ é™¤å®¹å™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p><strong>åˆ é™¤å®¹å™¨</strong></p> <p>å¯ä»¥ä½¿ç”¨ <code>docker container rm</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker rm</code>ï¼‰æ¥åˆ é™¤ä¸€ä¸ªå¤„äºç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨ã€‚ä¾‹å¦‚ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>$ docker rm trusting_newton
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>trusting_newton
</span></code></pre></div> <p>å¦‚æœè¦åˆ é™¤ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ï¼Œå¯ä»¥æ·»åŠ  <code>-f</code> å‚æ•°ã€‚Docker ä¼šå‘é€ <code>SIGKILL</code> ä¿¡å·ç»™å®¹å™¨ã€‚</p> <p><strong>æ¸…ç†æ‰€æœ‰å¤„äºç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨</strong></p> <p>ç”¨ <code>docker ps -a</code> å‘½ä»¤å¯ä»¥æŸ¥çœ‹æ‰€æœ‰å·²ç»åˆ›å»ºçš„åŒ…æ‹¬ç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨ï¼Œå¦‚æœæ•°é‡å¤ªå¤šè¦ä¸€ä¸ªä¸ªåˆ é™¤å¯èƒ½ä¼šå¾ˆéº»çƒ¦ï¼Œç”¨ <code>docker container prune</code> å‘½ä»¤å¯ä»¥æ¸…ç†æ‰æ‰€æœ‰å¤„äºç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨ã€‚</p> <h2 id="4è®¿é—®ä»“åº“">4ã€è®¿é—®ä»“åº“<a class="headerlink" href="#4è®¿é—®ä»“åº“" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <p>ä»“åº“ï¼ˆRepositoryï¼‰æ˜¯é›†ä¸­å­˜æ”¾é•œåƒçš„åœ°æ–¹ã€‚</p> <p>ä¸€ä¸ªå®¹æ˜“æ··æ·†çš„æ¦‚å¿µæ˜¯æ³¨å†ŒæœåŠ¡å™¨ï¼ˆRegistryï¼‰ã€‚å®é™…ä¸Šæ³¨å†ŒæœåŠ¡å™¨æ˜¯ç®¡ç†ä»“åº“çš„å…·ä½“æœåŠ¡å™¨ï¼Œæ¯ä¸ªæœåŠ¡å™¨ä¸Šå¯ä»¥æœ‰å¤šä¸ªä»“åº“ï¼Œè€Œæ¯ä¸ªä»“åº“ä¸‹é¢æœ‰å¤šä¸ªé•œåƒã€‚ä»è¿™æ–¹é¢æ¥è¯´ï¼Œä»“åº“å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå…·ä½“çš„é¡¹ç›®æˆ–ç›®å½•ã€‚ä¾‹å¦‚å¯¹äºä»“åº“åœ°å€ <code>docker.io/ubuntu</code> æ¥è¯´ï¼Œ<code>docker.io</code> æ˜¯æ³¨å†ŒæœåŠ¡å™¨åœ°å€ï¼Œ<code>ubuntu</code> æ˜¯ä»“åº“åã€‚</p> <p>å¤§éƒ¨åˆ†æ—¶å€™ï¼Œå¹¶ä¸éœ€è¦ä¸¥æ ¼åŒºåˆ†è¿™ä¸¤è€…çš„æ¦‚å¿µã€‚</p> <p>Docker è®¿é—®ä»“åº“æ¶‰åŠä»¥ä¸‹å¸¸ç”¨å‘½ä»¤ï¼š</p> <table> <thead> <tr> <th style="text-align: left;">å‘½ä»¤</th> <th style="text-align: left;">æè¿°</th> </tr> </thead> <tbody> <tr> <td style="text-align: left;"><code>docker login</code></td> <td style="text-align: left;">éªŒè¯æ³¨å†Œè¡¨èº«ä»½ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker logout</code></td> <td style="text-align: left;">ä»æ³¨å†Œè¡¨æ³¨é”€ã€‚å¦‚æœæœªæŒ‡å®šæœåŠ¡å™¨ï¼Œåˆ™é»˜è®¤æœåŠ¡å™¨ç”±å®ˆæŠ¤è¿›ç¨‹å®šä¹‰ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker search</code></td> <td style="text-align: left;">æœç´¢ Docker Hubä¸­ çš„é•œåƒã€‚</td> </tr> </tbody> </table> <h3 id="41docker-hub">4.1ã€Docker Hub<a class="headerlink" href="#41docker-hub" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>ç›®å‰ Docker å®˜æ–¹ç»´æŠ¤äº†ä¸€ä¸ªå…¬å…±ä»“åº“ <a href="https://hub.docker.com/">Docker Hub</a>ï¼Œå…¶ä¸­å·²ç»åŒ…æ‹¬äº†æ•°é‡è¶…è¿‡ <a href="https://hub.docker.com/search/?type=image">2,650,000</a> çš„é•œåƒã€‚å¤§éƒ¨åˆ†éœ€æ±‚éƒ½å¯ä»¥é€šè¿‡åœ¨ Docker Hub ä¸­ç›´æ¥ä¸‹è½½é•œåƒæ¥å®ç°ã€‚</p> <p><strong>æ³¨å†Œ</strong></p> <p>ä½ å¯ä»¥åœ¨ https://hub.docker.com å…è´¹æ³¨å†Œä¸€ä¸ª Docker è´¦å·ã€‚</p> <p><strong>ç™»å½•</strong></p> <p>å¯ä»¥é€šè¿‡æ‰§è¡Œ <code>docker login</code> å‘½ä»¤äº¤äº’å¼çš„è¾“å…¥ç”¨æˆ·ååŠå¯†ç æ¥å®Œæˆåœ¨å‘½ä»¤è¡Œç•Œé¢ç™»å½• Docker Hubã€‚</p> <p>ä½ å¯ä»¥é€šè¿‡ <code>docker logout</code> é€€å‡ºç™»å½•ã€‚</p> <p><strong>æ‹‰å–é•œåƒ</strong></p> <p>ä½ å¯ä»¥é€šè¿‡ <code>docker search</code> å‘½ä»¤æ¥æŸ¥æ‰¾å®˜æ–¹ä»“åº“ä¸­çš„é•œåƒï¼Œå¹¶åˆ©ç”¨ <code>docker pull</code> å‘½ä»¤æ¥å°†å®ƒä¸‹è½½åˆ°æœ¬åœ°ã€‚</p> <p>ä¾‹å¦‚ä»¥ centos ä¸ºå…³é”®è¯è¿›è¡Œæœç´¢ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>$ docker search centos
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>NAME                               DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>centos                             The official build of CentOS.                   6449      [OK]
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>ansible/centos7-ansible            Ansible on Centos7                              132                  [OK]
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>consol/centos-xfce-vnc             Centos container with "headless" VNC sessionâ€¦   126                  [OK]
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>jdeathe/centos-ssh                 OpenSSH / Supervisor / EPEL/IUS/SCL Repos - â€¦   117                  [OK]
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>centos/systemd                     systemd enabled base container.                 96                   [OK]
</span></code></pre></div> <p>å¯ä»¥çœ‹åˆ°è¿”å›äº†å¾ˆå¤šåŒ…å«å…³é”®å­—çš„é•œåƒï¼Œå…¶ä¸­åŒ…æ‹¬é•œåƒåå­—ã€æè¿°ã€æ”¶è—æ•°ï¼ˆè¡¨ç¤ºè¯¥é•œåƒçš„å—å…³æ³¨ç¨‹åº¦ï¼‰ã€æ˜¯å¦å®˜æ–¹åˆ›å»ºï¼ˆ<code>OFFICIAL</code>ï¼‰ã€æ˜¯å¦è‡ªåŠ¨æ„å»º ï¼ˆ<code>AUTOMATED</code>ï¼‰ã€‚</p> <p>æ ¹æ®æ˜¯å¦æ˜¯å®˜æ–¹æä¾›ï¼Œå¯å°†é•œåƒåˆ†ä¸ºä¸¤ç±»ã€‚</p> <p>ä¸€ç§æ˜¯ç±»ä¼¼ <code>centos</code> è¿™æ ·çš„é•œåƒï¼Œè¢«ç§°ä¸ºåŸºç¡€é•œåƒæˆ–æ ¹é•œåƒã€‚è¿™äº›åŸºç¡€é•œåƒç”± Docker å…¬å¸åˆ›å»ºã€éªŒè¯ã€æ”¯æŒã€æä¾›ã€‚è¿™æ ·çš„é•œåƒå¾€å¾€ä½¿ç”¨å•ä¸ªå•è¯ä½œä¸ºåå­—ã€‚</p> <p>è¿˜æœ‰ä¸€ç§ç±»å‹ï¼Œæ¯”å¦‚ <code>ansible/centos7-ansible</code> é•œåƒï¼Œå®ƒæ˜¯ç”± Docker Hub çš„æ³¨å†Œç”¨æˆ·åˆ›å»ºå¹¶ç»´æŠ¤çš„ï¼Œå¾€å¾€å¸¦æœ‰ç”¨æˆ·åç§°å‰ç¼€ã€‚å¯ä»¥é€šè¿‡å‰ç¼€ <code>username/</code> æ¥æŒ‡å®šä½¿ç”¨æŸä¸ªç”¨æˆ·æä¾›çš„é•œåƒï¼Œæ¯”å¦‚ ansible ç”¨æˆ·ã€‚</p> <p>å¦å¤–ï¼Œåœ¨æŸ¥æ‰¾çš„æ—¶å€™é€šè¿‡ <code>--filter=stars=N</code> å‚æ•°å¯ä»¥æŒ‡å®šä»…æ˜¾ç¤ºæ”¶è—æ•°é‡ä¸º <code>N</code> ä»¥ä¸Šçš„é•œåƒã€‚</p> <p>ä¸‹è½½å®˜æ–¹ <code>centos</code> é•œåƒåˆ°æœ¬åœ°ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>$ docker pull centos
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>Using default tag: latest
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>latest: Pulling from library/centos
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a>7a0437f04f83: Pull complete
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a>Digest: sha256:5528e8b1b1719d34604c87e11dcd1c0a20bedf46e83b5632cdeac91b8c04efc1
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a>Status: Downloaded newer image for centos:latest
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a>docker.io/library/centos:latest
</span></code></pre></div> <p><strong>æ¨é€é•œåƒ</strong></p> <p>ç”¨æˆ·ä¹Ÿå¯ä»¥åœ¨ç™»å½•åé€šè¿‡ <code>docker image push</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker push</code>ï¼‰æ¥å°†è‡ªå·±çš„é•œåƒæ¨é€åˆ° Docker Hubã€‚</p> <p>ä»¥ä¸‹å‘½ä»¤ä¸­çš„ <code>username</code> è¯·æ›¿æ¢ä¸ºä½ çš„ Docker è´¦å·ç”¨æˆ·åï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>$ docker tag ubuntu:18.04 username/ubuntu:18.04
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>$ docker images
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a>
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>REPOSITORY                                               TAG                    IMAGE ID            CREATED             SIZE
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a>ubuntu                                                   18.04                  275d79972a86        6 days ago          94.6MB
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a>username/ubuntu                                          18.04                  275d79972a86        6 days ago          94.6MB
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a>
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>$ docker push username/ubuntu:18.04
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a>
</span><span id="__span-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a>$ docker search username
</span><span id="__span-52-12"><a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a>
</span><span id="__span-52-13"><a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a>NAME                      DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED
</span><span id="__span-52-14"><a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a>username/ubuntu
</span></code></pre></div> <h3 id="42ç§æœ‰ä»“åº“">4.2ã€ç§æœ‰ä»“åº“<a class="headerlink" href="#42ç§æœ‰ä»“åº“" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>æœ‰æ—¶å€™ä½¿ç”¨ Docker Hub è¿™æ ·çš„å…¬å…±ä»“åº“å¯èƒ½ä¸æ–¹ä¾¿ï¼Œç”¨æˆ·å¯ä»¥åˆ›å»ºä¸€ä¸ªæœ¬åœ°ä»“åº“ä¾›ç§äººä½¿ç”¨ã€‚</p> <p><a href="https://docs.docker.com/registry/"><code>docker-registry</code></a> æ˜¯å®˜æ–¹æä¾›çš„å·¥å…·ï¼Œå¯ä»¥ç”¨äºæ„å»ºç§æœ‰çš„é•œåƒä»“åº“ã€‚æœ¬æ–‡å†…å®¹åŸºäº docker-registry v2.x ç‰ˆæœ¬ã€‚</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Docker Registry æ˜¯å®¹å™¨é•œåƒä»“åº“çš„å¼€æºå®ç°ã€‚å®ƒäº 2019 å¹´æèµ ç»™äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼š (CNCF)ï¼Œå¹¶ä»¥ â€œDistributionâ€ çš„åä¹‰è¿›è¡Œç»´æŠ¤ã€‚å®ƒä»ç„¶æ˜¯ç®¡ç†å’Œåˆ†å‘å®¹å™¨é•œåƒçš„åŸºçŸ³ã€‚</p> <p><a href="https://github.com/distribution/distribution">CNCF Distribution CNCF åˆ†å‘</a></p> </div> <h4 id="421å®‰è£…-docker-registry">4.2.1ã€å®‰è£… docker-registry<a class="headerlink" href="#421å®‰è£…-docker-registry" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>ä½ å¯ä»¥ä½¿ç”¨å®˜æ–¹ <code>registry</code> é•œåƒæ¥è¿è¡Œï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:5000<span class="w"> </span>--restart<span class="o">=</span>always<span class="w"> </span>--name<span class="w"> </span>registry<span class="w"> </span>registry
</span></code></pre></div> <p>è¿™å°†ä½¿ç”¨å®˜æ–¹çš„ <code>registry</code> é•œåƒæ¥å¯åŠ¨ç§æœ‰ä»“åº“ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä»“åº“ä¼šè¢«åˆ›å»ºåœ¨å®¹å™¨çš„ <code>/var/lib/registry</code> ç›®å½•ä¸‹ã€‚ä½ å¯ä»¥é€šè¿‡ <code>-v</code> å‚æ•°æ¥å°†é•œåƒæ–‡ä»¶å­˜æ”¾åœ¨æœ¬åœ°çš„æŒ‡å®šè·¯å¾„ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­å°†ä¸Šä¼ çš„é•œåƒæ”¾åˆ°æœ¬åœ°çš„ <code>/opt/data/registry</code> ç›®å½•ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:5000<span class="w"> </span>-v<span class="w"> </span>/opt/data/registry:/var/lib/registry<span class="w"> </span>registry
</span></code></pre></div> <h4 id="422ä½¿ç”¨ç§æœ‰ä»“åº“">4.2.2ã€ä½¿ç”¨ç§æœ‰ä»“åº“<a class="headerlink" href="#422ä½¿ç”¨ç§æœ‰ä»“åº“" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>åˆ›å»ºå¥½ç§æœ‰ä»“åº“ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>docker image tag</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker tag</code>ï¼‰æ¥æ ‡è®°ä¸€ä¸ªé•œåƒï¼Œç„¶åæ¨é€åˆ°ä»“åº“ã€‚<code>docker tag</code> æ ¼å¼ä¸ºï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>docker<span class="w"> </span>tag<span class="w"> </span>IMAGE<span class="o">[</span>:TAG<span class="o">]</span><span class="w"> </span><span class="o">[</span>REGISTRY_HOST<span class="o">[</span>:REGISTRY_PORT<span class="o">]</span>/<span class="o">]</span>REPOSITORY<span class="o">[</span>:TAG<span class="o">]</span>
</span></code></pre></div> <p><strong>ç¤ºä¾‹</strong></p> <p>ä¾‹å¦‚ç§æœ‰ä»“åº“åœ°å€ä¸º <code>127.0.0.1:5000</code>ã€‚</p> <ol> <li> <p>å…ˆåœ¨æœ¬æœºæŸ¥çœ‹å·²æœ‰çš„é•œåƒï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>$ docker images
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>REPOSITORY                        TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>ubuntu                            latest              ba5877dc9bec        6 weeks ago         192.7 MB
</span></code></pre></div> </li> <li> <p>ä½¿ç”¨ <code>docker tag</code> å°† <code>ubuntu:latest</code> è¿™ä¸ªé•œåƒæ ‡è®°ä¸º <code>127.0.0.1:5000/ubuntu:latest</code>ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>$ docker tag ubuntu:latest 127.0.0.1:5000/ubuntu:latest
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>$ docker images
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>REPOSITORY                        TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a>ubuntu                            latest              ba5877dc9bec        6 weeks ago         192.7 MB
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a>127.0.0.1:5000/ubuntu:latest      latest              ba5877dc9bec        6 weeks ago         192.7 MB
</span></code></pre></div> </li> <li> <p>ä½¿ç”¨ <code>docker push</code> ä¸Šä¼ æ ‡è®°çš„é•œåƒï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>$ docker push 127.0.0.1:5000/ubuntu:latest
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>The push refers to repository [127.0.0.1:5000/ubuntu]
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>373a30c24545: Pushed
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>a9148f5200b0: Pushed
</span><span id="__span-58-5"><a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a>cdd3de0940ab: Pushed
</span><span id="__span-58-6"><a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a>fc56279bbb33: Pushed
</span><span id="__span-58-7"><a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a>b38367233d37: Pushed
</span><span id="__span-58-8"><a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a>2aebd096e0e2: Pushed
</span><span id="__span-58-9"><a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a>latest: digest: sha256:fe4277621f10b5026266932ddf760f5a756d2facd505a94d2da12f4f52f71f5a size: 1568
</span></code></pre></div> </li> <li> <p>ç”¨ <code>curl</code> æŸ¥çœ‹ä»“åº“ä¸­çš„é•œåƒï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>$ curl 127.0.0.1:5000/v2/_catalog
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>{"repositories":["ubuntu"]}
</span></code></pre></div> <p>è¿™é‡Œå¯ä»¥çœ‹åˆ° <code>{"repositories":["ubuntu"]}</code>ï¼Œè¡¨æ˜é•œåƒå·²ç»è¢«æˆåŠŸä¸Šä¼ äº†ã€‚</p> </li> <li> <p>å…ˆåˆ é™¤å·²æœ‰é•œåƒï¼Œå†å°è¯•ä»ç§æœ‰ä»“åº“ä¸­ä¸‹è½½è¿™ä¸ªé•œåƒï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>$ docker rmi 127.0.0.1:5000/ubuntu:latest
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>$ docker pull 127.0.0.1:5000/ubuntu:latest
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>Pulling repository 127.0.0.1:5000/ubuntu:latest
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a>ba5877dc9bec: Download complete
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>511136ea3c5a: Download complete
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a>9bad880da3d2: Download complete
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a>25f11f5fb0cb: Download complete
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9" href="#__codelineno-60-9"></a>ebc34468f71d: Download complete
</span><span id="__span-60-10"><a id="__codelineno-60-10" name="__codelineno-60-10" href="#__codelineno-60-10"></a>2318d26665ef: Download complete
</span><span id="__span-60-11"><a id="__codelineno-60-11" name="__codelineno-60-11" href="#__codelineno-60-11"></a>
</span><span id="__span-60-12"><a id="__codelineno-60-12" name="__codelineno-60-12" href="#__codelineno-60-12"></a>$ docker images
</span><span id="__span-60-13"><a id="__codelineno-60-13" name="__codelineno-60-13" href="#__codelineno-60-13"></a>REPOSITORY                         TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
</span><span id="__span-60-14"><a id="__codelineno-60-14" name="__codelineno-60-14" href="#__codelineno-60-14"></a>127.0.0.1:5000/ubuntu:latest       latest              ba5877dc9bec        6 weeks ago         192.7 MB
</span></code></pre></div> </li> </ol> <h4 id="423é…ç½®é-https-åœ°å€">4.2.3ã€é…ç½®é https åœ°å€<a class="headerlink" href="#423é…ç½®é-https-åœ°å€" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ <code>127.0.0.1:5000</code> ä½œä¸ºä»“åº“åœ°å€ï¼Œæ¯”å¦‚æƒ³è®©æœ¬ç½‘æ®µçš„å…¶ä»–ä¸»æœºä¹Ÿèƒ½æŠŠé•œåƒæ¨é€åˆ°ç§æœ‰ä»“åº“ã€‚ä½ å°±å¾—æŠŠä¾‹å¦‚ <code>192.168.199.100:5000</code> è¿™æ ·çš„å†…ç½‘åœ°å€ä½œä¸ºç§æœ‰ä»“åº“åœ°å€ï¼Œè¿™æ—¶ä½ ä¼šå‘ç°æ— æ³•æˆåŠŸæ¨é€é•œåƒã€‚</p> <p>è¿™æ˜¯å› ä¸º Docker é»˜è®¤ä¸å…è®¸é <code>HTTPS</code> æ–¹å¼æ¨é€é•œåƒã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ Docker çš„é…ç½®é€‰é¡¹æ¥å–æ¶ˆè¿™ä¸ªé™åˆ¶ã€‚</p> <p><strong>Ubuntu 16.04+ã€Debian 8+ã€centos 7</strong></p> <p>å¯¹äºä½¿ç”¨ <code>systemd</code> çš„ç³»ç»Ÿï¼Œè¯·åœ¨ <code>/etc/docker/daemon.json</code> ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼ˆå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨è¯·æ–°å»ºè¯¥æ–‡ä»¶ï¼‰ï¼š</p> <div class="language-json highlight"><span class="filename">JSON</span><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="p">{</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="w">  </span><span class="nt">"registry-mirrors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="w">    </span><span class="s2">"https://hub-mirror.c.163.com"</span><span class="p">,</span>
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="w">    </span><span class="s2">"https://mirror.baidubce.com"</span>
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-61-6"><a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a><span class="w">  </span><span class="nt">"insecure-registries"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-61-7"><a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a><span class="w">    </span><span class="s2">"192.168.199.100:5000"</span>
</span><span id="__span-61-8"><a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-61-9"><a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a><span class="p">}</span>
</span></code></pre></div> <div class="admonition warning"> <p class="admonition-title">Caution</p> <p>è¯¥æ–‡ä»¶å¿…é¡»ç¬¦åˆ <code>json</code> è§„èŒƒï¼Œå¦åˆ™ Docker å°†ä¸èƒ½å¯åŠ¨ã€‚</p> </div> <p><strong>å…¶ä»–</strong></p> <p>å¯¹äº Docker Desktop for Windows ã€ Docker Desktop for Mac åœ¨è®¾ç½®ä¸­çš„ <code>Docker Engine</code> ä¸­è¿›è¡Œç¼–è¾‘ ï¼Œå¢åŠ å’Œä¸Šè¾¹ä¸€æ ·çš„å­—ç¬¦ä¸²å³å¯ã€‚</p> <h2 id="5æ•°æ®ç®¡ç†">5ã€æ•°æ®ç®¡ç†<a class="headerlink" href="#5æ•°æ®ç®¡ç†" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <p>åœ¨å®¹å™¨ä¸­ç®¡ç†æ•°æ®ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š</p> <ul> <li>æ•°æ®å·ï¼ˆVolumesï¼‰ã€‚</li> <li>ç»‘å®šæŒ‚è½½ (Bind mounts)ã€‚</li> </ul> <p>Docker ç®¡ç†æ•°æ®å·çš„å‘½ä»¤ä¸º <code>docker volume</code>ï¼Œå…¶ä¸‹æœ‰ä»¥ä¸‹å­å‘½ä»¤ï¼š</p> <table> <thead> <tr> <th style="text-align: left;">å‘½ä»¤</th> <th style="text-align: left;">æè¿°</th> </tr> </thead> <tbody> <tr> <td style="text-align: left;"><code>docker volume create</code></td> <td style="text-align: left;">åˆ›å»ºå·ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker volume inspect</code></td> <td style="text-align: left;">æ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªå·çš„è¯¦ç»†ä¿¡æ¯ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker volume ls</code></td> <td style="text-align: left;">åˆ—å‡ºå·ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker volume prune</code></td> <td style="text-align: left;">åˆ é™¤æœªä½¿ç”¨çš„æœ¬åœ°å·ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker volume rm</code></td> <td style="text-align: left;">åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå·ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker volume update</code></td> <td style="text-align: left;">æ›´æ–°å·ï¼ˆä»…é™é›†ç¾¤å·ï¼‰ã€‚</td> </tr> </tbody> </table> <h3 id="51æ•°æ®å·">5.1ã€æ•°æ®å·<a class="headerlink" href="#51æ•°æ®å·" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>æ•°æ®å·æ˜¯ä¸€ä¸ªå¯ä¾›ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ä½¿ç”¨çš„ç‰¹æ®Šç›®å½•ï¼Œå®ƒç»•è¿‡ UnionFSï¼Œå¯ä»¥æä¾›å¾ˆå¤šæœ‰ç”¨çš„ç‰¹æ€§ï¼š</p> <ul> <li>æ•°æ®å·å¯ä»¥åœ¨å®¹å™¨ä¹‹é—´å…±äº«å’Œé‡ç”¨ã€‚</li> <li>å¯¹æ•°æ®å·çš„ä¿®æ”¹ä¼šç«‹é©¬ç”Ÿæ•ˆã€‚</li> <li>å¯¹æ•°æ®å·çš„æ›´æ–°ï¼Œä¸ä¼šå½±å“é•œåƒã€‚</li> <li>æ•°æ®å·é»˜è®¤ä¼šä¸€ç›´å­˜åœ¨ï¼Œå³ä½¿å®¹å™¨è¢«åˆ é™¤ã€‚</li> </ul> <div class="admonition note"> <p class="admonition-title">Note</p> <p>æ•°æ®å·çš„ä½¿ç”¨ï¼Œç±»ä¼¼äº Linux ä¸‹å¯¹ç›®å½•æˆ–æ–‡ä»¶è¿›è¡Œ <code>mount</code>ï¼Œé•œåƒä¸­çš„è¢«æŒ‡å®šä¸ºæŒ‚è½½ç‚¹çš„ç›®å½•ä¸­çš„æ–‡ä»¶ä¼šå¤åˆ¶åˆ°æ•°æ®å·ä¸­ï¼ˆä»…æ•°æ®å·ä¸ºç©ºæ—¶ä¼šå¤åˆ¶ï¼‰ã€‚</p> </div> <h4 id="511åˆ›å»ºæ•°æ®å·">5.1.1ã€åˆ›å»ºæ•°æ®å·<a class="headerlink" href="#511åˆ›å»ºæ•°æ®å·" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>åˆ›å»ºæ•°æ®å· <code>my-vol</code>ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>docker<span class="w"> </span>volume<span class="w"> </span>create<span class="w"> </span>my-vol
</span></code></pre></div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>å¦‚æœæœªæŒ‡å®šåç§°ï¼ŒDocker å°†ç”Ÿæˆä¸€ä¸ªéšæœºåç§°ï¼Œè¿™ç§æ•°æ®å·è¢«ç§°ä¸ºåŒ¿åå·ã€‚</p> </div> <p>ä½¿ç”¨ <code>docker volume ls</code> æŸ¥çœ‹æ‰€æœ‰çš„æ•°æ®å·ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>$ docker volume ls
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a>
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a>DRIVER              VOLUME NAME
</span><span id="__span-63-4"><a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a>local               my-vol
</span></code></pre></div> <p>ä½¿ç”¨ <code>docker volume inspect</code> å‘½ä»¤å¯ä»¥æŸ¥çœ‹æŒ‡å®šæ•°æ®å·çš„ä¿¡æ¯ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>$ docker volume inspect my-vol
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>[
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a>    {
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a>        "Driver": "local",
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a>        "Labels": {},
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a>        "Mountpoint": "/var/lib/docker/volumes/my-vol/_data",
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a>        "Name": "my-vol",
</span><span id="__span-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a>        "Options": {},
</span><span id="__span-64-9"><a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a>        "Scope": "local"
</span><span id="__span-64-10"><a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a>    }
</span><span id="__span-64-11"><a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a>]
</span></code></pre></div> <h4 id="512ä½¿ç”¨æ•°æ®å·å¯åŠ¨å®¹å™¨">5.1.2ã€ä½¿ç”¨æ•°æ®å·å¯åŠ¨å®¹å™¨<a class="headerlink" href="#512ä½¿ç”¨æ•°æ®å·å¯åŠ¨å®¹å™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>åœ¨ç”¨ <code>docker run</code> å‘½ä»¤çš„æ—¶å€™ï¼Œä½¿ç”¨ <code>--mount</code> æ ‡è®°æ¥å°†æ•°æ®å·æŒ‚è½½åˆ°å®¹å™¨é‡Œï¼Œåœ¨ä¸€æ¬¡ <code>docker run</code> ä¸­å¯ä»¥æŒ‚è½½å¤šä¸ªæ•°æ®å·ã€‚</p> <p>ä¸‹é¢åˆ›å»ºä¸€ä¸ªåä¸º <code>web</code> çš„å®¹å™¨ï¼Œå¹¶åŠ è½½ä¸€ä¸ªæ•°æ®å·åˆ°å®¹å™¨çš„ <code>/usr/share/nginx/html</code> ç›®å½•ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>web<span class="w"> </span>--mount<span class="w"> </span><span class="nv">source</span><span class="o">=</span>my-vol,target<span class="o">=</span>/usr/share/nginx/html<span class="w"> </span>nginx:alpine
</span></code></pre></div> <p>ä½¿ç”¨ <code>docker inspect</code> å‘½ä»¤éªŒè¯ <code>web</code> å®¹å™¨æ˜¯å¦å·²æ­£ç¡®æŒ‚è½½æ•°æ®å·ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>docker<span class="w"> </span>inspect<span class="w"> </span>web
</span></code></pre></div> <p>æŸ¥æ‰¾ <code>Mounts</code> éƒ¨åˆ†ï¼š</p> <div class="language-json highlight"><span class="filename">JSON</span><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="nt">"Mounts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-67-3"><a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a><span class="w">        </span><span class="nt">"Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"volume"</span><span class="p">,</span>
</span><span id="__span-67-4"><a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a><span class="w">        </span><span class="nt">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"my-vol"</span><span class="p">,</span>
</span><span id="__span-67-5"><a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a><span class="w">        </span><span class="nt">"Source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/var/lib/docker/volumes/my-vol/_data"</span><span class="p">,</span>
</span><span id="__span-67-6"><a id="__codelineno-67-6" name="__codelineno-67-6" href="#__codelineno-67-6"></a><span class="w">        </span><span class="nt">"Destination"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/usr/share/nginx/html"</span><span class="p">,</span>
</span><span id="__span-67-7"><a id="__codelineno-67-7" name="__codelineno-67-7" href="#__codelineno-67-7"></a><span class="w">        </span><span class="nt">"Driver"</span><span class="p">:</span><span class="w"> </span><span class="s2">"local"</span><span class="p">,</span>
</span><span id="__span-67-8"><a id="__codelineno-67-8" name="__codelineno-67-8" href="#__codelineno-67-8"></a><span class="w">        </span><span class="nt">"Mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span>
</span><span id="__span-67-9"><a id="__codelineno-67-9" name="__codelineno-67-9" href="#__codelineno-67-9"></a><span class="w">        </span><span class="nt">"RW"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-67-10"><a id="__codelineno-67-10" name="__codelineno-67-10" href="#__codelineno-67-10"></a><span class="w">        </span><span class="nt">"Propagation"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span>
</span><span id="__span-67-11"><a id="__codelineno-67-11" name="__codelineno-67-11" href="#__codelineno-67-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-67-12"><a id="__codelineno-67-12" name="__codelineno-67-12" href="#__codelineno-67-12"></a><span class="p">],</span>
</span></code></pre></div> <p>è¿™è¡¨æ˜æ•°æ®å·æŒ‚è½½æˆåŠŸï¼Œå®ƒæ˜¾ç¤ºäº†æ­£ç¡®çš„æºå’Œç›®æ ‡ï¼Œå¹¶ä¸”æŒ‚è½½æ˜¯è¯»å†™çš„ã€‚</p> <h4 id="513åˆ é™¤æ•°æ®å·">5.1.3ã€åˆ é™¤æ•°æ®å·<a class="headerlink" href="#513åˆ é™¤æ•°æ®å·" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>åˆ é™¤æ•°æ®å· <code>my-vol</code>ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>docker<span class="w"> </span>volume<span class="w"> </span>rm<span class="w"> </span>my-vol
</span></code></pre></div> <p>æ•°æ®å·æ˜¯è¢«è®¾è®¡ç”¨æ¥æŒä¹…åŒ–æ•°æ®çš„ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸç‹¬ç«‹äºå®¹å™¨ï¼ŒDocker ä¸ä¼šåœ¨å®¹å™¨è¢«åˆ é™¤åè‡ªåŠ¨åˆ é™¤æ•°æ®å·ï¼Œå¹¶ä¸”ä¹Ÿä¸å­˜åœ¨åƒåœ¾å›æ”¶è¿™æ ·çš„æœºåˆ¶æ¥å¤„ç†æ²¡æœ‰ä»»ä½•å®¹å™¨å¼•ç”¨çš„æ•°æ®å·ã€‚</p> <p>æ— ä¸»çš„æ•°æ®å·å¯èƒ½ä¼šå æ®å¾ˆå¤šç©ºé—´ï¼Œè¦æ¸…ç†å¯ä»¥ä½¿ç”¨ <code>docker volume prune</code> å‘½ä»¤ã€‚</p> <div class="admonition tip"> <p class="admonition-title">Tip</p> <p><code>docker volume prune</code> åªä¼šåˆ é™¤æ‰€æœ‰æœªè¢«å®¹å™¨ä½¿ç”¨çš„åŒ¿åå·ï¼Œå¦‚æœæƒ³åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„å·ï¼Œéœ€è¦åŠ ä¸Šå‚æ•° <code>-a</code>ã€‚</p> </div> <h3 id="52ç»‘å®šæŒ‚è½½">5.2ã€ç»‘å®šæŒ‚è½½<a class="headerlink" href="#52ç»‘å®šæŒ‚è½½" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p><strong>æŒ‚è½½ä¸»æœºç›®å½•ä½œä¸ºæ•°æ®å·</strong></p> <p>ä½¿ç”¨ <code>--mount</code> å‚æ•°å¯ä»¥æŒ‡å®šæŒ‚è½½ä¸€ä¸ªæœ¬åœ°ä¸»æœºçš„ç›®å½•åˆ°å®¹å™¨ä¸­å»ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>web<span class="w"> </span>--mount<span class="w"> </span><span class="nv">type</span><span class="o">=</span>bind,source<span class="o">=</span>/src/webapp,target<span class="o">=</span>/usr/share/nginx/html<span class="w"> </span>nginx:alpine
</span></code></pre></div> <p>ä¸Šé¢çš„å‘½ä»¤åŠ è½½ä¸»æœºçš„ <code>/src/webapp</code> ç›®å½•åˆ°å®¹å™¨çš„ <code>/usr/share/nginx/html</code>ç›®å½•ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨è¿›è¡Œæµ‹è¯•çš„æ—¶å€™ååˆ†æ–¹ä¾¿ï¼Œæ¯”å¦‚ç”¨æˆ·å¯ä»¥æ”¾ç½®ä¸€äº›ç¨‹åºåˆ°æœ¬åœ°ç›®å½•ä¸­ï¼Œæ¥æŸ¥çœ‹å®¹å™¨æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p> <div class="admonition warning"> <p class="admonition-title">Caution</p> <p>ä½¿ç”¨ <code>--mount</code> å‚æ•°æ—¶å¦‚æœæœ¬åœ°ç›®å½•ä¸å­˜åœ¨ï¼ŒDocker ä¼šæŠ¥é”™ã€‚</p> </div> <p>ä½¿ç”¨ <code>docker inspect</code> å‘½ä»¤éªŒè¯ <code>web</code> å®¹å™¨æ˜¯å¦å·²æ­£ç¡®æŒ‚è½½æ•°æ®å·ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a>docker<span class="w"> </span>inspect<span class="w"> </span>web
</span></code></pre></div> <p>æŸ¥æ‰¾ <code>Mounts</code> éƒ¨åˆ†ï¼š</p> <div class="language-json highlight"><span class="filename">JSON</span><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="nt">"Mounts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a><span class="w">        </span><span class="nt">"Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bind"</span><span class="p">,</span>
</span><span id="__span-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a><span class="w">        </span><span class="nt">"Source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/src/webapp"</span><span class="p">,</span>
</span><span id="__span-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a><span class="w">        </span><span class="nt">"Destination"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/usr/share/nginx/html"</span><span class="p">,</span>
</span><span id="__span-71-6"><a id="__codelineno-71-6" name="__codelineno-71-6" href="#__codelineno-71-6"></a><span class="w">        </span><span class="nt">"Mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span>
</span><span id="__span-71-7"><a id="__codelineno-71-7" name="__codelineno-71-7" href="#__codelineno-71-7"></a><span class="w">        </span><span class="nt">"RW"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-71-8"><a id="__codelineno-71-8" name="__codelineno-71-8" href="#__codelineno-71-8"></a><span class="w">        </span><span class="nt">"Propagation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rprivate"</span>
</span><span id="__span-71-9"><a id="__codelineno-71-9" name="__codelineno-71-9" href="#__codelineno-71-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-71-10"><a id="__codelineno-71-10" name="__codelineno-71-10" href="#__codelineno-71-10"></a><span class="p">],</span>
</span></code></pre></div> <p>è¿™è¡¨æ˜ <code>bind</code> æŒ‚è½½æˆåŠŸï¼Œæ˜¾ç¤ºæŒ‚è½½æ˜¯è¯»å†™çš„ï¼Œï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥é€šè¿‡å¢åŠ  <code>readonly</code> æŒ‡å®šä¸ºåªè¯»ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>web<span class="w"> </span>--mount<span class="w"> </span><span class="nv">type</span><span class="o">=</span>bind,source<span class="o">=</span>/src/webapp,target<span class="o">=</span>/usr/share/nginx/html,readonly<span class="w"> </span>nginx:alpine
</span></code></pre></div> <p>åŠ äº† <code>readonly</code> ä¹‹åï¼Œå°±æŒ‚è½½ä¸ºåªè¯»äº†ã€‚å¦‚æœä½ åœ¨å®¹å™¨å†… <code>/usr/share/nginx/html</code> ç›®å½•æ–°å»ºæ–‡ä»¶ï¼Œä¼šæ˜¾ç¤ºå¦‚ä¸‹é”™è¯¯ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>/usr/share/nginx/html # touch new.txt
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>touch: new.txt: Read-only file system
</span></code></pre></div> <p><strong>æŒ‚è½½ä¸»æœºæ–‡ä»¶ä½œä¸ºæ•°æ®å·</strong></p> <p><code>--mount</code> å‚æ•°ä¹Ÿå¯ä»¥ä»ä¸»æœºæŒ‚è½½å•ä¸ªæ–‡ä»¶åˆ°å®¹å™¨ä¸­ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>$ docker run --rm -it --mount type=bind,source=$HOME/.bash_history,target=/root/.bash_history ubuntu:18.04 bash
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a>
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a>root@2affd44b4667:/# history
</span><span id="__span-74-4"><a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a>1  ls
</span><span id="__span-74-5"><a id="__codelineno-74-5" name="__codelineno-74-5" href="#__codelineno-74-5"></a>2  diskutil list
</span></code></pre></div> <p>è¿™æ ·å°±å¯ä»¥è®°å½•åœ¨å®¹å™¨è¾“å…¥è¿‡çš„å‘½ä»¤äº†ã€‚</p> <h2 id="6ä½¿ç”¨ç½‘ç»œ">6ã€ä½¿ç”¨ç½‘ç»œ<a class="headerlink" href="#6ä½¿ç”¨ç½‘ç»œ" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <p>Docker å…è®¸é€šè¿‡å¤–éƒ¨è®¿é—®å®¹å™¨æˆ–å®¹å™¨äº’è”çš„æ–¹å¼æ¥æä¾›ç½‘ç»œæœåŠ¡ã€‚</p> <p>Docker ç®¡ç†ç½‘ç»œçš„å‘½ä»¤ä¸º <code>docker network</code>ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å­å‘½ä»¤æ¥åˆ›å»ºã€æ£€æŸ¥ã€åˆ—å‡ºã€åˆ é™¤ã€æ¸…ç†ã€è¿æ¥å’Œæ–­å¼€ç½‘ç»œã€‚å…¶ä¸‹æœ‰ä»¥ä¸‹å­å‘½ä»¤ï¼š</p> <table> <thead> <tr> <th style="text-align: left;">å‘½ä»¤</th> <th style="text-align: left;">æè¿°</th> </tr> </thead> <tbody> <tr> <td style="text-align: left;"><code>docker network connect</code></td> <td style="text-align: left;">å°†å®¹å™¨è¿æ¥åˆ°ç½‘ç»œã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker network create</code></td> <td style="text-align: left;">åˆ›å»ºç½‘ç»œã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker network disconnect</code></td> <td style="text-align: left;">å°†å®¹å™¨ä»ç½‘ç»œæ–­å¼€è¿æ¥ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker network inspect</code></td> <td style="text-align: left;">æ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªç½‘ç»œçš„è¯¦ç»†ä¿¡æ¯ã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker network ls</code></td> <td style="text-align: left;">åˆ—å‡ºç½‘ç»œã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker network prune</code></td> <td style="text-align: left;">åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„ç½‘ç»œã€‚</td> </tr> <tr> <td style="text-align: left;"><code>docker network rm</code></td> <td style="text-align: left;">åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªç½‘ç»œã€‚</td> </tr> </tbody> </table> <h3 id="61å¤–éƒ¨è®¿é—®å®¹å™¨">6.1ã€å¤–éƒ¨è®¿é—®å®¹å™¨<a class="headerlink" href="#61å¤–éƒ¨è®¿é—®å®¹å™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>å®¹å™¨ä¸­å¯ä»¥è¿è¡Œä¸€äº›ç½‘ç»œåº”ç”¨ï¼Œè¦è®©å¤–éƒ¨ä¹Ÿå¯ä»¥è®¿é—®è¿™äº›åº”ç”¨ï¼Œå¯ä»¥é€šè¿‡ <code>-P</code> æˆ– <code>-p</code> å‚æ•°æ¥æŒ‡å®šç«¯å£æ˜ å°„ã€‚</p> <p>å½“ä½¿ç”¨ <code>-P</code> æ ‡è®°æ—¶ï¼ŒDocker ä¼šéšæœºæ˜ å°„ä¸€ä¸ªç«¯å£åˆ°å†…éƒ¨å®¹å™¨å¼€æ”¾çš„ç½‘ç»œç«¯å£ã€‚</p> <p>ä½¿ç”¨ <code>docker ps</code> å¯ä»¥çœ‹åˆ°ï¼Œæœ¬åœ°ä¸»æœºçš„ 32768 è¢«æ˜ å°„åˆ°äº†å®¹å™¨çš„ 80 ç«¯å£ã€‚æ­¤æ—¶è®¿é—®æœ¬æœºçš„ 32768 ç«¯å£å³å¯è®¿é—®å®¹å™¨å†… Nginx é»˜è®¤é¡µé¢ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>$ docker run -d -P nginx:alpine
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a>
</span><span id="__span-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a>$ docker ps -l
</span><span id="__span-75-4"><a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                   NAMES
</span><span id="__span-75-5"><a id="__codelineno-75-5" name="__codelineno-75-5" href="#__codelineno-75-5"></a>fae320d08268        nginx:alpine        "/docker-entrypoint.â€¦"   24 seconds ago      Up 20 seconds       0.0.0.0:32768-&gt;80/tcp   bold_mcnulty
</span></code></pre></div> <p>åŒæ ·çš„ï¼Œå¯ä»¥é€šè¿‡ <code>docker logs</code> å‘½ä»¤æ¥æŸ¥çœ‹è®¿é—®è®°å½•ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a>$ docker logs fae3
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a>172.17.0.1 - - [25/Aug/2020:08:34:04 +0000] "GET / HTTP/1.1" 200 612 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:80.0) Gecko/20100101 Firefox/80.0" "-"
</span></code></pre></div> <p><code>-p</code> åˆ™å¯ä»¥æŒ‡å®šè¦æ˜ å°„çš„ç«¯å£ï¼Œå¹¶ä¸”ï¼Œåœ¨ä¸€ä¸ªæŒ‡å®šç«¯å£ä¸Šåªå¯ä»¥ç»‘å®šä¸€ä¸ªå®¹å™¨ã€‚æ”¯æŒçš„æ ¼å¼æœ‰ï¼š</p> <ul> <li><code>hostPort:containerPort</code></li> <li><code>ip:hostPort:containerPort</code></li> <li><code>ip::containerPort</code></li> </ul> <p><strong>æ˜ å°„æ‰€æœ‰æ¥å£åœ°å€</strong></p> <p>ä½¿ç”¨ <code>hostPort:containerPort</code> æ ¼å¼æœ¬åœ°çš„ 80 ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„ 80 ç«¯å£ï¼Œå¯ä»¥æ‰§è¡Œï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span><span class="m">80</span>:80<span class="w"> </span>nginx:alpine
</span></code></pre></div> <p>æ­¤æ—¶é»˜è®¤ä¼šç»‘å®šæœ¬åœ°æ‰€æœ‰æ¥å£ä¸Šçš„æ‰€æœ‰åœ°å€ã€‚</p> <p><code>-p</code> æ ‡è®°å¯ä»¥å¤šæ¬¡ä½¿ç”¨æ¥ç»‘å®šå¤šä¸ªç«¯å£ï¼Œä¾‹å¦‚ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span><span class="m">80</span>:80<span class="w"> </span>-p<span class="w"> </span><span class="m">443</span>:443<span class="w"> </span>nginx:alpine
</span></code></pre></div> <p><strong>æ˜ å°„åˆ°æŒ‡å®šåœ°å€çš„æŒ‡å®šç«¯å£</strong></p> <p>å¯ä»¥ä½¿ç”¨ <code>ip:hostPort:containerPort</code> æ ¼å¼æŒ‡å®šæ˜ å°„ä½¿ç”¨ä¸€ä¸ªç‰¹å®šåœ°å€ï¼Œæ¯”å¦‚ <code>localhost</code> åœ°å€ <code>127.0.0.1</code>ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span><span class="m">127</span>.0.0.1:80:80<span class="w"> </span>nginx:alpine
</span></code></pre></div> <p><strong>æ˜ å°„åˆ°æŒ‡å®šåœ°å€çš„ä»»æ„ç«¯å£</strong></p> <p>ä½¿ç”¨ <code>ip::containerPort</code> ç»‘å®š <code>localhost</code> çš„ä»»æ„ç«¯å£åˆ°å®¹å™¨çš„ 80 ç«¯å£ï¼Œæœ¬åœ°ä¸»æœºä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ªç«¯å£ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span><span class="m">127</span>.0.0.1::80<span class="w"> </span>nginx:alpine
</span></code></pre></div> <p>è¿˜å¯ä»¥ä½¿ç”¨ <code>udp</code> æ ‡è®°æ¥æŒ‡å®š <code>udp</code> ç«¯å£ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span><span class="m">127</span>.0.0.1:80:80/udp<span class="w"> </span>nginx:alpine
</span></code></pre></div> <h4 id="611æŸ¥çœ‹æ˜ å°„ç«¯å£é…ç½®">6.1.1ã€æŸ¥çœ‹æ˜ å°„ç«¯å£é…ç½®<a class="headerlink" href="#611æŸ¥çœ‹æ˜ å°„ç«¯å£é…ç½®" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>ä½¿ç”¨ <code>docker container port</code>ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker port</code>ï¼‰æ¥æŸ¥çœ‹å½“å‰æ˜ å°„çš„ç«¯å£é…ç½®ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹åˆ°ç»‘å®šçš„åœ°å€ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>$ docker port fa 80
</span><span id="__span-82-2"><a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a>0.0.0.0:32768
</span></code></pre></div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>å®¹å™¨æœ‰è‡ªå·±çš„å†…éƒ¨ç½‘ç»œå’Œ IP åœ°å€ï¼ˆä½¿ç”¨ <code>docker inspect</code> æŸ¥çœ‹ï¼ŒDocker è¿˜å¯ä»¥æœ‰ä¸€ä¸ªå¯å˜çš„ç½‘ç»œé…ç½®ï¼‰ã€‚</p> </div> <h3 id="62å®¹å™¨äº’è”">6.2ã€å®¹å™¨äº’è”<a class="headerlink" href="#62å®¹å™¨äº’è”" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>å¦‚æœä½ ä¹‹å‰æœ‰ <code>Docker</code> ä½¿ç”¨ç»éªŒï¼Œä½ å¯èƒ½å·²ç»ä¹ æƒ¯äº†ä½¿ç”¨ <code>--link</code> å‚æ•°æ¥ä½¿å®¹å™¨äº’è”ã€‚</p> <p>éšç€ Docker ç½‘ç»œçš„å®Œå–„ï¼Œå¼ºçƒˆå»ºè®®å¤§å®¶å°†å®¹å™¨åŠ å…¥è‡ªå®šä¹‰çš„ Docker ç½‘ç»œæ¥è¿æ¥å¤šä¸ªå®¹å™¨ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ <code>--link</code> å‚æ•°ã€‚</p> <div class="admonition tip"> <p class="admonition-title">Tip</p> <p>å¦‚æœä½ æœ‰å¤šä¸ªå®¹å™¨ä¹‹é—´éœ€è¦äº’ç›¸è¿æ¥ï¼Œæ¨èä½¿ç”¨ Docker Composeã€‚</p> </div> <h4 id="621æ–°å»ºç½‘ç»œ">6.2.1ã€æ–°å»ºç½‘ç»œ<a class="headerlink" href="#621æ–°å»ºç½‘ç»œ" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>ä¸‹é¢å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„ Docker ç½‘ç»œï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a>docker<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>-d<span class="w"> </span>bridge<span class="w"> </span>my-net
</span></code></pre></div> <p><code>-d</code> å‚æ•°æŒ‡å®š Docker ç½‘ç»œç±»å‹ï¼Œæœ‰ <code>bridge</code>ã€<code>overlay</code>ã€‚</p> <h4 id="622è¿æ¥å®¹å™¨">6.2.2ã€è¿æ¥å®¹å™¨<a class="headerlink" href="#622è¿æ¥å®¹å™¨" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>è¿è¡Œä¸€ä¸ªå®¹å™¨å¹¶è¿æ¥åˆ°æ–°å»ºçš„ <code>my-net</code> ç½‘ç»œï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>--name<span class="w"> </span>busybox1<span class="w"> </span>--network<span class="w"> </span>my-net<span class="w"> </span>busybox<span class="w"> </span>sh
</span></code></pre></div> <p>æ‰“å¼€æ–°çš„ç»ˆç«¯ï¼Œå†è¿è¡Œä¸€ä¸ªå®¹å™¨å¹¶åŠ å…¥åˆ° <code>my-net</code> ç½‘ç»œï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span>--name<span class="w"> </span>busybox2<span class="w"> </span>--network<span class="w"> </span>my-net<span class="w"> </span>busybox<span class="w"> </span>sh
</span></code></pre></div> <p>å†æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯æŸ¥çœ‹å®¹å™¨ä¿¡æ¯ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>$ docker ps
</span><span id="__span-86-2"><a id="__codelineno-86-2" name="__codelineno-86-2" href="#__codelineno-86-2"></a>
</span><span id="__span-86-3"><a id="__codelineno-86-3" name="__codelineno-86-3" href="#__codelineno-86-3"></a>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</span><span id="__span-86-4"><a id="__codelineno-86-4" name="__codelineno-86-4" href="#__codelineno-86-4"></a>b47060aca56b        busybox             "sh"                11 minutes ago      Up 11 minutes                           busybox2
</span><span id="__span-86-5"><a id="__codelineno-86-5" name="__codelineno-86-5" href="#__codelineno-86-5"></a>8720575823ec        busybox             "sh"                16 minutes ago      Up 16 minutes                           busybox1
</span></code></pre></div> <h4 id="623æµ‹è¯•äº’è”">6.2.3ã€æµ‹è¯•äº’è”<a class="headerlink" href="#623æµ‹è¯•äº’è”" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>ä¸‹é¢é€šè¿‡ <code>ping</code> æ¥è¯æ˜ <code>busybox1</code> å®¹å™¨å’Œ <code>busybox2</code> å®¹å™¨å»ºç«‹äº†äº’è”å…³ç³»ã€‚</p> <p>åœ¨ <code>busybox1</code> å®¹å™¨ç”¨ <code>ping busybox2</code> æ¥æµ‹è¯•è¿æ¥ <code>busybox2</code> å®¹å™¨ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a>/ # ping busybox2
</span><span id="__span-87-2"><a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a>PING busybox2 (172.19.0.3): 56 data bytes
</span><span id="__span-87-3"><a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a>64 bytes from 172.19.0.3: seq=0 ttl=64 time=0.072 ms
</span><span id="__span-87-4"><a id="__codelineno-87-4" name="__codelineno-87-4" href="#__codelineno-87-4"></a>64 bytes from 172.19.0.3: seq=1 ttl=64 time=0.118 ms
</span></code></pre></div> <p>å¯ä»¥çœ‹åˆ°å®ƒä¼šè§£ææˆ <code>172.19.0.3</code>ï¼ŒåŒç†åœ¨ <code>busybox2</code> å®¹å™¨æ‰§è¡Œ <code>ping busybox1</code>ï¼Œä¹Ÿä¼šæˆåŠŸè¿æ¥åˆ°ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a>/ # ping busybox1
</span><span id="__span-88-2"><a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a>PING busybox1 (172.19.0.2): 56 data bytes
</span><span id="__span-88-3"><a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a>64 bytes from 172.19.0.2: seq=0 ttl=64 time=0.064 ms
</span><span id="__span-88-4"><a id="__codelineno-88-4" name="__codelineno-88-4" href="#__codelineno-88-4"></a>64 bytes from 172.19.0.2: seq=1 ttl=64 time=0.143 ms
</span></code></pre></div> <p>è¿™æ ·ï¼Œ<code>busybox1</code> å®¹å™¨å’Œ <code>busybox2</code> å®¹å™¨å»ºç«‹äº†äº’è”å…³ç³»ã€‚</p> <h3 id="63é…ç½®-dns">6.3ã€é…ç½® DNS<a class="headerlink" href="#63é…ç½®-dns" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>å¦‚ä½•è‡ªå®šä¹‰é…ç½®å®¹å™¨çš„ä¸»æœºåå’Œ DNS å‘¢ï¼Ÿç§˜è¯€å°±æ˜¯ Docker åˆ©ç”¨è™šæ‹Ÿæ–‡ä»¶æ¥æŒ‚è½½å®¹å™¨çš„ 3 ä¸ªç›¸å…³é…ç½®æ–‡ä»¶ã€‚</p> <p>åœ¨å®¹å™¨ä¸­ä½¿ç”¨ <code>mount</code> å‘½ä»¤å¯ä»¥çœ‹åˆ°æŒ‚è½½ä¿¡æ¯ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a>$ mount
</span><span id="__span-89-2"><a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a>/dev/disk/by-uuid/1fec...ebdf on /etc/hostname type ext4 ...
</span><span id="__span-89-3"><a id="__codelineno-89-3" name="__codelineno-89-3" href="#__codelineno-89-3"></a>/dev/disk/by-uuid/1fec...ebdf on /etc/hosts type ext4 ...
</span><span id="__span-89-4"><a id="__codelineno-89-4" name="__codelineno-89-4" href="#__codelineno-89-4"></a>tmpfs on /etc/resolv.conf type tmpfs ...
</span></code></pre></div> <p>è¿™ç§æœºåˆ¶å¯ä»¥è®©å®¿ä¸»ä¸»æœº DNS ä¿¡æ¯å‘ç”Ÿæ›´æ–°åï¼Œæ‰€æœ‰ Docker å®¹å™¨çš„ DNS é…ç½®é€šè¿‡ <code>/etc/resolv.conf</code> æ–‡ä»¶ç«‹åˆ»å¾—åˆ°æ›´æ–°ã€‚</p> <p>é…ç½®å…¨éƒ¨å®¹å™¨çš„ DNS ï¼Œä¹Ÿå¯ä»¥åœ¨ <code>/etc/docker/daemon.json</code> æ–‡ä»¶ä¸­å¢åŠ ä»¥ä¸‹å†…å®¹æ¥è®¾ç½®ï¼š</p> <div class="language-json highlight"><span class="filename">JSON</span><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a><span class="p">{</span>
</span><span id="__span-90-2"><a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a><span class="w">  </span><span class="nt">"dns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-90-3"><a id="__codelineno-90-3" name="__codelineno-90-3" href="#__codelineno-90-3"></a><span class="w">    </span><span class="s2">"114.114.114.114"</span><span class="p">,</span>
</span><span id="__span-90-4"><a id="__codelineno-90-4" name="__codelineno-90-4" href="#__codelineno-90-4"></a><span class="w">    </span><span class="s2">"8.8.8.8"</span>
</span><span id="__span-90-5"><a id="__codelineno-90-5" name="__codelineno-90-5" href="#__codelineno-90-5"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-90-6"><a id="__codelineno-90-6" name="__codelineno-90-6" href="#__codelineno-90-6"></a><span class="p">}</span>
</span></code></pre></div> <p>è¿™æ ·æ¯æ¬¡å¯åŠ¨çš„å®¹å™¨ DNS è‡ªåŠ¨é…ç½®ä¸º <code>114.114.114.114</code> å’Œ <code>8.8.8.8</code>ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥è¯æ˜å…¶å·²ç»ç”Ÿæ•ˆï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a>$ docker run -it --rm ubuntu:18.04 cat /etc/resolv.conf
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a>
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a>nameserver 114.114.114.114
</span><span id="__span-91-4"><a id="__codelineno-91-4" name="__codelineno-91-4" href="#__codelineno-91-4"></a>nameserver 8.8.8.8
</span></code></pre></div> <p>å¦‚æœç”¨æˆ·æƒ³è¦æ‰‹åŠ¨æŒ‡å®šå®¹å™¨çš„é…ç½®ï¼Œå¯ä»¥åœ¨ä½¿ç”¨ <code>docker run</code> å‘½ä»¤å¯åŠ¨å®¹å™¨æ—¶åŠ å…¥å¦‚ä¸‹å‚æ•°ï¼š</p> <ul> <li><code>-h HOSTNAME</code> æˆ–è€… <code>--hostname=HOSTNAME</code> è®¾å®šå®¹å™¨çš„ä¸»æœºåï¼Œå®ƒä¼šè¢«å†™åˆ°å®¹å™¨å†…çš„ <code>/etc/hostname</code> å’Œ <code>/etc/hosts</code>ã€‚ä½†å®ƒåœ¨å®¹å™¨å¤–éƒ¨çœ‹ä¸åˆ°ï¼Œæ—¢ä¸ä¼šåœ¨ <code>docker ps</code> ä¸­æ˜¾ç¤ºï¼Œä¹Ÿä¸ä¼šåœ¨å…¶ä»–çš„å®¹å™¨çš„ <code>/etc/hosts</code> çœ‹åˆ°ã€‚</li> <li><code>--dns=IP_ADDRESS</code> æ·»åŠ  DNS æœåŠ¡å™¨åˆ°å®¹å™¨çš„ <code>/etc/resolv.conf</code> ä¸­ï¼Œè®©å®¹å™¨ç”¨è¿™ä¸ªæœåŠ¡å™¨æ¥è§£ææ‰€æœ‰ä¸åœ¨ <code>/etc/hosts</code> ä¸­çš„ä¸»æœºåã€‚</li> <li><code>--dns-search=DOMAIN</code> è®¾å®šå®¹å™¨çš„æœç´¢åŸŸï¼Œå½“è®¾å®šæœç´¢åŸŸä¸º <code>.example.com</code> æ—¶ï¼Œåœ¨æœç´¢ä¸€ä¸ªåä¸º host çš„ä¸»æœºæ—¶ï¼ŒDNS ä¸ä»…æœç´¢ hostï¼Œè¿˜ä¼šæœç´¢ <code>host.example.com</code>ã€‚</li> </ul> <div class="admonition tip"> <p class="admonition-title">Important</p> <p>å¦‚æœåœ¨å®¹å™¨å¯åŠ¨æ—¶æ²¡æœ‰æŒ‡å®šæœ€åä¸¤ä¸ªå‚æ•°ï¼ŒDocker ä¼šé»˜è®¤ç”¨ä¸»æœºä¸Šçš„ <code>/etc/resolv.conf</code> æ¥é…ç½®å®¹å™¨ã€‚</p> </div> <h2 id="7æ„å»ºé•œåƒ">7ã€æ„å»ºé•œåƒ<a class="headerlink" href="#7æ„å»ºé•œåƒ" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <h3 id="71dockerfile-å®šåˆ¶é•œåƒ">7.1ã€Dockerfile å®šåˆ¶é•œåƒ<a class="headerlink" href="#71dockerfile-å®šåˆ¶é•œåƒ" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>é•œåƒçš„å®šåˆ¶å®é™…ä¸Šå°±æ˜¯å®šåˆ¶æ¯ä¸€å±‚æ‰€æ·»åŠ çš„é…ç½®ã€æ–‡ä»¶ã€‚å¦‚æœæˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸€å±‚ä¿®æ”¹ã€å®‰è£…ã€æ„å»ºã€æ“ä½œçš„å‘½ä»¤éƒ½å†™å…¥ä¸€ä¸ªè„šæœ¬ï¼Œç”¨è¿™ä¸ªè„šæœ¬æ¥æ„å»ºã€å®šåˆ¶é•œåƒï¼Œè¿™ä¸ªè„šæœ¬å°±æ˜¯ Dockerfileã€‚</p> <p>Dockerfile æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶å†…åŒ…å«äº†ä¸€æ¡æ¡çš„æŒ‡ä»¤ï¼ˆInstructionï¼‰ï¼Œæ¯ä¸€æ¡æŒ‡ä»¤æ„å»ºä¸€å±‚ï¼Œå› æ­¤æ¯ä¸€æ¡æŒ‡ä»¤çš„å†…å®¹ï¼Œå°±æ˜¯æè¿°è¯¥å±‚åº”å½“å¦‚ä½•æ„å»ºã€‚</p> <p>åœ¨ä¸€ä¸ªç©ºç™½ç›®å½•ä¸­ï¼Œå»ºç«‹ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶å‘½åä¸º <code>Dockerfile</code>ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a>mkdir<span class="w"> </span>mynginx
</span><span id="__span-92-2"><a id="__codelineno-92-2" name="__codelineno-92-2" href="#__codelineno-92-2"></a><span class="nb">cd</span><span class="w"> </span>mynginx
</span><span id="__span-92-3"><a id="__codelineno-92-3" name="__codelineno-92-3" href="#__codelineno-92-3"></a>touch<span class="w"> </span>Dockerfile
</span></code></pre></div> <p>å…¶å†…å®¹ä¸ºï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a><span class="k">FROM</span><span class="w"> </span><span class="s">nginx</span>
</span><span id="__span-93-2"><a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a><span class="k">RUN</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'&lt;h1&gt;Hello, Docker!&lt;/h1&gt;'</span><span class="w"> </span>&gt;<span class="w"> </span>/usr/share/nginx/html/index.html
</span></code></pre></div> <p>è¿™ä¸ª Dockerfile å¾ˆç®€å•ï¼Œä¸€å…±å°±ä¸¤è¡Œã€‚æ¶‰åŠåˆ°äº†ä¸¤æ¡æŒ‡ä»¤ï¼Œ<code>FROM</code> å’Œ <code>RUN</code>ã€‚</p> <h4 id="711from">7.1.1ã€FROM<a class="headerlink" href="#711from" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>æ‰€è°“å®šåˆ¶é•œåƒï¼Œé‚£ä¸€å®šæ˜¯ä»¥ä¸€ä¸ªé•œåƒä¸ºåŸºç¡€ï¼Œåœ¨å…¶ä¸Šè¿›è¡Œå®šåˆ¶ã€‚è€Œ <code>FROM</code> å°±æ˜¯æŒ‡å®šåŸºç¡€é•œåƒï¼Œå› æ­¤ä¸€ä¸ª Dockerfile ä¸­ <code>FROM</code> æ˜¯å¿…å¤‡çš„æŒ‡ä»¤ï¼Œå¹¶ä¸”å¿…é¡»æ˜¯ç¬¬ä¸€æ¡æŒ‡ä»¤ã€‚</p> <p>åœ¨ <a href="https://hub.docker.com/search?q=&amp;type=image&amp;image_filter=official">Docker Hub</a> ä¸Šæœ‰éå¸¸å¤šçš„é«˜è´¨é‡çš„å®˜æ–¹é•œåƒï¼Œæœ‰å¯ä»¥ç›´æ¥æ‹¿æ¥ä½¿ç”¨çš„æœåŠ¡ç±»çš„é•œåƒï¼Œå¦‚ <a href="https://hub.docker.com/_/nginx/"><code>nginx</code></a>ã€<a href="https://hub.docker.com/_/redis/"><code>redis</code></a>ã€<a href="https://hub.docker.com/_/mongo/"><code>mongo</code></a>ã€<a href="https://hub.docker.com/_/mysql/"><code>mysql</code></a>ã€<a href="https://hub.docker.com/_/httpd/"><code>httpd</code></a>ã€<a href="https://hub.docker.com/_/php/"><code>php</code></a>ã€<a href="https://hub.docker.com/_/tomcat/"><code>tomcat</code></a> ç­‰ï¼›ä¹Ÿæœ‰ä¸€äº›æ–¹ä¾¿å¼€å‘ã€æ„å»ºã€è¿è¡Œå„ç§è¯­è¨€åº”ç”¨çš„é•œåƒï¼Œå¦‚ <a href="https://hub.docker.com/_/node"><code>node</code></a>ã€<a href="https://hub.docker.com/_/openjdk/"><code>openjdk</code></a>ã€<a href="https://hub.docker.com/_/python/"><code>python</code></a>ã€<a href="https://hub.docker.com/_/ruby/"><code>ruby</code></a>ã€<a href="https://hub.docker.com/_/golang/"><code>golang</code></a> ç­‰ã€‚å¯ä»¥åœ¨å…¶ä¸­å¯»æ‰¾ä¸€ä¸ªæœ€ç¬¦åˆæˆ‘ä»¬æœ€ç»ˆç›®æ ‡çš„é•œåƒä¸ºåŸºç¡€é•œåƒè¿›è¡Œå®šåˆ¶ã€‚</p> <p>å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯¹åº”æœåŠ¡çš„é•œåƒï¼Œå®˜æ–¹é•œåƒä¸­è¿˜æä¾›äº†ä¸€äº›æ›´ä¸ºåŸºç¡€çš„æ“ä½œç³»ç»Ÿé•œåƒï¼Œå¦‚ <a href="https://hub.docker.com/_/ubuntu/"><code>ubuntu</code></a>ã€<a href="https://hub.docker.com/_/debian/"><code>debian</code></a>ã€<a href="https://hub.docker.com/_/centos/"><code>centos</code></a>ã€<a href="https://hub.docker.com/_/fedora/"><code>fedora</code></a>ã€<a href="https://hub.docker.com/_/alpine/"><code>alpine</code></a> ç­‰ï¼Œè¿™äº›æ“ä½œç³»ç»Ÿçš„è½¯ä»¶åº“ä¸ºæˆ‘ä»¬æä¾›äº†æ›´å¹¿é˜”çš„æ‰©å±•ç©ºé—´ã€‚</p> <p>é™¤äº†é€‰æ‹©ç°æœ‰é•œåƒä¸ºåŸºç¡€é•œåƒå¤–ï¼ŒDocker è¿˜å­˜åœ¨ä¸€ä¸ªç‰¹æ®Šçš„é•œåƒ <code>scratch</code>ã€‚è¿™ä¸ªé•œåƒæ˜¯è™šæ‹Ÿçš„æ¦‚å¿µï¼Œå¹¶ä¸å®é™…å­˜åœ¨ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªç©ºç™½çš„é•œåƒï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a><span class="k">FROM</span><span class="w"> </span><span class="s">scratch</span>
</span><span id="__span-94-2"><a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a>...
</span></code></pre></div> <p>å¦‚æœä½ ä»¥ <code>scratch</code> ä¸ºåŸºç¡€é•œåƒçš„è¯ï¼Œæ„å‘³ç€ä½ ä¸ä»¥ä»»ä½•é•œåƒä¸ºåŸºç¡€ï¼Œæ¥ä¸‹æ¥æ‰€å†™çš„æŒ‡ä»¤å°†ä½œä¸ºé•œåƒç¬¬ä¸€å±‚å¼€å§‹å­˜åœ¨ã€‚</p> <p>ä¸ä»¥ä»»ä½•ç³»ç»Ÿä¸ºåŸºç¡€ï¼Œç›´æ¥å°†å¯æ‰§è¡Œæ–‡ä»¶å¤åˆ¶è¿›é•œåƒçš„åšæ³•å¹¶ä¸ç½•è§ï¼Œå¯¹äº Linux ä¸‹é™æ€ç¼–è¯‘çš„ç¨‹åºæ¥è¯´ï¼Œå¹¶ä¸éœ€è¦æœ‰æ“ä½œç³»ç»Ÿæä¾›è¿è¡Œæ—¶æ”¯æŒï¼Œæ‰€éœ€çš„ä¸€åˆ‡åº“éƒ½å·²ç»åœ¨å¯æ‰§è¡Œæ–‡ä»¶é‡Œäº†ï¼Œå› æ­¤ç›´æ¥ <code>FROM scratch</code> ä¼šè®©é•œåƒä½“ç§¯æ›´åŠ å°å·§ã€‚ä½¿ç”¨ <a href="https://golang.google.cn/">Go è¯­è¨€</a> å¼€å‘çš„åº”ç”¨å¾ˆå¤šä¼šä½¿ç”¨è¿™ç§æ–¹å¼æ¥åˆ¶ä½œé•œåƒï¼Œè¿™ä¹Ÿæ˜¯æœ‰äººè®¤ä¸º Go æ˜¯ç‰¹åˆ«é€‚åˆå®¹å™¨å¾®æœåŠ¡æ¶æ„çš„è¯­è¨€çš„åŸå› ä¹‹ä¸€ã€‚</p> <h4 id="712run">7.1.2ã€RUN<a class="headerlink" href="#712run" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><code>RUN</code> æŒ‡ä»¤æ˜¯ç”¨æ¥æ‰§è¡Œå‘½ä»¤è¡Œå‘½ä»¤çš„ã€‚ç”±äºå‘½ä»¤è¡Œçš„å¼ºå¤§èƒ½åŠ›ï¼Œ<code>RUN</code> æŒ‡ä»¤åœ¨å®šåˆ¶é•œåƒæ—¶æ˜¯æœ€å¸¸ç”¨çš„æŒ‡ä»¤ä¹‹ä¸€ã€‚</p> <p>å…¶æ ¼å¼æœ‰ä¸¤ç§ï¼š</p> <ul> <li> <p>shell æ ¼å¼ï¼š<code>RUN &lt;å‘½ä»¤&gt;</code>ï¼Œå°±åƒç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥çš„å‘½ä»¤ä¸€æ ·ã€‚åˆšæ‰å†™çš„ Dockerfile ä¸­çš„ <code>RUN</code> æŒ‡ä»¤å°±æ˜¯è¿™ç§æ ¼å¼ã€‚</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-95-1"><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a>RUN<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'&lt;h1&gt;Hello, Docker!&lt;/h1&gt;'</span><span class="w"> </span>&gt;<span class="w"> </span>/usr/share/nginx/html/index.html
</span></code></pre></div> </li> <li> <p>exec æ ¼å¼ï¼š<code>RUN ["å¯æ‰§è¡Œæ–‡ä»¶", "å‚æ•°1", "å‚æ•°2"]</code>ï¼Œè¿™æ›´åƒæ˜¯å‡½æ•°è°ƒç”¨ä¸­çš„æ ¼å¼ã€‚</p> </li> </ul> <p>æ—¢ç„¶ <code>RUN</code> å°±åƒ Shell è„šæœ¬ä¸€æ ·å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å°±å¯ä»¥åƒ Shell è„šæœ¬ä¸€æ ·æŠŠæ¯ä¸ªå‘½ä»¤å¯¹åº”ä¸€ä¸ª <code>RUN</code> å‘¢ï¼Ÿæ¯”å¦‚è¿™æ ·ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-96-1"><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a><span class="k">FROM</span><span class="w"> </span><span class="s">debian:stretch</span>
</span><span id="__span-96-2"><a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a>
</span><span id="__span-96-3"><a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a><span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update
</span><span id="__span-96-4"><a id="__codelineno-96-4" name="__codelineno-96-4" href="#__codelineno-96-4"></a><span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>gcc<span class="w"> </span>libc6-dev<span class="w"> </span>make<span class="w"> </span>wget
</span><span id="__span-96-5"><a id="__codelineno-96-5" name="__codelineno-96-5" href="#__codelineno-96-5"></a><span class="k">RUN</span><span class="w"> </span>wget<span class="w"> </span>-O<span class="w"> </span>redis.tar.gz<span class="w"> </span><span class="s2">"http://download.redis.io/releases/redis-5.0.3.tar.gz"</span>
</span><span id="__span-96-6"><a id="__codelineno-96-6" name="__codelineno-96-6" href="#__codelineno-96-6"></a><span class="k">RUN</span><span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/usr/src/redis
</span><span id="__span-96-7"><a id="__codelineno-96-7" name="__codelineno-96-7" href="#__codelineno-96-7"></a><span class="k">RUN</span><span class="w"> </span>tar<span class="w"> </span>-xzf<span class="w"> </span>redis.tar.gz<span class="w"> </span>-C<span class="w"> </span>/usr/src/redis<span class="w"> </span>--strip-components<span class="o">=</span><span class="m">1</span>
</span><span id="__span-96-8"><a id="__codelineno-96-8" name="__codelineno-96-8" href="#__codelineno-96-8"></a><span class="k">RUN</span><span class="w"> </span>make<span class="w"> </span>-C<span class="w"> </span>/usr/src/redis
</span><span id="__span-96-9"><a id="__codelineno-96-9" name="__codelineno-96-9" href="#__codelineno-96-9"></a><span class="k">RUN</span><span class="w"> </span>make<span class="w"> </span>-C<span class="w"> </span>/usr/src/redis<span class="w"> </span>install
</span></code></pre></div> <p>ä¹‹å‰è¯´è¿‡ï¼ŒDockerfile ä¸­æ¯ä¸€ä¸ªæŒ‡ä»¤éƒ½ä¼šå»ºç«‹ä¸€å±‚ï¼Œ<code>RUN</code> ä¹Ÿä¸ä¾‹å¤–ã€‚æ¯ä¸€ä¸ª <code>RUN</code> çš„è¡Œä¸ºï¼Œå°±å’Œåˆšæ‰æˆ‘ä»¬æ‰‹å·¥å»ºç«‹é•œåƒçš„è¿‡ç¨‹ä¸€æ ·ï¼šæ–°å»ºç«‹ä¸€å±‚ï¼Œåœ¨å…¶ä¸Šæ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œæ‰§è¡Œç»“æŸåï¼Œ<code>commit</code> è¿™ä¸€å±‚çš„ä¿®æ”¹ï¼Œæ„æˆæ–°çš„é•œåƒã€‚</p> <p>è€Œä¸Šé¢çš„è¿™ç§å†™æ³•ï¼Œåˆ›å»ºäº† 7 å±‚é•œåƒã€‚è¿™æ˜¯å®Œå…¨æ²¡æœ‰æ„ä¹‰çš„ï¼Œè€Œä¸”å¾ˆå¤šè¿è¡Œæ—¶ä¸éœ€è¦çš„ä¸œè¥¿ï¼Œéƒ½è¢«è£…è¿›äº†é•œåƒé‡Œï¼Œæ¯”å¦‚ç¼–è¯‘ç¯å¢ƒã€æ›´æ–°çš„è½¯ä»¶åŒ…ç­‰ç­‰ã€‚ç»“æœå°±æ˜¯äº§ç”Ÿéå¸¸è‡ƒè‚¿ã€éå¸¸å¤šå±‚çš„é•œåƒï¼Œä¸ä»…ä»…å¢åŠ äº†æ„å»ºéƒ¨ç½²çš„æ—¶é—´ï¼Œä¹Ÿå¾ˆå®¹æ˜“å‡ºé”™ã€‚ è¿™æ˜¯å¾ˆå¤šåˆå­¦ Docker çš„äººå¸¸çŠ¯çš„ä¸€ä¸ªé”™è¯¯ã€‚</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Union FS æ˜¯æœ‰æœ€å¤§å±‚æ•°é™åˆ¶çš„ï¼Œæ¯”å¦‚ AUFSï¼Œæ›¾ç»æ˜¯æœ€å¤§ä¸å¾—è¶…è¿‡ 42 å±‚ï¼Œç°åœ¨æ˜¯ä¸å¾—è¶…è¿‡ 127 å±‚ã€‚</p> </div> <p>ä¸Šé¢çš„ Dockerfile æ­£ç¡®çš„å†™æ³•åº”è¯¥æ˜¯è¿™æ ·ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-97-1"><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a><span class="k">FROM</span><span class="w"> </span><span class="s">debian:stretch</span>
</span><span id="__span-97-2"><a id="__codelineno-97-2" name="__codelineno-97-2" href="#__codelineno-97-2"></a>
</span><span id="__span-97-3"><a id="__codelineno-97-3" name="__codelineno-97-3" href="#__codelineno-97-3"></a><span class="k">RUN</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>-x<span class="p">;</span><span class="w"> </span><span class="nv">buildDeps</span><span class="o">=</span><span class="s1">'gcc libc6-dev make wget'</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-97-4"><a id="__codelineno-97-4" name="__codelineno-97-4" href="#__codelineno-97-4"></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="se">\</span>
</span><span id="__span-97-5"><a id="__codelineno-97-5" name="__codelineno-97-5" href="#__codelineno-97-5"></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="nv">$buildDeps</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-97-6"><a id="__codelineno-97-6" name="__codelineno-97-6" href="#__codelineno-97-6"></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>wget<span class="w"> </span>-O<span class="w"> </span>redis.tar.gz<span class="w"> </span><span class="s2">"http://download.redis.io/releases/redis-5.0.3.tar.gz"</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-97-7"><a id="__codelineno-97-7" name="__codelineno-97-7" href="#__codelineno-97-7"></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/usr/src/redis<span class="w"> </span><span class="se">\</span>
</span><span id="__span-97-8"><a id="__codelineno-97-8" name="__codelineno-97-8" href="#__codelineno-97-8"></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>tar<span class="w"> </span>-xzf<span class="w"> </span>redis.tar.gz<span class="w"> </span>-C<span class="w"> </span>/usr/src/redis<span class="w"> </span>--strip-components<span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-97-9"><a id="__codelineno-97-9" name="__codelineno-97-9" href="#__codelineno-97-9"></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>-C<span class="w"> </span>/usr/src/redis<span class="w"> </span><span class="se">\</span>
</span><span id="__span-97-10"><a id="__codelineno-97-10" name="__codelineno-97-10" href="#__codelineno-97-10"></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>-C<span class="w"> </span>/usr/src/redis<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
</span><span id="__span-97-11"><a id="__codelineno-97-11" name="__codelineno-97-11" href="#__codelineno-97-11"></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*<span class="w"> </span><span class="se">\</span>
</span><span id="__span-97-12"><a id="__codelineno-97-12" name="__codelineno-97-12" href="#__codelineno-97-12"></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>redis.tar.gz<span class="w"> </span><span class="se">\</span>
</span><span id="__span-97-13"><a id="__codelineno-97-13" name="__codelineno-97-13" href="#__codelineno-97-13"></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-r<span class="w"> </span>/usr/src/redis<span class="w"> </span><span class="se">\</span>
</span><span id="__span-97-14"><a id="__codelineno-97-14" name="__codelineno-97-14" href="#__codelineno-97-14"></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>purge<span class="w"> </span>-y<span class="w"> </span>--auto-remove<span class="w"> </span><span class="nv">$buildDeps</span>
</span></code></pre></div> <p>é¦–å…ˆï¼Œä¹‹å‰æ‰€æœ‰çš„å‘½ä»¤åªæœ‰ä¸€ä¸ªç›®çš„ï¼Œå°±æ˜¯ç¼–è¯‘ã€å®‰è£… Redis å¯æ‰§è¡Œæ–‡ä»¶ã€‚å› æ­¤æ²¡æœ‰å¿…è¦å»ºç«‹å¾ˆå¤šå±‚ï¼Œè¿™åªæ˜¯ä¸€å±‚çš„äº‹æƒ…ã€‚å› æ­¤ï¼Œè¿™é‡Œæ²¡æœ‰ä½¿ç”¨å¾ˆå¤šä¸ª <code>RUN</code> å¯¹åº”ä¸åŒçš„å‘½ä»¤ï¼Œè€Œæ˜¯ä»…ä»…ä½¿ç”¨ä¸€ä¸ª <code>RUN</code> æŒ‡ä»¤ï¼Œå¹¶ä½¿ç”¨ <code>&amp;&amp;</code> å°†å„ä¸ªæ‰€éœ€å‘½ä»¤ä¸²è”èµ·æ¥ã€‚å°†ä¹‹å‰çš„ 7 å±‚ï¼Œç®€åŒ–ä¸ºäº† 1 å±‚ã€‚åœ¨æ’°å†™ Dockerfile çš„æ—¶å€™ï¼Œè¦ç»å¸¸æé†’è‡ªå·±ï¼Œè¿™å¹¶ä¸æ˜¯åœ¨å†™ Shell è„šæœ¬ï¼Œè€Œæ˜¯åœ¨å®šä¹‰æ¯ä¸€å±‚è¯¥å¦‚ä½•æ„å»ºã€‚</p> <p>å¹¶ä¸”ï¼Œè¿™é‡Œä¸ºäº†æ ¼å¼åŒ–è¿˜è¿›è¡Œäº†æ¢è¡Œã€‚Dockerfile æ”¯æŒ Shell ç±»çš„è¡Œå°¾æ·»åŠ  <code>\</code> çš„å‘½ä»¤æ¢è¡Œæ–¹å¼ï¼Œä»¥åŠè¡Œé¦– <code>#</code> è¿›è¡Œæ³¨é‡Šçš„æ ¼å¼ã€‚è‰¯å¥½çš„æ ¼å¼ï¼Œæ¯”å¦‚æ¢è¡Œã€ç¼©è¿›ã€æ³¨é‡Šç­‰ï¼Œä¼šè®©ç»´æŠ¤ã€æ’éšœæ›´ä¸ºå®¹æ˜“ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„ä¹ æƒ¯ã€‚</p> <p>æ­¤å¤–ï¼Œè¿˜å¯ä»¥çœ‹åˆ°è¿™ä¸€ç»„å‘½ä»¤çš„æœ€åæ·»åŠ äº†æ¸…ç†å·¥ä½œçš„å‘½ä»¤ï¼Œåˆ é™¤äº†ä¸ºäº†ç¼–è¯‘æ„å»ºæ‰€éœ€è¦çš„è½¯ä»¶ï¼Œæ¸…ç†äº†æ‰€æœ‰ä¸‹è½½ã€å±•å¼€çš„æ–‡ä»¶ï¼Œå¹¶ä¸”è¿˜æ¸…ç†äº† <code>apt</code> ç¼“å­˜æ–‡ä»¶ã€‚è¿™æ˜¯å¾ˆé‡è¦çš„ä¸€æ­¥ï¼Œæˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼Œé•œåƒæ˜¯å¤šå±‚å­˜å‚¨ï¼Œæ¯ä¸€å±‚çš„ä¸œè¥¿å¹¶ä¸ä¼šåœ¨ä¸‹ä¸€å±‚è¢«åˆ é™¤ï¼Œä¼šä¸€ç›´è·Ÿéšç€é•œåƒã€‚å› æ­¤é•œåƒæ„å»ºæ—¶ï¼Œä¸€å®šè¦ç¡®ä¿æ¯ä¸€å±‚åªæ·»åŠ çœŸæ­£éœ€è¦æ·»åŠ çš„ä¸œè¥¿ï¼Œä»»ä½•æ— å…³çš„ä¸œè¥¿éƒ½åº”è¯¥æ¸…ç†æ‰ã€‚</p> <p>å¾ˆå¤šäººåˆå­¦ Docker åˆ¶ä½œå‡ºäº†å¾ˆè‡ƒè‚¿çš„é•œåƒçš„åŸå› ä¹‹ä¸€ï¼Œå°±æ˜¯å¿˜è®°äº†æ¯ä¸€å±‚æ„å»ºçš„æœ€åä¸€å®šè¦æ¸…ç†æ‰æ— å…³æ–‡ä»¶ã€‚</p> <h4 id="713æ„å»ºé•œåƒ">7.1.3ã€æ„å»ºé•œåƒ<a class="headerlink" href="#713æ„å»ºé•œåƒ" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>åœ¨ Dockerfile æ–‡ä»¶æ‰€åœ¨ç›®å½•æ‰§è¡Œå‘½ä»¤å¼€å§‹æ„å»ºé•œåƒï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-98-1"><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a>$<span class="w"> </span>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>nginx:v3<span class="w"> </span>.
</span><span id="__span-98-2"><a id="__codelineno-98-2" name="__codelineno-98-2" href="#__codelineno-98-2"></a>Sending<span class="w"> </span>build<span class="w"> </span>context<span class="w"> </span>to<span class="w"> </span>Docker<span class="w"> </span>daemon<span class="w"> </span><span class="m">2</span>.048<span class="w"> </span>kB
</span><span id="__span-98-3"><a id="__codelineno-98-3" name="__codelineno-98-3" href="#__codelineno-98-3"></a>Step<span class="w"> </span><span class="m">1</span><span class="w"> </span>:<span class="w"> </span>FROM<span class="w"> </span>nginx
</span><span id="__span-98-4"><a id="__codelineno-98-4" name="__codelineno-98-4" href="#__codelineno-98-4"></a><span class="w"> </span>---&gt;<span class="w"> </span>e43d811ce2f4
</span><span id="__span-98-5"><a id="__codelineno-98-5" name="__codelineno-98-5" href="#__codelineno-98-5"></a>Step<span class="w"> </span><span class="m">2</span><span class="w"> </span>:<span class="w"> </span>RUN<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'&lt;h1&gt;Hello, Docker!&lt;/h1&gt;'</span><span class="w"> </span>&gt;<span class="w"> </span>/usr/share/nginx/html/index.html
</span><span id="__span-98-6"><a id="__codelineno-98-6" name="__codelineno-98-6" href="#__codelineno-98-6"></a><span class="w"> </span>---&gt;<span class="w"> </span>Running<span class="w"> </span><span class="k">in</span><span class="w"> </span>9cdc27646c7b
</span><span id="__span-98-7"><a id="__codelineno-98-7" name="__codelineno-98-7" href="#__codelineno-98-7"></a><span class="w"> </span>---&gt;<span class="w"> </span>44aa4490ce2c
</span><span id="__span-98-8"><a id="__codelineno-98-8" name="__codelineno-98-8" href="#__codelineno-98-8"></a>Removing<span class="w"> </span>intermediate<span class="w"> </span>container<span class="w"> </span>9cdc27646c7b
</span><span id="__span-98-9"><a id="__codelineno-98-9" name="__codelineno-98-9" href="#__codelineno-98-9"></a>Successfully<span class="w"> </span>built<span class="w"> </span>44aa4490ce2c
</span></code></pre></div> <p>ä»å‘½ä»¤çš„è¾“å‡ºç»“æœä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°é•œåƒçš„æ„å»ºè¿‡ç¨‹ã€‚åœ¨ Step 2 ä¸­ï¼Œ<code>RUN</code> æŒ‡ä»¤å¯åŠ¨äº†ä¸€ä¸ªå®¹å™¨ <code>9cdc27646c7b</code>ï¼Œæ‰§è¡Œäº†æ‰€è¦æ±‚çš„å‘½ä»¤ï¼Œå¹¶æœ€åæäº¤äº†è¿™ä¸€å±‚ <code>44aa4490ce2c</code>ï¼Œéšååˆ é™¤äº†æ‰€ç”¨åˆ°çš„è¿™ä¸ªå®¹å™¨ <code>9cdc27646c7b</code>ã€‚</p> <p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº† <code>docker image build</code> å‘½ä»¤ï¼ˆå¸¸ç”¨åˆ«åä¸º <code>docker build</code>ï¼‰è¿›è¡Œé•œåƒæ„å»ºã€‚å…¶æ ¼å¼ä¸ºï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-99-1"><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a>docker<span class="w"> </span>build<span class="w"> </span><span class="o">[</span>é€‰é¡¹<span class="o">]</span><span class="w"> </span>&lt;ä¸Šä¸‹æ–‡è·¯å¾„/URL/-&gt;
</span></code></pre></div> <p>åœ¨è¿™é‡Œæˆ‘ä»¬æŒ‡å®šäº†æœ€ç»ˆé•œåƒçš„åç§° <code>-t nginx:v3</code>ï¼Œæ„å»ºæˆåŠŸåï¼Œæˆ‘ä»¬å¯ä»¥åƒä¹‹å‰è¿è¡Œ <code>nginx:v2</code> é‚£æ ·æ¥è¿è¡Œè¿™ä¸ªé•œåƒï¼Œå…¶ç»“æœä¼šå’Œ <code>nginx:v2</code> ä¸€æ ·ã€‚</p> <h4 id="714é•œåƒæ„å»ºä¸Šä¸‹æ–‡">7.1.4ã€é•œåƒæ„å»ºä¸Šä¸‹æ–‡<a class="headerlink" href="#714é•œåƒæ„å»ºä¸Šä¸‹æ–‡" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>å¦‚æœæ³¨æ„ï¼Œä¼šçœ‹åˆ° <code>docker build</code> å‘½ä»¤æœ€åæœ‰ä¸€ä¸ª <code>.</code>ã€‚<code>.</code> è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œè€Œ Dockerfile å°±åœ¨å½“å‰ç›®å½•ï¼Œå› æ­¤ä¸å°‘åˆå­¦è€…ä»¥ä¸ºè¿™ä¸ªè·¯å¾„æ˜¯åœ¨æŒ‡å®š Dockerfile æ‰€åœ¨è·¯å¾„ï¼Œè¿™ä¹ˆç†è§£å…¶å®æ˜¯ä¸å‡†ç¡®çš„ã€‚å¦‚æœå¯¹åº”ä¸Šé¢çš„å‘½ä»¤æ ¼å¼ï¼Œä½ å¯èƒ½ä¼šå‘ç°ï¼Œè¿™æ˜¯åœ¨æŒ‡å®šä¸Šä¸‹æ–‡è·¯å¾„ã€‚</p> <p>é¦–å…ˆæˆ‘ä»¬è¦ç†è§£ <code>docker build</code> çš„å·¥ä½œåŸç†ã€‚Docker åœ¨è¿è¡Œæ—¶åˆ†ä¸º Docker å¼•æ“ï¼ˆä¹Ÿå°±æ˜¯æœåŠ¡ç«¯å®ˆæŠ¤è¿›ç¨‹ï¼‰å’Œå®¢æˆ·ç«¯å·¥å…·ã€‚Docker çš„å¼•æ“æä¾›äº†ä¸€ç»„ REST APIï¼Œè¢«ç§°ä¸º <a href="https://docs.docker.com/develop/sdk/">Docker Remote API</a>ï¼Œè€Œå¦‚ <code>docker</code> å‘½ä»¤è¿™æ ·çš„å®¢æˆ·ç«¯å·¥å…·ï¼Œåˆ™æ˜¯é€šè¿‡è¿™ç»„ API ä¸ Docker å¼•æ“äº¤äº’ï¼Œä»è€Œå®Œæˆå„ç§åŠŸèƒ½ã€‚å› æ­¤ï¼Œè™½ç„¶è¡¨é¢ä¸Šæˆ‘ä»¬å¥½åƒæ˜¯åœ¨æœ¬æœºæ‰§è¡Œå„ç§ <code>docker</code> åŠŸèƒ½ï¼Œä½†å®é™…ä¸Šï¼Œä¸€åˆ‡éƒ½æ˜¯ä½¿ç”¨çš„è¿œç¨‹è°ƒç”¨å½¢å¼åœ¨æœåŠ¡ç«¯ï¼ˆDocker å¼•æ“ï¼‰å®Œæˆã€‚ä¹Ÿå› ä¸ºè¿™ç§ C/S è®¾è®¡ï¼Œè®©æˆ‘ä»¬æ“ä½œè¿œç¨‹æœåŠ¡å™¨çš„ Docker å¼•æ“å˜å¾—è½»è€Œæ˜“ä¸¾ã€‚</p> <p>å½“æˆ‘ä»¬è¿›è¡Œé•œåƒæ„å»ºçš„æ—¶å€™ï¼Œå¹¶éæ‰€æœ‰å®šåˆ¶éƒ½ä¼šé€šè¿‡ <code>RUN</code> æŒ‡ä»¤å®Œæˆï¼Œç»å¸¸ä¼šéœ€è¦å°†ä¸€äº›æœ¬åœ°æ–‡ä»¶å¤åˆ¶è¿›é•œåƒï¼Œæ¯”å¦‚é€šè¿‡ <code>COPY</code> æŒ‡ä»¤ã€<code>ADD</code> æŒ‡ä»¤ç­‰ã€‚è€Œ <code>docker build</code> å‘½ä»¤æ„å»ºé•œåƒï¼Œå…¶å®å¹¶éåœ¨æœ¬åœ°æ„å»ºï¼Œè€Œæ˜¯åœ¨æœåŠ¡ç«¯ï¼Œä¹Ÿå°±æ˜¯ Docker å¼•æ“ä¸­æ„å»ºçš„ã€‚é‚£ä¹ˆåœ¨è¿™ç§å®¢æˆ·ç«¯/æœåŠ¡ç«¯çš„æ¶æ„ä¸­ï¼Œå¦‚ä½•æ‰èƒ½è®©æœåŠ¡ç«¯è·å¾—æœ¬åœ°æ–‡ä»¶å‘¢ï¼Ÿ</p> <p>è¿™å°±å¼•å…¥äº†ä¸Šä¸‹æ–‡çš„æ¦‚å¿µã€‚å½“æ„å»ºçš„æ—¶å€™ï¼Œç”¨æˆ·ä¼šæŒ‡å®šæ„å»ºé•œåƒä¸Šä¸‹æ–‡çš„è·¯å¾„ï¼Œ<code>docker build</code> å‘½ä»¤å¾—çŸ¥è¿™ä¸ªè·¯å¾„åï¼Œä¼šå°†è·¯å¾„ä¸‹çš„æ‰€æœ‰å†…å®¹æ‰“åŒ…ï¼Œç„¶åä¸Šä¼ ç»™ Docker å¼•æ“ã€‚è¿™æ · Docker å¼•æ“æ”¶åˆ°è¿™ä¸ªä¸Šä¸‹æ–‡åŒ…åï¼Œå±•å¼€å°±ä¼šè·å¾—æ„å»ºé•œåƒæ‰€éœ€çš„ä¸€åˆ‡æ–‡ä»¶ã€‚</p> <p>å¦‚æœåœ¨ Dockerfile ä¸­è¿™ä¹ˆå†™ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-100-1"><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a>COPY<span class="w"> </span>./package.json<span class="w"> </span>/app/
</span></code></pre></div> <p>è¿™å¹¶ä¸æ˜¯è¦å¤åˆ¶æ‰§è¡Œ <code>docker build</code> å‘½ä»¤æ‰€åœ¨çš„ç›®å½•ä¸‹çš„ <code>package.json</code>ï¼Œä¹Ÿä¸æ˜¯å¤åˆ¶ Dockerfile æ‰€åœ¨ç›®å½•ä¸‹çš„ <code>package.json</code>ï¼Œè€Œæ˜¯å¤åˆ¶ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰ ç›®å½•ä¸‹çš„ <code>package.json</code>ã€‚</p> <p>å› æ­¤ï¼Œ<code>COPY</code> è¿™ç±»æŒ‡ä»¤ä¸­çš„æºæ–‡ä»¶çš„è·¯å¾„éƒ½æ˜¯ç›¸å¯¹è·¯å¾„ã€‚è¿™ä¹Ÿæ˜¯åˆå­¦è€…ç»å¸¸ä¼šé—®çš„ä¸ºä»€ä¹ˆ <code>COPY ../package.json /app</code> æˆ–è€… <code>COPY /opt/xxxx /app</code> æ— æ³•å·¥ä½œçš„åŸå› ï¼Œå› ä¸ºè¿™äº›è·¯å¾„å·²ç»è¶…å‡ºäº†ä¸Šä¸‹æ–‡çš„èŒƒå›´ï¼ŒDocker å¼•æ“æ— æ³•è·å¾—è¿™äº›ä½ç½®çš„æ–‡ä»¶ã€‚å¦‚æœçœŸçš„éœ€è¦é‚£äº›æ–‡ä»¶ï¼Œåº”è¯¥å°†å®ƒä»¬å¤åˆ¶åˆ°ä¸Šä¸‹æ–‡ç›®å½•ä¸­å»ã€‚</p> <p>ç°åœ¨å°±å¯ä»¥ç†è§£åˆšæ‰çš„å‘½ä»¤ <code>docker build -t nginx:v3 .</code> ä¸­çš„è¿™ä¸ª <code>.</code>ï¼Œå®é™…ä¸Šæ˜¯åœ¨æŒ‡å®šä¸Šä¸‹æ–‡çš„ç›®å½•ï¼Œ<code>docker build</code> å‘½ä»¤ä¼šå°†è¯¥ç›®å½•ä¸‹çš„å†…å®¹æ‰“åŒ…äº¤ç»™ Docker å¼•æ“ä»¥å¸®åŠ©æ„å»ºé•œåƒã€‚</p> <p>å¦‚æœè§‚å¯Ÿ <code>docker build</code> è¾“å‡ºï¼Œæˆ‘ä»¬å…¶å®å·²ç»çœ‹åˆ°äº†è¿™ä¸ªå‘é€ä¸Šä¸‹æ–‡çš„è¿‡ç¨‹ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-101-1"><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a>$<span class="w"> </span>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>nginx:v3<span class="w"> </span>.
</span><span id="__span-101-2"><a id="__codelineno-101-2" name="__codelineno-101-2" href="#__codelineno-101-2"></a>Sending<span class="w"> </span>build<span class="w"> </span>context<span class="w"> </span>to<span class="w"> </span>Docker<span class="w"> </span>daemon<span class="w"> </span><span class="m">2</span>.048<span class="w"> </span>kB
</span><span id="__span-101-3"><a id="__codelineno-101-3" name="__codelineno-101-3" href="#__codelineno-101-3"></a>...
</span></code></pre></div> <p>ç†è§£æ„å»ºä¸Šä¸‹æ–‡å¯¹äºé•œåƒæ„å»ºæ˜¯å¾ˆé‡è¦çš„ï¼Œé¿å…çŠ¯ä¸€äº›ä¸åº”è¯¥çš„é”™è¯¯ã€‚æ¯”å¦‚æœ‰äº›åˆå­¦è€…åœ¨å‘ç° <code>COPY /opt/xxxx /app</code> ä¸å·¥ä½œåï¼Œäºæ˜¯å¹²è„†å°† Dockerfile æ”¾åˆ°äº†ç¡¬ç›˜æ ¹ç›®å½•å»æ„å»ºï¼Œç»“æœå‘ç° <code>docker build</code> æ‰§è¡Œåï¼Œåœ¨å‘é€ä¸€ä¸ªå‡ å GB çš„ä¸œè¥¿ï¼Œæä¸ºç¼“æ…¢è€Œä¸”å¾ˆå®¹æ˜“æ„å»ºå¤±è´¥ã€‚é‚£æ˜¯å› ä¸ºè¿™ç§åšæ³•æ˜¯åœ¨è®© <code>docker build</code> æ‰“åŒ…æ•´ä¸ªç¡¬ç›˜ï¼Œè¿™æ˜¾ç„¶æ˜¯ä½¿ç”¨é”™è¯¯ã€‚</p> <p>ä¸€èˆ¬æ¥è¯´ï¼Œåº”è¯¥ä¼šå°† Dockerfile ç½®äºä¸€ä¸ªç©ºç›®å½•ä¸‹ï¼Œæˆ–è€…é¡¹ç›®æ ¹ç›®å½•ä¸‹ã€‚å¦‚æœè¯¥ç›®å½•ä¸‹æ²¡æœ‰æ‰€éœ€æ–‡ä»¶ï¼Œé‚£ä¹ˆåº”è¯¥æŠŠæ‰€éœ€æ–‡ä»¶å¤åˆ¶ä¸€ä»½è¿‡æ¥ã€‚å¦‚æœç›®å½•ä¸‹æœ‰äº›ä¸œè¥¿ç¡®å®ä¸å¸Œæœ›æ„å»ºæ—¶ä¼ ç»™ Docker å¼•æ“ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ <code>.gitignore</code> ä¸€æ ·çš„è¯­æ³•å†™ä¸€ä¸ª <code>.dockerignore</code>ï¼Œè¯¥æ–‡ä»¶æ˜¯ç”¨äºå‰”é™¤ä¸éœ€è¦ä½œä¸ºä¸Šä¸‹æ–‡ä¼ é€’ç»™ Docker å¼•æ“çš„ã€‚</p> <p>é‚£ä¹ˆä¸ºä»€ä¹ˆä¼šæœ‰äººè¯¯ä»¥ä¸º <code>.</code> æ˜¯æŒ‡å®š Dockerfile æ‰€åœ¨ç›®å½•å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸é¢å¤–æŒ‡å®š Dockerfile çš„è¯ï¼Œä¼šå°†ä¸Šä¸‹æ–‡ç›®å½•ä¸‹çš„åä¸º <code>Dockerfile</code> çš„æ–‡ä»¶ä½œä¸º Dockerfileã€‚</p> <p>è¿™åªæ˜¯é»˜è®¤è¡Œä¸ºï¼Œå®é™…ä¸Š Dockerfile çš„æ–‡ä»¶åå¹¶ä¸è¦æ±‚å¿…é¡»ä¸º <code>Dockerfile</code>ï¼Œè€Œä¸”å¹¶ä¸è¦æ±‚å¿…é¡»ä½äºä¸Šä¸‹æ–‡ç›®å½•ä¸­ï¼Œæ¯”å¦‚å¯ä»¥ç”¨ <code>-f ../Dockerfile.php</code> å‚æ•°æŒ‡å®šæŸä¸ªæ–‡ä»¶ä½œä¸º Dockerfileã€‚</p> <p>å½“ç„¶ï¼Œä¸€èˆ¬å¤§å®¶ä¹ æƒ¯æ€§çš„ä¼šä½¿ç”¨é»˜è®¤çš„æ–‡ä»¶å <code>Dockerfile</code>ï¼Œä»¥åŠä¼šå°†å…¶ç½®äºé•œåƒæ„å»ºä¸Šä¸‹æ–‡ç›®å½•ä¸­ã€‚</p> <h4 id="715build-çš„å…¶å®ƒç”¨æ³•">7.1.5ã€build çš„å…¶å®ƒç”¨æ³•<a class="headerlink" href="#715build-çš„å…¶å®ƒç”¨æ³•" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><strong>ç›´æ¥ç”¨ Git repo è¿›è¡Œæ„å»º</strong></p> <p><code>docker build</code> è¿˜æ”¯æŒä» URL æ„å»ºï¼Œæ¯”å¦‚å¯ä»¥ç›´æ¥ä» Git repo ä¸­æ„å»ºï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-102-1"><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a><span class="c1">## $env:DOCKER_BUILDKIT=0</span>
</span><span id="__span-102-2"><a id="__codelineno-102-2" name="__codelineno-102-2" href="#__codelineno-102-2"></a><span class="c1">## export DOCKER_BUILDKIT=0</span>
</span><span id="__span-102-3"><a id="__codelineno-102-3" name="__codelineno-102-3" href="#__codelineno-102-3"></a>
</span><span id="__span-102-4"><a id="__codelineno-102-4" name="__codelineno-102-4" href="#__codelineno-102-4"></a>$<span class="w"> </span>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>hello-world<span class="w"> </span>https://github.com/docker-library/hello-world.git#master:amd64/hello-world
</span><span id="__span-102-5"><a id="__codelineno-102-5" name="__codelineno-102-5" href="#__codelineno-102-5"></a>
</span><span id="__span-102-6"><a id="__codelineno-102-6" name="__codelineno-102-6" href="#__codelineno-102-6"></a>Step<span class="w"> </span><span class="m">1</span>/3<span class="w"> </span>:<span class="w"> </span>FROM<span class="w"> </span>scratch
</span><span id="__span-102-7"><a id="__codelineno-102-7" name="__codelineno-102-7" href="#__codelineno-102-7"></a><span class="w"> </span>---&gt;
</span><span id="__span-102-8"><a id="__codelineno-102-8" name="__codelineno-102-8" href="#__codelineno-102-8"></a>Step<span class="w"> </span><span class="m">2</span>/3<span class="w"> </span>:<span class="w"> </span>COPY<span class="w"> </span>hello<span class="w"> </span>/
</span><span id="__span-102-9"><a id="__codelineno-102-9" name="__codelineno-102-9" href="#__codelineno-102-9"></a><span class="w"> </span>---&gt;<span class="w"> </span>ac779757d46e
</span><span id="__span-102-10"><a id="__codelineno-102-10" name="__codelineno-102-10" href="#__codelineno-102-10"></a>Step<span class="w"> </span><span class="m">3</span>/3<span class="w"> </span>:<span class="w"> </span>CMD<span class="w"> </span><span class="o">[</span><span class="s2">"/hello"</span><span class="o">]</span>
</span><span id="__span-102-11"><a id="__codelineno-102-11" name="__codelineno-102-11" href="#__codelineno-102-11"></a><span class="w"> </span>---&gt;<span class="w"> </span>Running<span class="w"> </span><span class="k">in</span><span class="w"> </span>d2a513a760ed
</span><span id="__span-102-12"><a id="__codelineno-102-12" name="__codelineno-102-12" href="#__codelineno-102-12"></a>Removing<span class="w"> </span>intermediate<span class="w"> </span>container<span class="w"> </span>d2a513a760ed
</span><span id="__span-102-13"><a id="__codelineno-102-13" name="__codelineno-102-13" href="#__codelineno-102-13"></a><span class="w"> </span>---&gt;<span class="w"> </span>038ad4142d2b
</span><span id="__span-102-14"><a id="__codelineno-102-14" name="__codelineno-102-14" href="#__codelineno-102-14"></a>Successfully<span class="w"> </span>built<span class="w"> </span>038ad4142d2b
</span></code></pre></div> <p>è¿™è¡Œå‘½ä»¤æŒ‡å®šäº†æ„å»ºæ‰€éœ€çš„ Git repoï¼Œå¹¶ä¸”æŒ‡å®šåˆ†æ”¯ä¸º <code>master</code>ï¼Œæ„å»ºç›®å½•ä¸º <code>/amd64/hello-world/</code>ï¼Œç„¶å Docker å°±ä¼šè‡ªå·±å» <code>git clone</code> è¿™ä¸ªé¡¹ç›®ã€åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯ã€å¹¶è¿›å…¥åˆ°æŒ‡å®šç›®å½•åå¼€å§‹æ„å»ºã€‚</p> <p><strong>ç”¨ç»™å®šçš„ tar å‹ç¼©åŒ…æ„å»º</strong></p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-103-1"><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a>docker<span class="w"> </span>build<span class="w"> </span>http://server/context.tar.gz
</span></code></pre></div> <p>å¦‚æœæ‰€ç»™å‡ºçš„ URL ä¸æ˜¯ä¸ª Git repoï¼Œè€Œæ˜¯ä¸ª <code>tar</code> å‹ç¼©åŒ…ï¼Œé‚£ä¹ˆ Docker å¼•æ“ä¼šä¸‹è½½è¿™ä¸ªåŒ…ï¼Œå¹¶è‡ªåŠ¨è§£å‹ç¼©ï¼Œä»¥å…¶ä½œä¸ºä¸Šä¸‹æ–‡ï¼Œå¼€å§‹æ„å»ºã€‚</p> <p><strong>ä»æ ‡å‡†è¾“å…¥ä¸­è¯»å– Dockerfile è¿›è¡Œæ„å»º</strong></p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-104-1"><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a>docker<span class="w"> </span>build<span class="w"> </span>-<span class="w"> </span>&lt;<span class="w"> </span>Dockerfile
</span></code></pre></div> <p>æˆ–</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-105-1"><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a>cat<span class="w"> </span>Dockerfile<span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>build<span class="w"> </span>-
</span></code></pre></div> <p>å¦‚æœæ ‡å‡†è¾“å…¥ä¼ å…¥çš„æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œåˆ™å°†å…¶è§†ä¸º Dockerfileï¼Œå¹¶å¼€å§‹æ„å»ºã€‚è¿™ç§å½¢å¼ç”±äºç›´æ¥ä»æ ‡å‡†è¾“å…¥ä¸­è¯»å– Dockerfile çš„å†…å®¹ï¼Œå®ƒæ²¡æœ‰ä¸Šä¸‹æ–‡ï¼Œå› æ­¤ä¸å¯ä»¥åƒå…¶ä»–æ–¹æ³•é‚£æ ·å¯ä»¥å°†æœ¬åœ°æ–‡ä»¶ <code>COPY</code> è¿›é•œåƒä¹‹ç±»çš„äº‹æƒ…ã€‚</p> <p><strong>ä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–ä¸Šä¸‹æ–‡å‹ç¼©åŒ…è¿›è¡Œæ„å»º</strong></p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-106-1"><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a>docker<span class="w"> </span>build<span class="w"> </span>-<span class="w"> </span>&lt;<span class="w"> </span>context.tar.gz
</span></code></pre></div> <p>å¦‚æœå‘ç°æ ‡å‡†è¾“å…¥çš„æ–‡ä»¶æ ¼å¼æ˜¯ <code>gzip</code>ã€<code>bzip2</code> ä»¥åŠ <code>xz</code> çš„è¯ï¼Œå°†ä¼šä½¿å…¶ä¸ºä¸Šä¸‹æ–‡å‹ç¼©åŒ…ï¼Œç›´æ¥å°†å…¶å±•å¼€ï¼Œå°†é‡Œé¢è§†ä¸ºä¸Šä¸‹æ–‡ï¼Œå¹¶å¼€å§‹æ„å»ºã€‚</p> <h3 id="72dockerfile-æŒ‡ä»¤è¯¦è§£">7.2ã€Dockerfile æŒ‡ä»¤è¯¦è§£<a class="headerlink" href="#72dockerfile-æŒ‡ä»¤è¯¦è§£" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>å…¶å® Dockerfile åŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œé™¤äº† <code>FROM</code> å’Œ <code>RUN</code>,å®ƒæä¾›äº†åå¤šä¸ªæŒ‡ä»¤ã€‚</p> <h4 id="721copy">7.2.1ã€COPY<a class="headerlink" href="#721copy" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><code>COPY</code> æŒ‡ä»¤å°†ä»æ„å»ºä¸Šä¸‹æ–‡ç›®å½•ä¸­ <code>&lt;æºè·¯å¾„&gt;</code> çš„æ–‡ä»¶/ç›®å½•å¤åˆ¶åˆ°æ–°çš„ä¸€å±‚çš„é•œåƒå†…çš„ <code>&lt;ç›®æ ‡è·¯å¾„&gt;</code> ä½ç½®ã€‚</p> <p>æ ¼å¼æœ‰ä¸¤ç§ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-107-1"><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a><span class="k">COPY</span><span class="w"> </span><span class="o">[</span>--chown<span class="o">=</span>&lt;user&gt;:&lt;group&gt;<span class="o">]</span><span class="w"> </span>&lt;æºè·¯å¾„&gt;...<span class="w"> </span>&lt;ç›®æ ‡è·¯å¾„&gt;
</span><span id="__span-107-2"><a id="__codelineno-107-2" name="__codelineno-107-2" href="#__codelineno-107-2"></a><span class="k">COPY</span><span class="w"> </span><span class="o">[</span>--chown<span class="o">=</span>&lt;user&gt;:&lt;group&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="s2">"&lt;æºè·¯å¾„1&gt;"</span>,...<span class="w"> </span><span class="s2">"&lt;ç›®æ ‡è·¯å¾„&gt;"</span><span class="o">]</span>
</span></code></pre></div> <p>å’Œ <code>RUN</code> æŒ‡ä»¤ä¸€æ ·ï¼Œ<code>COPY</code> ä¹Ÿæœ‰ä¸¤ç§æ ¼å¼ï¼Œä¸€ç§ç±»ä¼¼äºå‘½ä»¤è¡Œï¼Œä¸€ç§ç±»ä¼¼äºå‡½æ•°è°ƒç”¨ã€‚</p> <p>ä¸‹é¢æ˜¯ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-108-1"><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a><span class="k">COPY</span><span class="w"> </span>package.json<span class="w"> </span>/usr/src/app/
</span></code></pre></div> <p><code>&lt;æºè·¯å¾„&gt;</code> å¯ä»¥æ˜¯å¤šä¸ªï¼Œç”šè‡³å¯ä»¥æ˜¯é€šé…ç¬¦ï¼Œå…¶é€šé…ç¬¦è§„åˆ™è¦æ»¡è¶³ Go çš„ <a href="https://golang.org/pkg/path/filepath/#Match"><code>filepath.Match</code></a> è§„åˆ™ï¼Œå¦‚ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-109-1"><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a><span class="k">COPY</span><span class="w"> </span>hom*<span class="w"> </span>/mydir/
</span><span id="__span-109-2"><a id="__codelineno-109-2" name="__codelineno-109-2" href="#__codelineno-109-2"></a><span class="k">COPY</span><span class="w"> </span>hom?.txt<span class="w"> </span>/mydir/
</span></code></pre></div> <p><code>&lt;ç›®æ ‡è·¯å¾„&gt;</code> å¯ä»¥æ˜¯å®¹å™¨å†…çš„ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹äºå·¥ä½œç›®å½•çš„ç›¸å¯¹è·¯å¾„ï¼ˆå·¥ä½œç›®å½•å¯ä»¥ç”¨ <code>WORKDIR</code> æŒ‡ä»¤æ¥æŒ‡å®šï¼‰ã€‚ç›®æ ‡è·¯å¾„ä¸éœ€è¦äº‹å…ˆåˆ›å»ºï¼Œå¦‚æœç›®å½•ä¸å­˜åœ¨ä¼šåœ¨å¤åˆ¶æ–‡ä»¶å‰å…ˆè¡Œåˆ›å»ºç¼ºå¤±ç›®å½•ã€‚</p> <p>æ­¤å¤–ï¼Œä½¿ç”¨ <code>COPY</code> æŒ‡ä»¤ï¼Œæºæ–‡ä»¶çš„å„ç§å…ƒæ•°æ®éƒ½ä¼šä¿ç•™ã€‚æ¯”å¦‚è¯»ã€å†™ã€æ‰§è¡Œæƒé™ã€æ–‡ä»¶å˜æ›´æ—¶é—´ç­‰ã€‚è¿™ä¸ªç‰¹æ€§å¯¹äºé•œåƒå®šåˆ¶å¾ˆæœ‰ç”¨ã€‚ç‰¹åˆ«æ˜¯æ„å»ºç›¸å…³æ–‡ä»¶éƒ½åœ¨ä½¿ç”¨ Git è¿›è¡Œç®¡ç†çš„æ—¶å€™ã€‚</p> <p>åœ¨ä½¿ç”¨è¯¥æŒ‡ä»¤çš„æ—¶å€™è¿˜å¯ä»¥åŠ ä¸Š <code>--chown=&lt;user&gt;:&lt;group&gt;</code> é€‰é¡¹æ¥æ”¹å˜æ–‡ä»¶çš„æ‰€å±ç”¨æˆ·åŠæ‰€å±ç»„ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-110-1"><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a><span class="k">COPY</span><span class="w"> </span>--chown<span class="o">=</span><span class="m">55</span>:mygroup<span class="w"> </span>files*<span class="w"> </span>/mydir/
</span><span id="__span-110-2"><a id="__codelineno-110-2" name="__codelineno-110-2" href="#__codelineno-110-2"></a><span class="k">COPY</span><span class="w"> </span>--chown<span class="o">=</span>bin<span class="w"> </span>files*<span class="w"> </span>/mydir/
</span><span id="__span-110-3"><a id="__codelineno-110-3" name="__codelineno-110-3" href="#__codelineno-110-3"></a><span class="k">COPY</span><span class="w"> </span>--chown<span class="o">=</span><span class="m">1</span><span class="w"> </span>files*<span class="w"> </span>/mydir/
</span><span id="__span-110-4"><a id="__codelineno-110-4" name="__codelineno-110-4" href="#__codelineno-110-4"></a><span class="k">COPY</span><span class="w"> </span>--chown<span class="o">=</span><span class="m">10</span>:11<span class="w"> </span>files*<span class="w"> </span>/mydir/
</span></code></pre></div> <p>å¦‚æœæºè·¯å¾„ä¸ºæ–‡ä»¶å¤¹ï¼Œå¤åˆ¶çš„æ—¶å€™ä¸æ˜¯ç›´æ¥å¤åˆ¶è¯¥æ–‡ä»¶å¤¹ï¼Œè€Œæ˜¯å°†æ–‡ä»¶å¤¹ä¸­çš„å†…å®¹å¤åˆ¶åˆ°ç›®æ ‡è·¯å¾„ã€‚</p> <h4 id="722add">7.2.2ã€ADD<a class="headerlink" href="#722add" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><code>ADD</code> æŒ‡ä»¤å’Œ <code>COPY</code> çš„æ ¼å¼å’Œæ€§è´¨åŸºæœ¬ä¸€è‡´ã€‚ä½†æ˜¯åœ¨ <code>COPY</code> åŸºç¡€ä¸Šå¢åŠ äº†ä¸€äº›åŠŸèƒ½ã€‚</p> <p>æ¯”å¦‚ <code>&lt;æºè·¯å¾„&gt;</code> å¯ä»¥æ˜¯ä¸€ä¸ª <code>URL</code>ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒDocker å¼•æ“ä¼šè¯•å›¾å»ä¸‹è½½è¿™ä¸ªé“¾æ¥çš„æ–‡ä»¶æ”¾åˆ° <code>&lt;ç›®æ ‡è·¯å¾„&gt;</code> å»ã€‚ä¸‹è½½åçš„æ–‡ä»¶æƒé™è‡ªåŠ¨è®¾ç½®ä¸º <code>600</code>ï¼Œå¦‚æœè¿™å¹¶ä¸æ˜¯æƒ³è¦çš„æƒé™ï¼Œé‚£ä¹ˆè¿˜éœ€è¦å¢åŠ é¢å¤–çš„ä¸€å±‚ <code>RUN</code> è¿›è¡Œæƒé™è°ƒæ•´ï¼Œå¦å¤–ï¼Œå¦‚æœä¸‹è½½çš„æ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œéœ€è¦è§£å‹ç¼©ï¼Œä¹Ÿä¸€æ ·è¿˜éœ€è¦é¢å¤–çš„ä¸€å±‚ <code>RUN</code> æŒ‡ä»¤è¿›è¡Œè§£å‹ç¼©ã€‚æ‰€ä»¥ä¸å¦‚ç›´æ¥ä½¿ç”¨ <code>RUN</code> æŒ‡ä»¤ï¼Œç„¶åä½¿ç”¨ <code>wget</code> æˆ–è€… <code>curl</code> å·¥å…·ä¸‹è½½ï¼Œå¤„ç†æƒé™ã€è§£å‹ç¼©ã€ç„¶åæ¸…ç†æ— ç”¨æ–‡ä»¶æ›´åˆç†ã€‚å› æ­¤ï¼Œè¿™ä¸ªåŠŸèƒ½å…¶å®å¹¶ä¸å®ç”¨ï¼Œè€Œä¸”ä¸æ¨èä½¿ç”¨ã€‚</p> <p>å¦‚æœ <code>&lt;æºè·¯å¾„&gt;</code> ä¸ºä¸€ä¸ª <code>tar</code> å‹ç¼©æ–‡ä»¶çš„è¯ï¼Œå‹ç¼©æ ¼å¼ä¸º <code>gzip</code>ã€<code>bzip2</code> ä»¥åŠ <code>xz</code> çš„æƒ…å†µä¸‹ï¼Œ<code>ADD</code> æŒ‡ä»¤å°†ä¼šè‡ªåŠ¨è§£å‹ç¼©è¿™ä¸ªå‹ç¼©æ–‡ä»¶åˆ° <code>&lt;ç›®æ ‡è·¯å¾„&gt;</code> å»ã€‚</p> <p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™ä¸ªè‡ªåŠ¨è§£å‹ç¼©çš„åŠŸèƒ½éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚å®˜æ–¹é•œåƒ <code>ubuntu</code> ä¸­ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-111-1"><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a><span class="k">FROM</span><span class="w"> </span><span class="s">scratch</span>
</span><span id="__span-111-2"><a id="__codelineno-111-2" name="__codelineno-111-2" href="#__codelineno-111-2"></a><span class="k">ADD</span><span class="w"> </span>ubuntu-xenial-core-cloudimg-amd64-root.tar.gz<span class="w"> </span>/
</span><span id="__span-111-3"><a id="__codelineno-111-3" name="__codelineno-111-3" href="#__codelineno-111-3"></a>...
</span></code></pre></div> <p>ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬çœŸçš„æ˜¯å¸Œæœ›å¤åˆ¶ä¸ªå‹ç¼©æ–‡ä»¶è¿›å»ï¼Œè€Œä¸è§£å‹ç¼©ï¼Œè¿™æ—¶å°±ä¸å¯ä»¥ä½¿ç”¨ <code>ADD</code> å‘½ä»¤äº†ã€‚</p> <p>åœ¨ Docker å®˜æ–¹çš„ <a href="https://yeasy.gitbook.io/docker_practice/appendix/best_practices">Dockerfile æœ€ä½³å®è·µæ–‡æ¡£</a> ä¸­è¦æ±‚ï¼Œå°½å¯èƒ½çš„ä½¿ç”¨ <code>COPY</code>ï¼Œå› ä¸º <code>COPY</code> çš„è¯­ä¹‰å¾ˆæ˜ç¡®ï¼Œå°±æ˜¯å¤åˆ¶æ–‡ä»¶è€Œå·²ï¼Œè€Œ <code>ADD</code> åˆ™åŒ…å«äº†æ›´å¤æ‚çš„åŠŸèƒ½ï¼Œå…¶è¡Œä¸ºä¹Ÿä¸ä¸€å®šå¾ˆæ¸…æ™°ã€‚æœ€é€‚åˆä½¿ç”¨ <code>ADD</code> çš„åœºåˆï¼Œå°±æ˜¯æ‰€æåŠçš„éœ€è¦è‡ªåŠ¨è§£å‹ç¼©çš„åœºåˆã€‚</p> <p>å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>ADD</code> æŒ‡ä»¤ä¼šä»¤é•œåƒæ„å»ºç¼“å­˜å¤±æ•ˆï¼Œä»è€Œå¯èƒ½ä¼šä»¤é•œåƒæ„å»ºå˜å¾—æ¯”è¾ƒç¼“æ…¢ã€‚</p> <p>å› æ­¤åœ¨ <code>COPY</code> å’Œ <code>ADD</code> æŒ‡ä»¤ä¸­é€‰æ‹©çš„æ—¶å€™ï¼Œå¯ä»¥éµå¾ªè¿™æ ·çš„åŸåˆ™ï¼Œæ‰€æœ‰çš„æ–‡ä»¶å¤åˆ¶å‡ä½¿ç”¨ <code>COPY</code> æŒ‡ä»¤ï¼Œä»…åœ¨éœ€è¦è‡ªåŠ¨è§£å‹ç¼©çš„åœºåˆä½¿ç”¨ <code>ADD</code>ã€‚</p> <p>åœ¨ä½¿ç”¨è¯¥æŒ‡ä»¤çš„æ—¶å€™è¿˜å¯ä»¥åŠ ä¸Š <code>--chown=&lt;user&gt;:&lt;group&gt;</code> é€‰é¡¹æ¥æ”¹å˜æ–‡ä»¶çš„æ‰€å±ç”¨æˆ·åŠæ‰€å±ç»„ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-112-1"><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a><span class="k">ADD</span><span class="w"> </span>--chown<span class="o">=</span><span class="m">55</span>:mygroup<span class="w"> </span>files*<span class="w"> </span>/mydir/
</span><span id="__span-112-2"><a id="__codelineno-112-2" name="__codelineno-112-2" href="#__codelineno-112-2"></a><span class="k">ADD</span><span class="w"> </span>--chown<span class="o">=</span>bin<span class="w"> </span>files*<span class="w"> </span>/mydir/
</span><span id="__span-112-3"><a id="__codelineno-112-3" name="__codelineno-112-3" href="#__codelineno-112-3"></a><span class="k">ADD</span><span class="w"> </span>--chown<span class="o">=</span><span class="m">1</span><span class="w"> </span>files*<span class="w"> </span>/mydir/
</span><span id="__span-112-4"><a id="__codelineno-112-4" name="__codelineno-112-4" href="#__codelineno-112-4"></a><span class="k">ADD</span><span class="w"> </span>--chown<span class="o">=</span><span class="m">10</span>:11<span class="w"> </span>files*<span class="w"> </span>/mydir/
</span></code></pre></div> <h4 id="723cmd">7.2.3ã€CMD<a class="headerlink" href="#723cmd" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>Docker ä¸æ˜¯è™šæ‹Ÿæœºï¼Œå®¹å™¨å°±æ˜¯è¿›ç¨‹ã€‚æ—¢ç„¶æ˜¯è¿›ç¨‹ï¼Œé‚£ä¹ˆåœ¨å¯åŠ¨å®¹å™¨çš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å®šæ‰€è¿è¡Œçš„ç¨‹åºåŠå‚æ•°ã€‚<code>CMD</code> æŒ‡ä»¤å°±æ˜¯ç”¨äºæŒ‡å®šé»˜è®¤çš„å®¹å™¨ä¸»è¿›ç¨‹çš„å¯åŠ¨å‘½ä»¤ã€‚</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p><code>CMD</code> è®¾ç½®çš„é»˜è®¤å‘½ä»¤å¯ä»¥åœ¨å®¹å™¨è¿è¡Œæ—¶æŒ‡å®šæ–°çš„å‘½ä»¤æ¥æ›¿ä»£ï¼Œæ¯”å¦‚ <code>ubuntu</code> é•œåƒé»˜è®¤çš„ <code>CMD</code> æ˜¯ <code>/bin/bash</code>ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ <code>docker run -it ubuntu</code> çš„è¯ï¼Œä¼šç›´æ¥è¿›å…¥ <code>bash</code>ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶æŒ‡å®šè¿è¡Œåˆ«çš„å‘½ä»¤ï¼Œå¦‚ <code>docker run -it ubuntu cat /etc/os-release</code>ã€‚è¿™å°±æ˜¯ç”¨ <code>cat /etc/os-release</code> å‘½ä»¤æ›¿æ¢äº†é»˜è®¤çš„ <code>/bin/bash</code> å‘½ä»¤äº†ï¼Œè¾“å‡ºäº†ç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯ã€‚</p> </div> <p><code>CMD</code> æŒ‡ä»¤çš„æ ¼å¼å’Œ <code>RUN</code> ç›¸ä¼¼ï¼Œä¹Ÿæ˜¯ä¸¤ç§æ ¼å¼ï¼š</p> <ul> <li> <p>shell æ ¼å¼ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-113-1"><a id="__codelineno-113-1" name="__codelineno-113-1" href="#__codelineno-113-1"></a><span class="k">CMD</span><span class="w"> </span>&lt;å‘½ä»¤&gt;
</span></code></pre></div> </li> <li> <p>exec æ ¼å¼ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-114-1"><a id="__codelineno-114-1" name="__codelineno-114-1" href="#__codelineno-114-1"></a><span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">"å¯æ‰§è¡Œæ–‡ä»¶"</span><span class="p">,</span><span class="w"> </span><span class="s2">"å‚æ•°1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"å‚æ•°2"</span><span class="err">...</span><span class="p">]</span>
</span></code></pre></div> </li> </ul> <div class="admonition note"> <p class="admonition-title">Note</p> <p>åœ¨æŒ‡å®šäº† <code>ENTRYPOINT</code> æŒ‡ä»¤åï¼Œå¯ä»¥ç”¨ <code>CMD</code> æŒ‡å®šé»˜è®¤å‚æ•°ï¼š<code>CMD ["å‚æ•°1", "å‚æ•°2"...]</code>ã€‚</p> </div> <p>åœ¨æŒ‡ä»¤æ ¼å¼ä¸Šï¼Œä¸€èˆ¬æ¨èä½¿ç”¨ exec æ ¼å¼ï¼Œè¿™ç±»æ ¼å¼åœ¨è§£ææ—¶ä¼šè¢«è§£æä¸º JSON æ•°ç»„ï¼Œå› æ­¤ä¸€å®šè¦ä½¿ç”¨åŒå¼•å· <code>"</code>ï¼Œè€Œä¸è¦ä½¿ç”¨å•å¼•å·ã€‚</p> <p>å¦‚æœä½¿ç”¨ shell æ ¼å¼çš„è¯ï¼Œå®é™…çš„å‘½ä»¤ä¼šè¢«åŒ…è£…ä¸º <code>sh -c</code> çš„å‚æ•°çš„å½¢å¼è¿›è¡Œæ‰§è¡Œã€‚æ¯”å¦‚ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-115-1"><a id="__codelineno-115-1" name="__codelineno-115-1" href="#__codelineno-115-1"></a><span class="k">CMD</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$HOME</span>
</span></code></pre></div> <p>åœ¨å®é™…æ‰§è¡Œä¸­ï¼Œä¼šå°†å…¶å˜æ›´ä¸ºï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-116-1"><a id="__codelineno-116-1" name="__codelineno-116-1" href="#__codelineno-116-1"></a><span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"sh"</span><span class="p">,</span><span class="w"> </span><span class="s2">"-c"</span><span class="p">,</span><span class="w"> </span><span class="s2">"echo $HOME"</span><span class="w"> </span><span class="p">]</span>
</span></code></pre></div> <p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡çš„åŸå› ï¼Œå› ä¸ºè¿™äº›ç¯å¢ƒå˜é‡ä¼šè¢« shell è¿›è¡Œè§£æå¤„ç†ã€‚</p> <p><strong>å®¹å™¨ä¸­åº”ç”¨åœ¨å‰å°æ‰§è¡Œå’Œåå°æ‰§è¡Œçš„é—®é¢˜</strong></p> <p>Docker ä¸æ˜¯è™šæ‹Ÿæœºï¼Œå®¹å™¨ä¸­çš„åº”ç”¨éƒ½åº”è¯¥ä»¥å‰å°æ‰§è¡Œï¼Œè€Œä¸æ˜¯åƒè™šæ‹Ÿæœºã€ç‰©ç†æœºé‡Œé¢é‚£æ ·ï¼Œç”¨ <code>systemd</code> å»å¯åŠ¨åå°æœåŠ¡ï¼Œå®¹å™¨å†…æ²¡æœ‰åå°æœåŠ¡çš„æ¦‚å¿µã€‚</p> <p>ä¸€äº›åˆå­¦è€…å°† <code>CMD</code> å†™ä¸ºï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-117-1"><a id="__codelineno-117-1" name="__codelineno-117-1" href="#__codelineno-117-1"></a><span class="k">CMD</span><span class="w"> </span>service<span class="w"> </span>nginx<span class="w"> </span>start
</span></code></pre></div> <p>ç„¶åå‘ç°å®¹å™¨æ‰§è¡Œåå°±ç«‹å³é€€å‡ºäº†ã€‚ç”šè‡³åœ¨å®¹å™¨å†…å»ä½¿ç”¨ <code>systemctl</code> å‘½ä»¤ç»“æœå´å‘ç°æ ¹æœ¬æ‰§è¡Œä¸äº†ã€‚è¿™å°±æ˜¯å› ä¸ºæ²¡æœ‰ææ˜ç™½å‰å°ã€åå°çš„æ¦‚å¿µï¼Œæ²¡æœ‰åŒºåˆ†å®¹å™¨å’Œè™šæ‹Ÿæœºçš„å·®å¼‚ï¼Œä¾æ—§åœ¨ä»¥ä¼ ç»Ÿè™šæ‹Ÿæœºçš„è§’åº¦å»ç†è§£å®¹å™¨ã€‚</p> <p>å¯¹äºå®¹å™¨è€Œè¨€ï¼Œå…¶å¯åŠ¨ç¨‹åºå°±æ˜¯å®¹å™¨åº”ç”¨è¿›ç¨‹ï¼Œå®¹å™¨å°±æ˜¯ä¸ºäº†ä¸»è¿›ç¨‹è€Œå­˜åœ¨çš„ï¼Œä¸»è¿›ç¨‹é€€å‡ºï¼Œå®¹å™¨å°±å¤±å»äº†å­˜åœ¨çš„æ„ä¹‰ï¼Œä»è€Œé€€å‡ºï¼Œå…¶å®ƒè¾…åŠ©è¿›ç¨‹ä¸æ˜¯å®ƒéœ€è¦å…³å¿ƒçš„ä¸œè¥¿ã€‚</p> <p>è€Œä½¿ç”¨ <code>service nginx start</code> å‘½ä»¤ï¼Œåˆ™æ˜¯å¸Œæœ› init ç³»ç»Ÿä»¥åå°å®ˆæŠ¤è¿›ç¨‹çš„å½¢å¼å¯åŠ¨ nginx æœåŠ¡ã€‚è€Œåˆšæ‰è¯´äº† <code>CMD service nginx start</code> ä¼šè¢«ç†è§£ä¸º <code>CMD [ "sh", "-c", "service nginx start"]</code>ï¼Œå› æ­¤ä¸»è¿›ç¨‹å®é™…ä¸Šæ˜¯ <code>sh</code>ã€‚é‚£ä¹ˆå½“ <code>service nginx start</code> å‘½ä»¤ç»“æŸåï¼Œ<code>sh</code> ä¹Ÿå°±ç»“æŸäº†ï¼Œ<code>sh</code> ä½œä¸ºä¸»è¿›ç¨‹é€€å‡ºäº†ï¼Œè‡ªç„¶å°±ä¼šä»¤å®¹å™¨é€€å‡ºã€‚</p> <p>æ­£ç¡®çš„åšæ³•æ˜¯ç›´æ¥æ‰§è¡Œ <code>nginx</code> å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶ä¸”è¦æ±‚ä»¥å‰å°å½¢å¼è¿è¡Œã€‚æ¯”å¦‚ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-118-1"><a id="__codelineno-118-1" name="__codelineno-118-1" href="#__codelineno-118-1"></a><span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">"nginx"</span><span class="p">,</span><span class="w"> </span><span class="s2">"-g"</span><span class="p">,</span><span class="w"> </span><span class="s2">"daemon off;"</span><span class="p">]</span>
</span></code></pre></div> <h4 id="724entrypoint">7.2.4ã€ENTRYPOINT<a class="headerlink" href="#724entrypoint" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><code>ENTRYPOINT</code> çš„ä¸»è¦ç›®çš„æ˜¯å°†å®¹å™¨é…ç½®ä¸ºåƒä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚å½“ä½ è®¾ç½®äº† <code>ENTRYPOINT</code>ï¼Œå®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å°±æ˜¯è¿™ä¸ªå‘½ä»¤ï¼Œå¹¶ä¸” <code>docker run</code> å‘½ä»¤è¡Œä¸­è·Ÿåœ¨é•œåƒååé¢çš„æ‰€æœ‰å†…å®¹éƒ½ä¼šè¢«å½“ä½œå‚æ•°ä¼ é€’ç»™ <code>ENTRYPOINT</code>ã€‚</p> <p><code>ENTRYPOINT</code> çš„æ ¼å¼å’Œ <code>RUN</code> æŒ‡ä»¤æ ¼å¼ä¸€æ ·ï¼Œåˆ†ä¸º exec æ ¼å¼å’Œ shell æ ¼å¼ã€‚</p> <p>å½“æŒ‡å®šäº† <code>ENTRYPOINT</code> åï¼Œ<code>CMD</code> çš„å«ä¹‰å°±å‘ç”Ÿäº†æ”¹å˜ï¼Œä¸å†æ˜¯ç›´æ¥çš„è¿è¡Œå…¶å‘½ä»¤ï¼Œè€Œæ˜¯å°† <code>CMD</code> çš„å†…å®¹ä½œä¸ºå‚æ•°ä¼ ç»™ <code>ENTRYPOINT</code> æŒ‡ä»¤ï¼Œæ¢å¥è¯è¯´å®é™…æ‰§è¡Œæ—¶ï¼Œå°†å˜ä¸ºï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-119-1"><a id="__codelineno-119-1" name="__codelineno-119-1" href="#__codelineno-119-1"></a>&lt;ENTRYPOINT&gt;<span class="w"> </span><span class="s2">"&lt;CMD&gt;"</span>
</span></code></pre></div> <p><strong>æœ‰äº† <code>CMD</code> åï¼Œä¸ºä»€ä¹ˆè¿˜è¦æœ‰ <code>ENTRYPOINT</code>ï¼Ÿ</strong></p> <p>ç­”æ¡ˆåœ¨äºå®ƒä»¬ä¸åŒçš„è®¾è®¡å“²å­¦å’Œä½¿ç”¨åœºæ™¯ï¼š</p> <table> <thead> <tr> <th>ç‰¹æ€§/ç›®çš„</th> <th>CMD</th> <th>ENTRYPOINT</th> </tr> </thead> <tbody> <tr> <td>æ ¸å¿ƒè§’è‰²</td> <td>æä¾›é»˜è®¤è¡Œä¸ºï¼Œæ˜“äºè¢«è¦†ç›–</td> <td>å®šä¹‰å®¹å™¨çš„å›ºå®šå…¥å£ï¼Œä¸æ˜“è¢«è¦†ç›–</td> </tr> <tr> <td>å¦‚ä½•è¦†ç›–</td> <td>åœ¨ <code>docker run</code> åé¢ç›´æ¥åŠ æ–°å‘½ä»¤å³å¯</td> <td>éœ€è¦ä½¿ç”¨ <code>--entrypoint</code> æ ‡å¿—ï¼Œæ“ä½œæ›´ç¹ç</td> </tr> <tr> <td>ä½¿ç”¨åœºæ™¯</td> <td>ä¸ºå¼€å‘æˆ–è°ƒè¯•æä¾›ä¸€ä¸ªé»˜è®¤å‘½ä»¤</td> <td>åˆ›å»ºä¸€ä¸ªè¡Œä¸ºåƒå•ä¸€åº”ç”¨ç¨‹åºçš„é•œåƒ</td> </tr> <tr> <td>ç»„åˆä½¿ç”¨</td> <td>ä½œä¸º <code>ENTRYPOINT</code> çš„é»˜è®¤å‚æ•°</td> <td>ä½œä¸ºä¸»å‘½ä»¤ï¼Œæ¥æ”¶ <code>CMD</code> æˆ–å‘½ä»¤è¡Œå‚æ•°</td> </tr> </tbody> </table> <p>æ ¹æœ¬åŒºåˆ«åœ¨äº â€œæ˜¯å¦å®¹æ˜“è¢«è¦†ç›–â€ ä»¥åŠ â€œè®¾è®¡æ„å›¾â€ï¼š</p> <ul> <li> <p><code>CMD</code> çš„è®¾è®¡æ„å›¾æ˜¯ï¼šâ€œè¿™æ˜¯å®¹å™¨å¯åŠ¨æ—¶é»˜è®¤è¦åšçš„äº‹ï¼Œä½†ä½ å¯ä»¥è½»æ¾åœ°è®©å®ƒåšåˆ«çš„ã€‚â€</p> <p>ä¾‹å¦‚ï¼šä¸€ä¸ª ubuntu é•œåƒï¼Œ<code>CMD ["bash"]</code> è®©ä½ é»˜è®¤è¿›å…¥ä¸€ä¸ª shellï¼Œä½†ä½ ä¹Ÿå¯ä»¥ç”¨ <code>docker run ubuntu python my_script.py</code> æ¥è¿è¡Œä¸€ä¸ª Python è„šæœ¬ã€‚</p> </li> <li> <p><code>ENTRYPOINT</code> çš„è®¾è®¡æ„å›¾æ˜¯ï¼šâ€œè¿™ä¸ªå®¹å™¨å°±æ˜¯ä¸€ä¸ª X ç¨‹åºï¼Œä½ åªèƒ½ç»™å®ƒä¼ é€’å‚æ•°ï¼Œè€Œä¸æ˜¯æ›¿æ¢å®ƒã€‚â€</p> <p>ä¾‹å¦‚ï¼šä¸€ä¸ª redis é•œåƒï¼Œå®ƒçš„ <code>ENTRYPOINT</code> å°±æ˜¯ <code>redis-server</code>ã€‚ä½ å¯åŠ¨å®ƒå°±æ˜¯ä¸ºäº†è¿è¡Œ Redisï¼Œä½ å¯èƒ½ä¼šä¼ é€’ä¸€ä¸ªè‡ªå®šä¹‰é…ç½®æ–‡ä»¶çš„è·¯å¾„ä½œä¸ºå‚æ•°ï¼Œä½†ä½ ä¸ä¼šæƒ³æŠŠ <code>redis-server</code> æ¢æˆ <code>ls -l</code>ã€‚</p> </li> </ul> <p><strong>è¿™ç§ <code>&lt;ENTRYPOINT&gt; "&lt;CMD&gt;"</code> æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</strong></p> <p>å‡è®¾æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªå¯ä»¥ <code>ping</code> ä»»ä½•ä¸»æœºçš„å®¹å™¨ï¼Œä½†é»˜è®¤ <code>ping</code> æœ¬åœ°ä¸»æœº <code>localhost</code>ã€‚</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-120-1"><a id="__codelineno-120-1" name="__codelineno-120-1" href="#__codelineno-120-1"></a><span class="k">FROM</span><span class="w"> </span><span class="s">ubuntu</span>
</span><span id="__span-120-2"><a id="__codelineno-120-2" name="__codelineno-120-2" href="#__codelineno-120-2"></a><span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>iputils-ping
</span><span id="__span-120-3"><a id="__codelineno-120-3" name="__codelineno-120-3" href="#__codelineno-120-3"></a>
</span><span id="__span-120-4"><a id="__codelineno-120-4" name="__codelineno-120-4" href="#__codelineno-120-4"></a><span class="c">## 1. å®šä¹‰å›ºå®šçš„ä¸»å‘½ä»¤</span>
</span><span id="__span-120-5"><a id="__codelineno-120-5" name="__codelineno-120-5" href="#__codelineno-120-5"></a><span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">"ping"</span><span class="p">,</span><span class="w"> </span><span class="s2">"-c"</span><span class="p">,</span><span class="w"> </span><span class="s2">"4"</span><span class="p">]</span>
</span><span id="__span-120-6"><a id="__codelineno-120-6" name="__codelineno-120-6" href="#__codelineno-120-6"></a>
</span><span id="__span-120-7"><a id="__codelineno-120-7" name="__codelineno-120-7" href="#__codelineno-120-7"></a><span class="c">## 2. æä¾›é»˜è®¤å‚æ•°</span>
</span><span id="__span-120-8"><a id="__codelineno-120-8" name="__codelineno-120-8" href="#__codelineno-120-8"></a><span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">"localhost"</span><span class="p">]</span>
</span></code></pre></div> <p>ç°åœ¨æˆ‘ä»¬æ¥æ„å»ºå¹¶è¿è¡Œè¿™ä¸ªé•œåƒï¼ˆmy-pro-pingï¼‰ï¼š</p> <ul> <li> <p>åœºæ™¯ä¸€ï¼šä¸æä¾›ä»»ä½•å‚æ•°</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-121-1"><a id="__codelineno-121-1" name="__codelineno-121-1" href="#__codelineno-121-1"></a>docker<span class="w"> </span>run<span class="w"> </span>my-pro-ping
</span></code></pre></div> <p><code>CMD</code> çš„å€¼ <code>["localhost"]</code> ä¼šè¢«è¿½åŠ åˆ° <code>ENTRYPOINT</code> åé¢ã€‚å®é™…æ‰§è¡Œï¼š<code>ping -c 4 localhost</code>ã€‚</p> </li> <li> <p>åœºæ™¯äºŒï¼šæä¾›ä¸€ä¸ªæ–°çš„å‚æ•°</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-122-1"><a id="__codelineno-122-1" name="__codelineno-122-1" href="#__codelineno-122-1"></a>docker<span class="w"> </span>run<span class="w"> </span>my-pro-ping<span class="w"> </span>google.com
</span></code></pre></div> <p><code>docker run</code> åé¢çš„ <code>google.com</code> ä¼šè¦†ç›–æ‰ <code>CMD</code> çš„å†…å®¹ã€‚å®é™…æ‰§è¡Œï¼š<code>ping -c 4 google.com</code>ã€‚</p> </li> <li> <p>åœºæ™¯ä¸‰ï¼šæä¾›å¤šä¸ªæ–°å‚æ•°</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-123-1"><a id="__codelineno-123-1" name="__codelineno-123-1" href="#__codelineno-123-1"></a>docker<span class="w"> </span>run<span class="w"> </span>my-pro-ping<span class="w"> </span>-W<span class="w"> </span><span class="m">5</span><span class="w"> </span>baidu.com
</span></code></pre></div> <p><code>-W 5 baidu.com</code> ä¼šè¦†ç›– <code>CMD</code>ã€‚å®é™…æ‰§è¡Œï¼š<code>ping -c 4 -W 5 baidu.com</code>ã€‚</p> </li> </ul> <p>é€šè¿‡è¿™ç§ç»„åˆï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªéå¸¸å¼ºå¤§ä¸”çµæ´»çš„é•œåƒï¼š</p> <ul> <li>å®ƒæ˜ç¡®åœ°è¡¨ç¤ºè‡ªå·±æ˜¯ä¸€ä¸ª <code>ping</code> å·¥å…·ï¼ˆ<code>ENTRYPOINT</code>ï¼‰ã€‚</li> <li>å®ƒæœ‰åˆç†çš„é»˜è®¤è¡Œä¸ºï¼ˆ<code>ping localhost</code>ï¼‰ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œï¼ˆ<code>CMD</code>ï¼‰ã€‚</li> <li>å®ƒåˆå¯ä»¥éå¸¸æ–¹ä¾¿åœ°æ¥å—ç”¨æˆ·è‡ªå®šä¹‰çš„å‚æ•°ï¼Œæ¥æ”¹å˜å…¶è¡Œä¸ºï¼ˆè¦†ç›– <code>CMD</code>ï¼‰ã€‚</li> </ul> <p>æ€»ç»“ï¼š</p> <ul> <li>å•ç‹¬ä½¿ç”¨ <code>CMD</code>ï¼šé€‚ç”¨äºé€šç”¨é•œåƒï¼Œå¸Œæœ›ç”¨æˆ·å¯ä»¥è½»æ¾è¿è¡Œä»»ä½•å‘½ä»¤çš„åœºæ™¯ï¼ˆå¦‚åŸºç¡€æ“ä½œç³»ç»Ÿé•œåƒï¼‰ã€‚</li> <li>å•ç‹¬ä½¿ç”¨ <code>ENTRYPOINT</code>ï¼šé€‚ç”¨äºåˆ›å»ºä¸€ä¸ªåŠŸèƒ½éå¸¸å›ºå®šçš„ "å·¥å…·å‹" å®¹å™¨ï¼Œä½†éœ€è¦ç”¨æˆ·æ€»æ˜¯æä¾›å‚æ•°ã€‚</li> <li><code>ENTRYPOINT</code>+<code>CMD</code> ç»„åˆï¼šé€‚ç”¨äºåˆ›å»ºåº”ç”¨ç¨‹åºé•œåƒã€‚<code>ENTRYPOINT</code> å®šä¹‰äº†åº”ç”¨æœ¬èº«ï¼Œ<code>CMD</code> å®šä¹‰äº†åº”ç”¨çš„é»˜è®¤å‚æ•°ï¼Œè¿™ä½¿å¾—é•œåƒæ—¢ç¨³å®šåˆçµæ´»ã€‚</li> </ul> <h4 id="725env">7.2.5ã€ENV<a class="headerlink" href="#725env" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>è¿™ä¸ªæŒ‡ä»¤å¾ˆç®€å•ï¼Œå°±æ˜¯è®¾ç½®ç¯å¢ƒå˜é‡è€Œå·²ï¼Œæ— è®ºæ˜¯åé¢çš„å…¶å®ƒæŒ‡ä»¤ï¼Œå¦‚ <code>RUN</code>ï¼Œè¿˜æ˜¯è¿è¡Œæ—¶çš„åº”ç”¨ï¼Œéƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™é‡Œå®šä¹‰çš„ç¯å¢ƒå˜é‡ã€‚</p> <p>æ ¼å¼æœ‰ä¸¤ç§ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-124-1"><a id="__codelineno-124-1" name="__codelineno-124-1" href="#__codelineno-124-1"></a><span class="k">ENV</span><span class="w"> </span>&lt;key&gt;<span class="w"> </span>&lt;value&gt;
</span><span id="__span-124-2"><a id="__codelineno-124-2" name="__codelineno-124-2" href="#__codelineno-124-2"></a><span class="k">ENV</span><span class="w"> </span>&lt;key1&gt;<span class="o">=</span>&lt;value1&gt;<span class="w"> </span>&lt;key2&gt;<span class="o">=</span>&lt;value2&gt;...
</span></code></pre></div> <p>ä¸‹é¢æ˜¯ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-125-1"><a id="__codelineno-125-1" name="__codelineno-125-1" href="#__codelineno-125-1"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">VERSION</span><span class="o">=</span><span class="m">1</span>.0<span class="w"> </span><span class="nv">DEBUG</span><span class="o">=</span>on<span class="w"> </span><span class="se">\</span>
</span><span id="__span-125-2"><a id="__codelineno-125-2" name="__codelineno-125-2" href="#__codelineno-125-2"></a><span class="w">    </span><span class="nv">NAME</span><span class="o">=</span><span class="s2">"Happy Feet"</span>
</span></code></pre></div> <p>è¿™ä¸ªä¾‹å­ä¸­æ¼”ç¤ºäº†å¦‚ä½•æ¢è¡Œï¼Œä»¥åŠå¯¹å«æœ‰ç©ºæ ¼çš„å€¼ç”¨åŒå¼•å·æ‹¬èµ·æ¥çš„åŠæ³•ï¼Œè¿™å’Œ Shell ä¸­çš„è¡Œä¸ºæ˜¯ä¸€è‡´çš„ã€‚</p> <p>å®šä¹‰äº†ç¯å¢ƒå˜é‡ï¼Œé‚£ä¹ˆåœ¨åç»­çš„æŒ‡ä»¤ä¸­ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªç¯å¢ƒå˜é‡ã€‚æ¯”å¦‚åœ¨å®˜æ–¹ <code>node</code> é•œåƒ Dockerfile ä¸­ï¼Œå°±æœ‰ç±»ä¼¼è¿™æ ·çš„ä»£ç ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-126-1"><a id="__codelineno-126-1" name="__codelineno-126-1" href="#__codelineno-126-1"></a><span class="k">ENV</span><span class="w"> </span>NODE_VERSION<span class="w"> </span><span class="m">7</span>.2.0
</span><span id="__span-126-2"><a id="__codelineno-126-2" name="__codelineno-126-2" href="#__codelineno-126-2"></a>
</span><span id="__span-126-3"><a id="__codelineno-126-3" name="__codelineno-126-3" href="#__codelineno-126-3"></a><span class="k">RUN</span><span class="w"> </span>curl<span class="w"> </span>-SLO<span class="w"> </span><span class="s2">"https://nodejs.org/dist/v</span><span class="nv">$NODE_VERSION</span><span class="s2">/node-v</span><span class="nv">$NODE_VERSION</span><span class="s2">-linux-x64.tar.xz"</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-126-4"><a id="__codelineno-126-4" name="__codelineno-126-4" href="#__codelineno-126-4"></a><span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span>curl<span class="w"> </span>-SLO<span class="w"> </span><span class="s2">"https://nodejs.org/dist/v</span><span class="nv">$NODE_VERSION</span><span class="s2">/SHASUMS256.txt.asc"</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-126-5"><a id="__codelineno-126-5" name="__codelineno-126-5" href="#__codelineno-126-5"></a><span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span>gpg<span class="w"> </span>--batch<span class="w"> </span>--decrypt<span class="w"> </span>--output<span class="w"> </span>SHASUMS256.txt<span class="w"> </span>SHASUMS256.txt.asc<span class="w"> </span><span class="se">\</span>
</span><span id="__span-126-6"><a id="__codelineno-126-6" name="__codelineno-126-6" href="#__codelineno-126-6"></a><span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">" node-v</span><span class="nv">$NODE_VERSION</span><span class="s2">-linux-x64.tar.xz\$"</span><span class="w"> </span>SHASUMS256.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>sha256sum<span class="w"> </span>-c<span class="w"> </span>-<span class="w"> </span><span class="se">\</span>
</span><span id="__span-126-7"><a id="__codelineno-126-7" name="__codelineno-126-7" href="#__codelineno-126-7"></a><span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span>tar<span class="w"> </span>-xJf<span class="w"> </span><span class="s2">"node-v</span><span class="nv">$NODE_VERSION</span><span class="s2">-linux-x64.tar.xz"</span><span class="w"> </span>-C<span class="w"> </span>/usr/local<span class="w"> </span>--strip-components<span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-126-8"><a id="__codelineno-126-8" name="__codelineno-126-8" href="#__codelineno-126-8"></a><span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span><span class="s2">"node-v</span><span class="nv">$NODE_VERSION</span><span class="s2">-linux-x64.tar.xz"</span><span class="w"> </span>SHASUMS256.txt.asc<span class="w"> </span>SHASUMS256.txt<span class="w"> </span><span class="se">\</span>
</span><span id="__span-126-9"><a id="__codelineno-126-9" name="__codelineno-126-9" href="#__codelineno-126-9"></a><span class="w">  </span><span class="o">&amp;&amp;</span><span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/usr/local/bin/node<span class="w"> </span>/usr/local/bin/nodejs
</span></code></pre></div> <p>åœ¨è¿™é‡Œå…ˆå®šä¹‰äº†ç¯å¢ƒå˜é‡ <code>NODE_VERSION</code>ï¼Œå…¶åçš„ <code>RUN</code> è¿™å±‚é‡Œï¼Œå¤šæ¬¡ä½¿ç”¨ <code>$NODE_VERSION</code> æ¥è¿›è¡Œæ“ä½œå®šåˆ¶ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå°†æ¥å‡çº§é•œåƒæ„å»ºç‰ˆæœ¬çš„æ—¶å€™ï¼Œåªéœ€è¦æ›´æ–° <code>7.2.0</code> å³å¯ï¼ŒDockerfile æ„å»ºç»´æŠ¤å˜å¾—æ›´è½»æ¾äº†ã€‚</p> <p>ä¸‹åˆ—æŒ‡ä»¤å¯ä»¥æ”¯æŒç¯å¢ƒå˜é‡ï¼š <code>ADD</code>ã€<code>COPY</code>ã€<code>ENV</code>ã€<code>EXPOSE</code>ã€<code>FROM</code>ã€<code>LABEL</code>ã€<code>USER</code>ã€<code>WORKDIR</code>ã€<code>VOLUME</code>ã€<code>STOPSIGNAL</code>ã€<code>ONBUILD</code>ã€<code>RUN</code>ã€‚</p> <p>å¯ä»¥ä»è¿™ä¸ªæŒ‡ä»¤åˆ—è¡¨é‡Œæ„Ÿè§‰åˆ°ï¼Œç¯å¢ƒå˜é‡å¯ä»¥ä½¿ç”¨çš„åœ°æ–¹å¾ˆå¤šï¼Œå¾ˆå¼ºå¤§ã€‚é€šè¿‡ç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥è®©ä¸€ä»½ Dockerfile åˆ¶ä½œæ›´å¤šçš„é•œåƒï¼Œåªéœ€ä½¿ç”¨ä¸åŒçš„ç¯å¢ƒå˜é‡å³å¯ã€‚</p> <h4 id="726arg">7.2.6ã€ARG<a class="headerlink" href="#726arg" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><code>ARG</code> æ„å»ºå‚æ•°å’Œ <code>ENV</code> çš„æ•ˆæœä¸€æ ·ï¼Œéƒ½æ˜¯è®¾ç½®ç¯å¢ƒå˜é‡ã€‚æ‰€ä¸åŒçš„æ˜¯ï¼Œ<code>ARG</code> æ‰€è®¾ç½®çš„æ„å»ºç¯å¢ƒçš„ç¯å¢ƒå˜é‡ï¼Œåœ¨å°†æ¥å®¹å™¨è¿è¡Œæ—¶æ˜¯ä¸ä¼šå­˜åœ¨è¿™äº›ç¯å¢ƒå˜é‡çš„ã€‚ä½†æ˜¯ä¸è¦å› æ­¤å°±ä½¿ç”¨ <code>ARG</code> ä¿å­˜å¯†ç ä¹‹ç±»çš„ä¿¡æ¯ï¼Œå› ä¸º <code>docker history</code> è¿˜æ˜¯å¯ä»¥çœ‹åˆ°æ‰€æœ‰å€¼çš„ã€‚</p> <p>æ ¼å¼ä¸ºï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-127-1"><a id="__codelineno-127-1" name="__codelineno-127-1" href="#__codelineno-127-1"></a><span class="k">ARG</span><span class="w"> </span>&lt;å‚æ•°å&gt;<span class="o">[=</span>&lt;é»˜è®¤å€¼&gt;<span class="o">]</span>
</span></code></pre></div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Dockerfile ä¸­çš„ <code>ARG</code> æŒ‡ä»¤æ˜¯å®šä¹‰å‚æ•°åç§°ä»¥åŠå…¶é»˜è®¤å€¼ã€‚è¯¥é»˜è®¤å€¼å¯ä»¥åœ¨æ„å»ºå‘½ä»¤ <code>docker build</code> ä¸­ç”¨ <code>--build-arg &lt;å‚æ•°å&gt;=&lt;å€¼&gt;</code> æ¥è¦†ç›–ã€‚</p> </div> <p>çµæ´»çš„ä½¿ç”¨ <code>ARG</code> æŒ‡ä»¤ï¼Œèƒ½å¤Ÿåœ¨ä¸ä¿®æ”¹ Dockerfile çš„æƒ…å†µä¸‹ï¼Œæ„å»ºå‡ºä¸åŒçš„é•œåƒã€‚</p> <p>ARG æŒ‡ä»¤æœ‰ç”Ÿæ•ˆèŒƒå›´ï¼Œå¦‚æœåœ¨ <code>FROM</code> æŒ‡ä»¤ä¹‹å‰æŒ‡å®šï¼Œé‚£ä¹ˆåªèƒ½ç”¨äº <code>FROM</code> æŒ‡ä»¤ä¸­ã€‚</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-128-1"><a id="__codelineno-128-1" name="__codelineno-128-1" href="#__codelineno-128-1"></a><span class="k">ARG</span><span class="w"> </span><span class="nv">DOCKER_USERNAME</span><span class="o">=</span>library
</span><span id="__span-128-2"><a id="__codelineno-128-2" name="__codelineno-128-2" href="#__codelineno-128-2"></a>
</span><span id="__span-128-3"><a id="__codelineno-128-3" name="__codelineno-128-3" href="#__codelineno-128-3"></a><span class="k">FROM</span><span class="w"> </span><span class="s">${DOCKER_USERNAME}/alpine</span>
</span><span id="__span-128-4"><a id="__codelineno-128-4" name="__codelineno-128-4" href="#__codelineno-128-4"></a>
</span><span id="__span-128-5"><a id="__codelineno-128-5" name="__codelineno-128-5" href="#__codelineno-128-5"></a><span class="k">RUN</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>-x<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="si">${</span><span class="nv">DOCKER_USERNAME</span><span class="si">}</span>
</span></code></pre></div> <p>ä½¿ç”¨ä¸Šè¿° Dockerfile ä¼šå‘ç°æ— æ³•è¾“å‡º <code>${DOCKER_USERNAME}</code> å˜é‡çš„å€¼ï¼Œè¦æƒ³æ­£å¸¸è¾“å‡ºï¼Œä½ å¿…é¡»åœ¨ <code>FROM</code> ä¹‹åå†æ¬¡æŒ‡å®š <code>ARG</code></p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-129-1"><a id="__codelineno-129-1" name="__codelineno-129-1" href="#__codelineno-129-1"></a><span class="c">## åªåœ¨ FROM ä¸­ç”Ÿæ•ˆ</span>
</span><span id="__span-129-2"><a id="__codelineno-129-2" name="__codelineno-129-2" href="#__codelineno-129-2"></a><span class="k">ARG</span><span class="w"> </span><span class="nv">DOCKER_USERNAME</span><span class="o">=</span>library
</span><span id="__span-129-3"><a id="__codelineno-129-3" name="__codelineno-129-3" href="#__codelineno-129-3"></a>
</span><span id="__span-129-4"><a id="__codelineno-129-4" name="__codelineno-129-4" href="#__codelineno-129-4"></a><span class="k">FROM</span><span class="w"> </span><span class="s">${DOCKER_USERNAME}/alpine</span>
</span><span id="__span-129-5"><a id="__codelineno-129-5" name="__codelineno-129-5" href="#__codelineno-129-5"></a>
</span><span id="__span-129-6"><a id="__codelineno-129-6" name="__codelineno-129-6" href="#__codelineno-129-6"></a><span class="c">## è¦æƒ³åœ¨ FROM ä¹‹åä½¿ç”¨ï¼Œå¿…é¡»å†æ¬¡æŒ‡å®š</span>
</span><span id="__span-129-7"><a id="__codelineno-129-7" name="__codelineno-129-7" href="#__codelineno-129-7"></a><span class="k">ARG</span><span class="w"> </span><span class="nv">DOCKER_USERNAME</span><span class="o">=</span>library
</span><span id="__span-129-8"><a id="__codelineno-129-8" name="__codelineno-129-8" href="#__codelineno-129-8"></a>
</span><span id="__span-129-9"><a id="__codelineno-129-9" name="__codelineno-129-9" href="#__codelineno-129-9"></a><span class="k">RUN</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>-x<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="si">${</span><span class="nv">DOCKER_USERNAME</span><span class="si">}</span>
</span></code></pre></div> <p>å¯¹äºå¤šé˜¶æ®µæ„å»ºï¼Œå°¤å…¶è¦æ³¨æ„è¿™ä¸ªé—®é¢˜ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-130-1"><a id="__codelineno-130-1" name="__codelineno-130-1" href="#__codelineno-130-1"></a><span class="c">## è¿™ä¸ªå˜é‡åœ¨æ¯ä¸ª FROM ä¸­éƒ½ç”Ÿæ•ˆ</span>
</span><span id="__span-130-2"><a id="__codelineno-130-2" name="__codelineno-130-2" href="#__codelineno-130-2"></a><span class="k">ARG</span><span class="w"> </span><span class="nv">DOCKER_USERNAME</span><span class="o">=</span>library
</span><span id="__span-130-3"><a id="__codelineno-130-3" name="__codelineno-130-3" href="#__codelineno-130-3"></a>
</span><span id="__span-130-4"><a id="__codelineno-130-4" name="__codelineno-130-4" href="#__codelineno-130-4"></a><span class="k">FROM</span><span class="w"> </span><span class="s">${DOCKER_USERNAME}/alpine</span>
</span><span id="__span-130-5"><a id="__codelineno-130-5" name="__codelineno-130-5" href="#__codelineno-130-5"></a>
</span><span id="__span-130-6"><a id="__codelineno-130-6" name="__codelineno-130-6" href="#__codelineno-130-6"></a><span class="k">RUN</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>-x<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-130-7"><a id="__codelineno-130-7" name="__codelineno-130-7" href="#__codelineno-130-7"></a>
</span><span id="__span-130-8"><a id="__codelineno-130-8" name="__codelineno-130-8" href="#__codelineno-130-8"></a><span class="k">FROM</span><span class="w"> </span><span class="s">${DOCKER_USERNAME}/alpine</span>
</span><span id="__span-130-9"><a id="__codelineno-130-9" name="__codelineno-130-9" href="#__codelineno-130-9"></a>
</span><span id="__span-130-10"><a id="__codelineno-130-10" name="__codelineno-130-10" href="#__codelineno-130-10"></a><span class="k">RUN</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>-x<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="m">2</span>
</span></code></pre></div> <p>å¯¹äºä¸Šè¿° Dockerfile ä¸¤ä¸ª <code>FROM</code> æŒ‡ä»¤éƒ½å¯ä»¥ä½¿ç”¨ <code>${DOCKER_USERNAME}</code>ï¼Œå¯¹äºåœ¨å„ä¸ªé˜¶æ®µä¸­ä½¿ç”¨çš„å˜é‡éƒ½å¿…é¡»åœ¨æ¯ä¸ªé˜¶æ®µåˆ†åˆ«æŒ‡å®šï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-131-1"><a id="__codelineno-131-1" name="__codelineno-131-1" href="#__codelineno-131-1"></a><span class="k">ARG</span><span class="w"> </span><span class="nv">DOCKER_USERNAME</span><span class="o">=</span>library
</span><span id="__span-131-2"><a id="__codelineno-131-2" name="__codelineno-131-2" href="#__codelineno-131-2"></a>
</span><span id="__span-131-3"><a id="__codelineno-131-3" name="__codelineno-131-3" href="#__codelineno-131-3"></a><span class="k">FROM</span><span class="w"> </span><span class="s">${DOCKER_USERNAME}/alpine</span>
</span><span id="__span-131-4"><a id="__codelineno-131-4" name="__codelineno-131-4" href="#__codelineno-131-4"></a>
</span><span id="__span-131-5"><a id="__codelineno-131-5" name="__codelineno-131-5" href="#__codelineno-131-5"></a><span class="c">## åœ¨FROM ä¹‹åä½¿ç”¨å˜é‡ï¼Œå¿…é¡»åœ¨æ¯ä¸ªé˜¶æ®µåˆ†åˆ«æŒ‡å®š</span>
</span><span id="__span-131-6"><a id="__codelineno-131-6" name="__codelineno-131-6" href="#__codelineno-131-6"></a><span class="k">ARG</span><span class="w"> </span><span class="nv">DOCKER_USERNAME</span><span class="o">=</span>library
</span><span id="__span-131-7"><a id="__codelineno-131-7" name="__codelineno-131-7" href="#__codelineno-131-7"></a>
</span><span id="__span-131-8"><a id="__codelineno-131-8" name="__codelineno-131-8" href="#__codelineno-131-8"></a><span class="k">RUN</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>-x<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="si">${</span><span class="nv">DOCKER_USERNAME</span><span class="si">}</span>
</span><span id="__span-131-9"><a id="__codelineno-131-9" name="__codelineno-131-9" href="#__codelineno-131-9"></a>
</span><span id="__span-131-10"><a id="__codelineno-131-10" name="__codelineno-131-10" href="#__codelineno-131-10"></a><span class="k">FROM</span><span class="w"> </span><span class="s">${DOCKER_USERNAME}/alpine</span>
</span><span id="__span-131-11"><a id="__codelineno-131-11" name="__codelineno-131-11" href="#__codelineno-131-11"></a>
</span><span id="__span-131-12"><a id="__codelineno-131-12" name="__codelineno-131-12" href="#__codelineno-131-12"></a><span class="c">## åœ¨FROM ä¹‹åä½¿ç”¨å˜é‡ï¼Œå¿…é¡»åœ¨æ¯ä¸ªé˜¶æ®µåˆ†åˆ«æŒ‡å®š</span>
</span><span id="__span-131-13"><a id="__codelineno-131-13" name="__codelineno-131-13" href="#__codelineno-131-13"></a><span class="k">ARG</span><span class="w"> </span><span class="nv">DOCKER_USERNAME</span><span class="o">=</span>library
</span><span id="__span-131-14"><a id="__codelineno-131-14" name="__codelineno-131-14" href="#__codelineno-131-14"></a>
</span><span id="__span-131-15"><a id="__codelineno-131-15" name="__codelineno-131-15" href="#__codelineno-131-15"></a><span class="k">RUN</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>-x<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="si">${</span><span class="nv">DOCKER_USERNAME</span><span class="si">}</span>
</span></code></pre></div> <h4 id="727volume">7.2.7ã€VOLUME<a class="headerlink" href="#727volume" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>å®¹å™¨è¿è¡Œæ—¶åº”è¯¥å°½é‡ä¿æŒå®¹å™¨å­˜å‚¨å±‚ä¸å‘ç”Ÿå†™æ“ä½œï¼Œå¯¹äºæ•°æ®åº“ç±»éœ€è¦ä¿å­˜åŠ¨æ€æ•°æ®çš„åº”ç”¨ï¼Œå…¶æ•°æ®åº“æ–‡ä»¶åº”è¯¥ä¿å­˜äºå·ï¼ˆvolumeï¼‰ä¸­ã€‚ä¸ºäº†é˜²æ­¢è¿è¡Œæ—¶ç”¨æˆ·å¿˜è®°å°†åŠ¨æ€æ–‡ä»¶æ‰€ä¿å­˜ç›®å½•æŒ‚è½½ä¸ºå·ï¼Œåœ¨ Dockerfile ä¸­å¯ä»¥ä½¿ç”¨ <code>VOLUME</code> æŒ‡ä»¤äº‹å…ˆæŒ‡å®šæŸäº›ç›®å½•æŒ‚è½½ä¸ºåŒ¿åå·ï¼Œè¿™æ ·åœ¨è¿è¡Œæ—¶å¦‚æœç”¨æˆ·ä¸æŒ‡å®šæŒ‚è½½ï¼Œå…¶åº”ç”¨ä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä¸ä¼šå‘å®¹å™¨å­˜å‚¨å±‚å†™å…¥å¤§é‡æ•°æ®ã€‚</p> <p>æ ¼å¼æœ‰ä¸¤ç§ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-132-1"><a id="__codelineno-132-1" name="__codelineno-132-1" href="#__codelineno-132-1"></a><span class="k">VOLUME</span><span class="w"> </span><span class="p">[</span><span class="s2">"&lt;è·¯å¾„1&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">"&lt;è·¯å¾„2&gt;"</span><span class="err">...</span><span class="p">]</span>
</span><span id="__span-132-2"><a id="__codelineno-132-2" name="__codelineno-132-2" href="#__codelineno-132-2"></a><span class="k">VOLUME</span><span class="w"> </span><span class="s">&lt;è·¯å¾„&gt;</span>
</span></code></pre></div> <p>ä¸‹é¢æ˜¯ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-133-1"><a id="__codelineno-133-1" name="__codelineno-133-1" href="#__codelineno-133-1"></a><span class="k">VOLUME</span><span class="w"> </span><span class="s">/data</span>
</span></code></pre></div> <p>è¿™é‡Œçš„ <code>/data</code> ç›®å½•å°±ä¼šåœ¨å®¹å™¨è¿è¡Œæ—¶è‡ªåŠ¨æŒ‚è½½ä¸ºåŒ¿åå·ï¼Œä»»ä½•å‘ <code>/data</code> ä¸­å†™å…¥çš„ä¿¡æ¯éƒ½ä¸ä¼šè®°å½•è¿›å®¹å™¨å­˜å‚¨å±‚ï¼Œä»è€Œä¿è¯äº†å®¹å™¨å­˜å‚¨å±‚çš„æ— çŠ¶æ€åŒ–ã€‚å½“ç„¶ï¼Œè¿è¡Œå®¹å™¨æ—¶å¯ä»¥è¦†ç›–è¿™ä¸ªæŒ‚è½½è®¾ç½®ã€‚æ¯”å¦‚ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-134-1"><a id="__codelineno-134-1" name="__codelineno-134-1" href="#__codelineno-134-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-v<span class="w"> </span>mydata:/data<span class="w"> </span>xxxx
</span></code></pre></div> <p>åœ¨è¿™è¡Œå‘½ä»¤ä¸­ï¼Œå°±ä½¿ç”¨äº† <code>mydata</code> è¿™ä¸ªå‘½åå·æŒ‚è½½åˆ°äº† <code>/data</code> è¿™ä¸ªä½ç½®ï¼Œæ›¿ä»£äº† Dockerfile ä¸­å®šä¹‰çš„åŒ¿åå·çš„æŒ‚è½½é…ç½®ã€‚</p> <h4 id="728expose">7.2.8ã€EXPOSE<a class="headerlink" href="#728expose" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><code>EXPOSE</code> æŒ‡ä»¤æ˜¯å£°æ˜å®¹å™¨è¿è¡Œæ—¶æä¾›æœåŠ¡çš„ç«¯å£ï¼Œè¿™åªæ˜¯ä¸€ä¸ªå£°æ˜ï¼Œåœ¨å®¹å™¨è¿è¡Œæ—¶å¹¶ä¸ä¼šå› ä¸ºè¿™ä¸ªå£°æ˜åº”ç”¨å°±ä¼šå¼€å¯è¿™ä¸ªç«¯å£çš„æœåŠ¡ã€‚åœ¨ Dockerfile ä¸­å†™å…¥è¿™æ ·çš„å£°æ˜æœ‰ä¸¤ä¸ªå¥½å¤„ï¼Œä¸€ä¸ªæ˜¯å¸®åŠ©é•œåƒä½¿ç”¨è€…ç†è§£è¿™ä¸ªé•œåƒæœåŠ¡çš„å®ˆæŠ¤ç«¯å£ï¼Œä»¥æ–¹ä¾¿é…ç½®æ˜ å°„ï¼›å¦ä¸€ä¸ªç”¨å¤„åˆ™æ˜¯åœ¨è¿è¡Œæ—¶ä½¿ç”¨éšæœºç«¯å£æ˜ å°„æ—¶ï¼Œä¹Ÿå°±æ˜¯ <code>docker run -P</code> æ—¶ï¼Œä¼šè‡ªåŠ¨éšæœºæ˜ å°„ <code>EXPOSE</code> çš„ç«¯å£ã€‚</p> <p>æ ¼å¼ä¸ºï¼š </p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-135-1"><a id="__codelineno-135-1" name="__codelineno-135-1" href="#__codelineno-135-1"></a><span class="k">EXPOSE</span><span class="w"> </span><span class="s">&lt;ç«¯å£1&gt; [&lt;ç«¯å£2&gt;...]</span>
</span></code></pre></div> <p>è¦å°† <code>EXPOSE</code> å’Œåœ¨è¿è¡Œæ—¶ä½¿ç”¨ <code>-p &lt;å®¿ä¸»ç«¯å£&gt;:&lt;å®¹å™¨ç«¯å£&gt;</code> åŒºåˆ†å¼€æ¥ã€‚<code>-p</code> æ˜¯æ˜ å°„å®¿ä¸»ç«¯å£å’Œå®¹å™¨ç«¯å£ï¼Œæ¢å¥è¯è¯´ï¼Œå°±æ˜¯å°†å®¹å™¨çš„å¯¹åº”ç«¯å£æœåŠ¡å…¬å¼€ç»™å¤–ç•Œè®¿é—®ï¼Œè€Œ <code>EXPOSE</code> ä»…ä»…æ˜¯å£°æ˜å®¹å™¨æ‰“ç®—ä½¿ç”¨ä»€ä¹ˆç«¯å£è€Œå·²ï¼Œå¹¶ä¸ä¼šè‡ªåŠ¨åœ¨å®¿ä¸»è¿›è¡Œç«¯å£æ˜ å°„ã€‚</p> <h4 id="729workdir">7.2.9ã€WORKDIR<a class="headerlink" href="#729workdir" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>ä½¿ç”¨ <code>WORKDIR</code> æŒ‡ä»¤å¯ä»¥æ¥æŒ‡å®šå·¥ä½œç›®å½•ï¼ˆæˆ–è€…ç§°ä¸ºå½“å‰ç›®å½•ï¼‰ï¼Œä»¥åå„å±‚çš„å½“å‰ç›®å½•å°±è¢«æ”¹ä¸ºæŒ‡å®šçš„ç›®å½•ï¼Œå¦‚è¯¥ç›®å½•ä¸å­˜åœ¨ï¼Œ<code>WORKDIR</code> ä¼šå¸®ä½ å»ºç«‹ç›®å½•ã€‚</p> <p>æ ¼å¼ä¸ºï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-136-1"><a id="__codelineno-136-1" name="__codelineno-136-1" href="#__codelineno-136-1"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">&lt;å·¥ä½œç›®å½•è·¯å¾„&gt;</span>
</span></code></pre></div> <p>ä¹‹å‰æåˆ°ä¸€äº›åˆå­¦è€…å¸¸çŠ¯çš„é”™è¯¯æ˜¯æŠŠ Dockerfile ç­‰åŒäº Shell è„šæœ¬æ¥ä¹¦å†™ï¼Œè¿™ç§é”™è¯¯çš„ç†è§£è¿˜å¯èƒ½ä¼šå¯¼è‡´å‡ºç°ä¸‹é¢è¿™æ ·çš„é”™è¯¯ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-137-1"><a id="__codelineno-137-1" name="__codelineno-137-1" href="#__codelineno-137-1"></a><span class="k">RUN</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/app
</span><span id="__span-137-2"><a id="__codelineno-137-2" name="__codelineno-137-2" href="#__codelineno-137-2"></a><span class="k">RUN</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"hello"</span><span class="w"> </span>&gt;<span class="w"> </span>world.txt
</span></code></pre></div> <p>å¦‚æœå°†è¿™ä¸ª Dockerfile è¿›è¡Œæ„å»ºé•œåƒè¿è¡Œåï¼Œä¼šå‘ç°æ‰¾ä¸åˆ° <code>/app/world.txt</code> æ–‡ä»¶ï¼Œæˆ–è€…å…¶å†…å®¹ä¸æ˜¯ <code>hello</code>ã€‚åŸå› å…¶å®å¾ˆç®€å•ï¼Œåœ¨ Shell ä¸­ï¼Œè¿ç»­ä¸¤è¡Œæ˜¯åŒä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œç¯å¢ƒï¼Œå› æ­¤å‰ä¸€ä¸ªå‘½ä»¤ä¿®æ”¹çš„å†…å­˜çŠ¶æ€ï¼Œä¼šç›´æ¥å½±å“åä¸€ä¸ªå‘½ä»¤ï¼›è€Œåœ¨ Dockerfile ä¸­ï¼Œè¿™ä¸¤è¡Œ <code>RUN</code> å‘½ä»¤çš„æ‰§è¡Œç¯å¢ƒæ ¹æœ¬ä¸åŒï¼Œæ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„å®¹å™¨ã€‚è¿™å°±æ˜¯å¯¹ Dockerfile æ„å»ºåˆ†å±‚å­˜å‚¨çš„æ¦‚å¿µä¸äº†è§£æ‰€å¯¼è‡´çš„é”™è¯¯ã€‚</p> <p>æ¯ä¸€ä¸ª <code>RUN</code> éƒ½æ˜¯å¯åŠ¨ä¸€ä¸ªå®¹å™¨ã€æ‰§è¡Œå‘½ä»¤ã€ç„¶åæäº¤å­˜å‚¨å±‚æ–‡ä»¶å˜æ›´ã€‚ç¬¬ä¸€å±‚ <code>RUN cd /app</code> çš„æ‰§è¡Œä»…ä»…æ˜¯å½“å‰è¿›ç¨‹çš„å·¥ä½œç›®å½•å˜æ›´ï¼Œä¸€ä¸ªå†…å­˜ä¸Šçš„å˜åŒ–è€Œå·²ï¼Œå…¶ç»“æœä¸ä¼šé€ æˆä»»ä½•æ–‡ä»¶å˜æ›´ã€‚è€Œåˆ°ç¬¬äºŒå±‚çš„æ—¶å€™ï¼Œå¯åŠ¨çš„æ˜¯ä¸€ä¸ªå…¨æ–°çš„å®¹å™¨ï¼Œè·Ÿç¬¬ä¸€å±‚çš„å®¹å™¨æ›´å®Œå…¨æ²¡å…³ç³»ï¼Œè‡ªç„¶ä¸å¯èƒ½ç»§æ‰¿å‰ä¸€å±‚æ„å»ºè¿‡ç¨‹ä¸­çš„å†…å­˜å˜åŒ–ã€‚</p> <p>å› æ­¤å¦‚æœéœ€è¦æ”¹å˜ä»¥åå„å±‚çš„å·¥ä½œç›®å½•çš„ä½ç½®ï¼Œé‚£ä¹ˆåº”è¯¥ä½¿ç”¨ <code>WORKDIR</code> æŒ‡ä»¤ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-138-1"><a id="__codelineno-138-1" name="__codelineno-138-1" href="#__codelineno-138-1"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
</span><span id="__span-138-2"><a id="__codelineno-138-2" name="__codelineno-138-2" href="#__codelineno-138-2"></a>
</span><span id="__span-138-3"><a id="__codelineno-138-3" name="__codelineno-138-3" href="#__codelineno-138-3"></a><span class="k">RUN</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">"hello"</span><span class="w"> </span>&gt;<span class="w"> </span>world.txt
</span></code></pre></div> <p>å¦‚æœä½ çš„ <code>WORKDIR</code> æŒ‡ä»¤ä½¿ç”¨çš„ç›¸å¯¹è·¯å¾„ï¼Œé‚£ä¹ˆæ‰€åˆ‡æ¢çš„è·¯å¾„ä¸ä¹‹å‰çš„ <code>WORKDIR</code> æœ‰å…³ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-139-1"><a id="__codelineno-139-1" name="__codelineno-139-1" href="#__codelineno-139-1"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/a</span>
</span><span id="__span-139-2"><a id="__codelineno-139-2" name="__codelineno-139-2" href="#__codelineno-139-2"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">b</span>
</span><span id="__span-139-3"><a id="__codelineno-139-3" name="__codelineno-139-3" href="#__codelineno-139-3"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">c</span>
</span><span id="__span-139-4"><a id="__codelineno-139-4" name="__codelineno-139-4" href="#__codelineno-139-4"></a>
</span><span id="__span-139-5"><a id="__codelineno-139-5" name="__codelineno-139-5" href="#__codelineno-139-5"></a><span class="k">RUN</span><span class="w"> </span>pwd
</span></code></pre></div> <p><code>RUN pwd</code> çš„å·¥ä½œç›®å½•ä¸º <code>/a/b/c</code>ã€‚</p> <h4 id="7210user">7.2.10ã€USER<a class="headerlink" href="#7210user" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><code>USER</code> æŒ‡ä»¤å’Œ <code>WORKDIR</code> ç›¸ä¼¼ï¼Œéƒ½æ˜¯æ”¹å˜ç¯å¢ƒçŠ¶æ€å¹¶å½±å“ä»¥åçš„å±‚ã€‚<code>WORKDIR</code> æ˜¯æ”¹å˜å·¥ä½œç›®å½•ï¼Œ<code>USER</code> åˆ™æ˜¯æ”¹å˜ä¹‹åå±‚çš„æ‰§è¡Œ <code>RUN</code>ã€<code>CMD</code> ä»¥åŠ <code>ENTRYPOINT</code> è¿™ç±»å‘½ä»¤çš„èº«ä»½ã€‚</p> <p>æ ¼å¼ä¸ºï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-140-1"><a id="__codelineno-140-1" name="__codelineno-140-1" href="#__codelineno-140-1"></a><span class="k">USER</span><span class="w"> </span><span class="s">&lt;ç”¨æˆ·å&gt;[:&lt;ç”¨æˆ·ç»„&gt;]</span>
</span></code></pre></div> <p>æ³¨æ„ï¼Œ<code>USER</code> åªæ˜¯å¸®åŠ©ä½ åˆ‡æ¢åˆ°æŒ‡å®šç”¨æˆ·è€Œå·²ï¼Œè¿™ä¸ªç”¨æˆ·å¿…é¡»æ˜¯äº‹å…ˆå»ºç«‹å¥½çš„ï¼Œå¦åˆ™æ— æ³•åˆ‡æ¢ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-141-1"><a id="__codelineno-141-1" name="__codelineno-141-1" href="#__codelineno-141-1"></a><span class="k">RUN</span><span class="w"> </span>groupadd<span class="w"> </span>-r<span class="w"> </span>redis<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>useradd<span class="w"> </span>-r<span class="w"> </span>-g<span class="w"> </span>redis<span class="w"> </span>redis
</span><span id="__span-141-2"><a id="__codelineno-141-2" name="__codelineno-141-2" href="#__codelineno-141-2"></a><span class="k">USER</span><span class="w"> </span><span class="s">redis</span>
</span><span id="__span-141-3"><a id="__codelineno-141-3" name="__codelineno-141-3" href="#__codelineno-141-3"></a><span class="k">RUN</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">"redis-server"</span><span class="w"> </span><span class="o">]</span>
</span></code></pre></div> <p>å¦‚æœä»¥ <code>root</code> æ‰§è¡Œçš„è„šæœ¬ï¼Œåœ¨æ‰§è¡ŒæœŸé—´å¸Œæœ›æ”¹å˜èº«ä»½ï¼Œæ¯”å¦‚å¸Œæœ›ä»¥æŸä¸ªå·²ç»å»ºç«‹å¥½çš„ç”¨æˆ·æ¥è¿è¡ŒæŸä¸ªæœåŠ¡è¿›ç¨‹ï¼Œä¸è¦ä½¿ç”¨ <code>su</code> æˆ–è€… <code>sudo</code>ï¼Œè¿™äº›éƒ½éœ€è¦æ¯”è¾ƒéº»çƒ¦çš„é…ç½®ï¼Œè€Œä¸”åœ¨ TTY ç¼ºå¤±çš„ç¯å¢ƒä¸‹ç»å¸¸å‡ºé”™ã€‚å»ºè®®ä½¿ç”¨ <a href="https://github.com/tianon/gosu"><code>gosu</code></a>ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-142-1"><a id="__codelineno-142-1" name="__codelineno-142-1" href="#__codelineno-142-1"></a><span class="c">## å»ºç«‹ redis ç”¨æˆ·ï¼Œå¹¶ä½¿ç”¨ gosu æ¢å¦ä¸€ä¸ªç”¨æˆ·æ‰§è¡Œå‘½ä»¤</span>
</span><span id="__span-142-2"><a id="__codelineno-142-2" name="__codelineno-142-2" href="#__codelineno-142-2"></a><span class="k">RUN</span><span class="w"> </span>groupadd<span class="w"> </span>-r<span class="w"> </span>redis<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>useradd<span class="w"> </span>-r<span class="w"> </span>-g<span class="w"> </span>redis<span class="w"> </span>redis
</span><span id="__span-142-3"><a id="__codelineno-142-3" name="__codelineno-142-3" href="#__codelineno-142-3"></a><span class="c">## ä¸‹è½½ gosu</span>
</span><span id="__span-142-4"><a id="__codelineno-142-4" name="__codelineno-142-4" href="#__codelineno-142-4"></a><span class="k">RUN</span><span class="w"> </span>wget<span class="w"> </span>-O<span class="w"> </span>/usr/local/bin/gosu<span class="w"> </span><span class="s2">"https://github.com/tianon/gosu/releases/download/1.12/gosu-amd64"</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-142-5"><a id="__codelineno-142-5" name="__codelineno-142-5" href="#__codelineno-142-5"></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>/usr/local/bin/gosu<span class="w"> </span><span class="se">\</span>
</span><span id="__span-142-6"><a id="__codelineno-142-6" name="__codelineno-142-6" href="#__codelineno-142-6"></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>gosu<span class="w"> </span>nobody<span class="w"> </span>true
</span><span id="__span-142-7"><a id="__codelineno-142-7" name="__codelineno-142-7" href="#__codelineno-142-7"></a><span class="c">## è®¾ç½® CMDï¼Œå¹¶ä»¥å¦å¤–çš„ç”¨æˆ·æ‰§è¡Œ</span>
</span><span id="__span-142-8"><a id="__codelineno-142-8" name="__codelineno-142-8" href="#__codelineno-142-8"></a><span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"exec"</span><span class="p">,</span><span class="w"> </span><span class="s2">"gosu"</span><span class="p">,</span><span class="w"> </span><span class="s2">"redis"</span><span class="p">,</span><span class="w"> </span><span class="s2">"redis-server"</span><span class="w"> </span><span class="p">]</span>
</span></code></pre></div> <h4 id="7211healthcheck">7.2.11ã€HEALTHCHECK<a class="headerlink" href="#7211healthcheck" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><code>HEALTHCHECK</code> æŒ‡ä»¤æ˜¯å‘Šè¯‰ Docker åº”è¯¥å¦‚ä½•è¿›è¡Œåˆ¤æ–­å®¹å™¨çš„çŠ¶æ€æ˜¯å¦æ­£å¸¸ï¼Œè¿™æ˜¯ Docker 1.12 å¼•å…¥çš„æ–°æŒ‡ä»¤ã€‚</p> <p>æ ¼å¼æœ‰ä¸¤ç§ï¼š</p> <ul> <li> <p>è®¾ç½®æ£€æŸ¥å®¹å™¨å¥åº·çŠ¶å†µçš„å‘½ä»¤ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-143-1"><a id="__codelineno-143-1" name="__codelineno-143-1" href="#__codelineno-143-1"></a><span class="k">HEALTHCHECK</span><span class="w"> </span><span class="o">[</span>é€‰é¡¹<span class="o">]</span><span class="w"> </span>CMD<span class="w"> </span>&lt;å‘½ä»¤&gt;
</span></code></pre></div> </li> <li> <p>å¦‚æœåŸºç¡€é•œåƒæœ‰å¥åº·æ£€æŸ¥æŒ‡ä»¤ï¼Œä½¿ç”¨è¿™è¡Œå¯ä»¥å±è”½æ‰å…¶å¥åº·æ£€æŸ¥æŒ‡ä»¤ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-144-1"><a id="__codelineno-144-1" name="__codelineno-144-1" href="#__codelineno-144-1"></a><span class="k">HEALTHCHECK</span><span class="w"> </span>NONE
</span></code></pre></div> </li> </ul> <p>åœ¨æ²¡æœ‰ <code>HEALTHCHECK</code> æŒ‡ä»¤å‰ï¼ŒDocker å¼•æ“åªå¯ä»¥é€šè¿‡å®¹å™¨å†…ä¸»è¿›ç¨‹æ˜¯å¦é€€å‡ºæ¥åˆ¤æ–­å®¹å™¨æ˜¯å¦çŠ¶æ€å¼‚å¸¸ã€‚å¾ˆå¤šæƒ…å†µä¸‹è¿™æ²¡é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœç¨‹åºè¿›å…¥æ­»é”çŠ¶æ€ï¼Œæˆ–è€…æ­»å¾ªç¯çŠ¶æ€ï¼Œåº”ç”¨è¿›ç¨‹å¹¶ä¸é€€å‡ºï¼Œä½†æ˜¯è¯¥å®¹å™¨å·²ç»æ— æ³•æä¾›æœåŠ¡äº†ã€‚åœ¨ 1.12 ä»¥å‰ï¼ŒDocker ä¸ä¼šæ£€æµ‹åˆ°å®¹å™¨çš„è¿™ç§çŠ¶æ€ï¼Œä»è€Œä¸ä¼šé‡æ–°è°ƒåº¦ï¼Œå¯¼è‡´å¯èƒ½ä¼šæœ‰éƒ¨åˆ†å®¹å™¨å·²ç»æ— æ³•æä¾›æœåŠ¡äº†å´è¿˜åœ¨æ¥å—ç”¨æˆ·è¯·æ±‚ã€‚</p> <p>è€Œè‡ª 1.12 ä¹‹åï¼ŒDocker æä¾›äº† <code>HEALTHCHECK</code> æŒ‡ä»¤ï¼Œé€šè¿‡è¯¥æŒ‡ä»¤æŒ‡å®šä¸€è¡Œå‘½ä»¤ï¼Œç”¨è¿™è¡Œå‘½ä»¤æ¥åˆ¤æ–­å®¹å™¨ä¸»è¿›ç¨‹çš„æœåŠ¡çŠ¶æ€æ˜¯å¦è¿˜æ­£å¸¸ï¼Œä»è€Œæ¯”è¾ƒçœŸå®çš„ååº”å®¹å™¨å®é™…çŠ¶æ€ã€‚</p> <p>å½“åœ¨ä¸€ä¸ªé•œåƒæŒ‡å®šäº† <code>HEALTHCHECK</code> æŒ‡ä»¤åï¼Œç”¨å…¶å¯åŠ¨å®¹å™¨ï¼Œåˆå§‹çŠ¶æ€ä¼šä¸º <code>starting</code>ï¼Œåœ¨ <code>HEALTHCHECK</code> æŒ‡ä»¤æ£€æŸ¥æˆåŠŸåå˜ä¸º <code>healthy</code>ï¼Œå¦‚æœè¿ç»­ä¸€å®šæ¬¡æ•°å¤±è´¥ï¼Œåˆ™ä¼šå˜ä¸º <code>unhealthy</code>ã€‚</p> <p><code>HEALTHCHECK</code> æ”¯æŒä¸‹åˆ—é€‰é¡¹ï¼š</p> <ul> <li><code>--interval=&lt;é—´éš”&gt;</code>ï¼šä¸¤æ¬¡å¥åº·æ£€æŸ¥çš„é—´éš”ï¼Œé»˜è®¤ä¸º 30 ç§’ã€‚</li> <li><code>--timeout=&lt;æ—¶é•¿&gt;</code>ï¼šå¥åº·æ£€æŸ¥å‘½ä»¤è¿è¡Œè¶…æ—¶æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œæœ¬æ¬¡å¥åº·æ£€æŸ¥å°±è¢«è§†ä¸ºå¤±è´¥ï¼Œé»˜è®¤ 30 ç§’ã€‚</li> <li><code>--retries=&lt;æ¬¡æ•°&gt;</code>ï¼šå½“è¿ç»­å¤±è´¥æŒ‡å®šæ¬¡æ•°åï¼Œåˆ™å°†å®¹å™¨çŠ¶æ€è§†ä¸º <code>unhealthy</code>ï¼Œé»˜è®¤ 3 æ¬¡ã€‚</li> </ul> <p>å’Œ <code>CMD</code>ã€<code>ENTRYPOINT</code> ä¸€æ ·ï¼Œ<code>HEALTHCHECK</code> åªå¯ä»¥å‡ºç°ä¸€æ¬¡ï¼Œå¦‚æœå†™äº†å¤šä¸ªï¼Œåªæœ‰æœ€åä¸€ä¸ªç”Ÿæ•ˆã€‚</p> <p>åœ¨ <code>HEALTHCHECK [é€‰é¡¹] CMD</code> åé¢çš„å‘½ä»¤ï¼Œæ ¼å¼å’Œ <code>ENTRYPOINT</code> ä¸€æ ·ï¼Œåˆ†ä¸º shell æ ¼å¼ï¼Œå’Œ exec æ ¼å¼ã€‚å‘½ä»¤çš„è¿”å›å€¼å†³å®šäº†è¯¥æ¬¡å¥åº·æ£€æŸ¥çš„æˆåŠŸä¸å¦ï¼š</p> <ul> <li><code>0</code>ï¼šæˆåŠŸã€‚</li> <li><code>1</code>ï¼šå¤±è´¥ã€‚</li> <li><code>2</code>ï¼šä¿ç•™ï¼Œä¸è¦ä½¿ç”¨è¿™ä¸ªå€¼ã€‚</li> </ul> <p>å‡è®¾æˆ‘ä»¬æœ‰ä¸ªé•œåƒæ˜¯ä¸ªæœ€ç®€å•çš„ Web æœåŠ¡ï¼Œæˆ‘ä»¬å¸Œæœ›å¢åŠ å¥åº·æ£€æŸ¥æ¥åˆ¤æ–­å…¶ Web æœåŠ¡æ˜¯å¦åœ¨æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>curl</code> æ¥å¸®åŠ©åˆ¤æ–­ï¼Œå…¶ Dockerfile çš„ <code>HEALTHCHECK</code> å¯ä»¥è¿™ä¹ˆå†™ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-145-1"><a id="__codelineno-145-1" name="__codelineno-145-1" href="#__codelineno-145-1"></a><span class="k">FROM</span><span class="w"> </span><span class="s">nginx</span>
</span><span id="__span-145-2"><a id="__codelineno-145-2" name="__codelineno-145-2" href="#__codelineno-145-2"></a><span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>curl<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*
</span><span id="__span-145-3"><a id="__codelineno-145-3" name="__codelineno-145-3" href="#__codelineno-145-3"></a><span class="k">HEALTHCHECK</span><span class="w"> </span>--interval<span class="o">=</span>5s<span class="w"> </span>--timeout<span class="o">=</span>3s<span class="w"> </span><span class="se">\</span>
</span><span id="__span-145-4"><a id="__codelineno-145-4" name="__codelineno-145-4" href="#__codelineno-145-4"></a><span class="w">  </span><span class="k">CMD</span><span class="w"> </span>curl<span class="w"> </span>-fs<span class="w"> </span>http://localhost/<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</span></code></pre></div> <p>è¿™é‡Œæˆ‘ä»¬è®¾ç½®äº†æ¯ 5 ç§’æ£€æŸ¥ä¸€æ¬¡ï¼ˆè¿™é‡Œä¸ºäº†è¯•éªŒæ‰€ä»¥é—´éš”éå¸¸çŸ­ï¼Œå®é™…åº”è¯¥ç›¸å¯¹è¾ƒé•¿ï¼‰ï¼Œå¦‚æœå¥åº·æ£€æŸ¥å‘½ä»¤è¶…è¿‡ 3 ç§’æ²¡å“åº”å°±è§†ä¸ºå¤±è´¥ï¼Œå¹¶ä¸”ä½¿ç”¨ <code>curl -fs http://localhost/ || exit 1</code> ä½œä¸ºå¥åº·æ£€æŸ¥å‘½ä»¤ã€‚</p> <p>ä½¿ç”¨ <code>docker build</code> æ¥æ„å»ºè¿™ä¸ªé•œåƒï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-146-1"><a id="__codelineno-146-1" name="__codelineno-146-1" href="#__codelineno-146-1"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>myweb:v1<span class="w"> </span>.
</span></code></pre></div> <p>æ„å»ºå¥½äº†åï¼Œæˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-147-1"><a id="__codelineno-147-1" name="__codelineno-147-1" href="#__codelineno-147-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>web<span class="w"> </span>-p<span class="w"> </span><span class="m">80</span>:80<span class="w"> </span>myweb:v1
</span></code></pre></div> <p>å½“è¿è¡Œè¯¥é•œåƒåï¼Œå¯ä»¥é€šè¿‡ <code>docker ps</code> çœ‹åˆ°æœ€åˆçš„çŠ¶æ€ä¸º <code>(health: starting)</code>ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-148-1"><a id="__codelineno-148-1" name="__codelineno-148-1" href="#__codelineno-148-1"></a>$ docker ps
</span><span id="__span-148-2"><a id="__codelineno-148-2" name="__codelineno-148-2" href="#__codelineno-148-2"></a>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                            PORTS               NAMES
</span><span id="__span-148-3"><a id="__codelineno-148-3" name="__codelineno-148-3" href="#__codelineno-148-3"></a>03e28eb00bd0        myweb:v1            "nginx -g 'daemon off"   3 seconds ago       Up 2 seconds (health: starting)   80/tcp, 443/tcp     web
</span></code></pre></div> <p>åœ¨ç­‰å¾…å‡ ç§’é’Ÿåï¼Œå†æ¬¡ <code>docker ps</code>ï¼Œå°±ä¼šçœ‹åˆ°å¥åº·çŠ¶æ€å˜åŒ–ä¸ºäº† <code>(healthy)</code>ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-149-1"><a id="__codelineno-149-1" name="__codelineno-149-1" href="#__codelineno-149-1"></a>$ docker ps
</span><span id="__span-149-2"><a id="__codelineno-149-2" name="__codelineno-149-2" href="#__codelineno-149-2"></a>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                    PORTS               NAMES
</span><span id="__span-149-3"><a id="__codelineno-149-3" name="__codelineno-149-3" href="#__codelineno-149-3"></a>03e28eb00bd0        myweb:v1            "nginx -g 'daemon off"   18 seconds ago      Up 16 seconds (healthy)   80/tcp, 443/tcp     web
</span></code></pre></div> <p>å¦‚æœå¥åº·æ£€æŸ¥è¿ç»­å¤±è´¥è¶…è¿‡äº†é‡è¯•æ¬¡æ•°ï¼ŒçŠ¶æ€å°±ä¼šå˜ä¸º <code>(unhealthy)</code>ã€‚</p> <p>ä¸ºäº†å¸®åŠ©æ’éšœï¼Œå¥åº·æ£€æŸ¥å‘½ä»¤çš„è¾“å‡ºï¼ˆåŒ…æ‹¬ <code>stdout</code> ä»¥åŠ <code>stderr</code>ï¼‰éƒ½ä¼šè¢«å­˜å‚¨äºå¥åº·çŠ¶æ€é‡Œï¼Œå¯ä»¥ç”¨ <code>docker inspect</code> æ¥æŸ¥çœ‹ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-150-1"><a id="__codelineno-150-1" name="__codelineno-150-1" href="#__codelineno-150-1"></a>$ docker inspect --format '{{json .State.Health}}' web | python -m json.tool
</span><span id="__span-150-2"><a id="__codelineno-150-2" name="__codelineno-150-2" href="#__codelineno-150-2"></a>{
</span><span id="__span-150-3"><a id="__codelineno-150-3" name="__codelineno-150-3" href="#__codelineno-150-3"></a>    "FailingStreak": 0,
</span><span id="__span-150-4"><a id="__codelineno-150-4" name="__codelineno-150-4" href="#__codelineno-150-4"></a>    "Log": [
</span><span id="__span-150-5"><a id="__codelineno-150-5" name="__codelineno-150-5" href="#__codelineno-150-5"></a>        {
</span><span id="__span-150-6"><a id="__codelineno-150-6" name="__codelineno-150-6" href="#__codelineno-150-6"></a>            "End": "2016-11-25T14:35:37.940957051Z",
</span><span id="__span-150-7"><a id="__codelineno-150-7" name="__codelineno-150-7" href="#__codelineno-150-7"></a>            "ExitCode": 0,
</span><span id="__span-150-8"><a id="__codelineno-150-8" name="__codelineno-150-8" href="#__codelineno-150-8"></a>            "Output": "&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Welcome to nginx!&lt;/title&gt;\n&lt;style&gt;\n    body {\n        width: 35em;\n        margin: 0 auto;\n        font-family: Tahoma, Verdana, Arial, sans-serif;\n    }\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;\n&lt;p&gt;If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.&lt;/p&gt;\n\n&lt;p&gt;For online documentation and support please refer to\n&lt;a href=\"http://nginx.org/\"&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;\nCommercial support is available at\n&lt;a href=\"http://nginx.com/\"&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n",
</span><span id="__span-150-9"><a id="__codelineno-150-9" name="__codelineno-150-9" href="#__codelineno-150-9"></a>            "Start": "2016-11-25T14:35:37.780192565Z"
</span><span id="__span-150-10"><a id="__codelineno-150-10" name="__codelineno-150-10" href="#__codelineno-150-10"></a>        }
</span><span id="__span-150-11"><a id="__codelineno-150-11" name="__codelineno-150-11" href="#__codelineno-150-11"></a>    ],
</span><span id="__span-150-12"><a id="__codelineno-150-12" name="__codelineno-150-12" href="#__codelineno-150-12"></a>    "Status": "healthy"
</span><span id="__span-150-13"><a id="__codelineno-150-13" name="__codelineno-150-13" href="#__codelineno-150-13"></a>}
</span></code></pre></div> <h4 id="7212onbuild">7.2.12ã€ONBUILD<a class="headerlink" href="#7212onbuild" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><code>ONBUILD</code> æ˜¯ Dockerfile ä¸­çš„ä¸€ä¸ªç‰¹æ®ŠæŒ‡ä»¤ï¼Œå®ƒåé¢è·Ÿçš„æ˜¯å…¶å®ƒæŒ‡ä»¤ï¼Œæ¯”å¦‚ <code>RUN</code>ã€<code>COPY</code> ç­‰ï¼Œç”¨äºä¸ºå­é•œåƒè®¾ç½®è§¦å‘å™¨ï¼ˆtriggerï¼‰ï¼Œå³ï¼šå½“ä»¥å½“å‰é•œåƒä¸ºåŸºç¡€æ„å»ºå¦ä¸€ä¸ªé•œåƒæ—¶ï¼Œ<code>ONBUILD</code> ä¸­çš„æŒ‡ä»¤æ‰ä¼šæ‰§è¡Œã€‚</p> <p>æ ¼å¼ä¸ºï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-151-1"><a id="__codelineno-151-1" name="__codelineno-151-1" href="#__codelineno-151-1"></a><span class="k">ONBUILD</span><span class="w"> </span>&lt;å…¶å®ƒæŒ‡ä»¤&gt;
</span></code></pre></div> <p>Dockerfile ä¸­çš„å…¶å®ƒæŒ‡ä»¤éƒ½æ˜¯ä¸ºäº†å®šåˆ¶å½“å‰é•œåƒè€Œå‡†å¤‡çš„ï¼Œå”¯æœ‰ <code>ONBUILD</code> æ˜¯ä¸ºäº†å¸®åŠ©åˆ«äººå®šåˆ¶è‡ªå·±è€Œå‡†å¤‡çš„ã€‚</p> <p><strong>ä¸ºå¤šé¡¹ç›®åˆ›å»ºç»Ÿä¸€çš„æ„å»ºæ¨¡æ¿</strong></p> <p>å‡è®¾ä½ æœ‰å¤šä¸ªé¡¹ç›®ï¼Œå®ƒä»¬çš„æ„å»ºæ­¥éª¤ç±»ä¼¼ï¼Œæ¯”å¦‚ï¼š</p> <ul> <li>æŠŠæºç å¤åˆ¶è¿›å»</li> <li>å®‰è£…ä¾èµ–</li> <li>ç¼–è¯‘æˆ–æ‰“åŒ…</li> </ul> <p>ä½ å¯ä»¥åšä¸€ä¸ªç»Ÿä¸€çš„åŸºç¡€é•œåƒï¼Œæ¯”å¦‚ Java é¡¹ç›®æ‰“åŒ…é•œåƒï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-152-1"><a id="__codelineno-152-1" name="__codelineno-152-1" href="#__codelineno-152-1"></a><span class="c">## Dockerfile for base image</span>
</span><span id="__span-152-2"><a id="__codelineno-152-2" name="__codelineno-152-2" href="#__codelineno-152-2"></a><span class="k">FROM</span><span class="w"> </span><span class="s">maven:3.8.6-openjdk-17</span>
</span><span id="__span-152-3"><a id="__codelineno-152-3" name="__codelineno-152-3" href="#__codelineno-152-3"></a>
</span><span id="__span-152-4"><a id="__codelineno-152-4" name="__codelineno-152-4" href="#__codelineno-152-4"></a><span class="c">## è®¾ç½®è§¦å‘å™¨ï¼šå½“åˆ«äºº FROM è¿™ä¸ªé•œåƒæ—¶ä¼šæ‰§è¡Œä¸‹é¢æŒ‡ä»¤</span>
</span><span id="__span-152-5"><a id="__codelineno-152-5" name="__codelineno-152-5" href="#__codelineno-152-5"></a><span class="k">ONBUILD</span><span class="w"> </span><span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>/app
</span><span id="__span-152-6"><a id="__codelineno-152-6" name="__codelineno-152-6" href="#__codelineno-152-6"></a><span class="k">ONBUILD</span><span class="w"> </span><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
</span><span id="__span-152-7"><a id="__codelineno-152-7" name="__codelineno-152-7" href="#__codelineno-152-7"></a><span class="k">ONBUILD</span><span class="w"> </span><span class="k">RUN</span><span class="w"> </span>mvn<span class="w"> </span>clean<span class="w"> </span>package
</span></code></pre></div> <p>ç„¶åä½ åœ¨é¡¹ç›®ä¸­ç”¨è¿™ä¸ªé•œåƒï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-153-1"><a id="__codelineno-153-1" name="__codelineno-153-1" href="#__codelineno-153-1"></a><span class="c">## Project-specific Dockerfile</span>
</span><span id="__span-153-2"><a id="__codelineno-153-2" name="__codelineno-153-2" href="#__codelineno-153-2"></a><span class="k">FROM</span><span class="w"> </span><span class="s">yourcompany/maven-base:latest</span>
</span><span id="__span-153-3"><a id="__codelineno-153-3" name="__codelineno-153-3" href="#__codelineno-153-3"></a><span class="c">## ä¸éœ€è¦å†å†™ COPY å’Œ RUNï¼ŒONBUILD ä¼šè‡ªåŠ¨æ‰§è¡Œ</span>
</span></code></pre></div> <p><strong>å…¬å¸ç»Ÿä¸€æ„å»ºè§„èŒƒ</strong></p> <p>å½“å…¬å¸æœ‰ç»Ÿä¸€æ„å»ºç­–ç•¥ï¼Œä¾‹å¦‚ Node.js åº”ç”¨éƒ½éœ€è¦è¿è¡Œ ESLint å’Œæµ‹è¯•ï¼Œä½ å¯ä»¥åˆ›å»ºè¿™æ ·çš„åŸºç¡€é•œåƒï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-154-1"><a id="__codelineno-154-1" name="__codelineno-154-1" href="#__codelineno-154-1"></a><span class="k">FROM</span><span class="w"> </span><span class="s">node:20</span>
</span><span id="__span-154-2"><a id="__codelineno-154-2" name="__codelineno-154-2" href="#__codelineno-154-2"></a>
</span><span id="__span-154-3"><a id="__codelineno-154-3" name="__codelineno-154-3" href="#__codelineno-154-3"></a><span class="k">ONBUILD</span><span class="w"> </span><span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>/app
</span><span id="__span-154-4"><a id="__codelineno-154-4" name="__codelineno-154-4" href="#__codelineno-154-4"></a><span class="k">ONBUILD</span><span class="w"> </span><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
</span><span id="__span-154-5"><a id="__codelineno-154-5" name="__codelineno-154-5" href="#__codelineno-154-5"></a><span class="k">ONBUILD</span><span class="w"> </span><span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>install
</span><span id="__span-154-6"><a id="__codelineno-154-6" name="__codelineno-154-6" href="#__codelineno-154-6"></a><span class="k">ONBUILD</span><span class="w"> </span><span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>lint
</span><span id="__span-154-7"><a id="__codelineno-154-7" name="__codelineno-154-7" href="#__codelineno-154-7"></a><span class="k">ONBUILD</span><span class="w"> </span><span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>test
</span></code></pre></div> <h4 id="7213label">7.2.13ã€LABEL<a class="headerlink" href="#7213label" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><code>LABEL</code> æŒ‡ä»¤ç”¨æ¥ç»™é•œåƒä»¥é”®å€¼å¯¹çš„å½¢å¼æ·»åŠ ä¸€äº›å…ƒæ•°æ®ï¼ˆmetadataï¼‰ã€‚</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-155-1"><a id="__codelineno-155-1" name="__codelineno-155-1" href="#__codelineno-155-1"></a><span class="k">LABEL</span><span class="w"> </span>&lt;key&gt;<span class="o">=</span>&lt;value&gt;<span class="w"> </span>&lt;key&gt;<span class="o">=</span>&lt;value&gt;<span class="w"> </span>&lt;key&gt;<span class="o">=</span>&lt;value&gt;<span class="w"> </span>...
</span></code></pre></div> <p>æˆ‘ä»¬è¿˜å¯ä»¥ç”¨ä¸€äº›æ ‡ç­¾æ¥ç”³æ˜é•œåƒçš„ä½œè€…ã€æ–‡æ¡£åœ°å€ç­‰ï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-156-1"><a id="__codelineno-156-1" name="__codelineno-156-1" href="#__codelineno-156-1"></a><span class="k">LABEL</span><span class="w"> </span>org.opencontainers.image.authors<span class="o">=</span><span class="s2">"yeasy"</span>
</span><span id="__span-156-2"><a id="__codelineno-156-2" name="__codelineno-156-2" href="#__codelineno-156-2"></a>
</span><span id="__span-156-3"><a id="__codelineno-156-3" name="__codelineno-156-3" href="#__codelineno-156-3"></a><span class="k">LABEL</span><span class="w"> </span>org.opencontainers.image.documentation<span class="o">=</span><span class="s2">"https://yeasy.gitbooks.io"</span>
</span></code></pre></div> <p>å…·ä½“å¯ä»¥å‚è€ƒ https://github.com/opencontainers/image-spec/blob/master/annotations.md</p> <h4 id="7214shell">7.2.14ã€SHELL<a class="headerlink" href="#7214shell" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p><code>SHELL</code> æŒ‡ä»¤å¯ä»¥æŒ‡å®š <code>RUN</code>ã€<code>ENTRYPOINT</code> å’Œ <code>CMD</code> æŒ‡ä»¤çš„ shellï¼ŒLinux ä¸­é»˜è®¤ä¸º <code>["/bin/sh", "-c"]</code>ã€‚</p> <p>æ ¼å¼ä¸ºï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-157-1"><a id="__codelineno-157-1" name="__codelineno-157-1" href="#__codelineno-157-1"></a><span class="k">SHELL</span><span class="w"> </span><span class="p">[</span><span class="s2">"executable"</span><span class="p">,</span><span class="w"> </span><span class="s2">"parameters"</span><span class="p">]</span>
</span></code></pre></div> <p>ä¸¤ä¸ª <code>RUN</code> è¿è¡ŒåŒä¸€å‘½ä»¤ï¼Œç¬¬äºŒä¸ª <code>RUN</code> è¿è¡Œçš„å‘½ä»¤ä¼šæ‰“å°å‡ºæ¯æ¡å‘½ä»¤å¹¶å½“é‡åˆ°é”™è¯¯æ—¶é€€å‡ºï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-158-1"><a id="__codelineno-158-1" name="__codelineno-158-1" href="#__codelineno-158-1"></a><span class="k">SHELL</span><span class="w"> </span><span class="p">[</span><span class="s2">"/bin/sh"</span><span class="p">,</span><span class="w"> </span><span class="s2">"-c"</span><span class="p">]</span>
</span><span id="__span-158-2"><a id="__codelineno-158-2" name="__codelineno-158-2" href="#__codelineno-158-2"></a>
</span><span id="__span-158-3"><a id="__codelineno-158-3" name="__codelineno-158-3" href="#__codelineno-158-3"></a><span class="k">RUN</span><span class="w"> </span>lll<span class="w"> </span><span class="p">;</span><span class="w"> </span>ls
</span><span id="__span-158-4"><a id="__codelineno-158-4" name="__codelineno-158-4" href="#__codelineno-158-4"></a>
</span><span id="__span-158-5"><a id="__codelineno-158-5" name="__codelineno-158-5" href="#__codelineno-158-5"></a><span class="k">SHELL</span><span class="w"> </span><span class="p">[</span><span class="s2">"/bin/sh"</span><span class="p">,</span><span class="w"> </span><span class="s2">"-cex"</span><span class="p">]</span>
</span><span id="__span-158-6"><a id="__codelineno-158-6" name="__codelineno-158-6" href="#__codelineno-158-6"></a>
</span><span id="__span-158-7"><a id="__codelineno-158-7" name="__codelineno-158-7" href="#__codelineno-158-7"></a><span class="k">RUN</span><span class="w"> </span>lll<span class="w"> </span><span class="p">;</span><span class="w"> </span>ls
</span></code></pre></div> <p>å½“ <code>ENTRYPOINT</code>ã€<code>CMD</code> ä»¥ shell æ ¼å¼æŒ‡å®šæ—¶ï¼Œ<code>SHELL</code> æŒ‡ä»¤æ‰€æŒ‡å®šçš„ shell ä¹Ÿä¼šæˆä¸ºè¿™ä¸¤ä¸ªæŒ‡ä»¤çš„ shellï¼š</p> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-159-1"><a id="__codelineno-159-1" name="__codelineno-159-1" href="#__codelineno-159-1"></a><span class="k">SHELL</span><span class="w"> </span><span class="p">[</span><span class="s2">"/bin/sh"</span><span class="p">,</span><span class="w"> </span><span class="s2">"-cex"</span><span class="p">]</span>
</span><span id="__span-159-2"><a id="__codelineno-159-2" name="__codelineno-159-2" href="#__codelineno-159-2"></a>
</span><span id="__span-159-3"><a id="__codelineno-159-3" name="__codelineno-159-3" href="#__codelineno-159-3"></a><span class="c">## /bin/sh -cex "nginx"</span>
</span><span id="__span-159-4"><a id="__codelineno-159-4" name="__codelineno-159-4" href="#__codelineno-159-4"></a><span class="k">ENTRYPOINT</span><span class="w"> </span>nginx
</span></code></pre></div> <div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-160-1"><a id="__codelineno-160-1" name="__codelineno-160-1" href="#__codelineno-160-1"></a><span class="k">SHELL</span><span class="w"> </span><span class="p">[</span><span class="s2">"/bin/sh"</span><span class="p">,</span><span class="w"> </span><span class="s2">"-cex"</span><span class="p">]</span>
</span><span id="__span-160-2"><a id="__codelineno-160-2" name="__codelineno-160-2" href="#__codelineno-160-2"></a>
</span><span id="__span-160-3"><a id="__codelineno-160-3" name="__codelineno-160-3" href="#__codelineno-160-3"></a><span class="c">## /bin/sh -cex "nginx"</span>
</span><span id="__span-160-4"><a id="__codelineno-160-4" name="__codelineno-160-4" href="#__codelineno-160-4"></a><span class="k">CMD</span><span class="w"> </span>nginx
</span></code></pre></div> <h3 id="73docker-buildx">7.3ã€Docker Buildx<a class="headerlink" href="#73docker-buildx" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>Docker Buildx æ˜¯ä¸€ä¸ª Docker CLI æ’ä»¶ï¼Œå…¶æ‰©å±•äº† Docker å‘½ä»¤ï¼Œæ”¯æŒ <a href="https://yeasy.gitbook.io/docker_practice/buildx/buildkit">Moby BuildKit</a> æä¾›çš„åŠŸèƒ½ã€‚æä¾›äº†ä¸ <code>docker build</code> ç›¸åŒçš„ç”¨æˆ·ä½“éªŒï¼Œå¹¶å¢åŠ äº†è®¸å¤šæ–°åŠŸèƒ½ã€‚</p> <div class="admonition tip"> <p class="admonition-title">Important</p> <p>è¯¥åŠŸèƒ½ä»…é€‚ç”¨äº Docker v19.03+ ç‰ˆæœ¬ã€‚</p> </div> <aside class="md-source-file"> <span class="md-source-file__fact"> <span class="md-icon" title="æœ€åæ›´æ–°"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2026å¹´1æœˆ22æ—¥ 20:21:58 UTC">2026å¹´1æœˆ22æ—¥ 20:21:58</span> </span> <span class="md-source-file__fact"> <span class="md-icon" title="åˆ›å»ºæ—¥æœŸ"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2024å¹´9æœˆ15æ—¥ 18:47:26 UTC">2024å¹´9æœˆ15æ—¥ 18:47:26</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type="button" class="md-top md-icon" data-md-component="top" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> å›åˆ°é¡µé¢é¡¶éƒ¨ </button> </main> <footer class="md-footer"> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.top", "navigation.tracking", "navigation.instant", "navigation.path", "content.tabs.link", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script> <script src="../assets/javascripts/bundle.79ae519e.min.js"></script> <script src="../_javascripts/auto_title.js"></script>  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>