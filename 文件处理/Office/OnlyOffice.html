<!DOCTYPE html><html lang="zh" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://0richalcos.github.io/Note/%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/Office/OnlyOffice.html"><link rel="prev" href="EasyExcel.html"><link rel="next" href="Poi-tl.html"><link rel="icon" href="../../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>OnlyOffice - éšä¾¿è®°è®°</title><link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css"><link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel="stylesheet" href="../../_stylesheets/extra.css"><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal"> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a href="#1onlyoffice" class="md-skip"> è·³è½¬è‡³ </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow" data-md-component="header"> <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰"> <a href="../../index.html" title="éšä¾¿è®°è®°" class="md-header__button md-logo" aria-label="éšä¾¿è®°è®°" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> éšä¾¿è®°è®° </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> OnlyOffice </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input class="md-option" data-md-color-media data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal" aria-label="åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼" type="radio" name="__palette" id="__palette_0"> <label class="md-header__button md-icon" title="åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼" for="__palette_1" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> <input class="md-option" data-md-color-media data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal" aria-label="åˆ‡æ¢åˆ°äº®è‰²æ¨¡å¼" type="radio" name="__palette" id="__palette_1"> <label class="md-header__button md-icon" title="åˆ‡æ¢åˆ°äº®è‰²æ¨¡å¼" for="__palette_0" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <div class="md-header__source"> <a href="https://github.com/0richalcos/Note" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> GitHub </div> </a> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--primary" aria-label="å¯¼èˆªæ " data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a href="../../index.html" title="éšä¾¿è®°è®°" class="md-nav__button md-logo" aria-label="éšä¾¿è®°è®°" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> éšä¾¿è®°è®° </label> <div class="md-nav__source"> <a href="https://github.com/0richalcos/Note" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> GitHub </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../index.html" class="md-nav__link"> <span class="md-ellipsis"> ğŸ  é¦–é¡µ </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2"> <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0"> <span class="md-ellipsis"> â™¨ï¸ Java </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> â™¨ï¸ Java </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../Java/Java.html" class="md-nav__link"> <span class="md-ellipsis"> Java </span> </a> </li> <li class="md-nav__item"> <a href="../../Java/Java8.html" class="md-nav__link"> <span class="md-ellipsis"> Java 8 </span> </a> </li> <li class="md-nav__item"> <a href="../../Java/JavaBasics.html" class="md-nav__link"> <span class="md-ellipsis"> Java åŸºç¡€ </span> </a> </li> <li class="md-nav__item"> <a href="../../Java/JavaCollection.html" class="md-nav__link"> <span class="md-ellipsis"> Java é›†åˆ </span> </a> </li> <li class="md-nav__item"> <a href="../../Java/JavaObject.html" class="md-nav__link"> <span class="md-ellipsis"> Java ç±»å’Œå¯¹è±¡ </span> </a> </li> <li class="md-nav__item"> <a href="../../Java/JavaWeb.html" class="md-nav__link"> <span class="md-ellipsis"> JavaWeb </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3"> <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0"> <span class="md-ellipsis"> ğŸ§® æ•°æ®ç»“æ„åŠç®—æ³• </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> ğŸ§® æ•°æ®ç»“æ„åŠç®—æ³• </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E7%AE%97%E6%B3%95/Algorithm.html" class="md-nav__link"> <span class="md-ellipsis"> Algorithm </span> </a> </li> <li class="md-nav__item"> <a href="../../%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E7%AE%97%E6%B3%95/DesignPattern.html" class="md-nav__link"> <span class="md-ellipsis"> DesignPattern </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4"> <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0"> <span class="md-ellipsis"> ğŸƒ Spring </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> ğŸƒ Spring </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../Spring/Spring.html" class="md-nav__link"> <span class="md-ellipsis"> Spring </span> </a> </li> <li class="md-nav__item"> <a href="../../Spring/SpringBoot.html" class="md-nav__link"> <span class="md-ellipsis"> SpringBoot </span> </a> </li> <li class="md-nav__item"> <a href="../../Spring/SpringCloud.html" class="md-nav__link"> <span class="md-ellipsis"> SpringCloud </span> </a> </li> <li class="md-nav__item"> <a href="../../Spring/SpringMVC.html" class="md-nav__link"> <span class="md-ellipsis"> SpringMVC </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5"> <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0"> <span class="md-ellipsis"> ğŸ’¾ æŒä¹…å±‚æ¡†æ¶ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> ğŸ’¾ æŒä¹…å±‚æ¡†æ¶ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6/MyBatis-Plus.html" class="md-nav__link"> <span class="md-ellipsis"> MyBatis-Plus </span> </a> </li> <li class="md-nav__item"> <a href="../../%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6/Mybatis.html" class="md-nav__link"> <span class="md-ellipsis"> Mybatis </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6"> <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0"> <span class="md-ellipsis"> ğŸ” è®¤è¯ä¸æˆæƒ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> ğŸ” è®¤è¯ä¸æˆæƒ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/SSO.html" class="md-nav__link"> <span class="md-ellipsis"> SSO </span> </a> </li> <li class="md-nav__item"> <a href="../../%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/Sa-Token.html" class="md-nav__link"> <span class="md-ellipsis"> Sa-Token </span> </a> </li> <li class="md-nav__item"> <a href="../../%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/Shiro.html" class="md-nav__link"> <span class="md-ellipsis"> Shiro </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7"> <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0"> <span class="md-ellipsis"> ğŸŒ å‰ç«¯ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> ğŸŒ å‰ç«¯ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../%E5%89%8D%E7%AB%AF/CSS.html" class="md-nav__link"> <span class="md-ellipsis"> CSS </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%89%8D%E7%AB%AF/JavaScript.html" class="md-nav__link"> <span class="md-ellipsis"> JavaScript </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%89%8D%E7%AB%AF/Vue.html" class="md-nav__link"> <span class="md-ellipsis"> Vue </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%89%8D%E7%AB%AF/jQuery.html" class="md-nav__link"> <span class="md-ellipsis"> jQuery </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%89%8D%E7%AB%AF/%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/Thymeleaf.html" class="md-nav__link"> <span class="md-ellipsis"> Thymeleaf </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6"> <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0"> <span class="md-ellipsis"> ç»„ä»¶åº“ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_7_6"> <span class="md-nav__icon md-icon"></span> ç»„ä»¶åº“ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/AntV-X6.html" class="md-nav__link"> <span class="md-ellipsis"> AntV-X6 </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/ApacheECharts.html" class="md-nav__link"> <span class="md-ellipsis"> ApacheECharts </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/Axios.html" class="md-nav__link"> <span class="md-ellipsis"> Axios </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/BootstrapTable.html" class="md-nav__link"> <span class="md-ellipsis"> BootstrapTable </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/DHTMLXGantt.html" class="md-nav__link"> <span class="md-ellipsis"> DHTMLXGantt </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/Element.html" class="md-nav__link"> <span class="md-ellipsis"> Element </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/FullCalendar.html" class="md-nav__link"> <span class="md-ellipsis"> FullCalendar </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%89%8D%E7%AB%AF/%E7%BB%84%E4%BB%B6%E5%BA%93/X-editable.html" class="md-nav__link"> <span class="md-ellipsis"> X-editable </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8"> <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0"> <span class="md-ellipsis"> ğŸ“Š æ•°æ®åº“ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_8"> <span class="md-nav__icon md-icon"></span> ğŸ“Š æ•°æ®åº“ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../%E6%95%B0%E6%8D%AE%E5%BA%93/Dameng.html" class="md-nav__link"> <span class="md-ellipsis"> Dameng </span> </a> </li> <li class="md-nav__item"> <a href="../../%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL.html" class="md-nav__link"> <span class="md-ellipsis"> MySQL </span> </a> </li> <li class="md-nav__item"> <a href="../../%E6%95%B0%E6%8D%AE%E5%BA%93/MySQLQuery.html" class="md-nav__link"> <span class="md-ellipsis"> MySQLQuery </span> </a> </li> <li class="md-nav__item"> <a href="../../%E6%95%B0%E6%8D%AE%E5%BA%93/OceanBase.html" class="md-nav__link"> <span class="md-ellipsis"> OceanBase </span> </a> </li> <li class="md-nav__item"> <a href="../../%E6%95%B0%E6%8D%AE%E5%BA%93/Oracle.html" class="md-nav__link"> <span class="md-ellipsis"> Oracle </span> </a> </li> <li class="md-nav__item"> <a href="../../%E6%95%B0%E6%8D%AE%E5%BA%93/Redis.html" class="md-nav__link"> <span class="md-ellipsis"> Redis </span> </a> </li> <li class="md-nav__item"> <a href="../../%E6%95%B0%E6%8D%AE%E5%BA%93/Vastbase.html" class="md-nav__link"> <span class="md-ellipsis"> Vastbase </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/Elasticsearch.html" class="md-nav__link"> <span class="md-ellipsis"> Elasticsearch </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10"> <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0"> <span class="md-ellipsis"> ğŸ“‡ åˆ†å¸ƒå¼å­˜å‚¨ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_10"> <span class="md-nav__icon md-icon"></span> ğŸ“‡ åˆ†å¸ƒå¼å­˜å‚¨ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/FastDFS.html" class="md-nav__link"> <span class="md-ellipsis"> FastDFS </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/MinIO.html" class="md-nav__link"> <span class="md-ellipsis"> MinIO </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11"> <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0"> <span class="md-ellipsis"> ğŸ›°ï¸ ç½‘ç»œé€šä¿¡ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_11"> <span class="md-nav__icon md-icon"></span> ğŸ›°ï¸ ç½‘ç»œé€šä¿¡ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/Encryption.html" class="md-nav__link"> <span class="md-ellipsis"> Encryption </span> </a> </li> <li class="md-nav__item"> <a href="../../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/HTTP.html" class="md-nav__link"> <span class="md-ellipsis"> HTTP </span> </a> </li> <li class="md-nav__item"> <a href="../../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/OpenVPN.html" class="md-nav__link"> <span class="md-ellipsis"> OpenVPN </span> </a> </li> <li class="md-nav__item"> <a href="../../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/VNC.html" class="md-nav__link"> <span class="md-ellipsis"> VNC </span> </a> </li> <li class="md-nav__item"> <a href="../../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/WebSocket.html" class="md-nav__link"> <span class="md-ellipsis"> WebSocket </span> </a> </li> <li class="md-nav__item"> <a href="../../%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/frp.html" class="md-nav__link"> <span class="md-ellipsis"> frp </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" checked> <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0"> <span class="md-ellipsis"> ğŸ—ƒï¸ æ–‡ä»¶å¤„ç† </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="true"> <label class="md-nav__title" for="__nav_12"> <span class="md-nav__icon md-icon"></span> ğŸ—ƒï¸ æ–‡ä»¶å¤„ç† </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_1" checked> <label class="md-nav__link" for="__nav_12_1" id="__nav_12_1_label" tabindex="0"> <span class="md-ellipsis"> Office </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_1_label" aria-expanded="true"> <label class="md-nav__title" for="__nav_12_1"> <span class="md-nav__icon md-icon"></span> Office </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="ApachePOI.html" class="md-nav__link"> <span class="md-ellipsis"> ApachePOI </span> </a> </li> <li class="md-nav__item"> <a href="EasyExcel.html" class="md-nav__link"> <span class="md-ellipsis"> EasyExcel </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc"> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> OnlyOffice </span> <span class="md-nav__icon md-icon"></span> </label> <a href="OnlyOffice.html" class="md-nav__link md-nav__link--active"> <span class="md-ellipsis"> OnlyOffice </span> </a> <nav class="md-nav md-nav--secondary" aria-label="ç›®å½•"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> ç›®å½• </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#1onlyoffice" class="md-nav__link"> <span class="md-ellipsis"> 1ã€OnlyOffice </span> </a> <nav class="md-nav" aria-label="1ã€OnlyOffice"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#11åŸºæœ¬æ¦‚å¿µå’Œå®‰è£…" class="md-nav__link"> <span class="md-ellipsis"> 1.1ã€åŸºæœ¬æ¦‚å¿µå’Œå®‰è£… </span> </a> <nav class="md-nav" aria-label="1.1ã€åŸºæœ¬æ¦‚å¿µå’Œå®‰è£…"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#111-docker-å®‰è£…" class="md-nav__link"> <span class="md-ellipsis"> 1.1.1ã€ Docker å®‰è£… </span> </a> <nav class="md-nav" aria-label="1.1.1ã€ Docker å®‰è£…"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#å®‰è£…" class="md-nav__link"> <span class="md-ellipsis"> å®‰è£… </span> </a> </li> <li class="md-nav__item"> <a href="#å¸¸ç”¨å‘½ä»¤" class="md-nav__link"> <span class="md-ellipsis"> å¸¸ç”¨å‘½ä»¤ </span> </a> </li> <li class="md-nav__item"> <a href="#nginx-ä»£ç†" class="md-nav__link"> <span class="md-ellipsis"> Nginx ä»£ç† </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#12ç®€å•ç¤ºä¾‹" class="md-nav__link"> <span class="md-ellipsis"> 1.2ã€ç®€å•ç¤ºä¾‹ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#2å·¥ä½œåŸç†åŠå®è·µ" class="md-nav__link"> <span class="md-ellipsis"> 2ã€å·¥ä½œåŸç†åŠå®è·µ </span> </a> <nav class="md-nav" aria-label="2ã€å·¥ä½œåŸç†åŠå®è·µ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#21æ‰“å¼€æ–‡ä»¶" class="md-nav__link"> <span class="md-ellipsis"> 2.1ã€æ‰“å¼€æ–‡ä»¶ </span> </a> </li> <li class="md-nav__item"> <a href="#22ä¿å­˜æ–‡ä»¶" class="md-nav__link"> <span class="md-ellipsis"> 2.2ã€ä¿å­˜æ–‡ä»¶ </span> </a> </li> <li class="md-nav__item"> <a href="#33å®¡é˜…" class="md-nav__link"> <span class="md-ellipsis"> 3.3ã€å®¡é˜… </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#3æ–‡æ¡£" class="md-nav__link"> <span class="md-ellipsis"> 3ã€æ–‡æ¡£ </span> </a> <nav class="md-nav" aria-label="3ã€æ–‡æ¡£"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#31é«˜çº§å‚æ•°" class="md-nav__link"> <span class="md-ellipsis"> 3.1ã€é«˜çº§å‚æ•° </span> </a> </li> <li class="md-nav__item"> <a href="#32config" class="md-nav__link"> <span class="md-ellipsis"> 3.2ã€Config </span> </a> <nav class="md-nav" aria-label="3.2ã€Config"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#document" class="md-nav__link"> <span class="md-ellipsis"> Document </span> </a> <nav class="md-nav" aria-label="Document"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#info" class="md-nav__link"> <span class="md-ellipsis"> Info </span> </a> </li> <li class="md-nav__item"> <a href="#permissions" class="md-nav__link"> <span class="md-ellipsis"> Permissions </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#4æ•…éšœæ’é™¤" class="md-nav__link"> <span class="md-ellipsis"> 4ã€æ•…éšœæ’é™¤ </span> </a> <nav class="md-nav" aria-label="4ã€æ•…éšœæ’é™¤"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#411ä¸‹è½½å¤±è´¥" class="md-nav__link"> <span class="md-ellipsis"> 4.1.1ã€ä¸‹è½½å¤±è´¥ </span> </a> </li> <li class="md-nav__item"> <a href="#412æ–‡ä»¶ç‰ˆæœ¬å˜æ›´" class="md-nav__link"> <span class="md-ellipsis"> 4.1.2ã€æ–‡ä»¶ç‰ˆæœ¬å˜æ›´ </span> </a> </li> <li class="md-nav__item"> <a href="#413403-editorbin" class="md-nav__link"> <span class="md-ellipsis"> 4.1.3ã€403 Editor.bin </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#5å‰ç«¯æ¡†æ¶" class="md-nav__link"> <span class="md-ellipsis"> 5ã€å‰ç«¯æ¡†æ¶ </span> </a> <nav class="md-nav" aria-label="5ã€å‰ç«¯æ¡†æ¶"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#51vue-2x" class="md-nav__link"> <span class="md-ellipsis"> 5.1ã€Vue 2.x </span> </a> <nav class="md-nav" aria-label="5.1ã€Vue 2.x"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#511utilsjs" class="md-nav__link"> <span class="md-ellipsis"> 5.1.1ã€utils.js </span> </a> </li> <li class="md-nav__item"> <a href="#512doceditorvue" class="md-nav__link"> <span class="md-ellipsis"> 5.1.2ã€DocEditor.vue </span> </a> </li> <li class="md-nav__item"> <a href="#513docdialogvue" class="md-nav__link"> <span class="md-ellipsis"> 5.1.3ã€DocDialog.vue </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="Poi-tl.html" class="md-nav__link"> <span class="md-ellipsis"> Poi-tl </span> </a> </li> <li class="md-nav__item"> <a href="Spire.OfficeForJava.html" class="md-nav__link"> <span class="md-ellipsis"> Spire.OfficeForJava </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../PDF/ApachePDFBox.html" class="md-nav__link"> <span class="md-ellipsis"> ApachePDFBox </span> </a> </li> <li class="md-nav__item"> <a href="../XML/XMLParse.html" class="md-nav__link"> <span class="md-ellipsis"> XMLParse </span> </a> </li> <li class="md-nav__item"> <a href="../ZIP/Zip4j.html" class="md-nav__link"> <span class="md-ellipsis"> Zip4j </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/XXL-JOB.html" class="md-nav__link"> <span class="md-ellipsis"> XXL-JOB </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14"> <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0"> <span class="md-ellipsis"> ğŸ§‘â€ğŸ”§ è¿ç»´ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_14"> <span class="md-nav__icon md-icon"></span> ğŸ§‘â€ğŸ”§ è¿ç»´ </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../%E8%BF%90%E7%BB%B4/Docker.html" class="md-nav__link"> <span class="md-ellipsis"> Docker </span> </a> </li> <li class="md-nav__item"> <a href="../../%E8%BF%90%E7%BB%B4/Linux.html" class="md-nav__link"> <span class="md-ellipsis"> Linux </span> </a> </li> <li class="md-nav__item"> <a href="../../%E8%BF%90%E7%BB%B4/NSSM.html" class="md-nav__link"> <span class="md-ellipsis"> NSSM </span> </a> </li> <li class="md-nav__item"> <a href="../../%E8%BF%90%E7%BB%B4/Nginx.html" class="md-nav__link"> <span class="md-ellipsis"> Nginx </span> </a> </li> <li class="md-nav__item"> <a href="../../%E8%BF%90%E7%BB%B4/Tomcat.html" class="md-nav__link"> <span class="md-ellipsis"> Tomcat </span> </a> </li> <li class="md-nav__item"> <a href="../../%E8%BF%90%E7%BB%B4/TongWeb.html" class="md-nav__link"> <span class="md-ellipsis"> TongWeb </span> </a> </li> <li class="md-nav__item"> <a href="../../%E8%BF%90%E7%BB%B4/WSL.html" class="md-nav__link"> <span class="md-ellipsis"> WSL </span> </a> </li> <li class="md-nav__item"> <a href="../../%E8%BF%90%E7%BB%B4/WebLogic.html" class="md-nav__link"> <span class="md-ellipsis"> WebLogic </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15"> <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0"> <span class="md-ellipsis"> ğŸ› ï¸ å¼€å‘å·¥å…· </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_15"> <span class="md-nav__icon md-icon"></span> ğŸ› ï¸ å¼€å‘å·¥å…· </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Git.html" class="md-nav__link"> <span class="md-ellipsis"> Git </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Maven.html" class="md-nav__link"> <span class="md-ellipsis"> Maven </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Node.js.html" class="md-nav__link"> <span class="md-ellipsis"> Node.js </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Swagger.html" class="md-nav__link"> <span class="md-ellipsis"> Swagger </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16"> <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0"> <span class="md-ellipsis"> ğŸ‘» å…¶ä»– </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_16"> <span class="md-nav__icon md-icon"></span> ğŸ‘» å…¶ä»– </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../%E5%85%B6%E4%BB%96/Settings.html" class="md-nav__link"> <span class="md-ellipsis"> Settings </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%85%B6%E4%BB%96/Solutions.html" class="md-nav__link"> <span class="md-ellipsis"> Solutions </span> </a> </li> <li class="md-nav__item"> <a href="../../%E5%85%B6%E4%BB%96/Weasel.html" class="md-nav__link"> <span class="md-ellipsis"> Weasel </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--secondary" aria-label="ç›®å½•"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> ç›®å½• </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#1onlyoffice" class="md-nav__link"> <span class="md-ellipsis"> 1ã€OnlyOffice </span> </a> <nav class="md-nav" aria-label="1ã€OnlyOffice"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#11åŸºæœ¬æ¦‚å¿µå’Œå®‰è£…" class="md-nav__link"> <span class="md-ellipsis"> 1.1ã€åŸºæœ¬æ¦‚å¿µå’Œå®‰è£… </span> </a> <nav class="md-nav" aria-label="1.1ã€åŸºæœ¬æ¦‚å¿µå’Œå®‰è£…"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#111-docker-å®‰è£…" class="md-nav__link"> <span class="md-ellipsis"> 1.1.1ã€ Docker å®‰è£… </span> </a> <nav class="md-nav" aria-label="1.1.1ã€ Docker å®‰è£…"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#å®‰è£…" class="md-nav__link"> <span class="md-ellipsis"> å®‰è£… </span> </a> </li> <li class="md-nav__item"> <a href="#å¸¸ç”¨å‘½ä»¤" class="md-nav__link"> <span class="md-ellipsis"> å¸¸ç”¨å‘½ä»¤ </span> </a> </li> <li class="md-nav__item"> <a href="#nginx-ä»£ç†" class="md-nav__link"> <span class="md-ellipsis"> Nginx ä»£ç† </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#12ç®€å•ç¤ºä¾‹" class="md-nav__link"> <span class="md-ellipsis"> 1.2ã€ç®€å•ç¤ºä¾‹ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#2å·¥ä½œåŸç†åŠå®è·µ" class="md-nav__link"> <span class="md-ellipsis"> 2ã€å·¥ä½œåŸç†åŠå®è·µ </span> </a> <nav class="md-nav" aria-label="2ã€å·¥ä½œåŸç†åŠå®è·µ"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#21æ‰“å¼€æ–‡ä»¶" class="md-nav__link"> <span class="md-ellipsis"> 2.1ã€æ‰“å¼€æ–‡ä»¶ </span> </a> </li> <li class="md-nav__item"> <a href="#22ä¿å­˜æ–‡ä»¶" class="md-nav__link"> <span class="md-ellipsis"> 2.2ã€ä¿å­˜æ–‡ä»¶ </span> </a> </li> <li class="md-nav__item"> <a href="#33å®¡é˜…" class="md-nav__link"> <span class="md-ellipsis"> 3.3ã€å®¡é˜… </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#3æ–‡æ¡£" class="md-nav__link"> <span class="md-ellipsis"> 3ã€æ–‡æ¡£ </span> </a> <nav class="md-nav" aria-label="3ã€æ–‡æ¡£"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#31é«˜çº§å‚æ•°" class="md-nav__link"> <span class="md-ellipsis"> 3.1ã€é«˜çº§å‚æ•° </span> </a> </li> <li class="md-nav__item"> <a href="#32config" class="md-nav__link"> <span class="md-ellipsis"> 3.2ã€Config </span> </a> <nav class="md-nav" aria-label="3.2ã€Config"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#document" class="md-nav__link"> <span class="md-ellipsis"> Document </span> </a> <nav class="md-nav" aria-label="Document"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#info" class="md-nav__link"> <span class="md-ellipsis"> Info </span> </a> </li> <li class="md-nav__item"> <a href="#permissions" class="md-nav__link"> <span class="md-ellipsis"> Permissions </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#4æ•…éšœæ’é™¤" class="md-nav__link"> <span class="md-ellipsis"> 4ã€æ•…éšœæ’é™¤ </span> </a> <nav class="md-nav" aria-label="4ã€æ•…éšœæ’é™¤"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#411ä¸‹è½½å¤±è´¥" class="md-nav__link"> <span class="md-ellipsis"> 4.1.1ã€ä¸‹è½½å¤±è´¥ </span> </a> </li> <li class="md-nav__item"> <a href="#412æ–‡ä»¶ç‰ˆæœ¬å˜æ›´" class="md-nav__link"> <span class="md-ellipsis"> 4.1.2ã€æ–‡ä»¶ç‰ˆæœ¬å˜æ›´ </span> </a> </li> <li class="md-nav__item"> <a href="#413403-editorbin" class="md-nav__link"> <span class="md-ellipsis"> 4.1.3ã€403 Editor.bin </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#5å‰ç«¯æ¡†æ¶" class="md-nav__link"> <span class="md-ellipsis"> 5ã€å‰ç«¯æ¡†æ¶ </span> </a> <nav class="md-nav" aria-label="5ã€å‰ç«¯æ¡†æ¶"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#51vue-2x" class="md-nav__link"> <span class="md-ellipsis"> 5.1ã€Vue 2.x </span> </a> <nav class="md-nav" aria-label="5.1ã€Vue 2.x"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#511utilsjs" class="md-nav__link"> <span class="md-ellipsis"> 5.1.1ã€utils.js </span> </a> </li> <li class="md-nav__item"> <a href="#512doceditorvue" class="md-nav__link"> <span class="md-ellipsis"> 5.1.2ã€DocEditor.vue </span> </a> </li> <li class="md-nav__item"> <a href="#513docdialogvue" class="md-nav__link"> <span class="md-ellipsis"> 5.1.3ã€DocDialog.vue </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <nav class="md-path" aria-label="å¯¼èˆªæ "> <ol class="md-path__list"> <li class="md-path__item"> <a href="../../index.html" class="md-path__link"> <span class="md-ellipsis"> ğŸ  é¦–é¡µ </span> </a> </li> <li class="md-path__item"> <a href="ApachePOI.html" class="md-path__link"> <span class="md-ellipsis"> ğŸ—ƒï¸ æ–‡ä»¶å¤„ç† </span> </a> </li> <li class="md-path__item"> <a href="ApachePOI.html" class="md-path__link"> <span class="md-ellipsis"> Office </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <h1 id="onlyoffice">OnlyOffice<a class="headerlink" href="#onlyoffice" title="é”šç‚¹é“¾æ¥">Â¶</a></h1> <h2 id="1onlyoffice">1ã€OnlyOffice<a class="headerlink" href="#1onlyoffice" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <h3 id="11åŸºæœ¬æ¦‚å¿µå’Œå®‰è£…">1.1ã€åŸºæœ¬æ¦‚å¿µå’Œå®‰è£…<a class="headerlink" href="#11åŸºæœ¬æ¦‚å¿µå’Œå®‰è£…" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>OnlyOfficeï¼ˆå‰èº«ä¸ºTeamLab ï¼‰ï¼Œäº¦è¢«ç§°ä¸º ONLYOFFICEï¼Œ æ˜¯ä¸€ä¸ªå¼€æºåŠå…¬å¥—ä»¶ï¼ŒåŒ…æ‹¬æ–‡æœ¬æ–‡æ¡£ã€ç”µå­è¡¨æ ¼ã€æ¼”ç¤ºæ–‡ç¨¿å’Œå¯å¡«å†™è¡¨å•çš„ç¼–è¾‘å™¨ã€‚ ONLYOFFICE æ–‡æ¡£æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p> <ul> <li>åˆ›å»ºã€ç¼–è¾‘å’ŒæŸ¥çœ‹æ–‡æœ¬æ–‡æ¡£ã€ç”µå­è¡¨æ ¼ã€æ¼”ç¤ºæ–‡ç¨¿å’Œå¯å¡«å†™è¡¨å•ã€‚</li> <li>ä¸å…¶ä»–å›¢é˜Ÿæˆå‘˜å®æ—¶åä½œå¤„ç†æ–‡ä»¶ã€‚</li> </ul> <p><a href="https://api.onlyoffice.com/zh-CN/docs/docs-api/get-started/basic-concepts/">ONLYOFFICE æ–‡æ¡£ API</a> ç”¨äºè®©å¼€å‘äººå‘˜å°† ONLYOFFICE æ–‡æ¡£/ç”µå­è¡¨æ ¼/æ¼”ç¤ºæ–‡ç¨¿/ PDF ç¼–è¾‘å™¨é›†æˆåˆ°è‡ªå·±çš„ç½‘ç«™ä¸­ï¼Œå¹¶è®¾ç½®å’Œç®¡ç†ç¼–è¾‘å™¨ã€‚é€šè¿‡è‡ªå®šä¹‰ç”¨æˆ·ç•Œé¢ï¼Œå¯å°† ONLYOFFICE æ–‡æ¡£å®šåˆ¶ä¸ºä¸ä½ çš„åº”ç”¨ç¨‹åºæˆ–ç½‘é¡µå®ç°æ— ç¼èåˆçš„ç»„ä»¶ã€‚</p> <h4 id="111-docker-å®‰è£…">1.1.1ã€ Docker å®‰è£…<a class="headerlink" href="#111-docker-å®‰è£…" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>æ¨èä½¿ç”¨ <a href="https://www.docker.com/">Docker</a> è¿›è¡Œé›†æˆï¼Œé¿å…äº†å‡ºç°æœåŠ¡å™¨ç³»ç»Ÿçš„ä¸åŒè€Œé‡æ–°é€‚é…çš„é—®é¢˜ã€‚Dockerçš„æ€æƒ³æ¥è‡ªäºé›†è£…ç®±ï¼Œé›†è£…ç®±è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿåœ¨ä¸€è‰˜å¤§èˆ¹ä¸Šï¼Œå¯ä»¥æŠŠè´§ç‰©è§„æ•´çš„æ‘†æ”¾èµ·æ¥ã€‚å¹¶ä¸”å„ç§å„æ ·çš„è´§ç‰©è¢«é›†è£…ç®±æ ‡å‡†åŒ–äº†ï¼Œé›†è£…ç®±å’Œé›†è£…ç®±ä¹‹é—´ä¸ä¼šäº’ç›¸å½±å“ã€‚é‚£ä¹ˆæˆ‘å°±ä¸éœ€è¦ä¸“é—¨è¿é€æ°´æœçš„èˆ¹å’Œä¸“é—¨è¿é€åŒ–å­¦å“çš„èˆ¹äº†ã€‚åªè¦è¿™äº›è´§ç‰©åœ¨é›†è£…ç®±é‡Œå°è£…çš„å¥½å¥½çš„ï¼Œé‚£æˆ‘å°±å¯ä»¥ç”¨ä¸€è‰˜å¤§èˆ¹æŠŠä»–ä»¬éƒ½è¿èµ°ã€‚</p> <h5 id="å®‰è£…">å®‰è£…<a class="headerlink" href="#å®‰è£…" title="é”šç‚¹é“¾æ¥">Â¶</a></h5> <ol> <li> <p>æ‹‰å– OnlyOffice é•œåƒï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>docker<span class="w"> </span>pull<span class="w"> </span>onlyoffice/documentserver
</span></code></pre></div> <p>æŸ¥çœ‹é•œåƒï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>docker<span class="w"> </span>images
</span></code></pre></div> </li> <li> <p>è¿è¡Œé•œåƒï¼ˆåˆ›å»ºå®¹å™¨ï¼‰ï¼Œå¹¶ç»‘å®šç«¯å£ï¼ˆè¿™é‡Œç»‘å®š 9000ï¼‰ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-itd<span class="w"> </span>--name<span class="w"> </span>onlyoffice<span class="w"> </span>-p<span class="w"> </span><span class="m">9000</span>:80<span class="w"> </span>-e<span class="w"> </span><span class="nv">JWT_ENABLED</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span>onlyoffice/documentserver
</span></code></pre></div> <div class="admonition note"> <p class="admonition-title">Note</p> <p><code>JWT_ENABLED=false</code> ä»£è¡¨ä¸èµ° JWT éªŒè¯ï¼Œé¿å…è®¿é—® onlyoffice é€ æˆæŒ‡ä»¤é”™è¯¯é—®é¢˜ã€‚</p> </div> <p>æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œåé¢åŠ ä¸Š <code>-a</code> æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>docker<span class="w"> </span>ps
</span></code></pre></div> </li> <li> <p>è¿›å…¥å®¹å™¨ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>onlyoffice<span class="w"> </span>bash
</span></code></pre></div> </li> <li> <p>ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>nano<span class="w"> </span>/etc/onlyoffice/documentserver/local.json
</span></code></pre></div> <p>åœ¨ <code>"CoAuthoring": {}</code> é‡Œæœ€åé¢å¢åŠ ä¸€æ®µé…ç½®ï¼Œä½¿å…¶å…è®¸ç§æœ‰ IP é€šè¿‡ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>"request-filtering-agent" : {
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    "allowPrivateIPAddress": true,
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    "allowMetaIPAddress": true
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>}
</span></code></pre></div> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/image-20250520152241682.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/image-20250520152241682.png" alt="image-20250520152241682" style="zoom: 50%;"></a></p> <div class="admonition tip"> <p class="admonition-title">Important</p> <p>é»˜è®¤å€¼å­˜å‚¨åœ¨ <code>default.json</code> é…ç½®æ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶ä½äºä¸Šè¿°æ–‡ä»¶å¤¹ä¸­ï¼ˆé€‚ç”¨äº Linux å’Œ Windowsï¼‰ã€‚è¯·ä¸è¦ç›´æ¥ç¼–è¾‘ <code>default.json</code> æ–‡ä»¶çš„å†…å®¹ã€‚æ¯æ¬¡é‡å¯ Docker å®¹å™¨æˆ–å°† ONLYOFFICE æ–‡æ¡£å‡çº§åˆ°æ–°ç‰ˆæœ¬æ—¶ï¼Œé»˜è®¤å€¼å°†è¢«æ¢å¤ï¼Œæ‰€åšçš„æ‰€æœ‰æ›´æ”¹å°†ä¼šä¸¢å¤±ã€‚</p> </div> </li> <li> <p>é‡æ–°å¯åŠ¨æœåŠ¡ä»¥ä½¿é…ç½®æ›´æ”¹ç”Ÿæ•ˆï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>supervisorctl<span class="w"> </span>restart<span class="w"> </span>all
</span></code></pre></div> </li> <li> <p>æŸ¥çœ‹æœåŠ¡æ˜¯å¦å·²ç»å¯åŠ¨ï¼ˆéœ€è¦ç­‰å¾…ä¸€åˆ†é’Ÿå·¦å³ï¼‰ï¼š </p><div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>http://ç”µè„‘ip:ç»‘å®šç«¯å£
</span></code></pre></div><p></p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/image-20210303003314432.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/image-20210303003314432.png" alt="image-20210303003314432" style="width:100%;"></a></p> </li> </ol> <h5 id="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤<a class="headerlink" href="#å¸¸ç”¨å‘½ä»¤" title="é”šç‚¹é“¾æ¥">Â¶</a></h5> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">## å¼€å§‹è¿è¡Œ</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>docker<span class="w"> </span>start<span class="w"> </span>onlyoffice
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="c1">## åœæ­¢è¿è¡Œ</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>docker<span class="w"> </span>stop<span class="w"> </span>onlyoffice
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="c1">## åˆ é™¤é•œåƒï¼ˆå¦‚æœæœ‰é•œåƒåˆ›å»ºçš„å®¹å™¨éœ€è¦å…ˆåˆ é™¤å®¹å™¨ï¼Œåˆ é™¤å®¹å™¨éœ€è¦å…ˆåœæ­¢è¿è¡Œæ‰å¯ä»¥åˆ é™¤ï¼‰</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>docker<span class="w"> </span>rm<span class="w"> </span>onlyoffice
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>docker<span class="w"> </span>rmi<span class="w"> </span>onlyoffice/documentserver
</span></code></pre></div> <h5 id="nginx-ä»£ç†">Nginx ä»£ç†<a class="headerlink" href="#nginx-ä»£ç†" title="é”šç‚¹é“¾æ¥">Â¶</a></h5> <p>ä½¿ç”¨ Nginx å°†å®¢æˆ·ç«¯è¯·æ±‚è½¬å‘åˆ°åç«¯çš„ ONLYOFFICE Document Serverï¼ŒåŒæ—¶å¤„ç†å¥½ WebSocket å’Œåå‘ä»£ç†ç›¸å…³çš„å¤´éƒ¨ä¿¡æ¯ï¼Œç¡®ä¿ ONLYOFFICE æ­£å¸¸å·¥ä½œï¼š</p> <div class="language-nginx highlight"><span class="filename">Nginx Configuration File</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">upstream</span><span class="w"> </span><span class="s">docservice</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">  </span><span class="kn">server</span><span class="w"> </span><span class="s">backendserver-address</span><span class="p">;</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="p">}</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="k">map</span><span class="w"> </span><span class="nv">$http_x_forwarded_proto</span><span class="w"> </span><span class="nv">$the_scheme</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">     </span><span class="kn">default</span><span class="w"> </span><span class="nv">$http_x_forwarded_proto</span><span class="p">;</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">     </span><span class="kn">""</span><span class="w"> </span><span class="nv">$scheme</span><span class="p">;</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="p">}</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="k">map</span><span class="w"> </span><span class="nv">$http_x_forwarded_host</span><span class="w"> </span><span class="nv">$the_host</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">    </span><span class="kn">default</span><span class="w"> </span><span class="nv">$http_x_forwarded_host</span><span class="p">;</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">    </span><span class="kn">""</span><span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="p">}</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="k">map</span><span class="w"> </span><span class="nv">$http_upgrade</span><span class="w"> </span><span class="nv">$proxy_connection</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">  </span><span class="kn">default</span><span class="w"> </span><span class="s">upgrade</span><span class="p">;</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">  </span><span class="kn">""</span><span class="w"> </span><span class="s">close</span><span class="p">;</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="p">}</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="k">proxy_set_header</span><span class="w"> </span><span class="s">Upgrade</span><span class="w"> </span><span class="nv">$http_upgrade</span><span class="p">;</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="k">proxy_set_header</span><span class="w"> </span><span class="s">Connection</span><span class="w"> </span><span class="nv">$proxy_connection</span><span class="p">;</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="k">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Host</span><span class="w"> </span><span class="nv">$the_host/documentserver-virtual-path</span><span class="p">;</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="k">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-Proto</span><span class="w"> </span><span class="nv">$the_scheme</span><span class="p">;</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="k">proxy_set_header</span><span class="w"> </span><span class="s">X-Forwarded-For</span><span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="k">server</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="w">  </span><span class="kn">listen</span><span class="w"> </span><span class="n">0.0.0.0</span><span class="p">:</span><span class="mi">80</span><span class="p">;</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="w">  </span><span class="kn">listen</span><span class="w"> </span><span class="s">[::]:80</span><span class="w"> </span><span class="s">default_server</span><span class="p">;</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="w">  </span><span class="kn">server_tokens</span><span class="w"> </span><span class="no">off</span><span class="p">;</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="w">  </span><span class="kn">location</span><span class="w"> </span><span class="s">/documentserver-virtual-path/</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="w">    </span><span class="kn">proxy_pass</span><span class="w"> </span><span class="s">http://docservice/</span><span class="p">;</span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="w">    </span><span class="kn">proxy_http_version</span><span class="w"> </span><span class="mi">1</span><span class="s">.1</span><span class="p">;</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="p">}</span>
</span></code></pre></div> <p>éœ€è¦ä¿®æ”¹çš„å‚æ•°ï¼š</p> <ul> <li><em>backendserver-address</em>ï¼šéƒ¨ç½²çš„ ONLYOFFICE Document Server çš„åç«¯åœ°å€ã€‚</li> <li><em>documentserver-virtual-path</em>ï¼šå¤–éƒ¨è®¿é—® ONLYOFFICE æ—¶ä½¿ç”¨çš„ URL è·¯å¾„å‰ç¼€ã€‚</li> </ul> <h3 id="12ç®€å•ç¤ºä¾‹">1.2ã€ç®€å•ç¤ºä¾‹<a class="headerlink" href="#12ç®€å•ç¤ºä¾‹" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>é€šå¸¸å¯ä»¥åœ¨ä»¥ä¸‹ç¼–è¾‘å™¨æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ° API JavaScript æ–‡ä»¶ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>http://documentserver/web-apps/apps/api/documents/api.js
</span></code></pre></div> <p>å…¶ä¸­ <code>documentserver</code> æ˜¯å®‰è£…äº† ONLYOFFICE Document Server çš„æœåŠ¡å™¨çš„åç§°ã€‚</p> <p>è¦åµŒå…¥ç¼–è¾‘å™¨çš„ç›®æ ‡HTMLæ–‡ä»¶éœ€è¦æœ‰ä¸€ä¸ªå ä½ç¬¦divæ ‡è®°ï¼Œå…¶ä¸­å°†ä¼ é€’æœ‰å…³ç¼–è¾‘å™¨å‚æ•°çš„æ‰€æœ‰ä¿¡æ¯ï¼š</p> <div class="language-html highlight"><span class="filename">HTML</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"placeholder"</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span> <span class="na">src</span><span class="o">=</span><span class="s">"https://documentserver/web-apps/apps/api/documents/api.js"</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div> <p>åŒ…å«å¯å˜å‚æ•°çš„é¡µé¢ä»£ç æ˜¯è¿™æ ·çš„:</p> <div class="language-javascript highlight"><span class="filename">JavaScript</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kd">var</span><span class="w"> </span><span class="nx">docEditor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DocsAPI</span><span class="p">.</span><span class="nx">DocEditor</span><span class="p">(</span><span class="s2">"placeholder"</span><span class="p">,</span><span class="w"> </span><span class="nx">config</span><span class="p">);</span>
</span></code></pre></div> <p>å…¶ä¸­configæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼š</p> <div class="language-javascript highlight"><span class="filename">JavaScript</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nx">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">    </span><span class="s2">"document"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">        </span><span class="s2">"fileType"</span><span class="o">:</span><span class="w"> </span><span class="s2">"docx"</span><span class="p">,</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">        </span><span class="s2">"key"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Khirz6zTPdfd7"</span><span class="p">,</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">        </span><span class="s2">"title"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Example Document Title.docx"</span><span class="p">,</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">        </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/url-to-example-document.docx"</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">    </span><span class="s2">"documentType"</span><span class="o">:</span><span class="w"> </span><span class="s2">"word"</span><span class="p">,</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">    </span><span class="s2">"editorConfig"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">        </span><span class="s2">"callbackUrl"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/url-to-callback.ashx"</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="p">};</span>
</span></code></pre></div> <p>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p> <div class="language-html highlight"><span class="filename">HTML</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="p">&lt;</span><span class="nt">html</span> <span class="na">style</span><span class="o">=</span><span class="s">"height: 100%;"</span><span class="p">&gt;</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>ONLYOFFICE Api Documentation<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="p">&lt;</span><span class="nt">body</span> <span class="na">style</span><span class="o">=</span><span class="s">"height: 100%; margin: 0;"</span><span class="p">&gt;</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"placeholder"</span> <span class="na">style</span><span class="o">=</span><span class="s">"height: 100%"</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>    <span class="cm">&lt;!--å°† documentserver æ›¿æ¢ä¸º å®‰è£…äº† ONLYOFFICE Document Server çš„æœåŠ¡å™¨--&gt;</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span> <span class="na">src</span><span class="o">=</span><span class="s">"https://documentserver/web-apps/apps/api/documents/api.js"</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span><span class="p">&gt;</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">        </span><span class="nb">window</span><span class="p">.</span><span class="nx">docEditor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DocsAPI</span><span class="p">.</span><span class="nx">DocEditor</span><span class="p">(</span><span class="s2">"placeholder"</span><span class="p">,</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">                </span><span class="s2">"document"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">                    </span><span class="s2">"fileType"</span><span class="o">:</span><span class="w"> </span><span class="s2">"docx"</span><span class="p">,</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="w">                    </span><span class="s2">"key"</span><span class="o">:</span><span class="w"> </span><span class="s2">"E7FAFC9C22A8"</span><span class="p">,</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="w">                    </span><span class="s2">"title"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Example Document Title.docx"</span><span class="p">,</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="w">                    </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/url-to-example-document.docx"</span><span class="w"> </span><span class="c1">//è®¿é—®æ–‡æ¡£çš„urlï¼Œè‡ªè¡Œæ›¿æ¢</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="w">                </span><span class="s2">"documentType"</span><span class="o">:</span><span class="w"> </span><span class="s2">"word"</span><span class="p">,</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="w">                </span><span class="s2">"height"</span><span class="o">:</span><span class="w"> </span><span class="s2">"100%"</span><span class="p">,</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="w">                </span><span class="s2">"width"</span><span class="o">:</span><span class="w"> </span><span class="s2">"100%"</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="w">            </span><span class="p">});</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a><span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></code></pre></div> <h2 id="2å·¥ä½œåŸç†åŠå®è·µ">2ã€å·¥ä½œåŸç†åŠå®è·µ<a class="headerlink" href="#2å·¥ä½œåŸç†åŠå®è·µ" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <h3 id="21æ‰“å¼€æ–‡ä»¶">2.1ã€æ‰“å¼€æ–‡ä»¶<a class="headerlink" href="#21æ‰“å¼€æ–‡ä»¶" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>å‚è€ƒå›¾å’Œä»¥ä¸‹æ­¥éª¤è¯´æ˜äº†åœ¨ONLYOFFICE Document Serverä¸­æ‰“å¼€æ–‡æ¡£çš„è¿‡ç¨‹ï¼š</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/image-20210304001457116.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/image-20210304001457116.png" alt="image-20210304001457116" style="width:50%;"></a></p> <ol> <li> <p>ç”¨æˆ·ä½¿ç”¨æ–‡æ¡£ç®¡ç†å™¨ï¼ˆåœ¨ä»–/å¥¹çš„æµè§ˆå™¨ä¸­æ‰¾åˆ°ï¼‰æ‰“å¼€æ–‡æ¡£è¿›è¡ŒæŸ¥çœ‹æˆ–ç¼–è¾‘ã€‚</p> <blockquote> <p>æµè§ˆå™¨ä¸­çš„æ–‡æ¡£ç®¡ç†å™¨ä»æ–‡æ¡£å­˜å‚¨æœåŠ¡æ¥æ”¶ç”¨æˆ·å¯ç”¨çš„æ‰€æœ‰æ–‡æ¡£çš„åˆ—è¡¨ã€‚</p> </blockquote> </li> <li> <p>ä½¿ç”¨ JavaScript API å°†æ–‡æ¡£æ ‡è¯†ç¬¦åŠå…¶åœ¨æ–‡æ¡£å­˜å‚¨æœåŠ¡å¤„çš„é“¾æ¥å‘é€åˆ°æ–‡æ¡£ç¼–è¾‘å™¨ã€‚</p> </li> <li> <p>æ–‡æ¡£ç¼–è¾‘å™¨å‘æ–‡æ¡£ç¼–è¾‘æœåŠ¡å‘å‡ºæ‰“å¼€æ–‡æ¡£çš„è¯·æ±‚ã€‚æ–‡æ¡£ç¼–è¾‘å™¨ä½¿ç”¨ä»æ–‡æ¡£ç®¡ç†å™¨æ¥æ”¶çš„æ–‡æ¡£æ ‡è¯†ç¬¦åŠå…¶é“¾æ¥ï¼ˆåœ¨æ­¥éª¤2ï¼‰ã€‚</p> </li> <li> <p>æ–‡æ¡£ç¼–è¾‘æœåŠ¡ä½¿ç”¨æä¾›çš„IDå’Œé“¾æ¥ä»æ–‡æ¡£å­˜å‚¨æœåŠ¡ä¸‹è½½æ–‡æ¡£æ–‡ä»¶ã€‚ åœ¨æ­¤æ­¥éª¤ä¸­ï¼Œè¿˜æ‰§è¡Œäº†å°†æ–‡ä»¶è½¬æ¢ä¸ºOffice Open XML æ ¼å¼çš„æ“ä½œï¼Œä»¥ä½¿æ–‡æ¡£ç¼–è¾‘å™¨å…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œæ ¼å¼å…¼å®¹æ€§ã€‚</p> </li> <li> <p>å‡†å¤‡å°±ç»ªåï¼Œæ–‡æ¡£ç¼–è¾‘æœåŠ¡ä¼šå°†æ–‡æ¡£æ–‡ä»¶ä¼ è¾“åˆ°åŸºäºæµè§ˆå™¨çš„æ–‡æ¡£ç¼–è¾‘å™¨ã€‚</p> </li> <li> <p>æ–‡æ¡£ç¼–è¾‘å™¨æ˜¾ç¤ºæ–‡æ¡£æ–‡ä»¶å’Œ/æˆ–ï¼ˆå¦‚æœæä¾›äº†é€‚å½“çš„æƒé™ï¼‰å…è®¸å¯¹å…¶è¿›è¡Œç¼–è¾‘ã€‚</p> </li> </ol> <p>ç¼–è¾‘å®Œæˆåï¼Œå°†è¿›è¡Œæ–‡æ¡£ä¿å­˜è¿‡ç¨‹ã€‚</p> <p><strong>å®è·µ</strong></p> <ol> <li> <p>åˆ›å»ºä¸€ä¸ªç©ºçš„ html æ–‡ä»¶ã€‚</p> </li> <li> <p>å¦‚ä¸‹æ‰€ç¤ºæ·»åŠ  div å…ƒç´ ã€‚</p> <div class="language-html highlight"><span class="filename">HTML</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"placeholder"</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></code></pre></div> </li> <li> <p>ä½¿ç”¨å°†ç”¨äºæ‚¨çš„ç½‘ç«™çš„ JavaScript APIæŒ‡å®šçš„ ONLYOFFICE Document Server é“¾æ¥ã€‚</p> <div class="language-html highlight"><span class="filename">HTML</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span> <span class="na">src</span><span class="o">=</span><span class="s">"https://documentserver/web-apps/apps/api/documents/api.js"</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div> <p>å…¶ä¸­ documentserver æ˜¯å®‰è£…äº† ONLYOFFICE Document Server çš„æœåŠ¡å™¨çš„åç§°ã€‚</p> </li> <li> <p>æ·»åŠ åˆå§‹åŒ– div å…ƒç´ çš„æ–‡æ¡£ç¼–è¾‘å™¨çš„è„šæœ¬ï¼Œè¯¥è„šæœ¬å¸¦æœ‰è¦æ‰“å¼€çš„æ–‡æ¡£çš„é…ç½®ï¼š</p> <div class="language-javascript highlight"><span class="filename">JavaScript</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="ow">new</span><span class="w"> </span><span class="nx">DocsAPI</span><span class="p">.</span><span class="nx">DocEditor</span><span class="p">(</span><span class="s2">"placeholder"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">    </span><span class="s2">"document"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">        </span><span class="s2">"fileType"</span><span class="o">:</span><span class="w"> </span><span class="s2">"docx"</span><span class="p">,</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">        </span><span class="s2">"key"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Khirz6zTPdfd7"</span><span class="p">,</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">        </span><span class="s2">"title"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Example Document Title.docx"</span><span class="p">,</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">        </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/url-to-example-document.docx"</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">    </span><span class="s2">"documentType"</span><span class="o">:</span><span class="w"> </span><span class="s2">"word"</span><span class="p">,</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">    </span><span class="s2">"height"</span><span class="o">:</span><span class="w"> </span><span class="s2">"100%"</span><span class="p">,</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">    </span><span class="s2">"width"</span><span class="o">:</span><span class="w"> </span><span class="s2">"100%"</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="p">});</span>
</span></code></pre></div> <p>å…¶ä¸­ <code>example.com</code> æ˜¯å®‰è£…äº†æ–‡æ¡£ç®¡ç†å™¨å’Œæ–‡æ¡£å­˜å‚¨æœåŠ¡çš„æœåŠ¡å™¨çš„åç§°ï¼ˆè¯´ç™½äº†å°±æ˜¯è®¿é—®æ–‡æ¡£çš„ URLï¼‰ã€‚</p> </li> <li> <p>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€htmlæ–‡ä»¶ã€‚</p> <p>å¦‚æœå‡ºç°åªæœ‰å·¥å…·æ ã€çœ‹ä¸åˆ°æ–‡ç« ä¸»ä½“çš„é—®é¢˜ã€‚åŸå› æ˜¯æ²¡æœ‰ç»™ <code>&lt;body&gt;&lt;/body&gt;</code> è®¾ç½®é«˜åº¦ï¼Œè¯•ç€åŠ ä¸Šï¼š</p> <div class="language-css highlight"><span class="filename">CSS</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nt">html</span><span class="o">,</span><span class="w"> </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="p">}</span>
</span></code></pre></div> </li> </ol> <h3 id="22ä¿å­˜æ–‡ä»¶">2.2ã€ä¿å­˜æ–‡ä»¶<a class="headerlink" href="#22ä¿å­˜æ–‡ä»¶" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>å‚è€ƒå›¾å’Œä»¥ä¸‹æ­¥éª¤è¯´æ˜äº†å°†æ–‡æ¡£ä¿å­˜åœ¨ ONLYOFFICE Document Server ä¸­çš„è¿‡ç¨‹ã€‚</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/image-20210307232148928.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/image-20210307232148928.png" alt="image-20210307232148928" style="width:50%;"></a></p> <ol> <li>ç”¨æˆ·åœ¨æ–‡æ¡£ç¼–è¾‘å™¨ä¸­ç¼–è¾‘æ–‡æ¡£ã€‚</li> <li>æ–‡æ¡£ç¼–è¾‘å™¨å°†æ‰€åšçš„æ›´æ”¹å‘é€åˆ°æ–‡æ¡£ç¼–è¾‘æœåŠ¡ã€‚</li> <li>ç”¨æˆ·å…³é—­æ–‡æ¡£ç¼–è¾‘å™¨ã€‚</li> <li>æ–‡æ¡£ç¼–è¾‘æœåŠ¡ç›‘è§†æ–‡æ¡£å·¥ä½œçš„ç»“æŸï¼Œå¹¶å°†ä»æ–‡æ¡£ç¼–è¾‘å™¨å‘é€çš„æ›´æ”¹æ”¶é›†åˆ°ä¸€ä¸ªæ–‡æ¡£ä¸­ã€‚</li> <li>æ–‡æ¡£ç¼–è¾‘æœåŠ¡ä½¿ç”¨ JavaScript API ä¸­çš„ callbackUrl é€šçŸ¥æ–‡æ¡£å­˜å‚¨æœåŠ¡æœ‰å…³æ–‡æ¡£ç¼–è¾‘ç»“æŸçš„ä¿¡æ¯ï¼Œå¹¶è¿”å›åˆ°ä¿®æ”¹åçš„æ–‡æ¡£çš„é“¾æ¥ã€‚</li> <li>æ–‡æ¡£å­˜å‚¨æœåŠ¡ä»æ–‡æ¡£ç¼–è¾‘æœåŠ¡ä¸‹è½½å¸¦æœ‰æ‰€æœ‰å·²ä¿å­˜æ›´æ”¹çš„æ–‡æ¡£æ–‡ä»¶å¹¶è¿›è¡Œå­˜å‚¨ã€‚</li> </ol> <p><strong>å®è·µ</strong></p> <ol> <li> <p>åˆ›å»ºä¸€ä¸ªå›è°ƒå¤„ç†ç¨‹åºï¼Œä»¥ä»æ–‡æ¡£ç¼–è¾‘æœåŠ¡ä¸­ä¿å­˜æ–‡æ¡£ã€‚</p> <div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">saveFile</span><span class="p">(</span><span class="n">HttpServletRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">HttpServletResponse</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">    </span><span class="n">PrintWriter</span><span class="w"> </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">getWriter</span><span class="p">();</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">    </span><span class="n">Scanner</span><span class="w"> </span><span class="n">scanner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Scanner</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">()).</span><span class="na">useDelimiter</span><span class="p">(</span><span class="s">"\\A"</span><span class="p">);</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scanner</span><span class="p">.</span><span class="na">hasNext</span><span class="p">()</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">scanner</span><span class="p">.</span><span class="na">next</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">""</span><span class="p">;</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">    </span><span class="n">JSONObject</span><span class="w"> </span><span class="n">jsonObj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JSONObject</span><span class="p">.</span><span class="na">parseObject</span><span class="p">(</span><span class="n">body</span><span class="p">);</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">"status"</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">downloadUri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">jsonObj</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">"url"</span><span class="p">);</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">        </span><span class="n">URL</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">URL</span><span class="p">(</span><span class="n">downloadUri</span><span class="p">);</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="w">        </span><span class="n">java</span><span class="p">.</span><span class="na">net</span><span class="p">.</span><span class="na">HttpURLConnection</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="na">net</span><span class="p">.</span><span class="na">HttpURLConnection</span><span class="p">)</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">openConnection</span><span class="p">();</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="w">        </span><span class="n">InputStream</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">connection</span><span class="p">.</span><span class="na">getInputStream</span><span class="p">();</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="w">        </span><span class="c1">// pathForSave æ˜¯ä¿å­˜æ–‡ä»¶çš„è®¡ç®—æœºæ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„ï¼ŒåŒ…æ‹¬æ–‡ä»¶åã€‚</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="w">        </span><span class="n">File</span><span class="w"> </span><span class="n">savedFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">pathForSave</span><span class="p">);</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">FileOutputStream</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="n">savedFile</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">read</span><span class="p">;</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="w">            </span><span class="kd">final</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">]</span><span class="p">;</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">read</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stream</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">bytes</span><span class="p">))</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="w">                </span><span class="n">out</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">read</span><span class="p">);</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="w">            </span><span class="n">out</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="w">        </span><span class="n">connection</span><span class="p">.</span><span class="na">disconnect</span><span class="p">();</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a><span class="w">    </span><span class="n">writer</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="s">"{\"error\":0}"</span><span class="p">);</span>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="p">}</span>
</span></code></pre></div> </li> <li> <p>åˆ›å»ºä¸€ä¸ªhtmlæ–‡ä»¶ä»¥æ‰“å¼€æ–‡æ¡£ã€‚</p> </li> <li> <p>åœ¨æ–‡æ¡£ç¼–è¾‘å™¨åˆå§‹åŒ–çš„é…ç½®è„šæœ¬ä¸­ï¼Œä½¿ç”¨å‚æ•°è¡Œä¸­çš„å›è°ƒå¤„ç†ç¨‹åºæŒ‡å®šæ–‡ä»¶çš„URLã€‚</p> <div class="language-javascript highlight"><span class="filename">JavaScript</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="ow">new</span><span class="w"> </span><span class="nx">DocsAPI</span><span class="p">.</span><span class="nx">DocEditor</span><span class="p">(</span><span class="s2">"placeholder"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">    </span><span class="s2">"document"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">        </span><span class="s2">"fileType"</span><span class="o">:</span><span class="w"> </span><span class="s2">"docx"</span><span class="p">,</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">        </span><span class="s2">"key"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Khirz6zTPdfd7"</span><span class="p">,</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">        </span><span class="s2">"title"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Example Document Title.docx"</span><span class="p">,</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="w">        </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/url-to-example-document.docx"</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">    </span><span class="s2">"documentType"</span><span class="o">:</span><span class="w"> </span><span class="s2">"word"</span><span class="p">,</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">    </span><span class="s2">"editorConfig"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">        </span><span class="s2">"callbackUrl"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/url-to-callback.ashx"</span><span class="w"> </span><span class="c1">//å›è°ƒç¨‹åºæ¥å£</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="p">});</span>
</span></code></pre></div> <blockquote> <p>å…¶ä¸­example.comæ˜¯å®‰è£…æ–‡æ¡£ç®¡ç†å™¨å’Œæ–‡æ¡£å­˜å‚¨æœåŠ¡çš„æœåŠ¡å™¨çš„åç§°ã€‚</p> </blockquote> </li> <li> <p>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€htmlæ–‡ä»¶å¹¶ç¼–è¾‘æ–‡æ¡£ã€‚</p> </li> <li> <p>å…³é—­æ–‡æ¡£ç¼–è¾‘å™¨ã€‚å¤§çº¦10ç§’é’ŸåæŸ¥çœ‹æ‚¨çš„æ–‡æ¡£ã€‚åº”ä¿å­˜æ‰€æœ‰æ›´æ”¹ï¼Œè¿™æ„å‘³ç€é…ç½®æ­£ç¡®ã€‚</p> </li> </ol> <p><strong>ä¿å­˜å»¶æ—¶</strong></p> <p>æ–‡æ¡£ç¼–è¾‘å®Œæˆåï¼Œæ–‡æ¡£ç¼–è¾‘æœåŠ¡ä¼šå°†æ­¤é€šçŸ¥æ–‡æ¡£å­˜å‚¨æœåŠ¡ã€‚å®Œæˆæ­¤æ“ä½œä¹‹å‰çš„æ—¶é—´æ˜¯ä½¿ç”¨å·²ç¼–è¾‘æ–‡ä»¶åˆ°Office Open XMLæ ¼å¼çš„è½¬æ¢æ—¶é—´ï¼ˆå–å†³äºæ–‡ä»¶å¤§å°ã€å¤æ‚æ€§å’Œè®¡ç®—æœºåŠŸç‡ï¼Œå¯ä»¥æ‰§è¡Œç›¸å½“é•¿çš„æ—¶é—´ï¼‰å’Œè½¬æ¢å¼€å§‹å»¶è¿Ÿæ—¶é—´ï¼ˆé»˜è®¤æƒ…å†µä¸‹ç­‰äº5ç§’ï¼‰è®¡ç®—çš„ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤§çº¦æ˜¯ç¼–è¾‘å®Œæˆåçš„10ç§’ã€‚</p> <p>è½¬æ¢å¼€å§‹å»¶è¿Ÿæ˜¯å¿…è¦çš„ï¼Œä»¥å…è®¸åœ¨ä¸ä¿å­˜æ–‡ä»¶çš„æƒ…å†µä¸‹è¿”å›åˆ°æ–‡ä»¶ç¼–è¾‘ä¼šè¯ï¼Œä¾‹å¦‚ï¼Œåœ¨æ‰“å¼€æ–‡ä»¶è¿›è¡Œç¼–è¾‘çš„æƒ…å†µä¸‹é‡æ–°åŠ è½½æµè§ˆå™¨é¡µé¢æ—¶ã€‚é»˜è®¤è½¬æ¢å¼€å§‹å»¶è¿Ÿæ—¶é—´åœ¨æ–‡æ¡£æœåŠ¡å™¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰ï¼Œå¯ä»¥åœ¨ä»¥ä¸‹è·¯å¾„ä¸­æ‰¾åˆ°ï¼š</p> <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>/etc/onlyoffice/documentserver/default.json.
</span></code></pre></div> <p>å¦‚æœä½ æƒ³æ”¹å˜å®ƒï¼Œä½ å¯ä»¥ä½¿ç”¨ <em>local.json</em> æ–‡ä»¶ï¼Œæ‰€æœ‰ç¼–è¾‘è¿‡çš„å‚æ•°éƒ½åº”è¯¥å­˜å‚¨åœ¨è¿™é‡Œã€‚æ­¤æ–‡ä»¶ä¸ <em>default.json</em> ä½äºåŒä¸€ä¸ªç›®å½•ä¸­ã€‚</p> <table> <thead> <tr> <th>å‚æ•°</th> <th>è¯´æ˜</th> <th>ç±»å‹</th> <th>ä¾‹å­</th> </tr> </thead> <tbody> <tr> <td>services.CoAuthoring.server.savetimeoutdelay</td> <td>å®šä¹‰å·²ç¼–è¾‘æ–‡ä»¶å…³é—­åçš„è½¬æ¢å¼€å§‹å»¶è¿Ÿæ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚</td> <td>integer</td> <td>5000</td> </tr> </tbody> </table> <p><em>local.json</em> é…ç½®ç¤ºä¾‹</p> <div class="language-json highlight"><span class="filename">JSON</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="p">{</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">    </span><span class="nt">"services"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">        </span><span class="nt">"CoAuthoring"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">            </span><span class="nt">"server"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">                </span><span class="nt">"savetimeoutdelay"</span><span class="p">:</span><span class="w"> </span><span class="mi">5000</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="p">}</span>
</span></code></pre></div> <h3 id="33å®¡é˜…">3.3ã€å®¡é˜…<a class="headerlink" href="#33å®¡é˜…" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>â€œå®¡é˜…â€ é€‰é¡¹å…è®¸æ‚¨å®¡é˜…æ–‡æ¡£ã€æ›´æ”¹å¥å­ã€çŸ­è¯­å’Œå…¶ä»–é¡µé¢å…ƒç´ ã€æ›´æ­£æ‹¼å†™ç­‰ï¼Œè€Œæ— éœ€å®é™…ç¼–è¾‘æ–‡æ¡£ã€‚æ‰€æœ‰æ›´æ”¹éƒ½å°†è¢«è®°å½•å¹¶æ˜¾ç¤ºç»™åˆ›å»ºæ–‡æ¡£çš„ç”¨æˆ·ã€‚</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/review.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/review.png" alt="img" style="width:40%;"></a></p> <p>è¦å¯ç”¨â€œå®¡é˜…â€é€‰é¡¹ï¼Œå¿…é¡»å°†æ–‡æ¡£åˆå§‹åŒ–çš„<code>permissions</code>éƒ¨åˆ†ä¸­çš„<code>review</code>å‚æ•°è®¾ç½®ä¸º<code>true</code>ã€‚æ–‡æ¡£çŠ¶æ€æ å°†åŒ…å«â€œå®¡é˜…â€èœå•é€‰é¡¹ã€‚</p> <p>å¦‚æœ<code>edit</code>å‚æ•°è®¾ç½®ä¸º<code>true</code>ï¼Œ<code>review</code>å‚æ•°ä¹Ÿè®¾ç½®ä¸º<code>true</code>ï¼Œåˆ™ç”¨æˆ·å°†èƒ½å¤Ÿç¼–è¾‘æ–‡æ¡£ã€æ¥å—æˆ–æ‹’ç»æ›´æ”¹å¹¶åˆ‡æ¢åˆ°å®¡é˜…æ¨¡å¼ã€‚</p> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/accept_reject.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/accept_reject.png" alt="Reviewing" style="width:50%;"></a></p> <p>å¦‚æœ<code>edit</code>å‚æ•°è®¾ç½®ä¸º<code>false</code>ï¼Œè€Œ<code>review</code>å‚æ•°è®¾ç½®ä¸º<code>true</code>ï¼Œåˆ™æ–‡æ¡£å°†ä»…å¯ç”¨äºå®¡é˜…ã€‚</p> <div class="language-javascript highlight"><span class="filename">JavaScript</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="kd">var</span><span class="w"> </span><span class="nx">docEditor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DocsAPI</span><span class="p">.</span><span class="nx">DocEditor</span><span class="p">(</span><span class="s2">"placeholder"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">    </span><span class="s2">"document"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">        </span><span class="s2">"permissions"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">            </span><span class="s2">"edit"</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="w">            </span><span class="s2">"review"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="w">        </span><span class="p">...</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="w">    </span><span class="p">...</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="p">});</span>
</span></code></pre></div> <blockquote> <p>è¯·æ³¨æ„ï¼Œå¦‚æœ<code>mode</code>å‚æ•°è®¾ç½®ä¸º<code>edit</code>ï¼Œæ–‡æ¡£å®¡é˜…å°†ä»…å¯¹æ–‡æ¡£ç¼–è¾‘å™¨å¯ç”¨ã€‚</p> </blockquote> <h2 id="3æ–‡æ¡£">3ã€æ–‡æ¡£<a class="headerlink" href="#3æ–‡æ¡£" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <h3 id="31é«˜çº§å‚æ•°">3.1ã€é«˜çº§å‚æ•°<a class="headerlink" href="#31é«˜çº§å‚æ•°" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>å¯ä»¥ä¸º ONLYOFFICE Document Server æ›´æ”¹çš„å‚æ•°å¯ç»†åˆ†ä¸ºä»¥ä¸‹ä¸»è¦éƒ¨åˆ†ï¼š</p> <ul> <li>config -- å…è®¸æ›´æ”¹ä½¿ç”¨çš„å¹³å°ç±»å‹ã€æ–‡æ¡£æ˜¾ç¤ºå¤§å°ï¼ˆå®½åº¦å’Œé«˜åº¦ï¼‰ä»¥åŠæ‰“å¼€çš„æ–‡æ¡£ç±»å‹<ul> <li>document -- åŒ…å«ä¸æ–‡æ¡£ç›¸å…³çš„æ‰€æœ‰å‚æ•°ï¼ˆæ ‡é¢˜ã€urlã€æ–‡ä»¶ç±»å‹ç­‰ï¼‰<ul> <li>info -- åŒ…å«æ–‡æ¡£çš„å…¶ä»–å‚æ•°ï¼ˆæ–‡æ¡£æ‰€æœ‰è€…ã€å­˜å‚¨æ–‡æ¡£çš„æ–‡ä»¶å¤¹ã€ä¸Šè½½æ—¥æœŸã€å…±äº«è®¾ç½®ï¼‰</li> <li>permissions -- å®šä¹‰æ–‡æ¡£æ˜¯å¦å¯ä»¥ç¼–è¾‘å’Œä¸‹è½½</li> </ul> </li> <li>editorConfig -- å®šä¹‰ä¸ç¼–è¾‘å™¨ç•Œé¢ç›¸å…³çš„å‚æ•°ï¼šæ‰“å¼€æ¨¡å¼ï¼ˆæŸ¥çœ‹å™¨æˆ–ç¼–è¾‘å™¨ï¼‰ã€ç•Œé¢è¯­è¨€ã€é™„åŠ æŒ‰é’®ç­‰ï¼‰<ul> <li>customization -- å…è®¸è‡ªå®šä¹‰ç¼–è¾‘å™¨ç•Œé¢ï¼Œå¹¶æ”¹å˜æ˜¯å¦å­˜åœ¨å…¶ä»–æŒ‰é’®ã€é“¾æ¥ã€æ›´æ”¹å¾½æ ‡å’Œç¼–è¾‘å™¨æ‰€æœ‰è€…è¯¦ç»†ä¿¡æ¯</li> <li>embedded -- ä»…ç”¨äºåµŒå…¥å¼æ–‡æ¡£ç±»å‹ï¼Œå…è®¸æ›´æ”¹ç”¨äºæ§åˆ¶åµŒå…¥å¼æ¨¡å¼çš„æŒ‰é’®çš„è¡Œä¸º</li> <li>plugins -- ç”¨äºå°†å¿…è¦çš„æ’ä»¶è¿æ¥åˆ°æ–‡æ¡£æœåŠ¡å™¨ï¼Œä»¥ä¾¿æ‰€æœ‰æ–‡æ¡£ç¼–è¾‘å™¨ç”¨æˆ·éƒ½èƒ½çœ‹åˆ°å®ƒä»¬</li> </ul> </li> <li>events -- å¯¹æ–‡æ¡£åº”ç”¨æŸä¸ªæ“ä½œï¼ˆåŠ è½½ã€ä¿®æ”¹ç­‰ï¼‰æ—¶è°ƒç”¨çš„ç‰¹æ®Šäº‹ä»¶åˆ—è¡¨</li> </ul> </li> </ul> <p>åŒ…å«æ‰€æœ‰é™„åŠ å‚æ•°çš„å®Œæ•´é…ç½®å¦‚ä¸‹æ‰€ç¤º:</p> <div class="language-javascript highlight"><span class="filename">JavaScript</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nx">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">    </span><span class="s2">"document"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">        </span><span class="s2">"fileType"</span><span class="o">:</span><span class="w"> </span><span class="s2">"docx"</span><span class="p">,</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">        </span><span class="s2">"info"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">            </span><span class="s2">"folder"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Example Files"</span><span class="p">,</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">            </span><span class="s2">"owner"</span><span class="o">:</span><span class="w"> </span><span class="s2">"John Smith"</span><span class="p">,</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">            </span><span class="s2">"sharingSettings"</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">                </span><span class="p">{</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="w">                    </span><span class="s2">"permissions"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Full Access"</span><span class="p">,</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="w">                    </span><span class="s2">"user"</span><span class="o">:</span><span class="w"> </span><span class="s2">"John Smith"</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="w">                </span><span class="p">{</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="w">                    </span><span class="s2">"isLink"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="w">                    </span><span class="s2">"permissions"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Read Only"</span><span class="p">,</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="w">                    </span><span class="s2">"user"</span><span class="o">:</span><span class="w"> </span><span class="s2">"External link"</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="w">                </span><span class="p">...</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="w">            </span><span class="p">],</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="w">            </span><span class="s2">"uploaded"</span><span class="o">:</span><span class="w"> </span><span class="s2">"2010-07-07 3:46 PM"</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="w">        </span><span class="s2">"key"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Khirz6zTPdfd7"</span><span class="p">,</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a><span class="w">        </span><span class="s2">"permissions"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a><span class="w">            </span><span class="s2">"comment"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a><span class="w">            </span><span class="s2">"copy"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-25"><a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a><span class="w">            </span><span class="s2">"download"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-26"><a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a><span class="w">            </span><span class="s2">"edit"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-27"><a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a><span class="w">            </span><span class="s2">"fillForms"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-28"><a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a><span class="w">            </span><span class="s2">"modifyContentControl"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-29"><a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a><span class="w">            </span><span class="s2">"modifyFilter"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-30"><a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a><span class="w">            </span><span class="s2">"print"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-31"><a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a><span class="w">            </span><span class="s2">"review"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-25-32"><a id="__codelineno-25-32" name="__codelineno-25-32" href="#__codelineno-25-32"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-25-33"><a id="__codelineno-25-33" name="__codelineno-25-33" href="#__codelineno-25-33"></a><span class="w">        </span><span class="s2">"title"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Example Document Title.docx"</span><span class="p">,</span>
</span><span id="__span-25-34"><a id="__codelineno-25-34" name="__codelineno-25-34" href="#__codelineno-25-34"></a><span class="w">        </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/url-to-example-document.docx"</span>
</span><span id="__span-25-35"><a id="__codelineno-25-35" name="__codelineno-25-35" href="#__codelineno-25-35"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-25-36"><a id="__codelineno-25-36" name="__codelineno-25-36" href="#__codelineno-25-36"></a><span class="w">    </span><span class="s2">"documentType"</span><span class="o">:</span><span class="w"> </span><span class="s2">"word"</span><span class="p">,</span>
</span><span id="__span-25-37"><a id="__codelineno-25-37" name="__codelineno-25-37" href="#__codelineno-25-37"></a><span class="w">    </span><span class="s2">"editorConfig"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-38"><a id="__codelineno-25-38" name="__codelineno-25-38" href="#__codelineno-25-38"></a><span class="w">        </span><span class="s2">"actionLink"</span><span class="o">:</span><span class="w"> </span><span class="nx">ACTION_DATA</span><span class="p">,</span>
</span><span id="__span-25-39"><a id="__codelineno-25-39" name="__codelineno-25-39" href="#__codelineno-25-39"></a><span class="w">        </span><span class="s2">"callbackUrl"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/url-to-callback.ashx"</span><span class="p">,</span>
</span><span id="__span-25-40"><a id="__codelineno-25-40" name="__codelineno-25-40" href="#__codelineno-25-40"></a><span class="w">        </span><span class="s2">"createUrl"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/url-to-create-document/"</span><span class="p">,</span>
</span><span id="__span-25-41"><a id="__codelineno-25-41" name="__codelineno-25-41" href="#__codelineno-25-41"></a><span class="w">        </span><span class="s2">"customization"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-42"><a id="__codelineno-25-42" name="__codelineno-25-42" href="#__codelineno-25-42"></a><span class="w">            </span><span class="s2">"autosave"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-43"><a id="__codelineno-25-43" name="__codelineno-25-43" href="#__codelineno-25-43"></a><span class="w">            </span><span class="s2">"chat"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-44"><a id="__codelineno-25-44" name="__codelineno-25-44" href="#__codelineno-25-44"></a><span class="w">            </span><span class="s2">"commentAuthorOnly"</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-25-45"><a id="__codelineno-25-45" name="__codelineno-25-45" href="#__codelineno-25-45"></a><span class="w">            </span><span class="s2">"comments"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-46"><a id="__codelineno-25-46" name="__codelineno-25-46" href="#__codelineno-25-46"></a><span class="w">            </span><span class="s2">"compactHeader"</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-25-47"><a id="__codelineno-25-47" name="__codelineno-25-47" href="#__codelineno-25-47"></a><span class="w">            </span><span class="s2">"compactToolbar"</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-25-48"><a id="__codelineno-25-48" name="__codelineno-25-48" href="#__codelineno-25-48"></a><span class="w">            </span><span class="s2">"compatibleFeatures"</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-25-49"><a id="__codelineno-25-49" name="__codelineno-25-49" href="#__codelineno-25-49"></a><span class="w">            </span><span class="s2">"customer"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-50"><a id="__codelineno-25-50" name="__codelineno-25-50" href="#__codelineno-25-50"></a><span class="w">                </span><span class="s2">"address"</span><span class="o">:</span><span class="w"> </span><span class="s2">"My City, 123a-45"</span><span class="p">,</span>
</span><span id="__span-25-51"><a id="__codelineno-25-51" name="__codelineno-25-51" href="#__codelineno-25-51"></a><span class="w">                </span><span class="s2">"info"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Some additional information"</span><span class="p">,</span>
</span><span id="__span-25-52"><a id="__codelineno-25-52" name="__codelineno-25-52" href="#__codelineno-25-52"></a><span class="w">                </span><span class="s2">"logo"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/logo-big.png"</span><span class="p">,</span>
</span><span id="__span-25-53"><a id="__codelineno-25-53" name="__codelineno-25-53" href="#__codelineno-25-53"></a><span class="w">                </span><span class="s2">"mail"</span><span class="o">:</span><span class="w"> </span><span class="s2">"john@example.com"</span><span class="p">,</span>
</span><span id="__span-25-54"><a id="__codelineno-25-54" name="__codelineno-25-54" href="#__codelineno-25-54"></a><span class="w">                </span><span class="s2">"name"</span><span class="o">:</span><span class="w"> </span><span class="s2">"John Smith and Co."</span><span class="p">,</span>
</span><span id="__span-25-55"><a id="__codelineno-25-55" name="__codelineno-25-55" href="#__codelineno-25-55"></a><span class="w">                </span><span class="s2">"www"</span><span class="o">:</span><span class="w"> </span><span class="s2">"example.com"</span>
</span><span id="__span-25-56"><a id="__codelineno-25-56" name="__codelineno-25-56" href="#__codelineno-25-56"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-25-57"><a id="__codelineno-25-57" name="__codelineno-25-57" href="#__codelineno-25-57"></a><span class="w">            </span><span class="s2">"feedback"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-58"><a id="__codelineno-25-58" name="__codelineno-25-58" href="#__codelineno-25-58"></a><span class="w">                </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com"</span><span class="p">,</span>
</span><span id="__span-25-59"><a id="__codelineno-25-59" name="__codelineno-25-59" href="#__codelineno-25-59"></a><span class="w">                </span><span class="s2">"visible"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-25-60"><a id="__codelineno-25-60" name="__codelineno-25-60" href="#__codelineno-25-60"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-25-61"><a id="__codelineno-25-61" name="__codelineno-25-61" href="#__codelineno-25-61"></a><span class="w">            </span><span class="s2">"forcesave"</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-25-62"><a id="__codelineno-25-62" name="__codelineno-25-62" href="#__codelineno-25-62"></a><span class="w">            </span><span class="s2">"goback"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-63"><a id="__codelineno-25-63" name="__codelineno-25-63" href="#__codelineno-25-63"></a><span class="w">                </span><span class="s2">"blank"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-64"><a id="__codelineno-25-64" name="__codelineno-25-64" href="#__codelineno-25-64"></a><span class="w">                </span><span class="s2">"requestClose"</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-25-65"><a id="__codelineno-25-65" name="__codelineno-25-65" href="#__codelineno-25-65"></a><span class="w">                </span><span class="s2">"text"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Open file location"</span><span class="p">,</span>
</span><span id="__span-25-66"><a id="__codelineno-25-66" name="__codelineno-25-66" href="#__codelineno-25-66"></a><span class="w">                </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com"</span>
</span><span id="__span-25-67"><a id="__codelineno-25-67" name="__codelineno-25-67" href="#__codelineno-25-67"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-25-68"><a id="__codelineno-25-68" name="__codelineno-25-68" href="#__codelineno-25-68"></a><span class="w">            </span><span class="s2">"help"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-69"><a id="__codelineno-25-69" name="__codelineno-25-69" href="#__codelineno-25-69"></a><span class="w">            </span><span class="s2">"hideRightMenu"</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-25-70"><a id="__codelineno-25-70" name="__codelineno-25-70" href="#__codelineno-25-70"></a><span class="w">            </span><span class="s2">"logo"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-71"><a id="__codelineno-25-71" name="__codelineno-25-71" href="#__codelineno-25-71"></a><span class="w">                </span><span class="s2">"image"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/logo.png"</span><span class="p">,</span>
</span><span id="__span-25-72"><a id="__codelineno-25-72" name="__codelineno-25-72" href="#__codelineno-25-72"></a><span class="w">                </span><span class="s2">"imageEmbedded"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/logo_em.png"</span><span class="p">,</span>
</span><span id="__span-25-73"><a id="__codelineno-25-73" name="__codelineno-25-73" href="#__codelineno-25-73"></a><span class="w">                </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com"</span>
</span><span id="__span-25-74"><a id="__codelineno-25-74" name="__codelineno-25-74" href="#__codelineno-25-74"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-25-75"><a id="__codelineno-25-75" name="__codelineno-25-75" href="#__codelineno-25-75"></a><span class="w">            </span><span class="s2">"macros"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-76"><a id="__codelineno-25-76" name="__codelineno-25-76" href="#__codelineno-25-76"></a><span class="w">            </span><span class="s2">"macrosMode"</span><span class="o">:</span><span class="w"> </span><span class="s2">"warn"</span><span class="p">,</span>
</span><span id="__span-25-77"><a id="__codelineno-25-77" name="__codelineno-25-77" href="#__codelineno-25-77"></a><span class="w">            </span><span class="s2">"mentionShare"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-78"><a id="__codelineno-25-78" name="__codelineno-25-78" href="#__codelineno-25-78"></a><span class="w">            </span><span class="s2">"plugins"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-79"><a id="__codelineno-25-79" name="__codelineno-25-79" href="#__codelineno-25-79"></a><span class="w">            </span><span class="s2">"reviewDisplay"</span><span class="o">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span>
</span><span id="__span-25-80"><a id="__codelineno-25-80" name="__codelineno-25-80" href="#__codelineno-25-80"></a><span class="w">            </span><span class="s2">"showReviewChanges"</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-25-81"><a id="__codelineno-25-81" name="__codelineno-25-81" href="#__codelineno-25-81"></a><span class="w">            </span><span class="s2">"spellcheck"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-25-82"><a id="__codelineno-25-82" name="__codelineno-25-82" href="#__codelineno-25-82"></a><span class="w">            </span><span class="s2">"toolbarHideFileName"</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-25-83"><a id="__codelineno-25-83" name="__codelineno-25-83" href="#__codelineno-25-83"></a><span class="w">            </span><span class="s2">"toolbarNoTabs"</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-25-84"><a id="__codelineno-25-84" name="__codelineno-25-84" href="#__codelineno-25-84"></a><span class="w">            </span><span class="s2">"trackChanges"</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-25-85"><a id="__codelineno-25-85" name="__codelineno-25-85" href="#__codelineno-25-85"></a><span class="w">            </span><span class="s2">"unit"</span><span class="o">:</span><span class="w"> </span><span class="s2">"cm"</span><span class="p">,</span>
</span><span id="__span-25-86"><a id="__codelineno-25-86" name="__codelineno-25-86" href="#__codelineno-25-86"></a><span class="w">            </span><span class="s2">"zoom"</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span>
</span><span id="__span-25-87"><a id="__codelineno-25-87" name="__codelineno-25-87" href="#__codelineno-25-87"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-25-88"><a id="__codelineno-25-88" name="__codelineno-25-88" href="#__codelineno-25-88"></a><span class="w">        </span><span class="s2">"embedded"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-89"><a id="__codelineno-25-89" name="__codelineno-25-89" href="#__codelineno-25-89"></a><span class="w">            </span><span class="s2">"embedUrl"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/embedded?doc=exampledocument1.docx"</span><span class="p">,</span>
</span><span id="__span-25-90"><a id="__codelineno-25-90" name="__codelineno-25-90" href="#__codelineno-25-90"></a><span class="w">            </span><span class="s2">"fullscreenUrl"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/embedded?doc=exampledocument1.docx#fullscreen"</span><span class="p">,</span>
</span><span id="__span-25-91"><a id="__codelineno-25-91" name="__codelineno-25-91" href="#__codelineno-25-91"></a><span class="w">            </span><span class="s2">"saveUrl"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/download?doc=exampledocument1.docx"</span><span class="p">,</span>
</span><span id="__span-25-92"><a id="__codelineno-25-92" name="__codelineno-25-92" href="#__codelineno-25-92"></a><span class="w">            </span><span class="s2">"shareUrl"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/view?doc=exampledocument1.docx"</span><span class="p">,</span>
</span><span id="__span-25-93"><a id="__codelineno-25-93" name="__codelineno-25-93" href="#__codelineno-25-93"></a><span class="w">            </span><span class="s2">"toolbarDocked"</span><span class="o">:</span><span class="w"> </span><span class="s2">"top"</span>
</span><span id="__span-25-94"><a id="__codelineno-25-94" name="__codelineno-25-94" href="#__codelineno-25-94"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-25-95"><a id="__codelineno-25-95" name="__codelineno-25-95" href="#__codelineno-25-95"></a><span class="w">        </span><span class="s2">"lang"</span><span class="o">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span>
</span><span id="__span-25-96"><a id="__codelineno-25-96" name="__codelineno-25-96" href="#__codelineno-25-96"></a><span class="w">        </span><span class="s2">"location"</span><span class="o">:</span><span class="w"> </span><span class="s2">"us"</span><span class="p">,</span>
</span><span id="__span-25-97"><a id="__codelineno-25-97" name="__codelineno-25-97" href="#__codelineno-25-97"></a><span class="w">        </span><span class="s2">"mode"</span><span class="o">:</span><span class="w"> </span><span class="s2">"edit"</span><span class="p">,</span>
</span><span id="__span-25-98"><a id="__codelineno-25-98" name="__codelineno-25-98" href="#__codelineno-25-98"></a><span class="w">        </span><span class="s2">"plugins"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-99"><a id="__codelineno-25-99" name="__codelineno-25-99" href="#__codelineno-25-99"></a><span class="w">             </span><span class="s2">"autostart"</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-25-100"><a id="__codelineno-25-100" name="__codelineno-25-100" href="#__codelineno-25-100"></a><span class="w">                 </span><span class="s2">"asc.{0616AE85-5DBE-4B6B-A0A9-455C4F1503AD}"</span><span class="p">,</span>
</span><span id="__span-25-101"><a id="__codelineno-25-101" name="__codelineno-25-101" href="#__codelineno-25-101"></a><span class="w">                 </span><span class="s2">"asc.{FFE1F462-1EA2-4391-990D-4CC84940B754}"</span><span class="p">,</span>
</span><span id="__span-25-102"><a id="__codelineno-25-102" name="__codelineno-25-102" href="#__codelineno-25-102"></a><span class="w">                 </span><span class="p">...</span>
</span><span id="__span-25-103"><a id="__codelineno-25-103" name="__codelineno-25-103" href="#__codelineno-25-103"></a><span class="w">             </span><span class="p">],</span>
</span><span id="__span-25-104"><a id="__codelineno-25-104" name="__codelineno-25-104" href="#__codelineno-25-104"></a><span class="w">             </span><span class="s2">"pluginsData"</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-25-105"><a id="__codelineno-25-105" name="__codelineno-25-105" href="#__codelineno-25-105"></a><span class="w">                 </span><span class="s2">"https://example.com/plugin1/config.json"</span><span class="p">,</span>
</span><span id="__span-25-106"><a id="__codelineno-25-106" name="__codelineno-25-106" href="#__codelineno-25-106"></a><span class="w">                 </span><span class="s2">"https://example.com/plugin2/config.json"</span><span class="p">,</span>
</span><span id="__span-25-107"><a id="__codelineno-25-107" name="__codelineno-25-107" href="#__codelineno-25-107"></a><span class="w">                 </span><span class="p">...</span>
</span><span id="__span-25-108"><a id="__codelineno-25-108" name="__codelineno-25-108" href="#__codelineno-25-108"></a><span class="w">             </span><span class="p">]</span>
</span><span id="__span-25-109"><a id="__codelineno-25-109" name="__codelineno-25-109" href="#__codelineno-25-109"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-25-110"><a id="__codelineno-25-110" name="__codelineno-25-110" href="#__codelineno-25-110"></a><span class="w">        </span><span class="s2">"recent"</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-25-111"><a id="__codelineno-25-111" name="__codelineno-25-111" href="#__codelineno-25-111"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-25-112"><a id="__codelineno-25-112" name="__codelineno-25-112" href="#__codelineno-25-112"></a><span class="w">                </span><span class="s2">"folder"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Example Files"</span><span class="p">,</span>
</span><span id="__span-25-113"><a id="__codelineno-25-113" name="__codelineno-25-113" href="#__codelineno-25-113"></a><span class="w">                </span><span class="s2">"title"</span><span class="o">:</span><span class="w"> </span><span class="s2">"exampledocument1.docx"</span><span class="p">,</span>
</span><span id="__span-25-114"><a id="__codelineno-25-114" name="__codelineno-25-114" href="#__codelineno-25-114"></a><span class="w">                </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/exampledocument1.docx"</span>
</span><span id="__span-25-115"><a id="__codelineno-25-115" name="__codelineno-25-115" href="#__codelineno-25-115"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-25-116"><a id="__codelineno-25-116" name="__codelineno-25-116" href="#__codelineno-25-116"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-25-117"><a id="__codelineno-25-117" name="__codelineno-25-117" href="#__codelineno-25-117"></a><span class="w">                </span><span class="s2">"folder"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Example Files"</span><span class="p">,</span>
</span><span id="__span-25-118"><a id="__codelineno-25-118" name="__codelineno-25-118" href="#__codelineno-25-118"></a><span class="w">                </span><span class="s2">"title"</span><span class="o">:</span><span class="w"> </span><span class="s2">"exampledocument2.docx"</span><span class="p">,</span>
</span><span id="__span-25-119"><a id="__codelineno-25-119" name="__codelineno-25-119" href="#__codelineno-25-119"></a><span class="w">                </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/exampledocument2.docx"</span>
</span><span id="__span-25-120"><a id="__codelineno-25-120" name="__codelineno-25-120" href="#__codelineno-25-120"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-25-121"><a id="__codelineno-25-121" name="__codelineno-25-121" href="#__codelineno-25-121"></a><span class="w">            </span><span class="p">...</span>
</span><span id="__span-25-122"><a id="__codelineno-25-122" name="__codelineno-25-122" href="#__codelineno-25-122"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-25-123"><a id="__codelineno-25-123" name="__codelineno-25-123" href="#__codelineno-25-123"></a><span class="w">        </span><span class="s2">"region"</span><span class="o">:</span><span class="w"> </span><span class="s2">"en-US"</span><span class="p">,</span>
</span><span id="__span-25-124"><a id="__codelineno-25-124" name="__codelineno-25-124" href="#__codelineno-25-124"></a><span class="w">        </span><span class="s2">"templates"</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-25-125"><a id="__codelineno-25-125" name="__codelineno-25-125" href="#__codelineno-25-125"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-25-126"><a id="__codelineno-25-126" name="__codelineno-25-126" href="#__codelineno-25-126"></a><span class="w">                </span><span class="s2">"image"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/exampletemplate1.png"</span><span class="p">,</span>
</span><span id="__span-25-127"><a id="__codelineno-25-127" name="__codelineno-25-127" href="#__codelineno-25-127"></a><span class="w">                </span><span class="s2">"title"</span><span class="o">:</span><span class="w"> </span><span class="s2">"exampletemplate1.docx"</span><span class="p">,</span>
</span><span id="__span-25-128"><a id="__codelineno-25-128" name="__codelineno-25-128" href="#__codelineno-25-128"></a><span class="w">                </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/url-to-create-template1"</span>
</span><span id="__span-25-129"><a id="__codelineno-25-129" name="__codelineno-25-129" href="#__codelineno-25-129"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-25-130"><a id="__codelineno-25-130" name="__codelineno-25-130" href="#__codelineno-25-130"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-25-131"><a id="__codelineno-25-131" name="__codelineno-25-131" href="#__codelineno-25-131"></a><span class="w">                </span><span class="s2">"image"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/exampletemplate2.png"</span><span class="p">,</span>
</span><span id="__span-25-132"><a id="__codelineno-25-132" name="__codelineno-25-132" href="#__codelineno-25-132"></a><span class="w">                </span><span class="s2">"title"</span><span class="o">:</span><span class="w"> </span><span class="s2">"exampletemplate2.docx"</span><span class="p">,</span>
</span><span id="__span-25-133"><a id="__codelineno-25-133" name="__codelineno-25-133" href="#__codelineno-25-133"></a><span class="w">                </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/url-to-create-template2"</span>
</span><span id="__span-25-134"><a id="__codelineno-25-134" name="__codelineno-25-134" href="#__codelineno-25-134"></a><span class="w">            </span><span class="p">},</span>
</span><span id="__span-25-135"><a id="__codelineno-25-135" name="__codelineno-25-135" href="#__codelineno-25-135"></a><span class="w">            </span><span class="p">...</span>
</span><span id="__span-25-136"><a id="__codelineno-25-136" name="__codelineno-25-136" href="#__codelineno-25-136"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-25-137"><a id="__codelineno-25-137" name="__codelineno-25-137" href="#__codelineno-25-137"></a><span class="w">        </span><span class="s2">"user"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-138"><a id="__codelineno-25-138" name="__codelineno-25-138" href="#__codelineno-25-138"></a><span class="w">            </span><span class="s2">"id"</span><span class="o">:</span><span class="w"> </span><span class="s2">"78e1e841"</span><span class="p">,</span>
</span><span id="__span-25-139"><a id="__codelineno-25-139" name="__codelineno-25-139" href="#__codelineno-25-139"></a><span class="w">            </span><span class="s2">"name"</span><span class="o">:</span><span class="w"> </span><span class="s2">"John Smith"</span>
</span><span id="__span-25-140"><a id="__codelineno-25-140" name="__codelineno-25-140" href="#__codelineno-25-140"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-25-141"><a id="__codelineno-25-141" name="__codelineno-25-141" href="#__codelineno-25-141"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-25-142"><a id="__codelineno-25-142" name="__codelineno-25-142" href="#__codelineno-25-142"></a><span class="w">    </span><span class="s2">"events"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-143"><a id="__codelineno-25-143" name="__codelineno-25-143" href="#__codelineno-25-143"></a><span class="w">        </span><span class="s2">"onAppReady"</span><span class="o">:</span><span class="w"> </span><span class="nx">onAppReady</span><span class="p">,</span>
</span><span id="__span-25-144"><a id="__codelineno-25-144" name="__codelineno-25-144" href="#__codelineno-25-144"></a><span class="w">        </span><span class="s2">"onCollaborativeChanges"</span><span class="o">:</span><span class="w"> </span><span class="nx">onCollaborativeChanges</span><span class="p">,</span>
</span><span id="__span-25-145"><a id="__codelineno-25-145" name="__codelineno-25-145" href="#__codelineno-25-145"></a><span class="w">        </span><span class="s2">"onDocumentReady"</span><span class="o">:</span><span class="w"> </span><span class="nx">onDocumentReady</span><span class="p">,</span>
</span><span id="__span-25-146"><a id="__codelineno-25-146" name="__codelineno-25-146" href="#__codelineno-25-146"></a><span class="w">        </span><span class="s2">"onDocumentStateChange"</span><span class="o">:</span><span class="w"> </span><span class="nx">onDocumentStateChange</span><span class="p">,</span>
</span><span id="__span-25-147"><a id="__codelineno-25-147" name="__codelineno-25-147" href="#__codelineno-25-147"></a><span class="w">        </span><span class="s2">"onDownloadAs"</span><span class="o">:</span><span class="w"> </span><span class="nx">onDownloadAs</span><span class="p">,</span>
</span><span id="__span-25-148"><a id="__codelineno-25-148" name="__codelineno-25-148" href="#__codelineno-25-148"></a><span class="w">        </span><span class="s2">"onError"</span><span class="o">:</span><span class="w"> </span><span class="nx">onError</span><span class="p">,</span>
</span><span id="__span-25-149"><a id="__codelineno-25-149" name="__codelineno-25-149" href="#__codelineno-25-149"></a><span class="w">        </span><span class="s2">"onInfo"</span><span class="o">:</span><span class="w"> </span><span class="nx">onInfo</span><span class="p">,</span>
</span><span id="__span-25-150"><a id="__codelineno-25-150" name="__codelineno-25-150" href="#__codelineno-25-150"></a><span class="w">        </span><span class="s2">"onMetaChange"</span><span class="o">:</span><span class="w"> </span><span class="nx">onMetaChange</span><span class="p">,</span>
</span><span id="__span-25-151"><a id="__codelineno-25-151" name="__codelineno-25-151" href="#__codelineno-25-151"></a><span class="w">        </span><span class="s2">"onOutdatedVersion"</span><span class="o">:</span><span class="w"> </span><span class="nx">onOutdatedVersion</span><span class="p">,</span>
</span><span id="__span-25-152"><a id="__codelineno-25-152" name="__codelineno-25-152" href="#__codelineno-25-152"></a><span class="w">        </span><span class="s2">"onRequestClose"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestClose</span><span class="p">,</span>
</span><span id="__span-25-153"><a id="__codelineno-25-153" name="__codelineno-25-153" href="#__codelineno-25-153"></a><span class="w">        </span><span class="s2">"onRequestCompareFile"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestCompareFile</span><span class="p">,</span>
</span><span id="__span-25-154"><a id="__codelineno-25-154" name="__codelineno-25-154" href="#__codelineno-25-154"></a><span class="w">        </span><span class="s2">"onRequestCreateNew"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestCreateNew</span><span class="p">,</span>
</span><span id="__span-25-155"><a id="__codelineno-25-155" name="__codelineno-25-155" href="#__codelineno-25-155"></a><span class="w">        </span><span class="s2">"onRequestEditRights"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestEditRights</span><span class="p">,</span>
</span><span id="__span-25-156"><a id="__codelineno-25-156" name="__codelineno-25-156" href="#__codelineno-25-156"></a><span class="w">        </span><span class="s2">"onRequestHistory"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestHistory</span><span class="p">,</span>
</span><span id="__span-25-157"><a id="__codelineno-25-157" name="__codelineno-25-157" href="#__codelineno-25-157"></a><span class="w">        </span><span class="s2">"onRequestHistoryClose"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestHistoryClose</span><span class="p">,</span>
</span><span id="__span-25-158"><a id="__codelineno-25-158" name="__codelineno-25-158" href="#__codelineno-25-158"></a><span class="w">        </span><span class="s2">"onRequestHistoryData"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestHistoryData</span><span class="p">,</span>
</span><span id="__span-25-159"><a id="__codelineno-25-159" name="__codelineno-25-159" href="#__codelineno-25-159"></a><span class="w">        </span><span class="s2">"onRequestInsertImage"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestInsertImage</span><span class="p">,</span>
</span><span id="__span-25-160"><a id="__codelineno-25-160" name="__codelineno-25-160" href="#__codelineno-25-160"></a><span class="w">        </span><span class="s2">"onRequestMailMergeRecipients"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestMailMergeRecipients</span><span class="p">,</span>
</span><span id="__span-25-161"><a id="__codelineno-25-161" name="__codelineno-25-161" href="#__codelineno-25-161"></a><span class="w">        </span><span class="s2">"onRequestRename"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestRename</span><span class="p">,</span>
</span><span id="__span-25-162"><a id="__codelineno-25-162" name="__codelineno-25-162" href="#__codelineno-25-162"></a><span class="w">        </span><span class="s2">"onRequestRestore"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestRestore</span><span class="p">,</span>
</span><span id="__span-25-163"><a id="__codelineno-25-163" name="__codelineno-25-163" href="#__codelineno-25-163"></a><span class="w">        </span><span class="s2">"onRequestSaveAs"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestSaveAs</span><span class="p">,</span>
</span><span id="__span-25-164"><a id="__codelineno-25-164" name="__codelineno-25-164" href="#__codelineno-25-164"></a><span class="w">        </span><span class="s2">"onRequestSendNotify"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestSendNotify</span><span class="p">,</span>
</span><span id="__span-25-165"><a id="__codelineno-25-165" name="__codelineno-25-165" href="#__codelineno-25-165"></a><span class="w">        </span><span class="s2">"onRequestSharingSettings"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestSaveAs</span><span class="p">,</span>
</span><span id="__span-25-166"><a id="__codelineno-25-166" name="__codelineno-25-166" href="#__codelineno-25-166"></a><span class="w">        </span><span class="s2">"onRequestUsers"</span><span class="o">:</span><span class="w"> </span><span class="nx">onRequestUsers</span><span class="p">,</span>
</span><span id="__span-25-167"><a id="__codelineno-25-167" name="__codelineno-25-167" href="#__codelineno-25-167"></a><span class="w">        </span><span class="s2">"onWarning"</span><span class="o">:</span><span class="w"> </span><span class="nx">onWarning</span>
</span><span id="__span-25-168"><a id="__codelineno-25-168" name="__codelineno-25-168" href="#__codelineno-25-168"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-25-169"><a id="__codelineno-25-169" name="__codelineno-25-169" href="#__codelineno-25-169"></a><span class="w">    </span><span class="s2">"height"</span><span class="o">:</span><span class="w"> </span><span class="s2">"100%"</span><span class="p">,</span>
</span><span id="__span-25-170"><a id="__codelineno-25-170" name="__codelineno-25-170" href="#__codelineno-25-170"></a><span class="w">    </span><span class="s2">"token"</span><span class="o">:</span><span class="w"> </span><span class="s2">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.e30.t-IDcSemACt8x4iTMCda8Yhe3iZaWbvV5XKSTbuAn0M"</span><span class="p">,</span>
</span><span id="__span-25-171"><a id="__codelineno-25-171" name="__codelineno-25-171" href="#__codelineno-25-171"></a><span class="w">    </span><span class="s2">"type"</span><span class="o">:</span><span class="w"> </span><span class="s2">"desktop"</span><span class="p">,</span>
</span><span id="__span-25-172"><a id="__codelineno-25-172" name="__codelineno-25-172" href="#__codelineno-25-172"></a><span class="w">    </span><span class="s2">"width"</span><span class="o">:</span><span class="w"> </span><span class="s2">"100%"</span>
</span><span id="__span-25-173"><a id="__codelineno-25-173" name="__codelineno-25-173" href="#__codelineno-25-173"></a><span class="p">};</span>
</span></code></pre></div> <blockquote> <p>å…¶ä¸­example.comæ˜¯å®‰è£…äº†æ–‡æ¡£ç®¡ç†å™¨å’Œæ–‡æ¡£å­˜å‚¨æœåŠ¡çš„æœåŠ¡å™¨çš„åç§°ã€‚</p> </blockquote> <h3 id="32config">3.2ã€Config<a class="headerlink" href="#32config" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>config base éƒ¨åˆ†å…è®¸æ›´æ”¹ä½¿ç”¨çš„å¹³å°ç±»å‹ã€æ–‡æ¡£æ˜¾ç¤ºå¤§å°ï¼ˆå®½åº¦å’Œé«˜åº¦ï¼‰ä»¥åŠæ‰“å¼€çš„æ–‡æ¡£ç±»å‹ã€‚</p> <table> <thead> <tr> <th>åå­—</th> <th>è¯´æ˜</th> <th>ç±»å‹</th> <th>ç¤ºä¾‹</th> </tr> </thead> <tbody> <tr> <td>documentType</td> <td>å®šä¹‰è¦æ‰“å¼€çš„æ–‡æ¡£ç±»å‹ï¼šofficeä¸‰ä»¶å¥—ï¼ˆWordã€Excelã€PowerPointï¼‰åˆ†åˆ«å¯¹åº”ï¼ˆwordã€cellã€slideï¼‰</td> <td>string</td> <td>"cell"</td> </tr> <tr> <td>height</td> <td>åœ¨æµè§ˆå™¨çª—å£ä¸­å®šä¹‰æ–‡æ¡£é«˜åº¦ï¼ˆé»˜è®¤ä¸º100%ï¼‰ã€‚</td> <td>string</td> <td>"100%"</td> </tr> <tr> <td>token</td> <td>å®šä¹‰ä»¥ä»¤ç‰Œçš„å½¢å¼æ·»åŠ åˆ°æ–‡æ¡£æœåŠ¡å™¨é…ç½®ä¸­çš„åŠ å¯†ç­¾åã€‚</td> <td>string</td> <td></td> </tr> <tr> <td>type</td> <td>å®šä¹‰ç”¨äºè®¿é—®æ–‡æ¡£çš„å¹³å°ç±»å‹ï¼šdesktopï¼ˆç”µè„‘ï¼‰ã€mobileï¼ˆæ‰‹æœºå¹³æ¿ï¼‰ã€embeddedï¼ˆç½‘é¡µåµŒå…¥ï¼‰ï¼Œé»˜è®¤ä¸ºdesktop</td> <td>string</td> <td>"desktop"</td> </tr> <tr> <td>width</td> <td>åœ¨æµè§ˆå™¨çª—å£ä¸­å®šä¹‰æ–‡æ¡£å®½åº¦ï¼ˆé»˜è®¤ä¸º100%ï¼‰ã€‚</td> <td>string</td> <td>"100%"</td> </tr> </tbody> </table> <p><strong>ç¤ºä¾‹</strong></p> <div class="language-javascript highlight"><span class="filename">JavaScript</span><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="kd">var</span><span class="w"> </span><span class="nx">docEditor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DocsAPI</span><span class="p">.</span><span class="nx">DocEditor</span><span class="p">(</span><span class="s2">"placeholder"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">    </span><span class="s2">"documentType"</span><span class="o">:</span><span class="w"> </span><span class="s2">"word"</span><span class="p">,</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">    </span><span class="s2">"height"</span><span class="o">:</span><span class="w"> </span><span class="s2">"100%"</span><span class="p">,</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">    </span><span class="s2">"token"</span><span class="o">:</span><span class="w"> </span><span class="s2">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.e30.t-IDcSemACt8x4iTMCda8Yhe3iZaWbvV5XKSTbuAn0M"</span><span class="p">,</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">    </span><span class="s2">"type"</span><span class="o">:</span><span class="w"> </span><span class="s2">"desktop"</span><span class="p">,</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">    </span><span class="s2">"width"</span><span class="o">:</span><span class="w"> </span><span class="s2">"100%"</span><span class="p">,</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="w">    </span><span class="p">...</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="p">});</span>
</span></code></pre></div> <h4 id="document">Document<a class="headerlink" href="#document" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <p>æ–‡æ¡£éƒ¨åˆ†å…è®¸æ›´æ”¹ä¸æ–‡æ¡£ç›¸å…³çš„æ‰€æœ‰å‚æ•°ï¼ˆæ ‡é¢˜ã€urlã€æ–‡ä»¶ç±»å‹ç­‰ï¼‰ï¼Œè¿™äº›å‚æ•°ä¸ºå¿…å¡«å­—æ®µã€‚</p> <table> <thead> <tr> <th>åå­—</th> <th>è¯´æ˜</th> <th>ç±»å‹</th> <th>ç¤ºä¾‹</th> </tr> </thead> <tbody> <tr> <td>fileType</td> <td>å®šä¹‰æŸ¥çœ‹æˆ–ç¼–è¾‘çš„æºæ–‡æ¡£çš„æ–‡ä»¶ç±»å‹ã€‚å¿…é¡»å°å†™ã€‚</td> <td>string</td> <td>"docx"</td> </tr> <tr> <td>key</td> <td>å®šä¹‰æœåŠ¡ç”¨äºè¯†åˆ«æ–‡æ¡£çš„å”¯ä¸€æ–‡æ¡£æ ‡è¯†ç¬¦ã€‚å¦‚æœå‘é€äº†å·²çŸ¥å¯†é’¥ï¼Œæ–‡æ¡£å°†ä»ç¼“å­˜ä¸­è·å–ã€‚æ¯æ¬¡ç¼–è¾‘å’Œä¿å­˜æ–‡æ¡£æ—¶ï¼Œéƒ½å¿…é¡»é‡æ–°ç”Ÿæˆå¯†é’¥ã€‚æ–‡æ¡£ <code>url</code> å¯ç”¨ä½œé”®ï¼Œä½†ä¸åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼Œé•¿åº¦é™åˆ¶ä¸º128ä¸ªç¬¦å·ã€‚</td> <td>string</td> <td>"Khirz6zTPdfd7"</td> </tr> <tr> <td>title</td> <td>ä¸ºå·²æµè§ˆæˆ–ç¼–è¾‘çš„æ–‡æ¡£å®šä¹‰æ‰€éœ€çš„æ–‡ä»¶åï¼Œè¯¥æ–‡ä»¶åä¹Ÿå°†åœ¨ä¸‹è½½æ–‡æ¡£æ—¶ç”¨ä½œæ–‡ä»¶åã€‚é•¿åº¦é™åˆ¶ä¸º128ä¸ªç¬¦å·ã€‚</td> <td>string</td> <td>"æµ‹è¯•.docx"</td> </tr> <tr> <td>url</td> <td>å®šä¹‰å­˜å‚¨å·²æŸ¥çœ‹æˆ–ç¼–è¾‘çš„æºæ–‡æ¡£çš„ç»å¯¹URLã€‚</td> <td>string</td> <td></td> </tr> </tbody> </table> <p><strong>ç¤ºä¾‹</strong></p> <div class="language-javascript highlight"><span class="filename">JavaScript</span><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="kd">var</span><span class="w"> </span><span class="nx">docEditor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DocsAPI</span><span class="p">.</span><span class="nx">DocEditor</span><span class="p">(</span><span class="s2">"placeholder"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">    </span><span class="s2">"document"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">        </span><span class="s2">"fileType"</span><span class="o">:</span><span class="w"> </span><span class="s2">"docx"</span><span class="p">,</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">        </span><span class="s2">"key"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Khirz6zTPdfd7"</span><span class="p">,</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="w">        </span><span class="s2">"title"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Example Document Title.docx"</span><span class="p">,</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">        </span><span class="s2">"url"</span><span class="o">:</span><span class="w"> </span><span class="s2">"https://example.com/url-to-example-document.docx"</span><span class="p">,</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">    </span><span class="p">...</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="p">});</span>
</span></code></pre></div> <blockquote> <p>keyå¯ä»¥ä½¿ç”¨ï¼š0-9ã€a-zã€a-zã€-._=ã€‚æœ€å¤§å¯†é’¥é•¿åº¦ä¸º20ä¸ªå­—ç¬¦ã€‚</p> </blockquote> <h5 id="info">Info<a class="headerlink" href="#info" title="é”šç‚¹é“¾æ¥">Â¶</a></h5> <p>æ–‡æ¡£ä¿¡æ¯éƒ¨åˆ†å…è®¸æ›´æ”¹æ–‡æ¡£çš„é™„åŠ å‚æ•°(æ–‡æ¡£æ‰€æœ‰è€…ã€æ–‡æ¡£å­˜å‚¨çš„æ–‡ä»¶å¤¹ã€ä¸Šä¼ æ—¥æœŸã€å…±äº«è®¾ç½®)ã€‚</p> <table> <thead> <tr> <th>åå­—</th> <th>è¯´æ˜</th> <th>ç±»å‹</th> <th>ç¤ºä¾‹</th> </tr> </thead> <tbody> <tr> <td>folder</td> <td>å®šä¹‰ç”¨äºå­˜å‚¨æ–‡æ¡£çš„æ–‡ä»¶å¤¹ï¼ˆå¦‚æœæ–‡æ¡£å­˜å‚¨åœ¨æ ¹æ–‡ä»¶å¤¹ä¸­ï¼Œåˆ™å¯ä»¥ä¸ºç©ºï¼‰ã€‚</td> <td>string</td> <td>"Example Files"</td> </tr> <tr> <td>owner</td> <td>å®šä¹‰æ–‡æ¡£æ‰€æœ‰è€…/åˆ›å»ºè€…çš„åç§°ã€‚</td> <td>string</td> <td>"John Smith"</td> </tr> <tr> <td>sharingSettings</td> <td>æ˜¾ç¤ºæœ‰å…³å…è®¸ä¸å…¶ä»–ç”¨æˆ·å…±äº«æ–‡æ¡£çš„è®¾ç½®çš„ä¿¡æ¯ï¼š<br><strong>isLink</strong>--å°†ç”¨æˆ·å›¾æ ‡æ›´æ”¹ä¸ºé“¾æ¥å›¾æ ‡ï¼Œ<strong>type</strong>ï¼šbooleanï¼Œ<strong>example</strong>ï¼šfalseã€‚<br><strong>permissions</strong>--å…·æœ‰ä¸Šè¿°åç§°çš„ç”¨æˆ·çš„è®¿é—®æƒé™ã€‚å¯ä»¥æ˜¯ <strong>Full Access</strong>, <strong>Read Only</strong> æˆ–è€… <strong>Deny Access</strong>ã€‚<strong>type</strong>ï¼šstringï¼Œ<strong>example</strong>ï¼š"Full Access"ã€‚<br><strong>user</strong>--å°†ä¸ä¹‹å…±äº«æ–‡æ¡£çš„ç”¨æˆ·çš„åç§°ã€‚<strong>type</strong>ï¼šstringï¼Œ<strong>example</strong>ï¼šâ€John Smithâ€œã€‚</td> <td>å¯¹è±¡æ•°ç»„</td> <td></td> </tr> </tbody> </table> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/sharing_settings.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/sharing_settings.png" alt="img" style="width:60%;"></a></p> <table> <thead> <tr> <th>åå­—</th> <th>è¯´æ˜</th> <th>ç±»å‹</th> <th>ç¤ºä¾‹</th> </tr> </thead> <tbody> <tr> <td>uploaded</td> <td>å®šä¹‰æ–‡æ¡£ä¸Šä¼ æ—¥æœŸã€‚</td> <td>string</td> <td>"2010-07-07 3:46 PM"</td> </tr> </tbody> </table> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/info.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/info.png" alt="img" style="width:60%;"></a></p> <p><strong>ç¤ºä¾‹</strong></p> <div class="language-javascript highlight"><span class="filename">JavaScript</span><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kd">var</span><span class="w"> </span><span class="nx">docEditor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DocsAPI</span><span class="p">.</span><span class="nx">DocEditor</span><span class="p">(</span><span class="s2">"placeholder"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">    </span><span class="s2">"document"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">        </span><span class="s2">"info"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">            </span><span class="s2">"folder"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Example Files"</span><span class="p">,</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="w">            </span><span class="s2">"owner"</span><span class="o">:</span><span class="w"> </span><span class="s2">"John Smith"</span><span class="p">,</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="w">            </span><span class="s2">"sharingSettings"</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="w">                </span><span class="p">{</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="w">                    </span><span class="s2">"permissions"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Full Access"</span><span class="p">,</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="w">                    </span><span class="s2">"user"</span><span class="o">:</span><span class="w"> </span><span class="s2">"John Smith"</span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="w">                </span><span class="p">{</span>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="w">                    </span><span class="s2">"isLink"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="w">                    </span><span class="s2">"permissions"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Read Only"</span><span class="p">,</span>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="w">                    </span><span class="s2">"user"</span><span class="o">:</span><span class="w"> </span><span class="s2">"External link"</span>
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="w">                </span><span class="p">},</span>
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="w">                </span><span class="p">...</span>
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="w">            </span><span class="p">],</span>
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="w">            </span><span class="s2">"uploaded"</span><span class="o">:</span><span class="w"> </span><span class="s2">"2010-07-07 3:46 PM"</span>
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a><span class="w">        </span><span class="p">...</span>
</span><span id="__span-28-21"><a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-28-22"><a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a><span class="w">    </span><span class="p">...</span>
</span><span id="__span-28-23"><a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a><span class="p">});</span>
</span></code></pre></div> <h5 id="permissions">Permissions<a class="headerlink" href="#permissions" title="é”šç‚¹é“¾æ¥">Â¶</a></h5> <p>æ–‡æ¡£æƒé™éƒ¨åˆ†å…è®¸æ›´æ”¹æ˜¯å¦è¦ç¼–è¾‘å’Œä¸‹è½½æ–‡æ¡£çš„æƒé™ã€‚</p> <table> <thead> <tr> <th>åå­—</th> <th>è¯´æ˜</th> <th>ç±»å‹</th> <th>ç¤ºä¾‹</th> </tr> </thead> <tbody> <tr> <td>comment</td> <td>å®šä¹‰æ˜¯å¦å¯ä»¥å¯¹æ–‡æ¡£è¿›è¡Œæ³¨é‡Šã€‚ å¦‚æœæ³¨é‡Šæƒé™è®¾ç½®ä¸º<code>true</code>ï¼Œåˆ™æ–‡æ¡£ä¾§æ å°†åŒ…å«â€œæ³¨é‡Šâ€èœå•é€‰é¡¹ï¼› åªæœ‰å°†<code>mode</code>å‚æ•°è®¾ç½®ä¸º<code>edit</code>æ—¶ï¼Œæ–‡æ¡£æ³¨é‡Šæ‰å¯ç”¨äºæ–‡æ¡£ç¼–è¾‘å™¨ã€‚ é»˜è®¤å€¼ä¸<code>edit</code>å‚æ•°çš„å€¼ä¸€è‡´ã€‚</td> <td>boolean</td> <td>true</td> </tr> </tbody> </table> <blockquote> <p>å¦‚æœ<code>edit</code>è®¾ç½®ä¸º<code>true</code>ï¼Œ<code>comment</code>ä¹Ÿè®¾ç½®ä¸º<code>true</code>ï¼Œç”¨æˆ·å°†èƒ½å¤Ÿç¼–è¾‘æ–‡æ¡£å’Œæ³¨é‡Šã€‚å¦‚æœ<code>edit</code>è®¾ç½®ä¸º<code>true</code>ï¼Œ<code>comment</code>è®¾ç½®ä¸º<code>false</code>ï¼Œç”¨æˆ·åªèƒ½ç¼–è¾‘ï¼Œç›¸åº”çš„è¯„è®ºåŠŸèƒ½åªèƒ½æŸ¥çœ‹ï¼Œè¯„è®ºçš„æ·»åŠ å’Œç¼–è¾‘å°†ä¸å¯ç”¨ã€‚å¦‚æœ<code>edit</code>è®¾ç½®ä¸º<code>false</code>ï¼Œè€Œ<code>comment</code>è®¾ç½®ä¸º<code>true</code>ï¼Œåˆ™æ–‡æ¡£ä»…å¯ç”¨äºæ³¨é‡Šã€‚å¦‚æœ<code>edit</code>è®¾ç½®ä¸º<code>false</code>ï¼Œ<code>review</code>è®¾ç½®ä¸º<code>false</code>ï¼Œ<code>comment</code>è®¾ç½®ä¸º<code>true</code>ï¼Œåˆ™ä¸è€ƒè™‘<code>fillForms</code>å€¼ï¼Œè¡¨æ ¼å¡«å†™ä¸å¯ç”¨ã€‚</p> </blockquote> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/comment.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/comment.png" alt="img" style="width:35%;"></a></p> <table> <thead> <tr> <th>åå­—</th> <th>è¯´æ˜</th> <th>ç±»å‹</th> <th>ç¤ºä¾‹</th> </tr> </thead> <tbody> <tr> <td>copy</td> <td>å…è®¸æ‚¨å°†å†…å®¹å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚ é»˜è®¤å€¼æ˜¯trueã€‚</td> <td>boolean</td> <td>true</td> </tr> <tr> <td>download</td> <td>å®šä¹‰æ˜¯å¦å¯ä»¥ä¸‹è½½æ–‡æ¡£æˆ–ä»…åœ¨çº¿æŸ¥çœ‹æˆ–ç¼–è¾‘æ–‡æ¡£ã€‚ å¦‚æœå°†ä¸‹è½½æƒé™è®¾ç½®ä¸ºâ€œ falseâ€ï¼Œåˆ™â€œæ–‡ä»¶â€èœå•ä¸­å°†ä¸å­˜åœ¨â€œä¸‹è½½ä¸º...â€èœå•é€‰é¡¹ã€‚ é»˜è®¤å€¼æ˜¯trueã€‚</td> <td>boolean</td> <td>true</td> </tr> <tr> <td>edit</td> <td>å®šä¹‰æ–‡æ¡£æ˜¯å¯ä»¥ç¼–è¾‘è¿˜æ˜¯åªèƒ½æŸ¥çœ‹ã€‚ å¦‚æœå°†ç¼–è¾‘æƒé™è®¾ç½®ä¸ºâ€œ trueâ€ï¼Œåˆ™â€œæ–‡ä»¶â€èœå•å°†åŒ…å«â€œç¼–è¾‘æ–‡æ¡£â€èœå•é€‰é¡¹ï¼› è¯·æ³¨æ„ï¼Œå¦‚æœå°†ç¼–è¾‘æƒé™è®¾ç½®ä¸ºâ€œ falseâ€ï¼Œåˆ™å°†åœ¨æŸ¥çœ‹å™¨ä¸­æ‰“å¼€è¯¥æ–‡æ¡£ï¼Œå³ä½¿å°†<code>mode</code>å‚æ•°è®¾ç½®ä¸º<code>edit</code>ï¼Œä¹Ÿå°†æ— æ³•å°†å…¶åˆ‡æ¢åˆ°ç¼–è¾‘å™¨ã€‚ é»˜è®¤å€¼æ˜¯trueã€‚</td> <td>boolean</td> <td>true</td> </tr> <tr> <td>print</td> <td>å®šä¹‰æ˜¯å¦å¯ä»¥æ‰“å°æ–‡æ¡£ã€‚ å¦‚æœå°†æ‰“å°è®¸å¯è®¾ç½®ä¸ºâ€œ falseâ€ï¼Œåˆ™â€œæ–‡ä»¶â€èœå•ä¸­å°†ä¸å­˜åœ¨â€œæ‰“å°â€èœå•é€‰é¡¹ã€‚ é»˜è®¤å€¼æ˜¯trueã€‚</td> <td>boolean</td> <td>true</td> </tr> </tbody> </table> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/permissions.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/permissions.png" alt="img" style="width:60%;"></a></p> <table> <thead> <tr> <th>åå­—</th> <th>è¯´æ˜</th> <th>ç±»å‹</th> <th>ç¤ºä¾‹</th> </tr> </thead> <tbody> <tr> <td>fillForms</td> <td>å®šä¹‰æ˜¯å¦å¯ä»¥å¡«å†™è¡¨æ ¼ã€‚ å¦‚æœå°†modeå‚æ•°è®¾ç½®ä¸ºeditï¼Œåˆ™å¡«å†™è¡¨å•ä»…å¯¹æ–‡æ¡£ç¼–è¾‘å™¨å¯ç”¨ã€‚ é»˜è®¤å€¼ä¸editæˆ–reviewå‚æ•°çš„å€¼ä¸€è‡´ã€‚</td> <td>boolean</td> <td>true</td> </tr> </tbody> </table> <blockquote> <p>å¦‚æœå°†editè®¾ç½®ä¸ºâ€œ trueâ€æˆ–å°†reviewè®¾ç½®ä¸ºâ€œ trueâ€ï¼Œåˆ™ä¸è€ƒè™‘fillFormså€¼ï¼Œå¹¶ä¸”å¯ä»¥è¿›è¡Œè¡¨å•å¡«å……ã€‚ å¦‚æœå°†editè®¾ç½®ä¸ºâ€œ falseâ€ï¼Œå°†reviewè®¾ç½®ä¸ºâ€œ falseâ€ï¼Œå¹¶ä¸”fillFormsä¹Ÿè®¾ç½®ä¸ºâ€œ trueâ€ï¼Œåˆ™ç”¨æˆ·åªèƒ½åœ¨æ–‡æ¡£ä¸­å¡«å†™è¡¨å•ã€‚ å¦‚æœeditè®¾ç½®ä¸ºâ€œ falseâ€ä¸”å®¡é˜…è®¾ç½®ä¸ºâ€œ falseâ€ä¸”fillFormsè®¾ç½®ä¸ºâ€œ trueâ€ï¼Œåˆ™ä¸è€ƒè™‘æ³¨é‡Šå€¼ï¼Œå¹¶ä¸”æ³¨é‡Šä¸å¯ç”¨ã€‚ å½“å‰ä»…è¡¨å•å¡«å†™æ¨¡å¼ä»…é€‚ç”¨äºâ€œæ–‡æ¡£ç¼–è¾‘å™¨â€ã€‚</p> </blockquote> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/fill-forms.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/fill-forms.png" alt="img" style="width:40%;"></a></p> <table> <thead> <tr> <th>åå­—</th> <th>è¯´æ˜</th> <th>ç±»å‹</th> <th>ç¤ºä¾‹</th> </tr> </thead> <tbody> <tr> <td>modifyContentControl</td> <td>å®šä¹‰æ˜¯å¦å¯ä»¥æ›´æ”¹å†…å®¹æ§ä»¶è®¾ç½®ã€‚ ä»…å½“modeå‚æ•°è®¾ç½®ä¸ºeditæ—¶ï¼Œå†…å®¹æ§ä»¶ä¿®æ”¹æ‰å¯ç”¨äºæ–‡æ¡£ç¼–è¾‘å™¨ã€‚ é»˜è®¤å€¼æ˜¯trueã€‚</td> <td>boolean</td> <td>true</td> </tr> <tr> <td>modifyFilter</td> <td>å®šä¹‰è¿‡æ»¤å™¨æ˜¯å¦å¯ä»¥å…¨å±€åº”ç”¨ï¼ˆtrueï¼‰å½±å“æ‰€æœ‰å…¶ä»–ç”¨æˆ·ï¼Œæˆ–å±€éƒ¨åº”ç”¨ï¼ˆfalseï¼‰ï¼Œå³ä»…é€‚ç”¨äºå½“å‰ç”¨æˆ·ã€‚ å¦‚æœå°†modeå‚æ•°è®¾ç½®ä¸ºeditï¼Œåˆ™åªèƒ½å¯¹ç”µå­è¡¨æ ¼ç¼–è¾‘å™¨è¿›è¡Œè¿‡æ»¤å™¨ä¿®æ”¹ã€‚ é»˜è®¤å€¼æ˜¯trueã€‚</td> <td></td> <td></td> </tr> </tbody> </table> <blockquote> <p>å¦‚æœæ–‡æ¡£ç”±å…·æœ‰å®Œå…¨è®¿é—®æƒé™çš„ç”¨æˆ·ç¼–è¾‘ï¼Œåˆ™ç”±è¯¥ç”¨æˆ·åº”ç”¨çš„è¿‡æ»¤å™¨å°†å¯¹æ‰€æœ‰å…¶ä»–ç”¨æˆ·å¯è§ï¼Œè€Œä¸ç®¡å…¶æœ¬åœ°è®¾ç½®å¦‚ä½•ã€‚</p> </blockquote> <table> <thead> <tr> <th>åå­—</th> <th>è¯´æ˜</th> <th>ç±»å‹</th> <th>ç¤ºä¾‹</th> </tr> </thead> <tbody> <tr> <td>review</td> <td>å®šä¹‰æ˜¯å¦å¯ä»¥æŸ¥çœ‹æ–‡æ¡£ã€‚ å¦‚æœå®¡é˜…æƒé™è®¾ç½®ä¸ºtrueï¼Œåˆ™æ–‡æ¡£çŠ¶æ€æ å°†åŒ…å«â€œå®¡é˜…â€èœå•é€‰é¡¹ï¼› å¦‚æœå°†modeå‚æ•°è®¾ç½®ä¸ºeditï¼Œåˆ™æ–‡æ¡£å®¡é˜…ä»…å¯¹æ–‡æ¡£ç¼–è¾‘å™¨å¯ç”¨ã€‚ é»˜è®¤å€¼ä¸editå‚æ•°çš„å€¼ä¸€è‡´ã€‚</td> <td>boolean</td> <td>true</td> </tr> </tbody> </table> <blockquote> <p>å¦‚æœå°†ç¼–è¾‘è®¾ç½®ä¸ºâ€œ trueâ€ï¼Œå¹¶ä¸”å®¡é˜…ä¹Ÿè®¾ç½®ä¸ºâ€œ trueâ€ï¼Œåˆ™ç”¨æˆ·å°†èƒ½å¤Ÿç¼–è¾‘æ–‡æ¡£ï¼Œæ¥å—/æ‹’ç»æ‰€åšçš„æ›´æ”¹å¹¶è‡ªå·±åˆ‡æ¢åˆ°å®¡é˜…æ¨¡å¼ã€‚ å¦‚æœç¼–è¾‘è®¾ç½®ä¸ºâ€œ trueâ€ï¼Œè€Œå®¡é˜…è®¾ç½®ä¸ºâ€œ falseâ€ï¼Œåˆ™ç”¨æˆ·å°†åªèƒ½è¿›è¡Œç¼–è¾‘ã€‚ å¦‚æœå°†ç¼–è¾‘è®¾ç½®ä¸ºâ€œ falseâ€ï¼Œå°†å®¡é˜…è®¾ç½®ä¸ºâ€œ trueâ€ï¼Œåˆ™è¯¥æ–‡æ¡£ä»…åœ¨å®¡é˜…æ¨¡å¼ä¸‹å¯ç”¨ã€‚</p> </blockquote> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/review.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/review.png" alt="img" style="width:33%;"></a></p> <p><strong>å®¡é˜…</strong></p> <div class="language-javascript highlight"><span class="filename">JavaScript</span><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="kd">var</span><span class="w"> </span><span class="nx">docEditor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DocsAPI</span><span class="p">.</span><span class="nx">DocEditor</span><span class="p">(</span><span class="s2">"placeholder"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">    </span><span class="s2">"document"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="w">        </span><span class="s2">"permissions"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w">            </span><span class="s2">"comment"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="w">            </span><span class="s2">"copy"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="w">            </span><span class="s2">"download"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="w">            </span><span class="s2">"edit"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="w">            </span><span class="s2">"fillForms"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="w">            </span><span class="s2">"modifyContentControl"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="w">            </span><span class="s2">"modifyFilter"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="w">            </span><span class="s2">"print"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a><span class="w">            </span><span class="s2">"review"</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a><span class="w">        </span><span class="p">...</span>
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a><span class="w">    </span><span class="p">...</span>
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a><span class="p">});</span>
</span></code></pre></div> <h2 id="4æ•…éšœæ’é™¤">4ã€æ•…éšœæ’é™¤<a class="headerlink" href="#4æ•…éšœæ’é™¤" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <h3 id="411ä¸‹è½½å¤±è´¥">4.1.1ã€ä¸‹è½½å¤±è´¥<a class="headerlink" href="#411ä¸‹è½½å¤±è´¥" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/e-download.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/e-download.png" alt="Download failed" style="width:33%;"></a></p> <p>ç¼–è¾‘å™¨åŠ è½½è¿‡ç¨‹ä¸­å°†æ˜¾ç¤º â€œä¸‹è½½å¤±è´¥â€ æ¶ˆæ¯ã€‚</p> <p>æ–‡æ¡£ç¼–è¾‘æœåŠ¡æ— æ³•è·å–æ–‡ä»¶è¿›è¡Œç¼–è¾‘ã€‚</p> <p>æ£€æŸ¥åˆ° <code>document.url</code> ä¸­æŒ‡å®šçš„æ–‡ä»¶çš„é“¾æ¥æ˜¯å¦æ­£ç¡®ã€‚ å¿…é¡»å¯ä»¥ä»æ–‡æ¡£ç¼–è¾‘æœåŠ¡è®¿é—®è¯¥é“¾æ¥ã€‚</p> <h3 id="412æ–‡ä»¶ç‰ˆæœ¬å˜æ›´">4.1.2ã€æ–‡ä»¶ç‰ˆæœ¬å˜æ›´<a class="headerlink" href="#412æ–‡ä»¶ç‰ˆæœ¬å˜æ›´" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="!assets/OnlyOffice/e-key.png" data-desc-position="bottom"><img src="!assets/OnlyOffice/e-key.png" alt="The file version has been changed" style="width:50%;"></a></p> <p>ç¼–è¾‘å™¨åŠ è½½ â€œThe file version has been changed. The page will be reloaded.â€ï¼ˆæ–‡ä»¶ç‰ˆæœ¬å·²è¢«æ›´æ”¹ã€‚é¡µé¢å°†è¢«é‡æ–°åŠ è½½ï¼‰çš„æ¶ˆæ¯ã€‚</p> <p>æ–‡æ¡£ç¼–è¾‘æœåŠ¡æ— æ³•æ‰“å¼€ä»¥å‰ç¼–è¾‘å’Œä¿å­˜çš„æ–‡ä»¶è¿›è¡Œç¼–è¾‘ã€‚</p> <p>æ¯æ¬¡ç¼–è¾‘å’Œä¿å­˜æ–‡æ¡£æ—¶ï¼Œå¿…é¡»é‡æ–°ç”Ÿæˆ <code>document.key</code>ã€‚</p> <h3 id="413403-editorbin">4.1.3ã€403 Editor.bin<a class="headerlink" href="#413403-editorbin" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>ç¼–è¾‘å™¨åŠ è½½å¤±è´¥ï¼ŒF12 çœ‹åˆ°è·å– Editor.bin çš„é“¾æ¥å‡ºç° 403ã€‚</p> <p>æœ€ç®€å•çš„è§£å†³åŠæ³•æ˜¯åœ¨å®¹å™¨å†…éƒ¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p> <div class="language-shell highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>bash<span class="w"> </span>documentserver-update-securelink.sh
</span></code></pre></div> <h2 id="5å‰ç«¯æ¡†æ¶">5ã€å‰ç«¯æ¡†æ¶<a class="headerlink" href="#5å‰ç«¯æ¡†æ¶" title="é”šç‚¹é“¾æ¥">Â¶</a></h2> <p>ONLYOFFICE æ–‡æ¡£å¯ä»¥ä½¿ç”¨ç»„ä»¶ä¸ä¸€äº›ç°æœ‰çš„å‰ç«¯æ¡†æ¶é›†æˆã€‚è¿™äº›ç»„ä»¶æä¾›éšæ—¶å¯ç”¨çš„ä»£ç æ¨¡å—ã€æ ‡å‡†åŒ–çš„å‰ç«¯æŠ€æœ¯å’Œå¯é‡ç”¨çš„æ¥å£å—ï¼Œä½¿æ„å»ºç”¨æˆ·ç•Œé¢çš„è¿‡ç¨‹æ›´å¿«ã€æ›´å®¹æ˜“ã€‚</p> <p>ç›®å‰ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ¡†æ¶ï¼š</p> <ul> <li>Angular</li> <li>React</li> <li>Vue</li> </ul> <h3 id="51vue-2x">5.1ã€Vue 2.x<a class="headerlink" href="#51vue-2x" title="é”šç‚¹é“¾æ¥">Â¶</a></h3> <p>ç›®å‰å®˜æ–¹æä¾›çš„ç»„ä»¶éƒ½æ˜¯åŸºäº Vue 3.x çš„ï¼ŒVue 2.x ä¸èƒ½ç›´æ¥ä½¿ç”¨ã€‚</p> <p>ä¸‹é¢çš„çš„ä¸º Vue 2.x ä¸­åªä½¿ç”¨é¢„è§ˆçš„ç¤ºä¾‹ï¼š</p> <ul> <li>utils.jsï¼šå·¥å…·æ–¹æ³•ã€‚</li> <li>DocEditor.vueï¼šå°è£…çš„ OnlyOffice ç¼–è¾‘å™¨ç»„ä»¶ã€‚</li> <li>DocDialog.vueï¼šä½¿ç”¨ç¼–è¾‘å™¨ç»„ä»¶çš„ Dialog ç¤ºä¾‹ã€‚</li> </ul> <h4 id="511utilsjs">5.1.1ã€utils.js<a class="headerlink" href="#511utilsjs" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <div class="language-javascript highlight"><span class="filename">JavaScript</span><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="cm">/**</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="cm"> * åŠ¨æ€åŠ è½½æŒ‡å®š JavaScript è„šæœ¬åˆ°é¡µé¢ä¸­ï¼ˆæŒ‰éœ€åŠ è½½ OnlyOffice çš„ DocsAPIï¼‰</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="cm"> * @param {string} url - è¦åŠ è½½çš„è„šæœ¬ URL</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="cm"> * @param {string} id - è„šæœ¬åœ¨ DOM ä¸­çš„å”¯ä¸€ IDï¼Œé¿å…é‡å¤åŠ è½½</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="cm"> * @returns {Promise&lt;void&gt;} - è„šæœ¬åŠ è½½æˆåŠŸæˆ–å¤±è´¥çš„ Promise</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="cm"> */</span>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">loadScript</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="nx">reject</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">existingScript</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">existingScript</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a><span class="w">      </span><span class="c1">// å¦‚æœè„šæœ¬å·²å­˜åœ¨äº DOM ä¸­</span>
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DocsAPI</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a><span class="w">        </span><span class="c1">// DocsAPI å·²å¯ç”¨ï¼Œç«‹å³è§£æ</span>
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">resolve</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-31-16"><a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a>
</span><span id="__span-31-17"><a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a><span class="w">      </span><span class="c1">// è„šæœ¬å­˜åœ¨ä½† DocsAPI å°šæœªåˆå§‹åŒ–ï¼Œè¿›è¡Œè½®è¯¢</span>
</span><span id="__span-31-18"><a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a><span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nx">attempts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</span><span id="__span-31-19"><a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">maxAttempts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20</span><span class="p">;</span><span class="w"> </span><span class="c1">// æœ€å¤šè½®è¯¢ 20 æ¬¡ï¼ˆçº¦ 10 ç§’ï¼‰</span>
</span><span id="__span-31-20"><a id="__codelineno-31-20" name="__codelineno-31-20" href="#__codelineno-31-20"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">intervalHandler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">setInterval</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-21"><a id="__codelineno-31-21" name="__codelineno-31-21" href="#__codelineno-31-21"></a><span class="w">        </span><span class="nx">attempts</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-31-22"><a id="__codelineno-31-22" name="__codelineno-31-22" href="#__codelineno-31-22"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DocsAPI</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-23"><a id="__codelineno-31-23" name="__codelineno-31-23" href="#__codelineno-31-23"></a><span class="w">          </span><span class="nx">clearInterval</span><span class="p">(</span><span class="nx">intervalHandler</span><span class="p">);</span>
</span><span id="__span-31-24"><a id="__codelineno-31-24" name="__codelineno-31-24" href="#__codelineno-31-24"></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="nx">resolve</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-31-25"><a id="__codelineno-31-25" name="__codelineno-31-25" href="#__codelineno-31-25"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-31-26"><a id="__codelineno-31-26" name="__codelineno-31-26" href="#__codelineno-31-26"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">attempts</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nx">maxAttempts</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-27"><a id="__codelineno-31-27" name="__codelineno-31-27" href="#__codelineno-31-27"></a><span class="w">          </span><span class="nx">clearInterval</span><span class="p">(</span><span class="nx">intervalHandler</span><span class="p">);</span>
</span><span id="__span-31-28"><a id="__codelineno-31-28" name="__codelineno-31-28" href="#__codelineno-31-28"></a><span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[è„šæœ¬åŠ è½½å™¨] è½®è¯¢ DocsAPI è¶…æ—¶ï¼Œè„šæœ¬ '</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">' å¯èƒ½åŠ è½½å¤±è´¥ã€‚`</span><span class="p">);</span>
</span><span id="__span-31-29"><a id="__codelineno-31-29" name="__codelineno-31-29" href="#__codelineno-31-29"></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="nx">reject</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`è½®è¯¢ DocsAPI è¶…æ—¶ä»¥åŠ è½½è„šæœ¬ </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">));</span>
</span><span id="__span-31-30"><a id="__codelineno-31-30" name="__codelineno-31-30" href="#__codelineno-31-30"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-31-31"><a id="__codelineno-31-31" name="__codelineno-31-31" href="#__codelineno-31-31"></a><span class="w">      </span><span class="p">},</span><span class="w"> </span><span class="mf">500</span><span class="p">);</span>
</span><span id="__span-31-32"><a id="__codelineno-31-32" name="__codelineno-31-32" href="#__codelineno-31-32"></a><span class="w">      </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-31-33"><a id="__codelineno-31-33" name="__codelineno-31-33" href="#__codelineno-31-33"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-31-34"><a id="__codelineno-31-34" name="__codelineno-31-34" href="#__codelineno-31-34"></a>
</span><span id="__span-31-35"><a id="__codelineno-31-35" name="__codelineno-31-35" href="#__codelineno-31-35"></a><span class="w">    </span><span class="c1">// åˆ›å»ºæ–°çš„ script å…ƒç´ å¹¶åŠ è½½</span>
</span><span id="__span-31-36"><a id="__codelineno-31-36" name="__codelineno-31-36" href="#__codelineno-31-36"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'script'</span><span class="p">);</span>
</span><span id="__span-31-37"><a id="__codelineno-31-37" name="__codelineno-31-37" href="#__codelineno-31-37"></a><span class="w">    </span><span class="nx">script</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">'type'</span><span class="p">,</span><span class="w"> </span><span class="s1">'text/javascript'</span><span class="p">);</span>
</span><span id="__span-31-38"><a id="__codelineno-31-38" name="__codelineno-31-38" href="#__codelineno-31-38"></a><span class="w">    </span><span class="nx">script</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">'id'</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="p">);</span>
</span><span id="__span-31-39"><a id="__codelineno-31-39" name="__codelineno-31-39" href="#__codelineno-31-39"></a><span class="w">    </span><span class="nx">script</span><span class="p">.</span><span class="k">async</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-31-40"><a id="__codelineno-31-40" name="__codelineno-31-40" href="#__codelineno-31-40"></a><span class="w">    </span><span class="nx">script</span><span class="p">.</span><span class="nx">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">url</span><span class="p">;</span>
</span><span id="__span-31-41"><a id="__codelineno-31-41" name="__codelineno-31-41" href="#__codelineno-31-41"></a>
</span><span id="__span-31-42"><a id="__codelineno-31-42" name="__codelineno-31-42" href="#__codelineno-31-42"></a><span class="w">    </span><span class="nx">script</span><span class="p">.</span><span class="nx">onload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-43"><a id="__codelineno-31-43" name="__codelineno-31-43" href="#__codelineno-31-43"></a><span class="w">      </span><span class="c1">// è„šæœ¬åŠ è½½æˆåŠŸ</span>
</span><span id="__span-31-44"><a id="__codelineno-31-44" name="__codelineno-31-44" href="#__codelineno-31-44"></a><span class="w">      </span><span class="nx">resolve</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-31-45"><a id="__codelineno-31-45" name="__codelineno-31-45" href="#__codelineno-31-45"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-31-46"><a id="__codelineno-31-46" name="__codelineno-31-46" href="#__codelineno-31-46"></a><span class="w">    </span><span class="nx">script</span><span class="p">.</span><span class="nx">onerror</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-47"><a id="__codelineno-31-47" name="__codelineno-31-47" href="#__codelineno-31-47"></a><span class="w">      </span><span class="c1">// è„šæœ¬åŠ è½½å¤±è´¥</span>
</span><span id="__span-31-48"><a id="__codelineno-31-48" name="__codelineno-31-48" href="#__codelineno-31-48"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[è„šæœ¬åŠ è½½å™¨] åŠ è½½è„šæœ¬ '</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">' å¤±è´¥:`</span><span class="p">,</span><span class="w"> </span><span class="nx">event</span><span class="p">);</span>
</span><span id="__span-31-49"><a id="__codelineno-31-49" name="__codelineno-31-49" href="#__codelineno-31-49"></a><span class="w">      </span><span class="nx">reject</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`åŠ è½½è„šæœ¬ </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb"> å¤±è´¥`</span><span class="p">));</span>
</span><span id="__span-31-50"><a id="__codelineno-31-50" name="__codelineno-31-50" href="#__codelineno-31-50"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-31-51"><a id="__codelineno-31-51" name="__codelineno-31-51" href="#__codelineno-31-51"></a>
</span><span id="__span-31-52"><a id="__codelineno-31-52" name="__codelineno-31-52" href="#__codelineno-31-52"></a><span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
</span><span id="__span-31-53"><a id="__codelineno-31-53" name="__codelineno-31-53" href="#__codelineno-31-53"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-54"><a id="__codelineno-31-54" name="__codelineno-31-54" href="#__codelineno-31-54"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'[è„šæœ¬åŠ è½½å™¨] loadScript å‡½æ•°å†…éƒ¨é”™è¯¯:'</span><span class="p">,</span><span class="w"> </span><span class="nx">e</span><span class="p">);</span>
</span><span id="__span-31-55"><a id="__codelineno-31-55" name="__codelineno-31-55" href="#__codelineno-31-55"></a><span class="w">    </span><span class="nx">reject</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
</span><span id="__span-31-56"><a id="__codelineno-31-56" name="__codelineno-31-56" href="#__codelineno-31-56"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-31-57"><a id="__codelineno-31-57" name="__codelineno-31-57" href="#__codelineno-31-57"></a><span class="p">});</span>
</span><span id="__span-31-58"><a id="__codelineno-31-58" name="__codelineno-31-58" href="#__codelineno-31-58"></a>
</span><span id="__span-31-59"><a id="__codelineno-31-59" name="__codelineno-31-59" href="#__codelineno-31-59"></a><span class="cm">/**</span>
</span><span id="__span-31-60"><a id="__codelineno-31-60" name="__codelineno-31-60" href="#__codelineno-31-60"></a><span class="cm"> * æ·±åº¦åˆå¹¶å¤šä¸ªå¯¹è±¡ï¼ˆæ”¯æŒåµŒå¥—å¯¹è±¡ï¼‰</span>
</span><span id="__span-31-61"><a id="__codelineno-31-61" name="__codelineno-31-61" href="#__codelineno-31-61"></a><span class="cm"> * @param {object} target - ç›®æ ‡å¯¹è±¡ï¼ˆè¢«ä¿®æ”¹ï¼‰</span>
</span><span id="__span-31-62"><a id="__codelineno-31-62" name="__codelineno-31-62" href="#__codelineno-31-62"></a><span class="cm"> * @param  {...object} sources - éœ€è¦åˆå¹¶çš„æºå¯¹è±¡</span>
</span><span id="__span-31-63"><a id="__codelineno-31-63" name="__codelineno-31-63" href="#__codelineno-31-63"></a><span class="cm"> * @returns {object} - åˆå¹¶åçš„ç›®æ ‡å¯¹è±¡</span>
</span><span id="__span-31-64"><a id="__codelineno-31-64" name="__codelineno-31-64" href="#__codelineno-31-64"></a><span class="cm"> */</span>
</span><span id="__span-31-65"><a id="__codelineno-31-65" name="__codelineno-31-65" href="#__codelineno-31-65"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">mergeDeep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">target</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">sources</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-66"><a id="__codelineno-31-66" name="__codelineno-31-66" href="#__codelineno-31-66"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">isObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">item</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="nx">item</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">item</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">'object'</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">item</span><span class="p">));</span>
</span><span id="__span-31-67"><a id="__codelineno-31-67" name="__codelineno-31-67" href="#__codelineno-31-67"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">sources</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">target</span><span class="p">;</span>
</span><span id="__span-31-68"><a id="__codelineno-31-68" name="__codelineno-31-68" href="#__codelineno-31-68"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sources</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
</span><span id="__span-31-69"><a id="__codelineno-31-69" name="__codelineno-31-69" href="#__codelineno-31-69"></a>
</span><span id="__span-31-70"><a id="__codelineno-31-70" name="__codelineno-31-70" href="#__codelineno-31-70"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">isObject</span><span class="p">(</span><span class="nx">source</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-71"><a id="__codelineno-31-71" name="__codelineno-31-71" href="#__codelineno-31-71"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">source</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-72"><a id="__codelineno-31-72" name="__codelineno-31-72" href="#__codelineno-31-72"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">]))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-73"><a id="__codelineno-31-73" name="__codelineno-31-73" href="#__codelineno-31-73"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">target</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="nx">key</span><span class="p">]))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-74"><a id="__codelineno-31-74" name="__codelineno-31-74" href="#__codelineno-31-74"></a><span class="w">          </span><span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span><span class="w"> </span><span class="p">{[</span><span class="nx">key</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="p">{}});</span>
</span><span id="__span-31-75"><a id="__codelineno-31-75" name="__codelineno-31-75" href="#__codelineno-31-75"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-31-76"><a id="__codelineno-31-76" name="__codelineno-31-76" href="#__codelineno-31-76"></a><span class="w">        </span><span class="nx">mergeDeep</span><span class="p">(</span><span class="nx">target</span><span class="p">[</span><span class="nx">key</span><span class="p">],</span><span class="w"> </span><span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
</span><span id="__span-31-77"><a id="__codelineno-31-77" name="__codelineno-31-77" href="#__codelineno-31-77"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-78"><a id="__codelineno-31-78" name="__codelineno-31-78" href="#__codelineno-31-78"></a><span class="w">        </span><span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span><span class="w"> </span><span class="p">{[</span><span class="nx">key</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="nx">source</span><span class="p">[</span><span class="nx">key</span><span class="p">]});</span>
</span><span id="__span-31-79"><a id="__codelineno-31-79" name="__codelineno-31-79" href="#__codelineno-31-79"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-31-80"><a id="__codelineno-31-80" name="__codelineno-31-80" href="#__codelineno-31-80"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-31-81"><a id="__codelineno-31-81" name="__codelineno-31-81" href="#__codelineno-31-81"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-31-82"><a id="__codelineno-31-82" name="__codelineno-31-82" href="#__codelineno-31-82"></a>
</span><span id="__span-31-83"><a id="__codelineno-31-83" name="__codelineno-31-83" href="#__codelineno-31-83"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">mergeDeep</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">sources</span><span class="p">);</span>
</span><span id="__span-31-84"><a id="__codelineno-31-84" name="__codelineno-31-84" href="#__codelineno-31-84"></a><span class="p">};</span>
</span><span id="__span-31-85"><a id="__codelineno-31-85" name="__codelineno-31-85" href="#__codelineno-31-85"></a>
</span><span id="__span-31-86"><a id="__codelineno-31-86" name="__codelineno-31-86" href="#__codelineno-31-86"></a><span class="k">import</span><span class="w"> </span><span class="nx">SHA256</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">'crypto-js/sha256'</span><span class="p">;</span>
</span><span id="__span-31-87"><a id="__codelineno-31-87" name="__codelineno-31-87" href="#__codelineno-31-87"></a>
</span><span id="__span-31-88"><a id="__codelineno-31-88" name="__codelineno-31-88" href="#__codelineno-31-88"></a><span class="cm">/**</span>
</span><span id="__span-31-89"><a id="__codelineno-31-89" name="__codelineno-31-89" href="#__codelineno-31-89"></a><span class="cm"> * ç”Ÿæˆç”¨äºæ–‡æ¡£ä¼šè¯çš„å”¯ä¸€ keyï¼ˆé¿å…ç¼“å­˜å†²çªï¼‰</span>
</span><span id="__span-31-90"><a id="__codelineno-31-90" name="__codelineno-31-90" href="#__codelineno-31-90"></a><span class="cm"> *</span>
</span><span id="__span-31-91"><a id="__codelineno-31-91" name="__codelineno-31-91" href="#__codelineno-31-91"></a><span class="cm"> * @param {string} filename - æ–‡ä»¶åï¼ˆæˆ–å”¯ä¸€æ ‡è¯†ï¼‰</span>
</span><span id="__span-31-92"><a id="__codelineno-31-92" name="__codelineno-31-92" href="#__codelineno-31-92"></a><span class="cm"> * @param {number|string} lastModifiedTime - æ–‡ä»¶æœ€åä¿®æ”¹æ—¶é—´æˆ³ï¼ˆUnix æ—¶é—´æˆ³ / æ¯«ç§’æ—¶é—´æˆ³ï¼‰</span>
</span><span id="__span-31-93"><a id="__codelineno-31-93" name="__codelineno-31-93" href="#__codelineno-31-93"></a><span class="cm"> * @returns {string} - é•¿åº¦ä¸è¶…è¿‡ 20 å­—ç¬¦çš„å”¯ä¸€ key</span>
</span><span id="__span-31-94"><a id="__codelineno-31-94" name="__codelineno-31-94" href="#__codelineno-31-94"></a><span class="cm"> */</span>
</span><span id="__span-31-95"><a id="__codelineno-31-95" name="__codelineno-31-95" href="#__codelineno-31-95"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">generateKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">filename</span><span class="p">,</span><span class="w"> </span><span class="nx">lastModifiedTime</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-96"><a id="__codelineno-31-96" name="__codelineno-31-96" href="#__codelineno-31-96"></a><span class="w">  </span><span class="c1">// ç”Ÿæˆ UUIDï¼ˆæµè§ˆå™¨ç¯å¢ƒå…¼å®¹æ€§å¤„ç†ï¼‰</span>
</span><span id="__span-31-97"><a id="__codelineno-31-97" name="__codelineno-31-97" href="#__codelineno-31-97"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">uuid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">crypto</span><span class="o">?</span><span class="p">.</span><span class="nx">randomUUID</span><span class="o">?</span><span class="p">.()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">generateFallbackUUID</span><span class="p">();</span>
</span><span id="__span-31-98"><a id="__codelineno-31-98" name="__codelineno-31-98" href="#__codelineno-31-98"></a><span class="w">  </span><span class="c1">// æ„é€ åŸºç¡€å­—ç¬¦ä¸²ï¼šåŒ…å«æ–‡ä»¶å + æœ€åä¿®æ”¹æ—¶é—´ + éšæœºå€¼</span>
</span><span id="__span-31-99"><a id="__codelineno-31-99" name="__codelineno-31-99" href="#__codelineno-31-99"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">base</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">filename</span><span class="si">}</span><span class="sb">_</span><span class="si">${</span><span class="nx">lastModifiedTime</span><span class="si">}</span><span class="sb">_</span><span class="si">${</span><span class="nx">uuid</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span><span id="__span-31-100"><a id="__codelineno-31-100" name="__codelineno-31-100" href="#__codelineno-31-100"></a><span class="w">  </span><span class="c1">// ä½¿ç”¨ SHA256 å¯¹ base å­—ç¬¦ä¸²è¿›è¡Œå“ˆå¸Œï¼ˆæµè§ˆå™¨ç«¯ä½¿ç”¨ crypto-js å®ç°ï¼‰</span>
</span><span id="__span-31-101"><a id="__codelineno-31-101" name="__codelineno-31-101" href="#__codelineno-31-101"></a><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">SHA256</span><span class="p">(</span><span class="nx">base</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="w"> </span><span class="c1">// è¿”å› hex å­—ç¬¦ä¸²</span>
</span><span id="__span-31-102"><a id="__codelineno-31-102" name="__codelineno-31-102" href="#__codelineno-31-102"></a><span class="w">  </span><span class="c1">// æˆªå–å‰ 20 å­—ç¬¦ï¼ˆç¬¦åˆ OnlyOffice æ¨èé•¿åº¦é™åˆ¶ï¼‰</span>
</span><span id="__span-31-103"><a id="__codelineno-31-103" name="__codelineno-31-103" href="#__codelineno-31-103"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">hash</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">);</span>
</span><span id="__span-31-104"><a id="__codelineno-31-104" name="__codelineno-31-104" href="#__codelineno-31-104"></a><span class="p">};</span>
</span><span id="__span-31-105"><a id="__codelineno-31-105" name="__codelineno-31-105" href="#__codelineno-31-105"></a>
</span><span id="__span-31-106"><a id="__codelineno-31-106" name="__codelineno-31-106" href="#__codelineno-31-106"></a>
</span><span id="__span-31-107"><a id="__codelineno-31-107" name="__codelineno-31-107" href="#__codelineno-31-107"></a><span class="cm">/**</span>
</span><span id="__span-31-108"><a id="__codelineno-31-108" name="__codelineno-31-108" href="#__codelineno-31-108"></a><span class="cm"> * Fallback UUID ç”Ÿæˆå™¨</span>
</span><span id="__span-31-109"><a id="__codelineno-31-109" name="__codelineno-31-109" href="#__codelineno-31-109"></a><span class="cm"> * ç”¨äºå…¼å®¹æ—§ç‰ˆæµè§ˆå™¨ä¸æ”¯æŒ window.crypto.randomUUID çš„åœºæ™¯</span>
</span><span id="__span-31-110"><a id="__codelineno-31-110" name="__codelineno-31-110" href="#__codelineno-31-110"></a><span class="cm"> * æ¨¡æ‹Ÿæ ‡å‡† UUID v4 æ ¼å¼ï¼šxxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx</span>
</span><span id="__span-31-111"><a id="__codelineno-31-111" name="__codelineno-31-111" href="#__codelineno-31-111"></a><span class="cm"> *</span>
</span><span id="__span-31-112"><a id="__codelineno-31-112" name="__codelineno-31-112" href="#__codelineno-31-112"></a><span class="cm"> * @returns {string} - ä¼ªéšæœº UUID å­—ç¬¦ä¸²</span>
</span><span id="__span-31-113"><a id="__codelineno-31-113" name="__codelineno-31-113" href="#__codelineno-31-113"></a><span class="cm"> */</span>
</span><span id="__span-31-114"><a id="__codelineno-31-114" name="__codelineno-31-114" href="#__codelineno-31-114"></a><span class="kd">function</span><span class="w"> </span><span class="nx">generateFallbackUUID</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-115"><a id="__codelineno-31-115" name="__codelineno-31-115" href="#__codelineno-31-115"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s1">'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[xy]/g</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-116"><a id="__codelineno-31-116" name="__codelineno-31-116" href="#__codelineno-31-116"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">16</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// éšæœºæ•° [0, 15]</span>
</span><span id="__span-31-117"><a id="__codelineno-31-117" name="__codelineno-31-117" href="#__codelineno-31-117"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">'x'</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">r</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mh">0x8</span><span class="p">);</span><span class="w"> </span><span class="c1">// ç¬¦åˆ UUID v4 è§„èŒƒ</span>
</span><span id="__span-31-118"><a id="__codelineno-31-118" name="__codelineno-31-118" href="#__codelineno-31-118"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">v</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mf">16</span><span class="p">);</span>
</span><span id="__span-31-119"><a id="__codelineno-31-119" name="__codelineno-31-119" href="#__codelineno-31-119"></a><span class="w">  </span><span class="p">});</span>
</span><span id="__span-31-120"><a id="__codelineno-31-120" name="__codelineno-31-120" href="#__codelineno-31-120"></a><span class="p">}</span>
</span></code></pre></div> <h4 id="512doceditorvue">5.1.2ã€DocEditor.vue<a class="headerlink" href="#512doceditorvue" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <div class="language-vue highlight"><span class="filename">Vue</span><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>  <span class="cm">&lt;!-- ç»„ä»¶æ ¹è§†å›¾å®¹å™¨ --&gt;</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"view"</span><span class="p">&gt;</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>    <span class="cm">&lt;!-- OnlyOffice ç¼–è¾‘å™¨å°†åœ¨æ­¤ div å…ƒç´ ä¸­æ¸²æŸ“ --&gt;</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="p">:</span><span class="na">id</span><span class="o">=</span><span class="s">"</span><span class="nx">editorId</span><span class="s">"</span><span class="p">/&gt;</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">"js"</span><span class="p">&gt;</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="nx">loadScript</span><span class="p">,</span><span class="w"> </span><span class="nx">mergeDeep</span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">"@/plugins/DocEditor/utils"</span><span class="p">;</span>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="c1">// OnlyOffice Document Server API è„šæœ¬çš„é»˜è®¤ URL æ¨¡æ¿</span>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="kd">const</span><span class="w"> </span><span class="nx">DEFAULT_DOC_API_URL_TEMPLATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"{server}/web-apps/apps/api/documents/api.js"</span><span class="p">;</span>
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a><span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">'DocEditor'</span><span class="p">,</span>
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a><span class="w">  </span><span class="nx">props</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-18"><a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-19"><a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a><span class="cm">     * ç¼–è¾‘å™¨å ä½ç¬¦ DOM å…ƒç´ çš„ IDã€‚</span>
</span><span id="__span-32-20"><a id="__codelineno-32-20" name="__codelineno-32-20" href="#__codelineno-32-20"></a><span class="cm">     * å¦‚æœé¡µé¢ä¸Šå­˜åœ¨å¤šä¸ªç¼–è¾‘å™¨å®ä¾‹ï¼Œæ­¤ ID å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚</span>
</span><span id="__span-32-21"><a id="__codelineno-32-21" name="__codelineno-32-21" href="#__codelineno-32-21"></a><span class="cm">     * @type {String}</span>
</span><span id="__span-32-22"><a id="__codelineno-32-22" name="__codelineno-32-22" href="#__codelineno-32-22"></a><span class="cm">     * @default '' - å¦‚æœä¸æä¾›ï¼Œç»„ä»¶å†…éƒ¨ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª</span>
</span><span id="__span-32-23"><a id="__codelineno-32-23" name="__codelineno-32-23" href="#__codelineno-32-23"></a><span class="cm">     */</span>
</span><span id="__span-32-24"><a id="__codelineno-32-24" name="__codelineno-32-24" href="#__codelineno-32-24"></a><span class="w">    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s1">''</span><span class="p">},</span>
</span><span id="__span-32-25"><a id="__codelineno-32-25" name="__codelineno-32-25" href="#__codelineno-32-25"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-26"><a id="__codelineno-32-26" name="__codelineno-32-26" href="#__codelineno-32-26"></a><span class="cm">     * OnlyOffice ç¼–è¾‘å™¨çš„ä¸»è¦é…ç½®å¯¹è±¡ã€‚</span>
</span><span id="__span-32-27"><a id="__codelineno-32-27" name="__codelineno-32-27" href="#__codelineno-32-27"></a><span class="cm">     * æ­¤å¯¹è±¡çš„å±æ€§å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§ï¼Œå°†è¦†ç›–é€šè¿‡å•ç‹¬ props è®¾ç½®çš„é»˜è®¤å€¼ã€‚</span>
</span><span id="__span-32-28"><a id="__codelineno-32-28" name="__codelineno-32-28" href="#__codelineno-32-28"></a><span class="cm">     * @type {Object}</span>
</span><span id="__span-32-29"><a id="__codelineno-32-29" name="__codelineno-32-29" href="#__codelineno-32-29"></a><span class="cm">     * @default () =&gt; ({}) - é»˜è®¤ä¸ºä¸€ä¸ªç©ºå¯¹è±¡</span>
</span><span id="__span-32-30"><a id="__codelineno-32-30" name="__codelineno-32-30" href="#__codelineno-32-30"></a><span class="cm">     */</span>
</span><span id="__span-32-31"><a id="__codelineno-32-31" name="__codelineno-32-31" href="#__codelineno-32-31"></a><span class="w">    </span><span class="nx">config</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nb">Object</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({})},</span>
</span><span id="__span-32-32"><a id="__codelineno-32-32" name="__codelineno-32-32" href="#__codelineno-32-32"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-33"><a id="__codelineno-32-33" name="__codelineno-32-33" href="#__codelineno-32-33"></a><span class="cm">     * æ–‡æ¡£çš„æ–‡ä»¶ç±»å‹ (ä¾‹å¦‚: "docx", "xlsx", "pptx")ã€‚</span>
</span><span id="__span-32-34"><a id="__codelineno-32-34" name="__codelineno-32-34" href="#__codelineno-32-34"></a><span class="cm">     * ä½œä¸ºé»˜è®¤å€¼ï¼Œä¼šè¢« `config.document.fileType` è¦†ç›–ã€‚</span>
</span><span id="__span-32-35"><a id="__codelineno-32-35" name="__codelineno-32-35" href="#__codelineno-32-35"></a><span class="cm">     * @type {String}</span>
</span><span id="__span-32-36"><a id="__codelineno-32-36" name="__codelineno-32-36" href="#__codelineno-32-36"></a><span class="cm">     * @default ''</span>
</span><span id="__span-32-37"><a id="__codelineno-32-37" name="__codelineno-32-37" href="#__codelineno-32-37"></a><span class="cm">     */</span>
</span><span id="__span-32-38"><a id="__codelineno-32-38" name="__codelineno-32-38" href="#__codelineno-32-38"></a><span class="w">    </span><span class="nx">documentFileType</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s1">''</span><span class="p">},</span>
</span><span id="__span-32-39"><a id="__codelineno-32-39" name="__codelineno-32-39" href="#__codelineno-32-39"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-40"><a id="__codelineno-32-40" name="__codelineno-32-40" href="#__codelineno-32-40"></a><span class="cm">     * æ–‡æ¡£çš„æ ‡é¢˜ï¼Œå°†æ˜¾ç¤ºåœ¨ç¼–è¾‘å™¨é¡¶éƒ¨ã€‚</span>
</span><span id="__span-32-41"><a id="__codelineno-32-41" name="__codelineno-32-41" href="#__codelineno-32-41"></a><span class="cm">     * ä½œä¸ºé»˜è®¤å€¼ï¼Œä¼šè¢« `config.document.title` è¦†ç›–ã€‚</span>
</span><span id="__span-32-42"><a id="__codelineno-32-42" name="__codelineno-32-42" href="#__codelineno-32-42"></a><span class="cm">     * @type {String}</span>
</span><span id="__span-32-43"><a id="__codelineno-32-43" name="__codelineno-32-43" href="#__codelineno-32-43"></a><span class="cm">     * @default ''</span>
</span><span id="__span-32-44"><a id="__codelineno-32-44" name="__codelineno-32-44" href="#__codelineno-32-44"></a><span class="cm">     */</span>
</span><span id="__span-32-45"><a id="__codelineno-32-45" name="__codelineno-32-45" href="#__codelineno-32-45"></a><span class="w">    </span><span class="nx">documentTitle</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s1">''</span><span class="p">},</span>
</span><span id="__span-32-46"><a id="__codelineno-32-46" name="__codelineno-32-46" href="#__codelineno-32-46"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-47"><a id="__codelineno-32-47" name="__codelineno-32-47" href="#__codelineno-32-47"></a><span class="cm">     * ç¼–è¾‘å™¨çš„æ–‡æ¡£ç±»å‹ ("word", "cell", "slide")ã€‚</span>
</span><span id="__span-32-48"><a id="__codelineno-32-48" name="__codelineno-32-48" href="#__codelineno-32-48"></a><span class="cm">     * ä½œä¸ºé»˜è®¤å€¼ï¼Œä¼šè¢« `config.documentType` è¦†ç›–ã€‚</span>
</span><span id="__span-32-49"><a id="__codelineno-32-49" name="__codelineno-32-49" href="#__codelineno-32-49"></a><span class="cm">     * å¦‚æœæœªæä¾›ä¸” `config.document.fileType` å·²çŸ¥ï¼Œç»„ä»¶ä¼šå°è¯•æ¨æ–­æ­¤å€¼ã€‚</span>
</span><span id="__span-32-50"><a id="__codelineno-32-50" name="__codelineno-32-50" href="#__codelineno-32-50"></a><span class="cm">     * @type {String}</span>
</span><span id="__span-32-51"><a id="__codelineno-32-51" name="__codelineno-32-51" href="#__codelineno-32-51"></a><span class="cm">     * @default ''</span>
</span><span id="__span-32-52"><a id="__codelineno-32-52" name="__codelineno-32-52" href="#__codelineno-32-52"></a><span class="cm">     */</span>
</span><span id="__span-32-53"><a id="__codelineno-32-53" name="__codelineno-32-53" href="#__codelineno-32-53"></a><span class="w">    </span><span class="nx">documentType</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s1">''</span><span class="p">},</span>
</span><span id="__span-32-54"><a id="__codelineno-32-54" name="__codelineno-32-54" href="#__codelineno-32-54"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-55"><a id="__codelineno-32-55" name="__codelineno-32-55" href="#__codelineno-32-55"></a><span class="cm">     * ç¼–è¾‘å™¨çš„ç•Œé¢è¯­è¨€ (ä¾‹å¦‚: "zh-CN", "en")ã€‚</span>
</span><span id="__span-32-56"><a id="__codelineno-32-56" name="__codelineno-32-56" href="#__codelineno-32-56"></a><span class="cm">     * ä½œä¸ºé»˜è®¤å€¼ï¼Œä¼šè¢« `config.editorConfig.lang` è¦†ç›–ã€‚</span>
</span><span id="__span-32-57"><a id="__codelineno-32-57" name="__codelineno-32-57" href="#__codelineno-32-57"></a><span class="cm">     * @type {String}</span>
</span><span id="__span-32-58"><a id="__codelineno-32-58" name="__codelineno-32-58" href="#__codelineno-32-58"></a><span class="cm">     * @default 'zh-CN' - é»˜è®¤ä¸ºç®€ä½“ä¸­æ–‡</span>
</span><span id="__span-32-59"><a id="__codelineno-32-59" name="__codelineno-32-59" href="#__codelineno-32-59"></a><span class="cm">     */</span>
</span><span id="__span-32-60"><a id="__codelineno-32-60" name="__codelineno-32-60" href="#__codelineno-32-60"></a><span class="w">    </span><span class="nx">editorConfigLang</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s1">'zh-CN'</span><span class="p">},</span>
</span><span id="__span-32-61"><a id="__codelineno-32-61" name="__codelineno-32-61" href="#__codelineno-32-61"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-62"><a id="__codelineno-32-62" name="__codelineno-32-62" href="#__codelineno-32-62"></a><span class="cm">     * ç¼–è¾‘å™¨çš„å®½åº¦ (CSS å€¼ï¼Œä¾‹å¦‚: "100%", "800px")ã€‚</span>
</span><span id="__span-32-63"><a id="__codelineno-32-63" name="__codelineno-32-63" href="#__codelineno-32-63"></a><span class="cm">     * ä½œä¸ºé»˜è®¤å€¼ï¼Œä¼šè¢« `config.width` è¦†ç›–ã€‚</span>
</span><span id="__span-32-64"><a id="__codelineno-32-64" name="__codelineno-32-64" href="#__codelineno-32-64"></a><span class="cm">     * @type {String}</span>
</span><span id="__span-32-65"><a id="__codelineno-32-65" name="__codelineno-32-65" href="#__codelineno-32-65"></a><span class="cm">     * @default '100%'</span>
</span><span id="__span-32-66"><a id="__codelineno-32-66" name="__codelineno-32-66" href="#__codelineno-32-66"></a><span class="cm">     */</span>
</span><span id="__span-32-67"><a id="__codelineno-32-67" name="__codelineno-32-67" href="#__codelineno-32-67"></a><span class="w">    </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s1">'100%'</span><span class="p">},</span>
</span><span id="__span-32-68"><a id="__codelineno-32-68" name="__codelineno-32-68" href="#__codelineno-32-68"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-69"><a id="__codelineno-32-69" name="__codelineno-32-69" href="#__codelineno-32-69"></a><span class="cm">     * ç¼–è¾‘å™¨çš„é«˜åº¦ (CSS å€¼ï¼Œä¾‹å¦‚: "100%", "800px")ã€‚</span>
</span><span id="__span-32-70"><a id="__codelineno-32-70" name="__codelineno-32-70" href="#__codelineno-32-70"></a><span class="cm">     * ä½œä¸ºé»˜è®¤å€¼ï¼Œä¼šè¢« `config.height` è¦†ç›–ã€‚</span>
</span><span id="__span-32-71"><a id="__codelineno-32-71" name="__codelineno-32-71" href="#__codelineno-32-71"></a><span class="cm">     * @type {String}</span>
</span><span id="__span-32-72"><a id="__codelineno-32-72" name="__codelineno-32-72" href="#__codelineno-32-72"></a><span class="cm">     * @default '800px'</span>
</span><span id="__span-32-73"><a id="__codelineno-32-73" name="__codelineno-32-73" href="#__codelineno-32-73"></a><span class="cm">     */</span>
</span><span id="__span-32-74"><a id="__codelineno-32-74" name="__codelineno-32-74" href="#__codelineno-32-74"></a><span class="w">    </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s1">'800px'</span><span class="p">},</span>
</span><span id="__span-32-75"><a id="__codelineno-32-75" name="__codelineno-32-75" href="#__codelineno-32-75"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-76"><a id="__codelineno-32-76" name="__codelineno-32-76" href="#__codelineno-32-76"></a><span class="cm">     * ç¼–è¾‘å™¨ç•Œé¢ç±»å‹ ("desktop" æˆ– "mobile")ã€‚</span>
</span><span id="__span-32-77"><a id="__codelineno-32-77" name="__codelineno-32-77" href="#__codelineno-32-77"></a><span class="cm">     * ä½œä¸ºé»˜è®¤å€¼ï¼Œä¼šè¢« `config.type` è¦†ç›–ã€‚</span>
</span><span id="__span-32-78"><a id="__codelineno-32-78" name="__codelineno-32-78" href="#__codelineno-32-78"></a><span class="cm">     * @type {String}</span>
</span><span id="__span-32-79"><a id="__codelineno-32-79" name="__codelineno-32-79" href="#__codelineno-32-79"></a><span class="cm">     * @default 'desktop'</span>
</span><span id="__span-32-80"><a id="__codelineno-32-80" name="__codelineno-32-80" href="#__codelineno-32-80"></a><span class="cm">     */</span>
</span><span id="__span-32-81"><a id="__codelineno-32-81" name="__codelineno-32-81" href="#__codelineno-32-81"></a><span class="w">    </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s1">'desktop'</span><span class="p">},</span>
</span><span id="__span-32-82"><a id="__codelineno-32-82" name="__codelineno-32-82" href="#__codelineno-32-82"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-83"><a id="__codelineno-32-83" name="__codelineno-32-83" href="#__codelineno-32-83"></a><span class="cm">     * ä¼ é€’ç»™ OnlyOffice ç¼–è¾‘å™¨çš„äº‹ä»¶å›è°ƒå‡½æ•°å¯¹è±¡ã€‚</span>
</span><span id="__span-32-84"><a id="__codelineno-32-84" name="__codelineno-32-84" href="#__codelineno-32-84"></a><span class="cm">     * ä½œä¸ºäº‹ä»¶å¤„ç†çš„é»˜è®¤é…ç½®ï¼Œä¼šè¢« `config.events` ä¸­çš„åŒåäº‹ä»¶è¦†ç›–ã€‚</span>
</span><span id="__span-32-85"><a id="__codelineno-32-85" name="__codelineno-32-85" href="#__codelineno-32-85"></a><span class="cm">     * ä¾‹å¦‚: `{ onAppReady: () =&gt; { console.log('åº”ç”¨å‡†å¤‡å°±ç»ª'); } }`</span>
</span><span id="__span-32-86"><a id="__codelineno-32-86" name="__codelineno-32-86" href="#__codelineno-32-86"></a><span class="cm">     * @type {Object}</span>
</span><span id="__span-32-87"><a id="__codelineno-32-87" name="__codelineno-32-87" href="#__codelineno-32-87"></a><span class="cm">     * @default () =&gt; ({})</span>
</span><span id="__span-32-88"><a id="__codelineno-32-88" name="__codelineno-32-88" href="#__codelineno-32-88"></a><span class="cm">     */</span>
</span><span id="__span-32-89"><a id="__codelineno-32-89" name="__codelineno-32-89" href="#__codelineno-32-89"></a><span class="w">    </span><span class="nx">events</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nb">Object</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">({})},</span>
</span><span id="__span-32-90"><a id="__codelineno-32-90" name="__codelineno-32-90" href="#__codelineno-32-90"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-91"><a id="__codelineno-32-91" name="__codelineno-32-91" href="#__codelineno-32-91"></a><span class="cm">     * OnlyOffice Document Server çš„åŸºç¡€ URL (ä¾‹å¦‚: "http://localhost:8081")ã€‚</span>
</span><span id="__span-32-92"><a id="__codelineno-32-92" name="__codelineno-32-92" href="#__codelineno-32-92"></a><span class="cm">     * å¦‚æœæœªæä¾›ï¼Œç»„ä»¶ä¼šå°è¯•ä»ç¯å¢ƒå˜é‡ `VUE_APP_ONLY_OFFICE_SERVER` ä¸­è¯»å–ã€‚</span>
</span><span id="__span-32-93"><a id="__codelineno-32-93" name="__codelineno-32-93" href="#__codelineno-32-93"></a><span class="cm">     * @type {String}</span>
</span><span id="__span-32-94"><a id="__codelineno-32-94" name="__codelineno-32-94" href="#__codelineno-32-94"></a><span class="cm">     * @default ''</span>
</span><span id="__span-32-95"><a id="__codelineno-32-95" name="__codelineno-32-95" href="#__codelineno-32-95"></a><span class="cm">     */</span>
</span><span id="__span-32-96"><a id="__codelineno-32-96" name="__codelineno-32-96" href="#__codelineno-32-96"></a><span class="w">    </span><span class="nx">documentServerUrl</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="s1">''</span><span class="p">}</span>
</span><span id="__span-32-97"><a id="__codelineno-32-97" name="__codelineno-32-97" href="#__codelineno-32-97"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-32-98"><a id="__codelineno-32-98" name="__codelineno-32-98" href="#__codelineno-32-98"></a><span class="w">  </span><span class="nx">data</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-99"><a id="__codelineno-32-99" name="__codelineno-32-99" href="#__codelineno-32-99"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-100"><a id="__codelineno-32-100" name="__codelineno-32-100" href="#__codelineno-32-100"></a><span class="w">      </span><span class="cm">/**</span>
</span><span id="__span-32-101"><a id="__codelineno-32-101" name="__codelineno-32-101" href="#__codelineno-32-101"></a><span class="cm">       * ä¿å­˜å·²åˆå§‹åŒ–çš„ OnlyOffice ç¼–è¾‘å™¨å®ä¾‹ã€‚</span>
</span><span id="__span-32-102"><a id="__codelineno-32-102" name="__codelineno-32-102" href="#__codelineno-32-102"></a><span class="cm">       * @type {DocsAPI.DocEditor | null}</span>
</span><span id="__span-32-103"><a id="__codelineno-32-103" name="__codelineno-32-103" href="#__codelineno-32-103"></a><span class="cm">       */</span>
</span><span id="__span-32-104"><a id="__codelineno-32-104" name="__codelineno-32-104" href="#__codelineno-32-104"></a><span class="w">      </span><span class="nx">editorInstance</span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
</span><span id="__span-32-105"><a id="__codelineno-32-105" name="__codelineno-32-105" href="#__codelineno-32-105"></a><span class="w">      </span><span class="cm">/**</span>
</span><span id="__span-32-106"><a id="__codelineno-32-106" name="__codelineno-32-106" href="#__codelineno-32-106"></a><span class="cm">       * å†…éƒ¨ä½¿ç”¨çš„ç¼–è¾‘å™¨å ä½ç¬¦ IDã€‚</span>
</span><span id="__span-32-107"><a id="__codelineno-32-107" name="__codelineno-32-107" href="#__codelineno-32-107"></a><span class="cm">       * å¦‚æœ props.id æœªæä¾›ï¼Œåˆ™è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ IDã€‚</span>
</span><span id="__span-32-108"><a id="__codelineno-32-108" name="__codelineno-32-108" href="#__codelineno-32-108"></a><span class="cm">       * @type {String}</span>
</span><span id="__span-32-109"><a id="__codelineno-32-109" name="__codelineno-32-109" href="#__codelineno-32-109"></a><span class="cm">       */</span>
</span><span id="__span-32-110"><a id="__codelineno-32-110" name="__codelineno-32-110" href="#__codelineno-32-110"></a><span class="w">      </span><span class="nx">editorIdInternal</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="sb">`onlyoffice-editor-</span><span class="si">${</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="si">}${</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="mf">36</span><span class="p">).</span><span class="nx">substring</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">7</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span><span id="__span-32-111"><a id="__codelineno-32-111" name="__codelineno-32-111" href="#__codelineno-32-111"></a><span class="w">      </span><span class="cm">/**</span>
</span><span id="__span-32-112"><a id="__codelineno-32-112" name="__codelineno-32-112" href="#__codelineno-32-112"></a><span class="cm">       * æ ‡è®° OnlyOffice API è„šæœ¬æ˜¯å¦å·²æˆåŠŸåŠ è½½å¹¶å¯ç”¨ã€‚</span>
</span><span id="__span-32-113"><a id="__codelineno-32-113" name="__codelineno-32-113" href="#__codelineno-32-113"></a><span class="cm">       * @type {Boolean}</span>
</span><span id="__span-32-114"><a id="__codelineno-32-114" name="__codelineno-32-114" href="#__codelineno-32-114"></a><span class="cm">       */</span>
</span><span id="__span-32-115"><a id="__codelineno-32-115" name="__codelineno-32-115" href="#__codelineno-32-115"></a><span class="w">      </span><span class="nx">apiScriptLoaded</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-32-116"><a id="__codelineno-32-116" name="__codelineno-32-116" href="#__codelineno-32-116"></a><span class="w">      </span><span class="cm">/**</span>
</span><span id="__span-32-117"><a id="__codelineno-32-117" name="__codelineno-32-117" href="#__codelineno-32-117"></a><span class="cm">       * æ ‡è®°ç»„ä»¶æ˜¯å¦å·²æŒ‚è½½ (mounted)ã€‚ç”¨äº watcher é¿å…åœ¨æŒ‚è½½å‰æ‰§è¡Œã€‚</span>
</span><span id="__span-32-118"><a id="__codelineno-32-118" name="__codelineno-32-118" href="#__codelineno-32-118"></a><span class="cm">       * @type {Boolean}</span>
</span><span id="__span-32-119"><a id="__codelineno-32-119" name="__codelineno-32-119" href="#__codelineno-32-119"></a><span class="cm">       */</span>
</span><span id="__span-32-120"><a id="__codelineno-32-120" name="__codelineno-32-120" href="#__codelineno-32-120"></a><span class="w">      </span><span class="nx">isMounted</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-32-121"><a id="__codelineno-32-121" name="__codelineno-32-121" href="#__codelineno-32-121"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-32-122"><a id="__codelineno-32-122" name="__codelineno-32-122" href="#__codelineno-32-122"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-32-123"><a id="__codelineno-32-123" name="__codelineno-32-123" href="#__codelineno-32-123"></a><span class="w">  </span><span class="nx">computed</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-124"><a id="__codelineno-32-124" name="__codelineno-32-124" href="#__codelineno-32-124"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-125"><a id="__codelineno-32-125" name="__codelineno-32-125" href="#__codelineno-32-125"></a><span class="cm">     * è®¡ç®—ç¼–è¾‘å™¨å ä½ç¬¦æœ€ç»ˆä½¿ç”¨çš„ IDã€‚</span>
</span><span id="__span-32-126"><a id="__codelineno-32-126" name="__codelineno-32-126" href="#__codelineno-32-126"></a><span class="cm">     * ä¼˜å…ˆä½¿ç”¨ props.idï¼Œå¦‚æœæœªæä¾›ï¼Œåˆ™ä½¿ç”¨å†…éƒ¨ç”Ÿæˆçš„ editorIdInternalã€‚</span>
</span><span id="__span-32-127"><a id="__codelineno-32-127" name="__codelineno-32-127" href="#__codelineno-32-127"></a><span class="cm">     * @returns {String} ç¼–è¾‘å™¨ DOM å…ƒç´ çš„ IDã€‚</span>
</span><span id="__span-32-128"><a id="__codelineno-32-128" name="__codelineno-32-128" href="#__codelineno-32-128"></a><span class="cm">     */</span>
</span><span id="__span-32-129"><a id="__codelineno-32-129" name="__codelineno-32-129" href="#__codelineno-32-129"></a><span class="w">    </span><span class="nx">editorId</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-130"><a id="__codelineno-32-130" name="__codelineno-32-130" href="#__codelineno-32-130"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">editorIdInternal</span><span class="p">;</span>
</span><span id="__span-32-131"><a id="__codelineno-32-131" name="__codelineno-32-131" href="#__codelineno-32-131"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-32-132"><a id="__codelineno-32-132" name="__codelineno-32-132" href="#__codelineno-32-132"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-133"><a id="__codelineno-32-133" name="__codelineno-32-133" href="#__codelineno-32-133"></a><span class="cm">     * è®¡ç®— OnlyOffice Document Server API è„šæœ¬çš„å®Œæ•´ URLã€‚</span>
</span><span id="__span-32-134"><a id="__codelineno-32-134" name="__codelineno-32-134" href="#__codelineno-32-134"></a><span class="cm">     * ä¼˜å…ˆä½¿ç”¨ props.documentServerUrlï¼Œå¦‚æœæœªæä¾›ï¼Œåˆ™å°è¯•è¯»å–ç¯å¢ƒå˜é‡ã€‚</span>
</span><span id="__span-32-135"><a id="__codelineno-32-135" name="__codelineno-32-135" href="#__codelineno-32-135"></a><span class="cm">     * @returns {String} API è„šæœ¬çš„ URLã€‚å¦‚æœæ— æ³•ç¡®å®šæœåŠ¡å™¨åœ°å€ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</span>
</span><span id="__span-32-136"><a id="__codelineno-32-136" name="__codelineno-32-136" href="#__codelineno-32-136"></a><span class="cm">     */</span>
</span><span id="__span-32-137"><a id="__codelineno-32-137" name="__codelineno-32-137" href="#__codelineno-32-137"></a><span class="w">    </span><span class="nx">docApiUrl</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-138"><a id="__codelineno-32-138" name="__codelineno-32-138" href="#__codelineno-32-138"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">documentServerUrl</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VUE_APP_ONLY_OFFICE_SERVER</span><span class="p">;</span>
</span><span id="__span-32-139"><a id="__codelineno-32-139" name="__codelineno-32-139" href="#__codelineno-32-139"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">serverUrl</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-140"><a id="__codelineno-32-140" name="__codelineno-32-140" href="#__codelineno-32-140"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] é”™è¯¯ï¼šå¿…é¡»è®¾ç½® documentServerUrl prop æˆ– VUE_APP_ONLY_OFFICE_SERVER ç¯å¢ƒå˜é‡ã€‚'</span><span class="p">);</span>
</span><span id="__span-32-141"><a id="__codelineno-32-141" name="__codelineno-32-141" href="#__codelineno-32-141"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s1">''</span><span class="p">;</span>
</span><span id="__span-32-142"><a id="__codelineno-32-142" name="__codelineno-32-142" href="#__codelineno-32-142"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-32-143"><a id="__codelineno-32-143" name="__codelineno-32-143" href="#__codelineno-32-143"></a><span class="w">      </span><span class="c1">// æ›¿æ¢æ¨¡æ¿ä¸­çš„ {server} å¹¶ç¡®ä¿ URL æœ«å°¾æ²¡æœ‰å¤šä½™çš„æ–œæ </span>
</span><span id="__span-32-144"><a id="__codelineno-32-144" name="__codelineno-32-144" href="#__codelineno-32-144"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">DEFAULT_DOC_API_URL_TEMPLATE</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{server}'</span><span class="p">,</span><span class="w"> </span><span class="nx">serverUrl</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\/$/</span><span class="p">,</span><span class="w"> </span><span class="s1">''</span><span class="p">));</span>
</span><span id="__span-32-145"><a id="__codelineno-32-145" name="__codelineno-32-145" href="#__codelineno-32-145"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-32-146"><a id="__codelineno-32-146" name="__codelineno-32-146" href="#__codelineno-32-146"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-32-147"><a id="__codelineno-32-147" name="__codelineno-32-147" href="#__codelineno-32-147"></a><span class="w">  </span><span class="nx">watch</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-148"><a id="__codelineno-32-148" name="__codelineno-32-148" href="#__codelineno-32-148"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-149"><a id="__codelineno-32-149" name="__codelineno-32-149" href="#__codelineno-32-149"></a><span class="cm">     * æ·±åº¦ä¾¦å¬ `config` prop çš„å˜åŒ–ã€‚</span>
</span><span id="__span-32-150"><a id="__codelineno-32-150" name="__codelineno-32-150" href="#__codelineno-32-150"></a><span class="cm">     * å½“ `config` å¯¹è±¡å†…éƒ¨ä»»ä½•å±æ€§æ”¹å˜æ—¶ï¼Œè°ƒç”¨ `handleConfigChange` æ–¹æ³•ã€‚</span>
</span><span id="__span-32-151"><a id="__codelineno-32-151" name="__codelineno-32-151" href="#__codelineno-32-151"></a><span class="cm">     */</span>
</span><span id="__span-32-152"><a id="__codelineno-32-152" name="__codelineno-32-152" href="#__codelineno-32-152"></a><span class="w">    </span><span class="nx">config</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">handler</span><span class="o">:</span><span class="w"> </span><span class="s1">'handleConfigChange'</span><span class="p">,</span><span class="w"> </span><span class="nx">deep</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">},</span>
</span><span id="__span-32-153"><a id="__codelineno-32-153" name="__codelineno-32-153" href="#__codelineno-32-153"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-154"><a id="__codelineno-32-154" name="__codelineno-32-154" href="#__codelineno-32-154"></a><span class="cm">     * ä¾¦å¬ `documentFileType` prop çš„å˜åŒ–ã€‚</span>
</span><span id="__span-32-155"><a id="__codelineno-32-155" name="__codelineno-32-155" href="#__codelineno-32-155"></a><span class="cm">     * è°ƒç”¨ `reloadEditor` æ–¹æ³•ã€‚æœ€ç»ˆé…ç½®ç”± `createEditor` æ–¹æ³•ä¸­çš„åˆå¹¶é€»è¾‘å†³å®šã€‚</span>
</span><span id="__span-32-156"><a id="__codelineno-32-156" name="__codelineno-32-156" href="#__codelineno-32-156"></a><span class="cm">     */</span>
</span><span id="__span-32-157"><a id="__codelineno-32-157" name="__codelineno-32-157" href="#__codelineno-32-157"></a><span class="w">    </span><span class="nx">documentFileType</span><span class="o">:</span><span class="w"> </span><span class="s1">'reloadEditor'</span><span class="p">,</span>
</span><span id="__span-32-158"><a id="__codelineno-32-158" name="__codelineno-32-158" href="#__codelineno-32-158"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-159"><a id="__codelineno-32-159" name="__codelineno-32-159" href="#__codelineno-32-159"></a><span class="cm">     * ä¾¦å¬ `documentTitle` prop çš„å˜åŒ–ã€‚</span>
</span><span id="__span-32-160"><a id="__codelineno-32-160" name="__codelineno-32-160" href="#__codelineno-32-160"></a><span class="cm">     * è°ƒç”¨ `reloadEditor` æ–¹æ³•ã€‚</span>
</span><span id="__span-32-161"><a id="__codelineno-32-161" name="__codelineno-32-161" href="#__codelineno-32-161"></a><span class="cm">     */</span>
</span><span id="__span-32-162"><a id="__codelineno-32-162" name="__codelineno-32-162" href="#__codelineno-32-162"></a><span class="w">    </span><span class="nx">documentTitle</span><span class="o">:</span><span class="w"> </span><span class="s1">'reloadEditor'</span><span class="p">,</span>
</span><span id="__span-32-163"><a id="__codelineno-32-163" name="__codelineno-32-163" href="#__codelineno-32-163"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-164"><a id="__codelineno-32-164" name="__codelineno-32-164" href="#__codelineno-32-164"></a><span class="cm">     * ä¾¦å¬ `documentType` prop çš„å˜åŒ–ã€‚</span>
</span><span id="__span-32-165"><a id="__codelineno-32-165" name="__codelineno-32-165" href="#__codelineno-32-165"></a><span class="cm">     * è°ƒç”¨ `reloadEditor` æ–¹æ³•ã€‚</span>
</span><span id="__span-32-166"><a id="__codelineno-32-166" name="__codelineno-32-166" href="#__codelineno-32-166"></a><span class="cm">     */</span>
</span><span id="__span-32-167"><a id="__codelineno-32-167" name="__codelineno-32-167" href="#__codelineno-32-167"></a><span class="w">    </span><span class="nx">documentType</span><span class="o">:</span><span class="w"> </span><span class="s1">'reloadEditor'</span><span class="p">,</span>
</span><span id="__span-32-168"><a id="__codelineno-32-168" name="__codelineno-32-168" href="#__codelineno-32-168"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-169"><a id="__codelineno-32-169" name="__codelineno-32-169" href="#__codelineno-32-169"></a><span class="cm">     * ä¾¦å¬ `editorConfigLang` prop çš„å˜åŒ–ã€‚</span>
</span><span id="__span-32-170"><a id="__codelineno-32-170" name="__codelineno-32-170" href="#__codelineno-32-170"></a><span class="cm">     * è°ƒç”¨ `reloadEditor` æ–¹æ³•ã€‚</span>
</span><span id="__span-32-171"><a id="__codelineno-32-171" name="__codelineno-32-171" href="#__codelineno-32-171"></a><span class="cm">     */</span>
</span><span id="__span-32-172"><a id="__codelineno-32-172" name="__codelineno-32-172" href="#__codelineno-32-172"></a><span class="w">    </span><span class="nx">editorConfigLang</span><span class="o">:</span><span class="w"> </span><span class="s1">'reloadEditor'</span><span class="p">,</span>
</span><span id="__span-32-173"><a id="__codelineno-32-173" name="__codelineno-32-173" href="#__codelineno-32-173"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-174"><a id="__codelineno-32-174" name="__codelineno-32-174" href="#__codelineno-32-174"></a><span class="cm">     * ä¾¦å¬ `height` prop çš„å˜åŒ–ã€‚</span>
</span><span id="__span-32-175"><a id="__codelineno-32-175" name="__codelineno-32-175" href="#__codelineno-32-175"></a><span class="cm">     * è°ƒç”¨ `reloadEditor` æ–¹æ³•ã€‚</span>
</span><span id="__span-32-176"><a id="__codelineno-32-176" name="__codelineno-32-176" href="#__codelineno-32-176"></a><span class="cm">     */</span>
</span><span id="__span-32-177"><a id="__codelineno-32-177" name="__codelineno-32-177" href="#__codelineno-32-177"></a><span class="w">    </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="s1">'reloadEditor'</span><span class="p">,</span>
</span><span id="__span-32-178"><a id="__codelineno-32-178" name="__codelineno-32-178" href="#__codelineno-32-178"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-179"><a id="__codelineno-32-179" name="__codelineno-32-179" href="#__codelineno-32-179"></a><span class="cm">     * ä¾¦å¬ `type` prop çš„å˜åŒ–ã€‚</span>
</span><span id="__span-32-180"><a id="__codelineno-32-180" name="__codelineno-32-180" href="#__codelineno-32-180"></a><span class="cm">     * è°ƒç”¨ `reloadEditor` æ–¹æ³•ã€‚</span>
</span><span id="__span-32-181"><a id="__codelineno-32-181" name="__codelineno-32-181" href="#__codelineno-32-181"></a><span class="cm">     */</span>
</span><span id="__span-32-182"><a id="__codelineno-32-182" name="__codelineno-32-182" href="#__codelineno-32-182"></a><span class="w">    </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s1">'reloadEditor'</span><span class="p">,</span>
</span><span id="__span-32-183"><a id="__codelineno-32-183" name="__codelineno-32-183" href="#__codelineno-32-183"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-184"><a id="__codelineno-32-184" name="__codelineno-32-184" href="#__codelineno-32-184"></a><span class="cm">     * ä¾¦å¬ `width` prop çš„å˜åŒ–ã€‚</span>
</span><span id="__span-32-185"><a id="__codelineno-32-185" name="__codelineno-32-185" href="#__codelineno-32-185"></a><span class="cm">     * è°ƒç”¨ `reloadEditor` æ–¹æ³•ã€‚</span>
</span><span id="__span-32-186"><a id="__codelineno-32-186" name="__codelineno-32-186" href="#__codelineno-32-186"></a><span class="cm">     */</span>
</span><span id="__span-32-187"><a id="__codelineno-32-187" name="__codelineno-32-187" href="#__codelineno-32-187"></a><span class="w">    </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="s1">'reloadEditor'</span><span class="p">,</span>
</span><span id="__span-32-188"><a id="__codelineno-32-188" name="__codelineno-32-188" href="#__codelineno-32-188"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-189"><a id="__codelineno-32-189" name="__codelineno-32-189" href="#__codelineno-32-189"></a><span class="cm">     * ä¾¦å¬ `documentServerUrl` prop çš„å˜åŒ–ã€‚</span>
</span><span id="__span-32-190"><a id="__codelineno-32-190" name="__codelineno-32-190" href="#__codelineno-32-190"></a><span class="cm">     * å½“ Document Server URL æ”¹å˜æ—¶ï¼Œè°ƒç”¨ `reloadApiAndEditor` æ–¹æ³•é‡æ–°åŠ è½½ API å’Œç¼–è¾‘å™¨ã€‚</span>
</span><span id="__span-32-191"><a id="__codelineno-32-191" name="__codelineno-32-191" href="#__codelineno-32-191"></a><span class="cm">     */</span>
</span><span id="__span-32-192"><a id="__codelineno-32-192" name="__codelineno-32-192" href="#__codelineno-32-192"></a><span class="w">    </span><span class="nx">documentServerUrl</span><span class="o">:</span><span class="w"> </span><span class="s1">'reloadApiAndEditor'</span><span class="p">,</span>
</span><span id="__span-32-193"><a id="__codelineno-32-193" name="__codelineno-32-193" href="#__codelineno-32-193"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-194"><a id="__codelineno-32-194" name="__codelineno-32-194" href="#__codelineno-32-194"></a><span class="cm">     * æ·±åº¦ä¾¦å¬ `events` prop çš„å˜åŒ–ã€‚</span>
</span><span id="__span-32-195"><a id="__codelineno-32-195" name="__codelineno-32-195" href="#__codelineno-32-195"></a><span class="cm">     * å½“ `events` å¯¹è±¡å†…éƒ¨ä»»ä½•å±æ€§æ”¹å˜æ—¶ï¼Œè°ƒç”¨ `reloadEditor` æ–¹æ³•ã€‚</span>
</span><span id="__span-32-196"><a id="__codelineno-32-196" name="__codelineno-32-196" href="#__codelineno-32-196"></a><span class="cm">     */</span>
</span><span id="__span-32-197"><a id="__codelineno-32-197" name="__codelineno-32-197" href="#__codelineno-32-197"></a><span class="w">    </span><span class="nx">events</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">handler</span><span class="o">:</span><span class="w"> </span><span class="s1">'reloadEditor'</span><span class="p">,</span><span class="w"> </span><span class="nx">deep</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">},</span>
</span><span id="__span-32-198"><a id="__codelineno-32-198" name="__codelineno-32-198" href="#__codelineno-32-198"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-32-199"><a id="__codelineno-32-199" name="__codelineno-32-199" href="#__codelineno-32-199"></a><span class="w">  </span><span class="cm">/**</span>
</span><span id="__span-32-200"><a id="__codelineno-32-200" name="__codelineno-32-200" href="#__codelineno-32-200"></a><span class="cm">   * Vue ç»„ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­ï¼šå®ä¾‹è¢«æŒ‚è½½åè°ƒç”¨ã€‚</span>
</span><span id="__span-32-201"><a id="__codelineno-32-201" name="__codelineno-32-201" href="#__codelineno-32-201"></a><span class="cm">   * è®¾ç½® `isMounted` æ ‡å¿—ï¼Œå¹¶å¼€å§‹åŠ è½½ OnlyOffice API åŠåˆå§‹åŒ–ç¼–è¾‘å™¨ã€‚</span>
</span><span id="__span-32-202"><a id="__codelineno-32-202" name="__codelineno-32-202" href="#__codelineno-32-202"></a><span class="cm">   * @returns {void}</span>
</span><span id="__span-32-203"><a id="__codelineno-32-203" name="__codelineno-32-203" href="#__codelineno-32-203"></a><span class="cm">   */</span>
</span><span id="__span-32-204"><a id="__codelineno-32-204" name="__codelineno-32-204" href="#__codelineno-32-204"></a><span class="w">  </span><span class="nx">mounted</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-205"><a id="__codelineno-32-205" name="__codelineno-32-205" href="#__codelineno-32-205"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">isMounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-32-206"><a id="__codelineno-32-206" name="__codelineno-32-206" href="#__codelineno-32-206"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">loadApiAndInitEditor</span><span class="p">();</span>
</span><span id="__span-32-207"><a id="__codelineno-32-207" name="__codelineno-32-207" href="#__codelineno-32-207"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-32-208"><a id="__codelineno-32-208" name="__codelineno-32-208" href="#__codelineno-32-208"></a><span class="w">  </span><span class="cm">/**</span>
</span><span id="__span-32-209"><a id="__codelineno-32-209" name="__codelineno-32-209" href="#__codelineno-32-209"></a><span class="cm">   * Vue ç»„ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­ï¼šå®ä¾‹é”€æ¯ä¹‹å‰è°ƒç”¨ã€‚</span>
</span><span id="__span-32-210"><a id="__codelineno-32-210" name="__codelineno-32-210" href="#__codelineno-32-210"></a><span class="cm">   * ç¡®ä¿é”€æ¯ OnlyOffice ç¼–è¾‘å™¨å®ä¾‹ï¼Œé‡Šæ”¾èµ„æºã€‚</span>
</span><span id="__span-32-211"><a id="__codelineno-32-211" name="__codelineno-32-211" href="#__codelineno-32-211"></a><span class="cm">   * @returns {void}</span>
</span><span id="__span-32-212"><a id="__codelineno-32-212" name="__codelineno-32-212" href="#__codelineno-32-212"></a><span class="cm">   */</span>
</span><span id="__span-32-213"><a id="__codelineno-32-213" name="__codelineno-32-213" href="#__codelineno-32-213"></a><span class="w">  </span><span class="nx">beforeDestroy</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-214"><a id="__codelineno-32-214" name="__codelineno-32-214" href="#__codelineno-32-214"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">destroyEditorInstance</span><span class="p">();</span>
</span><span id="__span-32-215"><a id="__codelineno-32-215" name="__codelineno-32-215" href="#__codelineno-32-215"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-32-216"><a id="__codelineno-32-216" name="__codelineno-32-216" href="#__codelineno-32-216"></a><span class="w">  </span><span class="nx">methods</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-217"><a id="__codelineno-32-217" name="__codelineno-32-217" href="#__codelineno-32-217"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-218"><a id="__codelineno-32-218" name="__codelineno-32-218" href="#__codelineno-32-218"></a><span class="cm">     * å¤„ç† `config` prop å˜åŒ–çš„å›è°ƒå‡½æ•°ã€‚</span>
</span><span id="__span-32-219"><a id="__codelineno-32-219" name="__codelineno-32-219" href="#__codelineno-32-219"></a><span class="cm">     * ç¡®ä¿ç»„ä»¶å·²æŒ‚è½½ï¼Œç„¶åè°ƒç”¨ `reloadEditor`ã€‚</span>
</span><span id="__span-32-220"><a id="__codelineno-32-220" name="__codelineno-32-220" href="#__codelineno-32-220"></a><span class="cm">     * @returns {void}</span>
</span><span id="__span-32-221"><a id="__codelineno-32-221" name="__codelineno-32-221" href="#__codelineno-32-221"></a><span class="cm">     */</span>
</span><span id="__span-32-222"><a id="__codelineno-32-222" name="__codelineno-32-222" href="#__codelineno-32-222"></a><span class="w">    </span><span class="nx">handleConfigChange</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-223"><a id="__codelineno-32-223" name="__codelineno-32-223" href="#__codelineno-32-223"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isMounted</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span><span class="w"> </span><span class="c1">// å¦‚æœç»„ä»¶å°šæœªæŒ‚è½½ï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œ</span>
</span><span id="__span-32-224"><a id="__codelineno-32-224" name="__codelineno-32-224" href="#__codelineno-32-224"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">reloadEditor</span><span class="p">();</span><span class="w"> </span><span class="c1">// é‡æ–°åŠ è½½ç¼–è¾‘å™¨ä»¥åº”ç”¨æ–°çš„ config</span>
</span><span id="__span-32-225"><a id="__codelineno-32-225" name="__codelineno-32-225" href="#__codelineno-32-225"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-32-226"><a id="__codelineno-32-226" name="__codelineno-32-226" href="#__codelineno-32-226"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-227"><a id="__codelineno-32-227" name="__codelineno-32-227" href="#__codelineno-32-227"></a><span class="cm">     * å¼‚æ­¥åŠ è½½ OnlyOffice Document Server API è„šæœ¬ï¼Œå¹¶åœ¨æˆåŠŸååˆå§‹åŒ–ç¼–è¾‘å™¨ã€‚</span>
</span><span id="__span-32-228"><a id="__codelineno-32-228" name="__codelineno-32-228" href="#__codelineno-32-228"></a><span class="cm">     * @async</span>
</span><span id="__span-32-229"><a id="__codelineno-32-229" name="__codelineno-32-229" href="#__codelineno-32-229"></a><span class="cm">     * @returns {Promise&lt;void&gt;} ä¸€ä¸ªåœ¨ API åŠ è½½å’Œç¼–è¾‘å™¨åˆå§‹åŒ–å°è¯•å®Œæˆåè§£æçš„ Promiseã€‚</span>
</span><span id="__span-32-230"><a id="__codelineno-32-230" name="__codelineno-32-230" href="#__codelineno-32-230"></a><span class="cm">     */</span>
</span><span id="__span-32-231"><a id="__codelineno-32-231" name="__codelineno-32-231" href="#__codelineno-32-231"></a><span class="w">    </span><span class="k">async</span><span class="w"> </span><span class="nx">loadApiAndInitEditor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-232"><a id="__codelineno-32-232" name="__codelineno-32-232" href="#__codelineno-32-232"></a><span class="w">      </span><span class="c1">// æ£€æŸ¥ Document Server API URL æ˜¯å¦å·²é…ç½®</span>
</span><span id="__span-32-233"><a id="__codelineno-32-233" name="__codelineno-32-233" href="#__codelineno-32-233"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">docApiUrl</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-234"><a id="__codelineno-32-234" name="__codelineno-32-234" href="#__codelineno-32-234"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">'OnlyOffice API URL æœªé…ç½®ã€‚'</span><span class="p">));</span>
</span><span id="__span-32-235"><a id="__codelineno-32-235" name="__codelineno-32-235" href="#__codelineno-32-235"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-32-236"><a id="__codelineno-32-236" name="__codelineno-32-236" href="#__codelineno-32-236"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-32-237"><a id="__codelineno-32-237" name="__codelineno-32-237" href="#__codelineno-32-237"></a>
</span><span id="__span-32-238"><a id="__codelineno-32-238" name="__codelineno-32-238" href="#__codelineno-32-238"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] å‡†å¤‡åŠ è½½/éªŒè¯ OnlyOffice API è„šæœ¬...'</span><span class="p">);</span>
</span><span id="__span-32-239"><a id="__codelineno-32-239" name="__codelineno-32-239" href="#__codelineno-32-239"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">apiScriptLoaded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"> </span><span class="c1">// é‡ç½® API åŠ è½½çŠ¶æ€</span>
</span><span id="__span-32-240"><a id="__codelineno-32-240" name="__codelineno-32-240" href="#__codelineno-32-240"></a>
</span><span id="__span-32-241"><a id="__codelineno-32-241" name="__codelineno-32-241" href="#__codelineno-32-241"></a><span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-242"><a id="__codelineno-32-242" name="__codelineno-32-242" href="#__codelineno-32-242"></a><span class="w">        </span><span class="c1">// è°ƒç”¨å¤–éƒ¨çš„ loadScript å‡½æ•°åŠ è½½ API</span>
</span><span id="__span-32-243"><a id="__codelineno-32-243" name="__codelineno-32-243" href="#__codelineno-32-243"></a><span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="nx">loadScript</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">docApiUrl</span><span class="p">,</span><span class="w"> </span><span class="s1">'onlyoffice-api-script'</span><span class="p">);</span><span class="w"> </span><span class="c1">// 'onlyoffice-api-script' æ˜¯ script æ ‡ç­¾çš„ ID</span>
</span><span id="__span-32-244"><a id="__codelineno-32-244" name="__codelineno-32-244" href="#__codelineno-32-244"></a>
</span><span id="__span-32-245"><a id="__codelineno-32-245" name="__codelineno-32-245" href="#__codelineno-32-245"></a><span class="w">        </span><span class="c1">// å½“ loadScript è§£æ (resolve) æ—¶ï¼Œç†è®ºä¸Š DocsAPI åº”è¯¥å¯ç”¨äº†</span>
</span><span id="__span-32-246"><a id="__codelineno-32-246" name="__codelineno-32-246" href="#__codelineno-32-246"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DocsAPI</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-247"><a id="__codelineno-32-247" name="__codelineno-32-247" href="#__codelineno-32-247"></a><span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] OnlyOffice API è„šæœ¬å·²ç¡®è®¤å¯ç”¨ã€‚'</span><span class="p">);</span>
</span><span id="__span-32-248"><a id="__codelineno-32-248" name="__codelineno-32-248" href="#__codelineno-32-248"></a><span class="w">          </span><span class="k">this</span><span class="p">.</span><span class="nx">apiScriptLoaded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w"> </span><span class="c1">// æ ‡è®° API è„šæœ¬åŠ è½½æµç¨‹å®Œæˆ</span>
</span><span id="__span-32-249"><a id="__codelineno-32-249" name="__codelineno-32-249" href="#__codelineno-32-249"></a><span class="w">          </span><span class="k">this</span><span class="p">.</span><span class="nx">initEditor</span><span class="p">();</span><span class="w"> </span><span class="c1">// åˆå§‹åŒ–ç¼–è¾‘å™¨</span>
</span><span id="__span-32-250"><a id="__codelineno-32-250" name="__codelineno-32-250" href="#__codelineno-32-250"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-251"><a id="__codelineno-32-251" name="__codelineno-32-251" href="#__codelineno-32-251"></a><span class="w">          </span><span class="c1">// è¿™æ˜¯ä¸€ä¸ªå¼‚å¸¸æƒ…å†µï¼ŒloadScript åº”è¯¥ç¡®ä¿ DocsAPI å¯ç”¨æ‰è§£æ</span>
</span><span id="__span-32-252"><a id="__codelineno-32-252" name="__codelineno-32-252" href="#__codelineno-32-252"></a><span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] loadScript è§£æå®Œæˆï¼Œä½† window.DocsAPI ä»ä¸å¯ç”¨ï¼'</span><span class="p">);</span>
</span><span id="__span-32-253"><a id="__codelineno-32-253" name="__codelineno-32-253" href="#__codelineno-32-253"></a><span class="w">          </span><span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">'API è„šæœ¬åŠ è½½å DocsAPI ä»ä¸å¯ç”¨ã€‚'</span><span class="p">));</span>
</span><span id="__span-32-254"><a id="__codelineno-32-254" name="__codelineno-32-254" href="#__codelineno-32-254"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-32-255"><a id="__codelineno-32-255" name="__codelineno-32-255" href="#__codelineno-32-255"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-256"><a id="__codelineno-32-256" name="__codelineno-32-256" href="#__codelineno-32-256"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] è°ƒç”¨ loadScript åŠ è½½ OnlyOffice API è„šæœ¬æ—¶å‘ç”Ÿé”™è¯¯:'</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-32-257"><a id="__codelineno-32-257" name="__codelineno-32-257" href="#__codelineno-32-257"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">apiScriptLoaded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"> </span><span class="c1">// ç¡®ä¿çŠ¶æ€åœ¨å‡ºé”™æ—¶ä¹Ÿæ˜¯æ­£ç¡®çš„</span>
</span><span id="__span-32-258"><a id="__codelineno-32-258" name="__codelineno-32-258" href="#__codelineno-32-258"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span><span class="w"> </span><span class="c1">// å°†é”™è¯¯äº‹ä»¶ä¼ é€’ç»™çˆ¶ç»„ä»¶</span>
</span><span id="__span-32-259"><a id="__codelineno-32-259" name="__codelineno-32-259" href="#__codelineno-32-259"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-32-260"><a id="__codelineno-32-260" name="__codelineno-32-260" href="#__codelineno-32-260"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-32-261"><a id="__codelineno-32-261" name="__codelineno-32-261" href="#__codelineno-32-261"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-262"><a id="__codelineno-32-262" name="__codelineno-32-262" href="#__codelineno-32-262"></a><span class="cm">     * å½“ Document Server URL å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé‡æ–°åŠ è½½ API è„šæœ¬å’Œç¼–è¾‘å™¨ã€‚</span>
</span><span id="__span-32-263"><a id="__codelineno-32-263" name="__codelineno-32-263" href="#__codelineno-32-263"></a><span class="cm">     * @returns {void}</span>
</span><span id="__span-32-264"><a id="__codelineno-32-264" name="__codelineno-32-264" href="#__codelineno-32-264"></a><span class="cm">     */</span>
</span><span id="__span-32-265"><a id="__codelineno-32-265" name="__codelineno-32-265" href="#__codelineno-32-265"></a><span class="w">    </span><span class="nx">reloadApiAndEditor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-266"><a id="__codelineno-32-266" name="__codelineno-32-266" href="#__codelineno-32-266"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isMounted</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span><span class="w"> </span><span class="c1">// å¦‚æœç»„ä»¶å°šæœªæŒ‚è½½ï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œ</span>
</span><span id="__span-32-267"><a id="__codelineno-32-267" name="__codelineno-32-267" href="#__codelineno-32-267"></a><span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] Document Server URL å‘ç”Ÿå˜åŒ–ï¼Œé‡æ–°åŠ è½½ API å’Œç¼–è¾‘å™¨ã€‚'</span><span class="p">);</span>
</span><span id="__span-32-268"><a id="__codelineno-32-268" name="__codelineno-32-268" href="#__codelineno-32-268"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">destroyEditorInstance</span><span class="p">();</span><span class="w"> </span><span class="c1">// é”€æ¯å½“å‰ç¼–è¾‘å™¨å®ä¾‹</span>
</span><span id="__span-32-269"><a id="__codelineno-32-269" name="__codelineno-32-269" href="#__codelineno-32-269"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">apiScriptLoaded</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"> </span><span class="c1">// é‡ç½® API åŠ è½½çŠ¶æ€ï¼Œå› ä¸º URL å·²æ”¹å˜</span>
</span><span id="__span-32-270"><a id="__codelineno-32-270" name="__codelineno-32-270" href="#__codelineno-32-270"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">loadApiAndInitEditor</span><span class="p">();</span><span class="w"> </span><span class="c1">// é‡æ–°åŠ è½½ API å¹¶åˆå§‹åŒ–ç¼–è¾‘å™¨</span>
</span><span id="__span-32-271"><a id="__codelineno-32-271" name="__codelineno-32-271" href="#__codelineno-32-271"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-32-272"><a id="__codelineno-32-272" name="__codelineno-32-272" href="#__codelineno-32-272"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-273"><a id="__codelineno-32-273" name="__codelineno-32-273" href="#__codelineno-32-273"></a><span class="cm">     * åˆå§‹åŒ–ç¼–è¾‘å™¨çš„å‰ç½®æ£€æŸ¥ã€‚</span>
</span><span id="__span-32-274"><a id="__codelineno-32-274" name="__codelineno-32-274" href="#__codelineno-32-274"></a><span class="cm">     * ç¡®ä¿ API å·²åŠ è½½ä¸” DOM å ä½ç¬¦å…ƒç´ å­˜åœ¨ï¼Œç„¶åè°ƒç”¨ `createEditor`ã€‚</span>
</span><span id="__span-32-275"><a id="__codelineno-32-275" name="__codelineno-32-275" href="#__codelineno-32-275"></a><span class="cm">     * @returns {void}</span>
</span><span id="__span-32-276"><a id="__codelineno-32-276" name="__codelineno-32-276" href="#__codelineno-32-276"></a><span class="cm">     */</span>
</span><span id="__span-32-277"><a id="__codelineno-32-277" name="__codelineno-32-277" href="#__codelineno-32-277"></a><span class="w">    </span><span class="nx">initEditor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-278"><a id="__codelineno-32-278" name="__codelineno-32-278" href="#__codelineno-32-278"></a><span class="w">      </span><span class="c1">// æ£€æŸ¥ API è„šæœ¬æ˜¯å¦å·²åŠ è½½</span>
</span><span id="__span-32-279"><a id="__codelineno-32-279" name="__codelineno-32-279" href="#__codelineno-32-279"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">apiScriptLoaded</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-280"><a id="__codelineno-32-280" name="__codelineno-32-280" href="#__codelineno-32-280"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] API è„šæœ¬æœªåŠ è½½ã€‚æ­£åœ¨å°è¯•é‡æ–°åŠ è½½ã€‚'</span><span class="p">);</span>
</span><span id="__span-32-281"><a id="__codelineno-32-281" name="__codelineno-32-281" href="#__codelineno-32-281"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">loadApiAndInitEditor</span><span class="p">();</span><span class="w"> </span><span class="c1">// å°è¯•å†æ¬¡åŠ è½½ API</span>
</span><span id="__span-32-282"><a id="__codelineno-32-282" name="__codelineno-32-282" href="#__codelineno-32-282"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-32-283"><a id="__codelineno-32-283" name="__codelineno-32-283" href="#__codelineno-32-283"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-32-284"><a id="__codelineno-32-284" name="__codelineno-32-284" href="#__codelineno-32-284"></a><span class="w">      </span><span class="c1">// æ£€æŸ¥ç¼–è¾‘å™¨å ä½ç¬¦ DOM å…ƒç´ æ˜¯å¦å­˜åœ¨</span>
</span><span id="__span-32-285"><a id="__codelineno-32-285" name="__codelineno-32-285" href="#__codelineno-32-285"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">editorId</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-286"><a id="__codelineno-32-286" name="__codelineno-32-286" href="#__codelineno-32-286"></a><span class="w">        </span><span class="c1">// å¦‚æœ DOM å…ƒç´ å°šä¸å­˜åœ¨ï¼Œåˆ™ç­‰å¾…ä¸‹ä¸€ä¸ª Tick (DOM æ›´æ–°å‘¨æœŸ)</span>
</span><span id="__span-32-287"><a id="__codelineno-32-287" name="__codelineno-32-287" href="#__codelineno-32-287"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">$nextTick</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-288"><a id="__codelineno-32-288" name="__codelineno-32-288" href="#__codelineno-32-288"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">editorId</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-289"><a id="__codelineno-32-289" name="__codelineno-32-289" href="#__codelineno-32-289"></a><span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`[æ–‡æ¡£ç¼–è¾‘å™¨] æœªæ‰¾åˆ° ID ä¸º '</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">editorId</span><span class="si">}</span><span class="sb">' çš„ç¼–è¾‘å™¨å ä½ç¬¦å…ƒç´ ã€‚`</span><span class="p">);</span>
</span><span id="__span-32-290"><a id="__codelineno-32-290" name="__codelineno-32-290" href="#__codelineno-32-290"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`æœªæ‰¾åˆ°å ä½ç¬¦ ID '</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">editorId</span><span class="si">}</span><span class="sb">'ã€‚`</span><span class="p">));</span>
</span><span id="__span-32-291"><a id="__codelineno-32-291" name="__codelineno-32-291" href="#__codelineno-32-291"></a><span class="w">            </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-32-292"><a id="__codelineno-32-292" name="__codelineno-32-292" href="#__codelineno-32-292"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-32-293"><a id="__codelineno-32-293" name="__codelineno-32-293" href="#__codelineno-32-293"></a><span class="w">          </span><span class="c1">// ç¡®ä¿ DocsAPI ä»ç„¶å¯ç”¨ (ä»¥é˜²ä¸‡ä¸€)</span>
</span><span id="__span-32-294"><a id="__codelineno-32-294" name="__codelineno-32-294" href="#__codelineno-32-294"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DocsAPI</span><span class="p">)</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">createEditor</span><span class="p">();</span>
</span><span id="__span-32-295"><a id="__codelineno-32-295" name="__codelineno-32-295" href="#__codelineno-32-295"></a><span class="w">        </span><span class="p">});</span>
</span><span id="__span-32-296"><a id="__codelineno-32-296" name="__codelineno-32-296" href="#__codelineno-32-296"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-32-297"><a id="__codelineno-32-297" name="__codelineno-32-297" href="#__codelineno-32-297"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-32-298"><a id="__codelineno-32-298" name="__codelineno-32-298" href="#__codelineno-32-298"></a><span class="w">      </span><span class="c1">// å¦‚æœä¸€åˆ‡å°±ç»ªï¼Œåˆ›å»ºç¼–è¾‘å™¨</span>
</span><span id="__span-32-299"><a id="__codelineno-32-299" name="__codelineno-32-299" href="#__codelineno-32-299"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">createEditor</span><span class="p">();</span>
</span><span id="__span-32-300"><a id="__codelineno-32-300" name="__codelineno-32-300" href="#__codelineno-32-300"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-32-301"><a id="__codelineno-32-301" name="__codelineno-32-301" href="#__codelineno-32-301"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-302"><a id="__codelineno-32-302" name="__codelineno-32-302" href="#__codelineno-32-302"></a><span class="cm">     * åˆ›å»ºå¹¶åˆå§‹åŒ– OnlyOffice ç¼–è¾‘å™¨å®ä¾‹ã€‚</span>
</span><span id="__span-32-303"><a id="__codelineno-32-303" name="__codelineno-32-303" href="#__codelineno-32-303"></a><span class="cm">     * æ­¤æ–¹æ³•è´Ÿè´£åˆå¹¶é…ç½®ã€æ ¡éªŒå…³é”®å‚æ•°ï¼Œå¹¶æœ€ç»ˆè°ƒç”¨ `DocsAPI.DocEditor`ã€‚</span>
</span><span id="__span-32-304"><a id="__codelineno-32-304" name="__codelineno-32-304" href="#__codelineno-32-304"></a><span class="cm">     * @returns {void}</span>
</span><span id="__span-32-305"><a id="__codelineno-32-305" name="__codelineno-32-305" href="#__codelineno-32-305"></a><span class="cm">     */</span>
</span><span id="__span-32-306"><a id="__codelineno-32-306" name="__codelineno-32-306" href="#__codelineno-32-306"></a><span class="w">    </span><span class="nx">createEditor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-307"><a id="__codelineno-32-307" name="__codelineno-32-307" href="#__codelineno-32-307"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">destroyEditorInstance</span><span class="p">();</span><span class="w"> </span><span class="c1">// å…ˆé”€æ¯ä»»ä½•å·²å­˜åœ¨çš„ç¼–è¾‘å™¨å®ä¾‹</span>
</span><span id="__span-32-308"><a id="__codelineno-32-308" name="__codelineno-32-308" href="#__codelineno-32-308"></a><span class="w">      </span><span class="c1">// ç¡®ä¿ DocsAPI å…¨å±€å¯¹è±¡å­˜åœ¨</span>
</span><span id="__span-32-309"><a id="__codelineno-32-309" name="__codelineno-32-309" href="#__codelineno-32-309"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">window</span><span class="p">.</span><span class="nx">DocsAPI</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-310"><a id="__codelineno-32-310" name="__codelineno-32-310" href="#__codelineno-32-310"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] DocsAPI ä¸å¯ç”¨ã€‚'</span><span class="p">);</span>
</span><span id="__span-32-311"><a id="__codelineno-32-311" name="__codelineno-32-311" href="#__codelineno-32-311"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">'DocsAPI ä¸å¯ç”¨ã€‚'</span><span class="p">));</span>
</span><span id="__span-32-312"><a id="__codelineno-32-312" name="__codelineno-32-312" href="#__codelineno-32-312"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-32-313"><a id="__codelineno-32-313" name="__codelineno-32-313" href="#__codelineno-32-313"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-32-314"><a id="__codelineno-32-314" name="__codelineno-32-314" href="#__codelineno-32-314"></a>
</span><span id="__span-32-315"><a id="__codelineno-32-315" name="__codelineno-32-315" href="#__codelineno-32-315"></a><span class="w">      </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-316"><a id="__codelineno-32-316" name="__codelineno-32-316" href="#__codelineno-32-316"></a><span class="w">        </span><span class="c1">// 1. ä»å•ç‹¬çš„ props æ„å»ºé»˜è®¤é…ç½®å¯¹è±¡</span>
</span><span id="__span-32-317"><a id="__codelineno-32-317" name="__codelineno-32-317" href="#__codelineno-32-317"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">defaultConfigFromProps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-318"><a id="__codelineno-32-318" name="__codelineno-32-318" href="#__codelineno-32-318"></a><span class="w">          </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span>
</span><span id="__span-32-319"><a id="__codelineno-32-319" name="__codelineno-32-319" href="#__codelineno-32-319"></a><span class="w">          </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span>
</span><span id="__span-32-320"><a id="__codelineno-32-320" name="__codelineno-32-320" href="#__codelineno-32-320"></a><span class="w">          </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="p">,</span>
</span><span id="__span-32-321"><a id="__codelineno-32-321" name="__codelineno-32-321" href="#__codelineno-32-321"></a><span class="w">          </span><span class="nx">documentType</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">documentType</span><span class="p">,</span>
</span><span id="__span-32-322"><a id="__codelineno-32-322" name="__codelineno-32-322" href="#__codelineno-32-322"></a><span class="w">          </span><span class="nb">document</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-323"><a id="__codelineno-32-323" name="__codelineno-32-323" href="#__codelineno-32-323"></a><span class="w">            </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">documentTitle</span><span class="p">,</span>
</span><span id="__span-32-324"><a id="__codelineno-32-324" name="__codelineno-32-324" href="#__codelineno-32-324"></a><span class="w">            </span><span class="nx">fileType</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">documentFileType</span><span class="p">,</span>
</span><span id="__span-32-325"><a id="__codelineno-32-325" name="__codelineno-32-325" href="#__codelineno-32-325"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-32-326"><a id="__codelineno-32-326" name="__codelineno-32-326" href="#__codelineno-32-326"></a><span class="w">          </span><span class="nx">editorConfig</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-327"><a id="__codelineno-32-327" name="__codelineno-32-327" href="#__codelineno-32-327"></a><span class="w">            </span><span class="nx">lang</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">editorConfigLang</span><span class="p">,</span>
</span><span id="__span-32-328"><a id="__codelineno-32-328" name="__codelineno-32-328" href="#__codelineno-32-328"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-32-329"><a id="__codelineno-32-329" name="__codelineno-32-329" href="#__codelineno-32-329"></a><span class="w">          </span><span class="c1">// å°† props.events ä½œä¸ºé»˜è®¤äº‹ä»¶é…ç½®ï¼Œæ·±æ‹·è´ä»¥é¿å…æ„å¤–ä¿®æ”¹åŸå§‹ prop</span>
</span><span id="__span-32-330"><a id="__codelineno-32-330" name="__codelineno-32-330" href="#__codelineno-32-330"></a><span class="w">          </span><span class="nx">events</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">events</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">events</span><span class="p">))</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-32-331"><a id="__codelineno-32-331" name="__codelineno-32-331" href="#__codelineno-32-331"></a><span class="w">        </span><span class="p">};</span>
</span><span id="__span-32-332"><a id="__codelineno-32-332" name="__codelineno-32-332" href="#__codelineno-32-332"></a>
</span><span id="__span-32-333"><a id="__codelineno-32-333" name="__codelineno-32-333" href="#__codelineno-32-333"></a><span class="w">        </span><span class="c1">// 2. ä» props.config æ·±æ‹·è´é«˜ä¼˜å…ˆçº§é…ç½®</span>
</span><span id="__span-32-334"><a id="__codelineno-32-334" name="__codelineno-32-334" href="#__codelineno-32-334"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">highPriorityConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">config</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">config</span><span class="p">))</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-32-335"><a id="__codelineno-32-335" name="__codelineno-32-335" href="#__codelineno-32-335"></a>
</span><span id="__span-32-336"><a id="__codelineno-32-336" name="__codelineno-32-336" href="#__codelineno-32-336"></a><span class="w">        </span><span class="c1">// 3. åˆå¹¶é…ç½®ï¼šhighPriorityConfig ä¼šè¦†ç›– defaultConfigFromProps ä¸­çš„åŒåå±æ€§</span>
</span><span id="__span-32-337"><a id="__codelineno-32-337" name="__codelineno-32-337" href="#__codelineno-32-337"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">finalConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mergeDeep</span><span class="p">({},</span><span class="w"> </span><span class="nx">defaultConfigFromProps</span><span class="p">,</span><span class="w"> </span><span class="nx">highPriorityConfig</span><span class="p">);</span>
</span><span id="__span-32-338"><a id="__codelineno-32-338" name="__codelineno-32-338" href="#__codelineno-32-338"></a>
</span><span id="__span-32-339"><a id="__codelineno-32-339" name="__codelineno-32-339" href="#__codelineno-32-339"></a><span class="w">        </span><span class="c1">// 4. å•ç‹¬æ„å»ºäº‹ä»¶å¤„ç†å™¨ï¼Œç¡®ä¿æ­£ç¡®çš„ä¼˜å…ˆçº§å’Œ $emit è¡Œä¸º</span>
</span><span id="__span-32-340"><a id="__codelineno-32-340" name="__codelineno-32-340" href="#__codelineno-32-340"></a><span class="w">        </span><span class="nx">finalConfig</span><span class="p">.</span><span class="nx">events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">buildEventHandlers</span><span class="p">();</span>
</span><span id="__span-32-341"><a id="__codelineno-32-341" name="__codelineno-32-341" href="#__codelineno-32-341"></a>
</span><span id="__span-32-342"><a id="__codelineno-32-342" name="__codelineno-32-342" href="#__codelineno-32-342"></a><span class="w">        </span><span class="c1">// 5. æ ¡éªŒå…³é”®é…ç½®å­—æ®µï¼šdocument.url å’Œ document.key</span>
</span><span id="__span-32-343"><a id="__codelineno-32-343" name="__codelineno-32-343" href="#__codelineno-32-343"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">finalConfig</span><span class="p">.</span><span class="nb">document</span><span class="o">?</span><span class="p">.</span><span class="nx">url</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">finalConfig</span><span class="p">.</span><span class="nb">document</span><span class="o">?</span><span class="p">.</span><span class="nx">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-344"><a id="__codelineno-32-344" name="__codelineno-32-344" href="#__codelineno-32-344"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">errMsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"[æ–‡æ¡£ç¼–è¾‘å™¨] å…³é”®é”™è¯¯ï¼šå¿…é¡»æä¾› 'config.document.url' å’Œ 'config.document.key'ã€‚"</span><span class="p">;</span>
</span><span id="__span-32-345"><a id="__codelineno-32-345" name="__codelineno-32-345" href="#__codelineno-32-345"></a><span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">errMsg</span><span class="p">,</span><span class="w"> </span><span class="nx">finalConfig</span><span class="p">.</span><span class="nb">document</span><span class="p">);</span>
</span><span id="__span-32-346"><a id="__codelineno-32-346" name="__codelineno-32-346" href="#__codelineno-32-346"></a><span class="w">          </span><span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="nx">errMsg</span><span class="p">));</span>
</span><span id="__span-32-347"><a id="__codelineno-32-347" name="__codelineno-32-347" href="#__codelineno-32-347"></a><span class="w">          </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-32-348"><a id="__codelineno-32-348" name="__codelineno-32-348" href="#__codelineno-32-348"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-32-349"><a id="__codelineno-32-349" name="__codelineno-32-349" href="#__codelineno-32-349"></a><span class="w">        </span><span class="c1">// æ ¡éªŒ editorConfig.callbackUrl (å¯é€‰ï¼Œä½†å»ºè®®æä¾›)</span>
</span><span id="__span-32-350"><a id="__codelineno-32-350" name="__codelineno-32-350" href="#__codelineno-32-350"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">finalConfig</span><span class="p">.</span><span class="nx">editorConfig</span><span class="o">?</span><span class="p">.</span><span class="nx">callbackUrl</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-351"><a id="__codelineno-32-351" name="__codelineno-32-351" href="#__codelineno-32-351"></a><span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">"[æ–‡æ¡£ç¼–è¾‘å™¨] è­¦å‘Šï¼šæœªæä¾› 'config.editorConfig.callbackUrl'ã€‚"</span><span class="p">,</span><span class="w"> </span><span class="nx">finalConfig</span><span class="p">.</span><span class="nx">editorConfig</span><span class="p">);</span>
</span><span id="__span-32-352"><a id="__codelineno-32-352" name="__codelineno-32-352" href="#__codelineno-32-352"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-32-353"><a id="__codelineno-32-353" name="__codelineno-32-353" href="#__codelineno-32-353"></a><span class="w">        </span><span class="c1">// å¦‚æœ documentType æœªæä¾›ï¼Œå°è¯•ä» fileType æ¨æ–­</span>
</span><span id="__span-32-354"><a id="__codelineno-32-354" name="__codelineno-32-354" href="#__codelineno-32-354"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">finalConfig</span><span class="p">.</span><span class="nx">documentType</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">finalConfig</span><span class="p">.</span><span class="nb">document</span><span class="o">?</span><span class="p">.</span><span class="nx">fileType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-355"><a id="__codelineno-32-355" name="__codelineno-32-355" href="#__codelineno-32-355"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">fileType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">finalConfig</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">fileType</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span id="__span-32-356"><a id="__codelineno-32-356" name="__codelineno-32-356" href="#__codelineno-32-356"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="s1">'doc'</span><span class="p">,</span><span class="w"> </span><span class="s1">'docx'</span><span class="p">,</span><span class="w"> </span><span class="s1">'odt'</span><span class="p">,</span><span class="w"> </span><span class="s1">'rtf'</span><span class="p">,</span><span class="w"> </span><span class="s1">'txt'</span><span class="p">,</span><span class="w"> </span><span class="s1">'html'</span><span class="p">,</span><span class="w"> </span><span class="s1">'mht'</span><span class="p">,</span><span class="w"> </span><span class="s1">'pdf'</span><span class="p">,</span><span class="w"> </span><span class="s1">'djvu'</span><span class="p">,</span><span class="w"> </span><span class="s1">'xps'</span><span class="p">,</span><span class="w"> </span><span class="s1">'fodt'</span><span class="p">].</span><span class="nx">includes</span><span class="p">(</span><span class="nx">fileType</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-357"><a id="__codelineno-32-357" name="__codelineno-32-357" href="#__codelineno-32-357"></a><span class="w">            </span><span class="nx">finalConfig</span><span class="p">.</span><span class="nx">documentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'word'</span><span class="p">;</span>
</span><span id="__span-32-358"><a id="__codelineno-32-358" name="__codelineno-32-358" href="#__codelineno-32-358"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="s1">'xls'</span><span class="p">,</span><span class="w"> </span><span class="s1">'xlsx'</span><span class="p">,</span><span class="w"> </span><span class="s1">'ods'</span><span class="p">,</span><span class="w"> </span><span class="s1">'csv'</span><span class="p">,</span><span class="w"> </span><span class="s1">'fods'</span><span class="p">].</span><span class="nx">includes</span><span class="p">(</span><span class="nx">fileType</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-359"><a id="__codelineno-32-359" name="__codelineno-32-359" href="#__codelineno-32-359"></a><span class="w">            </span><span class="nx">finalConfig</span><span class="p">.</span><span class="nx">documentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'cell'</span><span class="p">;</span>
</span><span id="__span-32-360"><a id="__codelineno-32-360" name="__codelineno-32-360" href="#__codelineno-32-360"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="s1">'ppt'</span><span class="p">,</span><span class="w"> </span><span class="s1">'pptx'</span><span class="p">,</span><span class="w"> </span><span class="s1">'odp'</span><span class="p">,</span><span class="w"> </span><span class="s1">'fodp'</span><span class="p">].</span><span class="nx">includes</span><span class="p">(</span><span class="nx">fileType</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-361"><a id="__codelineno-32-361" name="__codelineno-32-361" href="#__codelineno-32-361"></a><span class="w">            </span><span class="nx">finalConfig</span><span class="p">.</span><span class="nx">documentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'slide'</span><span class="p">;</span>
</span><span id="__span-32-362"><a id="__codelineno-32-362" name="__codelineno-32-362" href="#__codelineno-32-362"></a><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-363"><a id="__codelineno-32-363" name="__codelineno-32-363" href="#__codelineno-32-363"></a><span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="sb">`[æ–‡æ¡£ç¼–è¾‘å™¨] æœªçŸ¥çš„ fileType '</span><span class="si">${</span><span class="nx">fileType</span><span class="si">}</span><span class="sb">'ï¼Œæ— æ³•æ¨æ–­ documentTypeã€‚`</span><span class="p">);</span>
</span><span id="__span-32-364"><a id="__codelineno-32-364" name="__codelineno-32-364" href="#__codelineno-32-364"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-32-365"><a id="__codelineno-32-365" name="__codelineno-32-365" href="#__codelineno-32-365"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-32-366"><a id="__codelineno-32-366" name="__codelineno-32-366" href="#__codelineno-32-366"></a><span class="w">        </span><span class="c1">// æœ€ç»ˆæ ¡éªŒ documentType æ˜¯å¦å­˜åœ¨</span>
</span><span id="__span-32-367"><a id="__codelineno-32-367" name="__codelineno-32-367" href="#__codelineno-32-367"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">finalConfig</span><span class="p">.</span><span class="nx">documentType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-368"><a id="__codelineno-32-368" name="__codelineno-32-368" href="#__codelineno-32-368"></a><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">errMsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"[æ–‡æ¡£ç¼–è¾‘å™¨] å…³é”®é”™è¯¯ï¼š'documentType' ç¼ºå¤±æˆ–æ— æ³•æ¨æ–­ã€‚"</span><span class="p">;</span>
</span><span id="__span-32-369"><a id="__codelineno-32-369" name="__codelineno-32-369" href="#__codelineno-32-369"></a><span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">errMsg</span><span class="p">);</span>
</span><span id="__span-32-370"><a id="__codelineno-32-370" name="__codelineno-32-370" href="#__codelineno-32-370"></a><span class="w">          </span><span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="nx">errMsg</span><span class="p">));</span>
</span><span id="__span-32-371"><a id="__codelineno-32-371" name="__codelineno-32-371" href="#__codelineno-32-371"></a><span class="w">          </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-32-372"><a id="__codelineno-32-372" name="__codelineno-32-372" href="#__codelineno-32-372"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-32-373"><a id="__codelineno-32-373" name="__codelineno-32-373" href="#__codelineno-32-373"></a>
</span><span id="__span-32-374"><a id="__codelineno-32-374" name="__codelineno-32-374" href="#__codelineno-32-374"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] ä½¿ç”¨æœ€ç»ˆé…ç½®åˆå§‹åŒ–ç¼–è¾‘å™¨:'</span><span class="p">,</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">finalConfig</span><span class="p">)));</span>
</span><span id="__span-32-375"><a id="__codelineno-32-375" name="__codelineno-32-375" href="#__codelineno-32-375"></a><span class="w">        </span><span class="c1">// åˆ›å»º OnlyOffice ç¼–è¾‘å™¨å®ä¾‹</span>
</span><span id="__span-32-376"><a id="__codelineno-32-376" name="__codelineno-32-376" href="#__codelineno-32-376"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">editorInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">DocsAPI</span><span class="p">.</span><span class="nx">DocEditor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">editorId</span><span class="p">,</span><span class="w"> </span><span class="nx">finalConfig</span><span class="p">);</span>
</span><span id="__span-32-377"><a id="__codelineno-32-377" name="__codelineno-32-377" href="#__codelineno-32-377"></a><span class="w">        </span><span class="c1">// è§¦å‘ 'ready' äº‹ä»¶ï¼Œå¹¶ä¼ é€’ç¼–è¾‘å™¨å®ä¾‹</span>
</span><span id="__span-32-378"><a id="__codelineno-32-378" name="__codelineno-32-378" href="#__codelineno-32-378"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">'ready'</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">editorInstance</span><span class="p">);</span>
</span><span id="__span-32-379"><a id="__codelineno-32-379" name="__codelineno-32-379" href="#__codelineno-32-379"></a>
</span><span id="__span-32-380"><a id="__codelineno-32-380" name="__codelineno-32-380" href="#__codelineno-32-380"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-381"><a id="__codelineno-32-381" name="__codelineno-32-381" href="#__codelineno-32-381"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] åˆå§‹åŒ– OnlyOffice ç¼–è¾‘å™¨æ—¶å‡ºé”™:'</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-32-382"><a id="__codelineno-32-382" name="__codelineno-32-382" href="#__codelineno-32-382"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">'error'</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-32-383"><a id="__codelineno-32-383" name="__codelineno-32-383" href="#__codelineno-32-383"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-32-384"><a id="__codelineno-32-384" name="__codelineno-32-384" href="#__codelineno-32-384"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-32-385"><a id="__codelineno-32-385" name="__codelineno-32-385" href="#__codelineno-32-385"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-386"><a id="__codelineno-32-386" name="__codelineno-32-386" href="#__codelineno-32-386"></a><span class="cm">     * æ„å»ºä¼ é€’ç»™ OnlyOffice ç¼–è¾‘å™¨çš„äº‹ä»¶å¤„ç†å™¨å¯¹è±¡ã€‚</span>
</span><span id="__span-32-387"><a id="__codelineno-32-387" name="__codelineno-32-387" href="#__codelineno-32-387"></a><span class="cm">     * æ­¤æ–¹æ³•ç¡®ä¿ `config.events` ä¸­çš„äº‹ä»¶ä¼˜å…ˆäº `props.events` ä¸­çš„äº‹ä»¶ï¼Œ</span>
</span><span id="__span-32-388"><a id="__codelineno-32-388" name="__codelineno-32-388" href="#__codelineno-32-388"></a><span class="cm">     * å¹¶ä¸”æ‰€æœ‰è¢«ä»£ç†çš„äº‹ä»¶éƒ½ä¼šé€šè¿‡ `$emit` è§¦å‘ä¸º Vue ç»„ä»¶äº‹ä»¶ã€‚</span>
</span><span id="__span-32-389"><a id="__codelineno-32-389" name="__codelineno-32-389" href="#__codelineno-32-389"></a><span class="cm">     * @returns {Object} äº‹ä»¶å¤„ç†å™¨å¯¹è±¡ã€‚</span>
</span><span id="__span-32-390"><a id="__codelineno-32-390" name="__codelineno-32-390" href="#__codelineno-32-390"></a><span class="cm">     */</span>
</span><span id="__span-32-391"><a id="__codelineno-32-391" name="__codelineno-32-391" href="#__codelineno-32-391"></a><span class="w">    </span><span class="nx">buildEventHandlers</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-392"><a id="__codelineno-32-392" name="__codelineno-32-392" href="#__codelineno-32-392"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">handlers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span><span class="w"> </span><span class="c1">// å­˜å‚¨æœ€ç»ˆçš„äº‹ä»¶å¤„ç†å™¨</span>
</span><span id="__span-32-393"><a id="__codelineno-32-393" name="__codelineno-32-393" href="#__codelineno-32-393"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">;</span><span class="w"> </span><span class="c1">// ä¿å­˜ Vue ç»„ä»¶å®ä¾‹çš„å¼•ç”¨</span>
</span><span id="__span-32-394"><a id="__codelineno-32-394" name="__codelineno-32-394" href="#__codelineno-32-394"></a><span class="w">      </span><span class="c1">// éœ€è¦ä»£ç†çš„ OnlyOffice äº‹ä»¶åˆ—è¡¨</span>
</span><span id="__span-32-395"><a id="__codelineno-32-395" name="__codelineno-32-395" href="#__codelineno-32-395"></a><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">eventsToProxy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-32-396"><a id="__codelineno-32-396" name="__codelineno-32-396" href="#__codelineno-32-396"></a><span class="w">        </span><span class="s1">'onAppReady'</span><span class="p">,</span><span class="w"> </span><span class="s1">'onDocumentStateChange'</span><span class="p">,</span><span class="w"> </span><span class="s1">'onMetaChange'</span><span class="p">,</span><span class="w"> </span><span class="s1">'onDocumentReady'</span><span class="p">,</span><span class="w"> </span><span class="s1">'onError'</span><span class="p">,</span>
</span><span id="__span-32-397"><a id="__codelineno-32-397" name="__codelineno-32-397" href="#__codelineno-32-397"></a><span class="w">        </span><span class="s1">'onInfo'</span><span class="p">,</span><span class="w"> </span><span class="s1">'onWarning'</span><span class="p">,</span><span class="w"> </span><span class="s1">'onRequestEditRights'</span><span class="p">,</span><span class="w"> </span><span class="s1">'onRequestClose'</span><span class="p">,</span><span class="w"> </span><span class="s1">'onRequestSave'</span><span class="p">,</span>
</span><span id="__span-32-398"><a id="__codelineno-32-398" name="__codelineno-32-398" href="#__codelineno-32-398"></a><span class="w">        </span><span class="s1">'onRequestUsers'</span><span class="p">,</span><span class="w"> </span><span class="s1">'onRequestMailMergeRecipients'</span><span class="p">,</span><span class="w"> </span><span class="s1">'onRequestCompareFile'</span><span class="p">,</span>
</span><span id="__span-32-399"><a id="__codelineno-32-399" name="__codelineno-32-399" href="#__codelineno-32-399"></a><span class="w">        </span><span class="s1">'onRequestSharingSettings'</span><span class="p">,</span><span class="w"> </span><span class="s1">'onRequestInsertImage'</span><span class="p">,</span><span class="w"> </span><span class="s1">'onRequestSaveAs'</span><span class="p">,</span><span class="w"> </span><span class="s1">'onDownloadAs'</span><span class="p">,</span>
</span><span id="__span-32-400"><a id="__codelineno-32-400" name="__codelineno-32-400" href="#__codelineno-32-400"></a><span class="w">        </span><span class="s1">'onMakeActionLink'</span><span class="p">,</span>
</span><span id="__span-32-401"><a id="__codelineno-32-401" name="__codelineno-32-401" href="#__codelineno-32-401"></a><span class="w">      </span><span class="p">];</span>
</span><span id="__span-32-402"><a id="__codelineno-32-402" name="__codelineno-32-402" href="#__codelineno-32-402"></a>
</span><span id="__span-32-403"><a id="__codelineno-32-403" name="__codelineno-32-403" href="#__codelineno-32-403"></a><span class="w">      </span><span class="nx">eventsToProxy</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">eventName</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-404"><a id="__codelineno-32-404" name="__codelineno-32-404" href="#__codelineno-32-404"></a><span class="w">        </span><span class="c1">// å°† OnlyOffice äº‹ä»¶å (å¦‚ onAppReady) è½¬æ¢ä¸º Vue äº‹ä»¶å (å¦‚ app-ready)</span>
</span><span id="__span-32-405"><a id="__codelineno-32-405" name="__codelineno-32-405" href="#__codelineno-32-405"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">vueEventName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">eventName</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mf">2</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/([A-Z])/g</span><span class="p">,</span><span class="w"> </span><span class="s1">'-$1'</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">();</span>
</span><span id="__span-32-406"><a id="__codelineno-32-406" name="__codelineno-32-406" href="#__codelineno-32-406"></a>
</span><span id="__span-32-407"><a id="__codelineno-32-407" name="__codelineno-32-407" href="#__codelineno-32-407"></a><span class="w">        </span><span class="c1">// ä¸ºæ¯ä¸ª OnlyOffice äº‹ä»¶åˆ›å»ºä¸€ä¸ªåŒ…è£…å‡½æ•°</span>
</span><span id="__span-32-408"><a id="__codelineno-32-408" name="__codelineno-32-408" href="#__codelineno-32-408"></a><span class="w">        </span><span class="nx">handlers</span><span class="p">[</span><span class="nx">eventName</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(...</span><span class="nx">eventArgs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// ä½¿ç”¨æ™®é€šå‡½æ•°ä»¥ä¿ç•™ OnlyOffice å¯èƒ½çš„ `this` ä¸Šä¸‹æ–‡</span>
</span><span id="__span-32-409"><a id="__codelineno-32-409" name="__codelineno-32-409" href="#__codelineno-32-409"></a><span class="w">          </span><span class="kd">let</span><span class="w"> </span><span class="nx">userHandlerReturnValue</span><span class="p">;</span><span class="w"> </span><span class="c1">// å­˜å‚¨ç”¨æˆ·äº‹ä»¶å¤„ç†å™¨çš„è¿”å›å€¼</span>
</span><span id="__span-32-410"><a id="__codelineno-32-410" name="__codelineno-32-410" href="#__codelineno-32-410"></a><span class="w">          </span><span class="kd">let</span><span class="w"> </span><span class="nx">userHandlerCalled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"> </span><span class="c1">// æ ‡è®°ç”¨æˆ·äº‹ä»¶å¤„ç†å™¨æ˜¯å¦è¢«è°ƒç”¨</span>
</span><span id="__span-32-411"><a id="__codelineno-32-411" name="__codelineno-32-411" href="#__codelineno-32-411"></a>
</span><span id="__span-32-412"><a id="__codelineno-32-412" name="__codelineno-32-412" href="#__codelineno-32-412"></a><span class="w">          </span><span class="c1">// ä¼˜å…ˆçº§ 1: æ£€æŸ¥ props.config.events ä¸­æ˜¯å¦æœ‰æ­¤äº‹ä»¶çš„å¤„ç†å™¨</span>
</span><span id="__span-32-413"><a id="__codelineno-32-413" name="__codelineno-32-413" href="#__codelineno-32-413"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">config</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">self</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">events</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">self</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">eventName</span><span class="p">]</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">'function'</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-414"><a id="__codelineno-32-414" name="__codelineno-32-414" href="#__codelineno-32-414"></a><span class="w">            </span><span class="nx">userHandlerReturnValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">self</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">eventName</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="nx">eventArgs</span><span class="p">);</span><span class="w"> </span><span class="c1">// è°ƒç”¨å¹¶ä¼ å…¥å‚æ•°</span>
</span><span id="__span-32-415"><a id="__codelineno-32-415" name="__codelineno-32-415" href="#__codelineno-32-415"></a><span class="w">            </span><span class="nx">userHandlerCalled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-32-416"><a id="__codelineno-32-416" name="__codelineno-32-416" href="#__codelineno-32-416"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-32-417"><a id="__codelineno-32-417" name="__codelineno-32-417" href="#__codelineno-32-417"></a><span class="w">          </span><span class="c1">// ä¼˜å…ˆçº§ 2: å¦‚æœ props.config.events ä¸­æ²¡æœ‰ï¼Œåˆ™æ£€æŸ¥ props.events ä¸­æ˜¯å¦æœ‰</span>
</span><span id="__span-32-418"><a id="__codelineno-32-418" name="__codelineno-32-418" href="#__codelineno-32-418"></a><span class="w">          </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">events</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">self</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">eventName</span><span class="p">]</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">'function'</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-419"><a id="__codelineno-32-419" name="__codelineno-32-419" href="#__codelineno-32-419"></a><span class="w">            </span><span class="nx">userHandlerReturnValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">self</span><span class="p">.</span><span class="nx">events</span><span class="p">[</span><span class="nx">eventName</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="nx">eventArgs</span><span class="p">);</span>
</span><span id="__span-32-420"><a id="__codelineno-32-420" name="__codelineno-32-420" href="#__codelineno-32-420"></a><span class="w">            </span><span class="nx">userHandlerCalled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-32-421"><a id="__codelineno-32-421" name="__codelineno-32-421" href="#__codelineno-32-421"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-32-422"><a id="__codelineno-32-422" name="__codelineno-32-422" href="#__codelineno-32-422"></a>
</span><span id="__span-32-423"><a id="__codelineno-32-423" name="__codelineno-32-423" href="#__codelineno-32-423"></a><span class="w">          </span><span class="c1">// å§‹ç»ˆé€šè¿‡ $emit è§¦å‘ Vue ç»„ä»¶äº‹ä»¶</span>
</span><span id="__span-32-424"><a id="__codelineno-32-424" name="__codelineno-32-424" href="#__codelineno-32-424"></a><span class="w">          </span><span class="nx">self</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="nx">vueEventName</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">eventArgs</span><span class="p">);</span>
</span><span id="__span-32-425"><a id="__codelineno-32-425" name="__codelineno-32-425" href="#__codelineno-32-425"></a>
</span><span id="__span-32-426"><a id="__codelineno-32-426" name="__codelineno-32-426" href="#__codelineno-32-426"></a><span class="w">          </span><span class="c1">// å¦‚æœç”¨æˆ·äº‹ä»¶å¤„ç†å™¨è¢«è°ƒç”¨ä¸”æœ‰è¿”å›å€¼ï¼Œåˆ™è¿”å›è¯¥å€¼</span>
</span><span id="__span-32-427"><a id="__codelineno-32-427" name="__codelineno-32-427" href="#__codelineno-32-427"></a><span class="w">          </span><span class="c1">// (æŸäº› OnlyOffice äº‹ä»¶å¯èƒ½ä¾èµ–å¤„ç†å™¨çš„è¿”å›å€¼)</span>
</span><span id="__span-32-428"><a id="__codelineno-32-428" name="__codelineno-32-428" href="#__codelineno-32-428"></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">userHandlerCalled</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">userHandlerReturnValue</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-429"><a id="__codelineno-32-429" name="__codelineno-32-429" href="#__codelineno-32-429"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nx">userHandlerReturnValue</span><span class="p">;</span>
</span><span id="__span-32-430"><a id="__codelineno-32-430" name="__codelineno-32-430" href="#__codelineno-32-430"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-32-431"><a id="__codelineno-32-431" name="__codelineno-32-431" href="#__codelineno-32-431"></a><span class="w">        </span><span class="p">};</span>
</span><span id="__span-32-432"><a id="__codelineno-32-432" name="__codelineno-32-432" href="#__codelineno-32-432"></a><span class="w">      </span><span class="p">});</span>
</span><span id="__span-32-433"><a id="__codelineno-32-433" name="__codelineno-32-433" href="#__codelineno-32-433"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">handlers</span><span class="p">;</span><span class="w"> </span><span class="c1">// è¿”å›æ„å»ºå¥½çš„äº‹ä»¶å¤„ç†å™¨å¯¹è±¡</span>
</span><span id="__span-32-434"><a id="__codelineno-32-434" name="__codelineno-32-434" href="#__codelineno-32-434"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-32-435"><a id="__codelineno-32-435" name="__codelineno-32-435" href="#__codelineno-32-435"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-436"><a id="__codelineno-32-436" name="__codelineno-32-436" href="#__codelineno-32-436"></a><span class="cm">     * é”€æ¯å½“å‰çš„ OnlyOffice ç¼–è¾‘å™¨å®ä¾‹ã€‚</span>
</span><span id="__span-32-437"><a id="__codelineno-32-437" name="__codelineno-32-437" href="#__codelineno-32-437"></a><span class="cm">     * @returns {void}</span>
</span><span id="__span-32-438"><a id="__codelineno-32-438" name="__codelineno-32-438" href="#__codelineno-32-438"></a><span class="cm">     */</span>
</span><span id="__span-32-439"><a id="__codelineno-32-439" name="__codelineno-32-439" href="#__codelineno-32-439"></a><span class="w">    </span><span class="nx">destroyEditorInstance</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-440"><a id="__codelineno-32-440" name="__codelineno-32-440" href="#__codelineno-32-440"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">editorInstance</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-441"><a id="__codelineno-32-441" name="__codelineno-32-441" href="#__codelineno-32-441"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-442"><a id="__codelineno-32-442" name="__codelineno-32-442" href="#__codelineno-32-442"></a><span class="w">          </span><span class="k">this</span><span class="p">.</span><span class="nx">editorInstance</span><span class="p">.</span><span class="nx">destroyEditor</span><span class="p">();</span><span class="w"> </span><span class="c1">// è°ƒç”¨ OnlyOffice API çš„é”€æ¯æ–¹æ³•</span>
</span><span id="__span-32-443"><a id="__codelineno-32-443" name="__codelineno-32-443" href="#__codelineno-32-443"></a><span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] ç¼–è¾‘å™¨å®ä¾‹å·²é”€æ¯ã€‚'</span><span class="p">);</span>
</span><span id="__span-32-444"><a id="__codelineno-32-444" name="__codelineno-32-444" href="#__codelineno-32-444"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-445"><a id="__codelineno-32-445" name="__codelineno-32-445" href="#__codelineno-32-445"></a><span class="w">          </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] é”€æ¯ç¼–è¾‘å™¨å®ä¾‹æ—¶å‡ºé”™:'</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-32-446"><a id="__codelineno-32-446" name="__codelineno-32-446" href="#__codelineno-32-446"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-32-447"><a id="__codelineno-32-447" name="__codelineno-32-447" href="#__codelineno-32-447"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">editorInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"> </span><span class="c1">// æ¸…é™¤å®ä¾‹å¼•ç”¨</span>
</span><span id="__span-32-448"><a id="__codelineno-32-448" name="__codelineno-32-448" href="#__codelineno-32-448"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-32-449"><a id="__codelineno-32-449" name="__codelineno-32-449" href="#__codelineno-32-449"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-32-450"><a id="__codelineno-32-450" name="__codelineno-32-450" href="#__codelineno-32-450"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-32-451"><a id="__codelineno-32-451" name="__codelineno-32-451" href="#__codelineno-32-451"></a><span class="cm">     * å½“ä»»ä¸€ç›¸å…³ prop (é config æˆ– documentServerUrl) å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé‡æ–°åŠ è½½ç¼–è¾‘å™¨ã€‚</span>
</span><span id="__span-32-452"><a id="__codelineno-32-452" name="__codelineno-32-452" href="#__codelineno-32-452"></a><span class="cm">     * @returns {void}</span>
</span><span id="__span-32-453"><a id="__codelineno-32-453" name="__codelineno-32-453" href="#__codelineno-32-453"></a><span class="cm">     */</span>
</span><span id="__span-32-454"><a id="__codelineno-32-454" name="__codelineno-32-454" href="#__codelineno-32-454"></a><span class="w">    </span><span class="nx">reloadEditor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-455"><a id="__codelineno-32-455" name="__codelineno-32-455" href="#__codelineno-32-455"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isMounted</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span><span class="w"> </span><span class="c1">// å¦‚æœç»„ä»¶å°šæœªæŒ‚è½½ï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œ</span>
</span><span id="__span-32-456"><a id="__codelineno-32-456" name="__codelineno-32-456" href="#__codelineno-32-456"></a><span class="w">      </span><span class="c1">// ç¡®ä¿ API è„šæœ¬å·²åŠ è½½ä¸” DocsAPI å¯ç”¨</span>
</span><span id="__span-32-457"><a id="__codelineno-32-457" name="__codelineno-32-457" href="#__codelineno-32-457"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">apiScriptLoaded</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">DocsAPI</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-458"><a id="__codelineno-32-458" name="__codelineno-32-458" href="#__codelineno-32-458"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] Prop å‘ç”Ÿå˜åŒ–ï¼Œé‡æ–°åŠ è½½ç¼–è¾‘å™¨ã€‚'</span><span class="p">);</span>
</span><span id="__span-32-459"><a id="__codelineno-32-459" name="__codelineno-32-459" href="#__codelineno-32-459"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">initEditor</span><span class="p">();</span><span class="w"> </span><span class="c1">// é‡æ–°åˆå§‹åŒ–ç¼–è¾‘å™¨</span>
</span><span id="__span-32-460"><a id="__codelineno-32-460" name="__codelineno-32-460" href="#__codelineno-32-460"></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">apiScriptLoaded</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-461"><a id="__codelineno-32-461" name="__codelineno-32-461" href="#__codelineno-32-461"></a><span class="w">        </span><span class="c1">// å¦‚æœ API å°šæœªåŠ è½½ï¼Œåˆ™å‘å‡ºè­¦å‘Šï¼Œç¼–è¾‘å™¨å°†åœ¨ API åŠ è½½åè‡ªåŠ¨åˆå§‹åŒ–</span>
</span><span id="__span-32-462"><a id="__codelineno-32-462" name="__codelineno-32-462" href="#__codelineno-32-462"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">'[æ–‡æ¡£ç¼–è¾‘å™¨] Prop å‘ç”Ÿå˜åŒ–ï¼Œä½† API æœªåŠ è½½ã€‚ç¼–è¾‘å™¨å°†åœ¨ API åŠ è½½ååˆå§‹åŒ–ã€‚'</span><span class="p">);</span>
</span><span id="__span-32-463"><a id="__codelineno-32-463" name="__codelineno-32-463" href="#__codelineno-32-463"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-32-464"><a id="__codelineno-32-464" name="__codelineno-32-464" href="#__codelineno-32-464"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-32-465"><a id="__codelineno-32-465" name="__codelineno-32-465" href="#__codelineno-32-465"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-32-466"><a id="__codelineno-32-466" name="__codelineno-32-466" href="#__codelineno-32-466"></a><span class="p">};</span>
</span><span id="__span-32-467"><a id="__codelineno-32-467" name="__codelineno-32-467" href="#__codelineno-32-467"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-32-468"><a id="__codelineno-32-468" name="__codelineno-32-468" href="#__codelineno-32-468"></a>
</span><span id="__span-32-469"><a id="__codelineno-32-469" name="__codelineno-32-469" href="#__codelineno-32-469"></a><span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">"scss"</span> <span class="na">scoped</span><span class="p">&gt;</span>
</span><span id="__span-32-470"><a id="__codelineno-32-470" name="__codelineno-32-470" href="#__codelineno-32-470"></a><span class="p">.</span><span class="nc">view</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-471"><a id="__codelineno-32-471" name="__codelineno-32-471" href="#__codelineno-32-471"></a><span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span><span id="__span-32-472"><a id="__codelineno-32-472" name="__codelineno-32-472" href="#__codelineno-32-472"></a><span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span><span id="__span-32-473"><a id="__codelineno-32-473" name="__codelineno-32-473" href="#__codelineno-32-473"></a><span class="w">  </span><span class="k">min-height</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-32-474"><a id="__codelineno-32-474" name="__codelineno-32-474" href="#__codelineno-32-474"></a>
</span><span id="__span-32-475"><a id="__codelineno-32-475" name="__codelineno-32-475" href="#__codelineno-32-475"></a><span class="w">  </span><span class="err">&amp;</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="err">div</span><span class="w"> </span><span class="err">{</span>
</span><span id="__span-32-476"><a id="__codelineno-32-476" name="__codelineno-32-476" href="#__codelineno-32-476"></a><span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span><span id="__span-32-477"><a id="__codelineno-32-477" name="__codelineno-32-477" href="#__codelineno-32-477"></a><span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span><span id="__span-32-478"><a id="__codelineno-32-478" name="__codelineno-32-478" href="#__codelineno-32-478"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-32-479"><a id="__codelineno-32-479" name="__codelineno-32-479" href="#__codelineno-32-479"></a><span class="err">}</span>
</span><span id="__span-32-480"><a id="__codelineno-32-480" name="__codelineno-32-480" href="#__codelineno-32-480"></a><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></code></pre></div> <h4 id="513docdialogvue">5.1.3ã€DocDialog.vue<a class="headerlink" href="#513docdialogvue" title="é”šç‚¹é“¾æ¥">Â¶</a></h4> <div class="language-vue highlight"><span class="filename">Vue</span><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>  <span class="p">&lt;</span><span class="nt">el-dialog</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>    <span class="p">:</span><span class="na">close-on-click-modal</span><span class="o">=</span><span class="s">"</span><span class="kc">false</span><span class="s">"</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>    <span class="p">:</span><span class="na">visible</span><span class="p">.</span><span class="na">sync</span><span class="o">=</span><span class="s">"</span><span class="nx">dialogVisible</span><span class="s">"</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>    <span class="na">append-to-body</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>    <span class="na">class</span><span class="o">=</span><span class="s">"doc-dialog"</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>    <span class="na">width</span><span class="o">=</span><span class="s">"60%"</span><span class="p">&gt;</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>    <span class="p">&lt;</span><span class="nt">DocEditor</span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>      <span class="na">v-if</span><span class="o">=</span><span class="s">"</span><span class="nx">dialogVisible</span><span class="s">"</span>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>      <span class="p">:</span><span class="na">id</span><span class="o">=</span><span class="s">"</span><span class="nx">id</span><span class="s">"</span>
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>      <span class="p">:</span><span class="na">config</span><span class="o">=</span><span class="s">"</span><span class="nx">config</span><span class="s">"</span>
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>      <span class="p">:</span><span class="na">document-file-type</span><span class="o">=</span><span class="s">"</span><span class="nx">config</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentFileType</span><span class="s">"</span>
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a>      <span class="p">:</span><span class="na">document-title</span><span class="o">=</span><span class="s">"</span><span class="nx">config</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="s">"</span>
</span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a>      <span class="p">:</span><span class="na">events</span><span class="o">=</span><span class="s">"</span><span class="nx">config</span><span class="p">.</span><span class="nx">events</span><span class="s">"</span>
</span><span id="__span-33-15"><a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a>      <span class="na">class</span><span class="o">=</span><span class="s">"document-editor"</span>
</span><span id="__span-33-16"><a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a>    <span class="p">/&gt;</span>
</span><span id="__span-33-17"><a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a>  <span class="p">&lt;/</span><span class="nt">el-dialog</span><span class="p">&gt;</span>
</span><span id="__span-33-18"><a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a><span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</span><span id="__span-33-19"><a id="__codelineno-33-19" name="__codelineno-33-19" href="#__codelineno-33-19"></a>
</span><span id="__span-33-20"><a id="__codelineno-33-20" name="__codelineno-33-20" href="#__codelineno-33-20"></a><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-33-21"><a id="__codelineno-33-21" name="__codelineno-33-21" href="#__codelineno-33-21"></a><span class="k">import</span><span class="w"> </span><span class="nx">DocEditor</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">"@/components/DocEditor/index.vue"</span>
</span><span id="__span-33-22"><a id="__codelineno-33-22" name="__codelineno-33-22" href="#__codelineno-33-22"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="nx">generateKey</span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">"@/plugins/DocEditor/utils"</span><span class="p">;</span>
</span><span id="__span-33-23"><a id="__codelineno-33-23" name="__codelineno-33-23" href="#__codelineno-33-23"></a>
</span><span id="__span-33-24"><a id="__codelineno-33-24" name="__codelineno-33-24" href="#__codelineno-33-24"></a><span class="kd">const</span><span class="w"> </span><span class="nx">DOCUMENT_URL_TEMPLATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span><span class="si">}${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VUE_APP_BASE_API</span><span class="si">}</span><span class="sb">/upload/upAnnex/download/{fileId}`</span>
</span><span id="__span-33-25"><a id="__codelineno-33-25" name="__codelineno-33-25" href="#__codelineno-33-25"></a>
</span><span id="__span-33-26"><a id="__codelineno-33-26" name="__codelineno-33-26" href="#__codelineno-33-26"></a><span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-27"><a id="__codelineno-33-27" name="__codelineno-33-27" href="#__codelineno-33-27"></a><span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">"DocDialog"</span><span class="p">,</span>
</span><span id="__span-33-28"><a id="__codelineno-33-28" name="__codelineno-33-28" href="#__codelineno-33-28"></a><span class="w">  </span><span class="nx">components</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-29"><a id="__codelineno-33-29" name="__codelineno-33-29" href="#__codelineno-33-29"></a><span class="w">    </span><span class="nx">DocEditor</span>
</span><span id="__span-33-30"><a id="__codelineno-33-30" name="__codelineno-33-30" href="#__codelineno-33-30"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-33-31"><a id="__codelineno-33-31" name="__codelineno-33-31" href="#__codelineno-33-31"></a><span class="w">  </span><span class="nx">data</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-32"><a id="__codelineno-33-32" name="__codelineno-33-32" href="#__codelineno-33-32"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-33"><a id="__codelineno-33-33" name="__codelineno-33-33" href="#__codelineno-33-33"></a><span class="w">      </span><span class="c1">// ç»™å½“å‰æ–‡æ¡£ç¼–è¾‘å™¨åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ IDï¼Œç”¨äºåˆå§‹åŒ–å’Œç®¡ç†å¤šä¸ªå®ä¾‹æ—¶è¿›è¡ŒåŒºåˆ†</span>
</span><span id="__span-33-34"><a id="__codelineno-33-34" name="__codelineno-33-34" href="#__codelineno-33-34"></a><span class="w">      </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">'DocDialog'</span><span class="p">,</span>
</span><span id="__span-33-35"><a id="__codelineno-33-35" name="__codelineno-33-35" href="#__codelineno-33-35"></a><span class="w">      </span><span class="nx">config</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-36"><a id="__codelineno-33-36" name="__codelineno-33-36" href="#__codelineno-33-36"></a><span class="w">        </span><span class="c1">// ç¼–è¾‘å™¨é«˜åº¦çš„è®¾ç½®</span>
</span><span id="__span-33-37"><a id="__codelineno-33-37" name="__codelineno-33-37" href="#__codelineno-33-37"></a><span class="w">        </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="s2">"100%"</span><span class="p">,</span>
</span><span id="__span-33-38"><a id="__codelineno-33-38" name="__codelineno-33-38" href="#__codelineno-33-38"></a><span class="w">        </span><span class="c1">// æ–‡æ¡£ç›¸å…³é…ç½®</span>
</span><span id="__span-33-39"><a id="__codelineno-33-39" name="__codelineno-33-39" href="#__codelineno-33-39"></a><span class="w">        </span><span class="nb">document</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-40"><a id="__codelineno-33-40" name="__codelineno-33-40" href="#__codelineno-33-40"></a><span class="w">          </span><span class="c1">// æ–‡æ¡£çš„æ ‡é¢˜ï¼Œåœ¨ç¼–è¾‘å™¨ä¸­æ˜¾ç¤º</span>
</span><span id="__span-33-41"><a id="__codelineno-33-41" name="__codelineno-33-41" href="#__codelineno-33-41"></a><span class="w">          </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">'ç¼–è¾‘æµ‹è¯•'</span><span class="p">,</span>
</span><span id="__span-33-42"><a id="__codelineno-33-42" name="__codelineno-33-42" href="#__codelineno-33-42"></a><span class="w">          </span><span class="c1">// æ–‡ä»¶ç±»å‹ï¼Œä¾‹å¦‚ docxã€xlsxã€pptxã€pdf</span>
</span><span id="__span-33-43"><a id="__codelineno-33-43" name="__codelineno-33-43" href="#__codelineno-33-43"></a><span class="w">          </span><span class="nx">documentFileType</span><span class="o">:</span><span class="w"> </span><span class="s1">'docx'</span><span class="p">,</span>
</span><span id="__span-33-44"><a id="__codelineno-33-44" name="__codelineno-33-44" href="#__codelineno-33-44"></a><span class="w">          </span><span class="c1">// onlyofficeç”¨keyåšæ–‡ä»¶ç¼“å­˜ç´¢å¼•ï¼Œæ¨èæ¯æ¬¡éƒ½éšæœºç”Ÿæˆä¸€ä¸‹ï¼Œä¸ç„¶æ€»æ˜¯è¯»å–ç¼“å­˜ï¼Œå¦å¤–keyä¸­å»ºè®®æºå¸¦å”¯ä¸€è¯†åˆ«æ–‡ä»¶åç›¸å…³ä¿¡æ¯ï¼Œåœ¨å›è°ƒæ¥å£ä¸­ç”¨å¾—åˆ°</span>
</span><span id="__span-33-45"><a id="__codelineno-33-45" name="__codelineno-33-45" href="#__codelineno-33-45"></a><span class="w">          </span><span class="nx">key</span><span class="o">:</span><span class="w"> </span><span class="s1">'e932e7bb1e4d44xxxxxx1xx8sxx18'</span><span class="p">,</span>
</span><span id="__span-33-46"><a id="__codelineno-33-46" name="__codelineno-33-46" href="#__codelineno-33-46"></a><span class="w">          </span><span class="c1">// æ–‡æ¡£URL</span>
</span><span id="__span-33-47"><a id="__codelineno-33-47" name="__codelineno-33-47" href="#__codelineno-33-47"></a><span class="w">          </span><span class="nx">url</span><span class="o">:</span><span class="w"> </span><span class="s1">'http://host.docker.internal:8087/template/æµ‹è¯•.docx'</span><span class="p">,</span>
</span><span id="__span-33-48"><a id="__codelineno-33-48" name="__codelineno-33-48" href="#__codelineno-33-48"></a><span class="w">          </span><span class="nx">info</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-33-49"><a id="__codelineno-33-49" name="__codelineno-33-49" href="#__codelineno-33-49"></a><span class="w">          </span><span class="c1">// æ–‡æ¡£æƒé™</span>
</span><span id="__span-33-50"><a id="__codelineno-33-50" name="__codelineno-33-50" href="#__codelineno-33-50"></a><span class="w">          </span><span class="nx">permissions</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-51"><a id="__codelineno-33-51" name="__codelineno-33-51" href="#__codelineno-33-51"></a><span class="w">            </span><span class="c1">// èŠå¤©</span>
</span><span id="__span-33-52"><a id="__codelineno-33-52" name="__codelineno-33-52" href="#__codelineno-33-52"></a><span class="w">            </span><span class="nx">chat</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-33-53"><a id="__codelineno-33-53" name="__codelineno-33-53" href="#__codelineno-33-53"></a><span class="w">            </span><span class="c1">// æ˜¯å¦å¯ä»¥ç¼–è¾‘</span>
</span><span id="__span-33-54"><a id="__codelineno-33-54" name="__codelineno-33-54" href="#__codelineno-33-54"></a><span class="w">            </span><span class="nx">edit</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-33-55"><a id="__codelineno-33-55" name="__codelineno-33-55" href="#__codelineno-33-55"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-33-56"><a id="__codelineno-33-56" name="__codelineno-33-56" href="#__codelineno-33-56"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-33-57"><a id="__codelineno-33-57" name="__codelineno-33-57" href="#__codelineno-33-57"></a><span class="w">        </span><span class="nx">editorConfig</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-58"><a id="__codelineno-33-58" name="__codelineno-33-58" href="#__codelineno-33-58"></a><span class="w">          </span><span class="c1">// é¢„è§ˆæ¨¡å¼</span>
</span><span id="__span-33-59"><a id="__codelineno-33-59" name="__codelineno-33-59" href="#__codelineno-33-59"></a><span class="w">          </span><span class="nx">mode</span><span class="o">:</span><span class="w"> </span><span class="s2">"view"</span><span class="p">,</span>
</span><span id="__span-33-60"><a id="__codelineno-33-60" name="__codelineno-33-60" href="#__codelineno-33-60"></a><span class="w">          </span><span class="c1">// ç”¨æˆ·ä¿¡æ¯</span>
</span><span id="__span-33-61"><a id="__codelineno-33-61" name="__codelineno-33-61" href="#__codelineno-33-61"></a><span class="w">          </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-62"><a id="__codelineno-33-62" name="__codelineno-33-62" href="#__codelineno-33-62"></a><span class="w">            </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">"78e1e841"</span><span class="p">,</span>
</span><span id="__span-33-63"><a id="__codelineno-33-63" name="__codelineno-33-63" href="#__codelineno-33-63"></a><span class="w">            </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">"John Smith"</span><span class="p">,</span>
</span><span id="__span-33-64"><a id="__codelineno-33-64" name="__codelineno-33-64" href="#__codelineno-33-64"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-33-65"><a id="__codelineno-33-65" name="__codelineno-33-65" href="#__codelineno-33-65"></a><span class="w">          </span><span class="nx">customization</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-66"><a id="__codelineno-33-66" name="__codelineno-33-66" href="#__codelineno-33-66"></a><span class="w">            </span><span class="c1">// ç´§å‡‘å¸ƒå±€</span>
</span><span id="__span-33-67"><a id="__codelineno-33-67" name="__codelineno-33-67" href="#__codelineno-33-67"></a><span class="w">            </span><span class="nx">compactToolbar</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-33-68"><a id="__codelineno-33-68" name="__codelineno-33-68" href="#__codelineno-33-68"></a><span class="w">            </span><span class="c1">// å¸®åŠ©</span>
</span><span id="__span-33-69"><a id="__codelineno-33-69" name="__codelineno-33-69" href="#__codelineno-33-69"></a><span class="w">            </span><span class="nx">help</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-33-70"><a id="__codelineno-33-70" name="__codelineno-33-70" href="#__codelineno-33-70"></a><span class="w">            </span><span class="c1">// æ’ä»¶</span>
</span><span id="__span-33-71"><a id="__codelineno-33-71" name="__codelineno-33-71" href="#__codelineno-33-71"></a><span class="w">            </span><span class="nx">plugins</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-33-72"><a id="__codelineno-33-72" name="__codelineno-33-72" href="#__codelineno-33-72"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-33-73"><a id="__codelineno-33-73" name="__codelineno-33-73" href="#__codelineno-33-73"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-33-74"><a id="__codelineno-33-74" name="__codelineno-33-74" href="#__codelineno-33-74"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-33-75"><a id="__codelineno-33-75" name="__codelineno-33-75" href="#__codelineno-33-75"></a><span class="w">      </span><span class="c1">// å¯¹è¯æ¡†æ˜¯å¦æ˜¾ç¤º</span>
</span><span id="__span-33-76"><a id="__codelineno-33-76" name="__codelineno-33-76" href="#__codelineno-33-76"></a><span class="w">      </span><span class="nx">dialogVisible</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-33-77"><a id="__codelineno-33-77" name="__codelineno-33-77" href="#__codelineno-33-77"></a><span class="w">      </span><span class="c1">// æ–‡ä»¶å…ƒæ•°æ®</span>
</span><span id="__span-33-78"><a id="__codelineno-33-78" name="__codelineno-33-78" href="#__codelineno-33-78"></a><span class="w">      </span><span class="nx">fileMetadata</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-33-79"><a id="__codelineno-33-79" name="__codelineno-33-79" href="#__codelineno-33-79"></a><span class="w">      </span><span class="c1">// ç”¨æˆ·æ•°æ®</span>
</span><span id="__span-33-80"><a id="__codelineno-33-80" name="__codelineno-33-80" href="#__codelineno-33-80"></a><span class="w">      </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-33-81"><a id="__codelineno-33-81" name="__codelineno-33-81" href="#__codelineno-33-81"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-33-82"><a id="__codelineno-33-82" name="__codelineno-33-82" href="#__codelineno-33-82"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-33-83"><a id="__codelineno-33-83" name="__codelineno-33-83" href="#__codelineno-33-83"></a><span class="w">  </span><span class="nx">methods</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-84"><a id="__codelineno-33-84" name="__codelineno-33-84" href="#__codelineno-33-84"></a><span class="w">    </span><span class="nx">openDialog</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-85"><a id="__codelineno-33-85" name="__codelineno-33-85" href="#__codelineno-33-85"></a><span class="w">      </span><span class="c1">// å¡«å……ç”¨æˆ·æ•°æ®</span>
</span><span id="__span-33-86"><a id="__codelineno-33-86" name="__codelineno-33-86" href="#__codelineno-33-86"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">$store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">user</span>
</span><span id="__span-33-87"><a id="__codelineno-33-87" name="__codelineno-33-87" href="#__codelineno-33-87"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">editorConfig</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span>
</span><span id="__span-33-88"><a id="__codelineno-33-88" name="__codelineno-33-88" href="#__codelineno-33-88"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">editorConfig</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">nickName</span>
</span><span id="__span-33-89"><a id="__codelineno-33-89" name="__codelineno-33-89" href="#__codelineno-33-89"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">editorConfig</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span><span class="si">}</span><span class="sb">/</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">avatar</span><span class="si">}</span><span class="sb">`</span>
</span><span id="__span-33-90"><a id="__codelineno-33-90" name="__codelineno-33-90" href="#__codelineno-33-90"></a>
</span><span id="__span-33-91"><a id="__codelineno-33-91" name="__codelineno-33-91" href="#__codelineno-33-91"></a><span class="w">      </span><span class="c1">// å¡«å……æ–‡ä»¶å…ƒæ•°æ®</span>
</span><span id="__span-33-92"><a id="__codelineno-33-92" name="__codelineno-33-92" href="#__codelineno-33-92"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">fileMetadata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">file</span>
</span><span id="__span-33-93"><a id="__codelineno-33-93" name="__codelineno-33-93" href="#__codelineno-33-93"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">fileMetadata</span><span class="p">.</span><span class="nx">name</span>
</span><span id="__span-33-94"><a id="__codelineno-33-94" name="__codelineno-33-94" href="#__codelineno-33-94"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentFileType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">fileMetadata</span><span class="p">.</span><span class="nx">fileSuffix</span>
</span><span id="__span-33-95"><a id="__codelineno-33-95" name="__codelineno-33-95" href="#__codelineno-33-95"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">DOCUMENT_URL_TEMPLATE</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s1">'{fileId}'</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">fileMetadata</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>
</span><span id="__span-33-96"><a id="__codelineno-33-96" name="__codelineno-33-96" href="#__codelineno-33-96"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">generateKey</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">fileMetadata</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span>
</span><span id="__span-33-97"><a id="__codelineno-33-97" name="__codelineno-33-97" href="#__codelineno-33-97"></a><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="nx">dialogVisible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-33-98"><a id="__codelineno-33-98" name="__codelineno-33-98" href="#__codelineno-33-98"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-33-99"><a id="__codelineno-33-99" name="__codelineno-33-99" href="#__codelineno-33-99"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-33-100"><a id="__codelineno-33-100" name="__codelineno-33-100" href="#__codelineno-33-100"></a><span class="p">}</span>
</span><span id="__span-33-101"><a id="__codelineno-33-101" name="__codelineno-33-101" href="#__codelineno-33-101"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span><span id="__span-33-102"><a id="__codelineno-33-102" name="__codelineno-33-102" href="#__codelineno-33-102"></a>
</span><span id="__span-33-103"><a id="__codelineno-33-103" name="__codelineno-33-103" href="#__codelineno-33-103"></a><span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">"css"</span> <span class="na">scoped</span><span class="p">&gt;</span>
</span><span id="__span-33-104"><a id="__codelineno-33-104" name="__codelineno-33-104" href="#__codelineno-33-104"></a><span class="nt">div</span><span class="w"> </span><span class="o">/</span><span class="nt">deep</span><span class="o">/</span><span class="w"> </span><span class="p">.</span><span class="nc">el-dialog</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-105"><a id="__codelineno-33-105" name="__codelineno-33-105" href="#__codelineno-33-105"></a><span class="w">  </span><span class="k">left</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span><span id="__span-33-106"><a id="__codelineno-33-106" name="__codelineno-33-106" href="#__codelineno-33-106"></a><span class="w">  </span><span class="k">top</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span><span id="__span-33-107"><a id="__codelineno-33-107" name="__codelineno-33-107" href="#__codelineno-33-107"></a><span class="w">  </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">translate</span><span class="p">(</span><span class="mi">-50</span><span class="kt">%</span><span class="p">,</span><span class="w"> </span><span class="mi">-50</span><span class="kt">%</span><span class="p">);</span>
</span><span id="__span-33-108"><a id="__codelineno-33-108" name="__codelineno-33-108" href="#__codelineno-33-108"></a><span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
</span><span id="__span-33-109"><a id="__codelineno-33-109" name="__codelineno-33-109" href="#__codelineno-33-109"></a><span class="p">}</span>
</span><span id="__span-33-110"><a id="__codelineno-33-110" name="__codelineno-33-110" href="#__codelineno-33-110"></a>
</span><span id="__span-33-111"><a id="__codelineno-33-111" name="__codelineno-33-111" href="#__codelineno-33-111"></a><span class="p">.</span><span class="nc">doc-dialog</span><span class="w"> </span><span class="o">/</span><span class="nt">deep</span><span class="o">/</span><span class="w"> </span><span class="p">.</span><span class="nc">el-dialog__header</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-112"><a id="__codelineno-33-112" name="__codelineno-33-112" href="#__codelineno-33-112"></a><span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-33-113"><a id="__codelineno-33-113" name="__codelineno-33-113" href="#__codelineno-33-113"></a><span class="p">}</span>
</span><span id="__span-33-114"><a id="__codelineno-33-114" name="__codelineno-33-114" href="#__codelineno-33-114"></a>
</span><span id="__span-33-115"><a id="__codelineno-33-115" name="__codelineno-33-115" href="#__codelineno-33-115"></a><span class="p">.</span><span class="nc">doc-dialog</span><span class="w"> </span><span class="o">/</span><span class="nt">deep</span><span class="o">/</span><span class="w"> </span><span class="p">.</span><span class="nc">el-dialog__body</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-116"><a id="__codelineno-33-116" name="__codelineno-33-116" href="#__codelineno-33-116"></a><span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-33-117"><a id="__codelineno-33-117" name="__codelineno-33-117" href="#__codelineno-33-117"></a><span class="p">}</span>
</span><span id="__span-33-118"><a id="__codelineno-33-118" name="__codelineno-33-118" href="#__codelineno-33-118"></a>
</span><span id="__span-33-119"><a id="__codelineno-33-119" name="__codelineno-33-119" href="#__codelineno-33-119"></a><span class="p">.</span><span class="nc">doc-dialog</span><span class="w"> </span><span class="o">/</span><span class="nt">deep</span><span class="o">/</span><span class="w"> </span><span class="p">.</span><span class="nc">el-dialog__headerbtn</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-120"><a id="__codelineno-33-120" name="__codelineno-33-120" href="#__codelineno-33-120"></a><span class="w">  </span><span class="k">top</span><span class="p">:</span><span class="w"> </span><span class="mi">-8</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-33-121"><a id="__codelineno-33-121" name="__codelineno-33-121" href="#__codelineno-33-121"></a><span class="w">  </span><span class="k">right</span><span class="p">:</span><span class="w"> </span><span class="mi">-8</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-33-122"><a id="__codelineno-33-122" name="__codelineno-33-122" href="#__codelineno-33-122"></a><span class="p">}</span>
</span><span id="__span-33-123"><a id="__codelineno-33-123" name="__codelineno-33-123" href="#__codelineno-33-123"></a>
</span><span id="__span-33-124"><a id="__codelineno-33-124" name="__codelineno-33-124" href="#__codelineno-33-124"></a><span class="p">.</span><span class="nc">doc-dialog</span><span class="w"> </span><span class="o">/</span><span class="nt">deep</span><span class="o">/</span><span class="w"> </span><span class="p">.</span><span class="nc">el-icon-close</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-125"><a id="__codelineno-33-125" name="__codelineno-33-125" href="#__codelineno-33-125"></a><span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#d61616</span><span class="p">;</span>
</span><span id="__span-33-126"><a id="__codelineno-33-126" name="__codelineno-33-126" href="#__codelineno-33-126"></a><span class="w">  </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
</span><span id="__span-33-127"><a id="__codelineno-33-127" name="__codelineno-33-127" href="#__codelineno-33-127"></a><span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
</span><span id="__span-33-128"><a id="__codelineno-33-128" name="__codelineno-33-128" href="#__codelineno-33-128"></a><span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span><span id="__span-33-129"><a id="__codelineno-33-129" name="__codelineno-33-129" href="#__codelineno-33-129"></a><span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="p">;</span>
</span><span id="__span-33-130"><a id="__codelineno-33-130" name="__codelineno-33-130" href="#__codelineno-33-130"></a>
</span><span id="__span-33-131"><a id="__codelineno-33-131" name="__codelineno-33-131" href="#__codelineno-33-131"></a><span class="w">  </span><span class="err">&amp;::before</span><span class="w"> </span><span class="err">{</span>
</span><span id="__span-33-132"><a id="__codelineno-33-132" name="__codelineno-33-132" href="#__codelineno-33-132"></a><span class="w">    </span><span class="k">content</span><span class="p">:</span><span class="w"> </span><span class="s2">"\e78d"</span><span class="p">;</span>
</span><span id="__span-33-133"><a id="__codelineno-33-133" name="__codelineno-33-133" href="#__codelineno-33-133"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-33-134"><a id="__codelineno-33-134" name="__codelineno-33-134" href="#__codelineno-33-134"></a><span class="err">}</span>
</span><span id="__span-33-135"><a id="__codelineno-33-135" name="__codelineno-33-135" href="#__codelineno-33-135"></a>
</span><span id="__span-33-136"><a id="__codelineno-33-136" name="__codelineno-33-136" href="#__codelineno-33-136"></a><span class="p">.</span><span class="nc">document-editor</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-137"><a id="__codelineno-33-137" name="__codelineno-33-137" href="#__codelineno-33-137"></a><span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">90</span><span class="kt">vh</span><span class="p">;</span>
</span><span id="__span-33-138"><a id="__codelineno-33-138" name="__codelineno-33-138" href="#__codelineno-33-138"></a><span class="p">}</span>
</span><span id="__span-33-139"><a id="__codelineno-33-139" name="__codelineno-33-139" href="#__codelineno-33-139"></a><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></code></pre></div> <aside class="md-source-file"> <span class="md-source-file__fact"> <span class="md-icon" title="æœ€åæ›´æ–°"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2026å¹´1æœˆ22æ—¥ 20:21:58 UTC">2026å¹´1æœˆ22æ—¥ 20:21:58</span> </span> <span class="md-source-file__fact"> <span class="md-icon" title="åˆ›å»ºæ—¥æœŸ"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2021å¹´7æœˆ7æ—¥ 11:09:49 UTC">2021å¹´7æœˆ7æ—¥ 11:09:49</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type="button" class="md-top md-icon" data-md-component="top" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> å›åˆ°é¡µé¢é¡¶éƒ¨ </button> </main> <footer class="md-footer"> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.top", "navigation.tracking", "navigation.instant", "navigation.path", "content.tabs.link", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script> <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script> <script src="../../_javascripts/auto_title.js"></script>  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>